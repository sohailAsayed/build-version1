var YF=Object.create;var H1=Object.defineProperty,KF=Object.defineProperties,QF=Object.getOwnPropertyDescriptor,JF=Object.getOwnPropertyDescriptors,eN=Object.getOwnPropertyNames,jI=Object.getOwnPropertySymbols,tN=Object.getPrototypeOf,UI=Object.prototype.hasOwnProperty,nN=Object.prototype.propertyIsEnumerable;var VI=(n,r,e)=>r in n?H1(n,r,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[r]=e,ut=(n,r)=>{for(var e in r||={})UI.call(r,e)&&VI(n,e,r[e]);if(jI)for(var e of jI(r))nN.call(r,e)&&VI(n,e,r[e]);return n},Cn=(n,r)=>KF(n,JF(r));var $I=(n,r)=>()=>(r||n((r={exports:{}}).exports,r),r.exports);var iN=(n,r,e,s)=>{if(r&&typeof r=="object"||typeof r=="function")for(let u of eN(r))!UI.call(n,u)&&u!==e&&H1(n,u,{get:()=>r[u],enumerable:!(s=QF(r,u))||s.enumerable});return n};var HI=(n,r,e)=>(e=n!=null?YF(tN(n)):{},iN(r||!n||!n.__esModule?H1(e,"default",{value:n,enumerable:!0}):e,n));var Fm=(n,r,e)=>new Promise((s,u)=>{var i=j=>{try{L(e.next(j))}catch(Y){u(Y)}},E=j=>{try{L(e.throw(j))}catch(Y){u(Y)}},L=j=>j.done?s(j.value):Promise.resolve(j.value).then(i,E);L((e=e.apply(n,r)).next())});var QO=$I((IM,SM)=>{"use strict";(function(n,r){typeof IM=="object"&&typeof SM<"u"?SM.exports=r():typeof define=="function"&&define.amd?define(r):(n=typeof globalThis<"u"?globalThis:n||self,n.mapboxgl=r())})(IM,function(){"use strict";var n,r,e;function s(i,E){if(!n)n=E;else if(!r)r=E;else{var L="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+n+")(sharedChunk); ("+r+")(sharedChunk); self.onerror = null;",j={};n(j),e=E(j),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(e.workerUrl=window.URL.createObjectURL(new Blob([L],{type:"text/javascript"})))}}s(["exports"],function(i){"use strict";var E=typeof self<"u"?self:{},L="2.15.0";let j,Y={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(j==null){let o=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{j=process.env.API_URL_REGEX!=null?new RegExp(process.env.API_URL_REGEX):o}catch{j=o}}return j},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!Y.API_URL)return null;try{let o=new URL(Y.API_URL);return o.hostname==="api.mapbox.cn"?"https://events.mapbox.cn/events/v2":o.hostname==="api.mapbox.com"?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},oe={supported:!1,testSupport:function(o){!Ne&&Ye&&(ct?bt(o):Ee=o)}},Ee,Ye,Ne=!1,ct=!1;function bt(o){let t=o.createTexture();o.bindTexture(o.TEXTURE_2D,t);try{if(o.texImage2D(o.TEXTURE_2D,0,o.RGBA,o.RGBA,o.UNSIGNED_BYTE,Ye),o.isContextLost())return;oe.supported=!0}catch{}o.deleteTexture(t),Ne=!0}E.document&&(Ye=E.document.createElement("img"),Ye.onload=function(){Ee&&bt(Ee),Ee=null,ct=!0},Ye.onerror=function(){Ne=!0,Ee=null},Ye.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");let Ut="01";function Qt(o){return o&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o}var _i=Gn;function Gn(o,t,a,c){this.cx=3*o,this.bx=3*(a-o)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(c-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=o,this.p1y=t,this.p2x=a,this.p2y=c}Gn.prototype={sampleCurveX:function(o){return((this.ax*o+this.bx)*o+this.cx)*o},sampleCurveY:function(o){return((this.ay*o+this.by)*o+this.cy)*o},sampleCurveDerivativeX:function(o){return(3*this.ax*o+2*this.bx)*o+this.cx},solveCurveX:function(o,t){if(t===void 0&&(t=1e-6),o<0)return 0;if(o>1)return 1;for(var a=o,c=0;c<8;c++){var f=this.sampleCurveX(a)-o;if(Math.abs(f)<t)return a;var g=this.sampleCurveDerivativeX(a);if(Math.abs(g)<1e-6)break;a-=f/g}var v=0,C=1;for(a=o,c=0;c<20&&(f=this.sampleCurveX(a),!(Math.abs(f-o)<t));c++)o>f?v=a:C=a,a=.5*(C-v)+v;return a},solve:function(o,t){return this.sampleCurveY(this.solveCurveX(o,t))}};var Ro=Qt(_i),lt=_o;function _o(o,t){this.x=o,this.y=t}_o.prototype={clone:function(){return new _o(this.x,this.y)},add:function(o){return this.clone()._add(o)},sub:function(o){return this.clone()._sub(o)},multByPoint:function(o){return this.clone()._multByPoint(o)},divByPoint:function(o){return this.clone()._divByPoint(o)},mult:function(o){return this.clone()._mult(o)},div:function(o){return this.clone()._div(o)},rotate:function(o){return this.clone()._rotate(o)},rotateAround:function(o,t){return this.clone()._rotateAround(o,t)},matMult:function(o){return this.clone()._matMult(o)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(o){return this.x===o.x&&this.y===o.y},dist:function(o){return Math.sqrt(this.distSqr(o))},distSqr:function(o){var t=o.x-this.x,a=o.y-this.y;return t*t+a*a},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(o){return Math.atan2(this.y-o.y,this.x-o.x)},angleWith:function(o){return this.angleWithSep(o.x,o.y)},angleWithSep:function(o,t){return Math.atan2(this.x*t-this.y*o,this.x*o+this.y*t)},_matMult:function(o){var t=o[2]*this.x+o[3]*this.y;return this.x=o[0]*this.x+o[1]*this.y,this.y=t,this},_add:function(o){return this.x+=o.x,this.y+=o.y,this},_sub:function(o){return this.x-=o.x,this.y-=o.y,this},_mult:function(o){return this.x*=o,this.y*=o,this},_div:function(o){return this.x/=o,this.y/=o,this},_multByPoint:function(o){return this.x*=o.x,this.y*=o.y,this},_divByPoint:function(o){return this.x/=o.x,this.y/=o.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var o=this.y;return this.y=this.x,this.x=-o,this},_rotate:function(o){var t=Math.cos(o),a=Math.sin(o),c=a*this.x+t*this.y;return this.x=t*this.x-a*this.y,this.y=c,this},_rotateAround:function(o,t){var a=Math.cos(o),c=Math.sin(o),f=t.y+c*(this.x-t.x)+a*(this.y-t.y);return this.x=t.x+a*(this.x-t.x)-c*(this.y-t.y),this.y=f,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},_o.convert=function(o){return o instanceof _o?o:Array.isArray(o)?new _o(o[0],o[1]):o};var It=Qt(lt);let qs=Math.PI/180,Ja=180/Math.PI;function Pn(o){return o*qs}function tr(o){return o*Ja}let ec=[[0,0],[1,0],[1,1],[0,1]];function Zs(o){if(o<=0)return 0;if(o>=1)return 1;let t=o*o,a=t*o;return 4*(o<.5?a:3*(o-t)+a-.75)}function el(o,t,a,c){let f=new Ro(o,t,a,c);return function(g){return f.solve(g)}}let eu=el(.25,.1,.25,1);function Tn(o,t,a){return Math.min(a,Math.max(t,o))}function Yo(o,t,a){return(a=Tn((a-o)/(t-o),0,1))*a*(3-2*a)}function gr(o,t,a){let c=a-t,f=((o-t)%c+c)%c+t;return f===t?a:f}function wr(o,t,a){if(!o.length)return a(null,[]);let c=o.length,f=new Array(o.length),g=null;o.forEach((v,C)=>{t(v,(I,A)=>{I&&(g=I),f[C]=A,--c==0&&a(g,f)})})}function vo(o){let t=[];for(let a in o)t.push(o[a]);return t}function Bi(o,...t){for(let a of t)for(let c in a)o[c]=a[c];return o}let ms=1;function tl(){return ms++}function Xs(){return function o(t){return t?(t^Math.random()*(16>>t/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,o)}()}function Ys(o){return o<=1?1:Math.pow(2,Math.ceil(Math.log(o)/Math.LN2))}function gs(o){return!!o&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(o)}function Ma(o,t){o.forEach(a=>{t[a]&&(t[a]=t[a].bind(t))})}function nl(o,t){return o.indexOf(t,o.length-t.length)!==-1}function jn(o,t,a){let c={};for(let f in o)c[f]=t.call(a||this,o[f],f,o);return c}function Zt(o,t,a){let c={};for(let f in o)t.call(a||this,o[f],f,o)&&(c[f]=o[f]);return c}function bo(o){return Array.isArray(o)?o.map(bo):typeof o=="object"&&o?jn(o,bo):o}let Ta={};function vi(o){Ta[o]||(typeof console<"u"&&console.warn(o),Ta[o]=!0)}function xo(o,t,a){return(a.y-o.y)*(t.x-o.x)>(t.y-o.y)*(a.x-o.x)}function il(o){let t=0;for(let a,c,f=0,g=o.length,v=g-1;f<g;v=f++)a=o[f],c=o[v],t+=(c.x-a.x)*(a.y+c.y);return t}function ys(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function to(o){let t={};if(o.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(a,c,f,g)=>{let v=f||g;return t[c]=!v||v.toLowerCase(),""}),t["max-age"]){let a=parseInt(t["max-age"],10);isNaN(a)?delete t["max-age"]:t["max-age"]=a}return t}let Ks=null;function tc(o){if(Ks==null){let t=o.navigator?o.navigator.userAgent:null;Ks=!!o.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return Ks}function tu(o){try{let t=E[o];return t.setItem("_mapbox_test_",1),t.removeItem("_mapbox_test_"),!0}catch{return!1}}function no(o,t){return[o[4*t],o[4*t+1],o[4*t+2],o[4*t+3]]}let nc="mapbox-tiles",Mi=500,gd=50,Po,Ia;function ic(){try{return E.caches}catch{}}function Qs(){ic()&&!Po&&(Po=E.caches.open(nc))}function rc(o){let t=o.indexOf("?");if(t<0)return o;let a=function(f){let g=f.indexOf("?");return g>0?f.slice(g+1).split("&"):[]}(o),c=a.filter(f=>{let g=f.split("=");return g[0]==="language"||g[0]==="worldview"});return c.length?`${o.slice(0,t)}?${c.join("&")}`:o.slice(0,t)}let nu=1/0,rl={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(rl);class wo extends Error{constructor(t,a,c){a===401&&$e(c)&&(t+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(t),this.status=a,this.url=c}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}let Js=ys()?()=>self.worker&&self.worker.referrer:()=>(E.location.protocol==="blob:"?E.parent:E).location.href,Sr=function(o,t){if(!(/^file:/.test(a=o.url)||/^file:/.test(Js())&&!/^\w+:/.test(a))){if(E.fetch&&E.Request&&E.AbortController&&E.Request.prototype.hasOwnProperty("signal"))return function(c,f){let g=new E.AbortController,v=new E.Request(c.url,{method:c.method||"GET",body:c.body,credentials:c.credentials,headers:c.headers,referrer:Js(),referrerPolicy:c.referrerPolicy,signal:g.signal}),C=!1,I=!1,A=(F=v.url).indexOf("sku=")>0&&$e(F);var F;c.type==="json"&&v.headers.set("Accept","application/json");let V=(W,q,ee)=>{if(I)return;if(W&&W.message!=="SecurityError"&&vi(W.toString()),q&&ee)return $(q);let ae=Date.now();E.fetch(v).then(me=>{if(me.ok){let Ce=A?me.clone():null;return $(me,Ce,ae)}return f(new wo(me.statusText,me.status,c.url))}).catch(me=>{me.name!=="AbortError"&&f(new Error(`${me.message} ${c.url}`))})},$=(W,q,ee)=>{(c.type==="arrayBuffer"?W.arrayBuffer():c.type==="json"?W.json():W.text()).then(ae=>{I||(q&&ee&&function(me,Ce,ge){if(Qs(),!Po)return;let xe={status:Ce.status,statusText:Ce.statusText,headers:new E.Headers};Ce.headers.forEach((qe,We)=>xe.headers.set(We,qe));let Te=to(Ce.headers.get("Cache-Control")||"");if(Te["no-store"])return;Te["max-age"]&&xe.headers.set("Expires",new Date(ge+1e3*Te["max-age"]).toUTCString());let De=xe.headers.get("Expires");De&&(new Date(De).getTime()-ge<42e4||function(qe,We){if(Ia===void 0)try{new Response(new ReadableStream),Ia=!0}catch{Ia=!1}Ia?We(qe.body):qe.blob().then(We)}(Ce,qe=>{let We=new E.Response(qe,xe);Qs(),Po&&Po.then(et=>et.put(rc(me.url),We)).catch(et=>vi(et.message))}))}(v,q,ee),C=!0,f(null,ae,W.headers.get("Cache-Control"),W.headers.get("Expires")))}).catch(ae=>{I||f(new Error(ae.message))})};return A?function(W,q){if(Qs(),!Po)return q(null);let ee=rc(W.url);Po.then(ae=>{ae.match(ee).then(me=>{let Ce=function(ge){if(!ge)return!1;let xe=new Date(ge.headers.get("Expires")||0),Te=to(ge.headers.get("Cache-Control")||"");return xe>Date.now()&&!Te["no-cache"]}(me);ae.delete(ee),Ce&&ae.put(ee,me.clone()),q(null,me,Ce)}).catch(q)}).catch(q)}(v,V):V(null,null),{cancel:()=>{I=!0,C||g.abort()}}}(o,t);if(ys()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",o,t,void 0,!0)}var a;return function(c,f){let g=new E.XMLHttpRequest;g.open(c.method||"GET",c.url,!0),c.type==="arrayBuffer"&&(g.responseType="arraybuffer");for(let v in c.headers)g.setRequestHeader(v,c.headers[v]);return c.type==="json"&&(g.responseType="text",g.setRequestHeader("Accept","application/json")),g.withCredentials=c.credentials==="include",g.onerror=()=>{f(new Error(g.statusText))},g.onload=()=>{if((g.status>=200&&g.status<300||g.status===0)&&g.response!==null){let v=g.response;if(c.type==="json")try{v=JSON.parse(g.response)}catch(C){return f(C)}f(null,v,g.getResponseHeader("Cache-Control"),g.getResponseHeader("Expires"))}else f(new wo(g.statusText,g.status,c.url))},g.send(c.body),{cancel:()=>g.abort()}}(o,t)},ea=function(o,t){return Sr(Bi(o,{type:"arrayBuffer"}),t)};function yd(o){let t=E.document.createElement("a");return t.href=o,t.protocol===E.document.location.protocol&&t.host===E.document.location.host}let be="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=",ie,re;ie=[],re=0;let ve=function(o,t){if(oe.supported&&(o.headers||(o.headers={}),o.headers.accept="image/webp,*/*"),re>=Y.MAX_PARALLEL_IMAGE_REQUESTS){let g={requestParameters:o,callback:t,cancelled:!1,cancel(){this.cancelled=!0}};return ie.push(g),g}re++;let a=!1,c=()=>{if(!a)for(a=!0,re--;ie.length&&re<Y.MAX_PARALLEL_IMAGE_REQUESTS;){let g=ie.shift(),{requestParameters:v,callback:C,cancelled:I}=g;I||(g.cancel=ve(v,C).cancel)}},f=ea(o,(g,v,C,I)=>{c(),g?t(g):v&&(E.createImageBitmap?function(A,F){let V=new E.Blob([new Uint8Array(A)],{type:"image/png"});E.createImageBitmap(V).then($=>{F(null,$)}).catch($=>{F(new Error(`Could not load image because of ${$.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(v,(A,F)=>t(A,F,C,I)):function(A,F){let V=new E.Image,$=E.URL;V.onload=()=>{F(null,V),$.revokeObjectURL(V.src),V.onload=null,E.requestAnimationFrame(()=>{V.src=be})},V.onerror=()=>F(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));let W=new E.Blob([new Uint8Array(A)],{type:"image/png"});V.src=A.byteLength?$.createObjectURL(W):be}(v,(A,F)=>t(A,F,C,I)))});return{cancel:()=>{f.cancel(),c()}}},Ie="NO_ACCESS_TOKEN";function Pe(o){return o.indexOf("mapbox:")===0}function $e(o){return Y.API_URL_REGEX.test(o)}function Ve(o){return Y.API_CDN_URL_REGEX.test(o)}function Oe(o){return Y.API_STYLE_REGEX.test(o)&&!Xe(o)}function Xe(o){return Y.API_SPRITE_REGEX.test(o)}let Ct=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Tt(o){let t=o.match(Ct);if(!t)throw new Error("Unable to parse URL object");return{protocol:t[1],authority:t[2],path:t[3]||"/",params:t[4]?t[4].split("&"):[]}}function yt(o){let t=o.params.length?`?${o.params.join("&")}`:"";return`${o.protocol}://${o.authority}${o.path}${t}`}let cn="mapbox.eventData";function In(o){if(!o)return null;let t=o.split(".");if(!t||t.length!==3)return null;try{return JSON.parse(decodeURIComponent(E.atob(t[1]).split("").map(a=>"%"+("00"+a.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch{return null}}class dn{constructor(t){this.type=t,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(t){let a=In(Y.ACCESS_TOKEN),c="";return c=a&&a.u?E.btoa(encodeURIComponent(a.u).replace(/%([0-9A-F]{2})/g,(f,g)=>String.fromCharCode(+("0x"+g)))):Y.ACCESS_TOKEN||"",t?`${cn}.${t}:${c}`:`${cn}:${c}`}fetchEventData(){let t=tu("localStorage"),a=this.getStorageKey(),c=this.getStorageKey("uuid");if(t)try{let f=E.localStorage.getItem(a);f&&(this.eventData=JSON.parse(f));let g=E.localStorage.getItem(c);g&&(this.anonId=g)}catch{vi("Unable to read from LocalStorage")}}saveEventData(){let t=tu("localStorage"),a=this.getStorageKey(),c=this.getStorageKey("uuid");if(t)try{E.localStorage.setItem(c,this.anonId),Object.keys(this.eventData).length>=1&&E.localStorage.setItem(a,JSON.stringify(this.eventData))}catch{vi("Unable to write to LocalStorage")}}processRequests(t){}postEvent(t,a,c,f){if(!Y.EVENTS_URL)return;let g=Tt(Y.EVENTS_URL);g.params.push(`access_token=${f||Y.ACCESS_TOKEN||""}`);let v={event:this.type,created:new Date(t).toISOString()},C=a?Bi(v,a):v,I={url:yt(g),headers:{"Content-Type":"text/plain"},body:JSON.stringify([C])};this.pendingRequest=function(A,F){return Sr(Bi(A,{method:"POST"}),F)}(I,A=>{this.pendingRequest=null,c(A),this.saveEventData(),this.processRequests(f)})}queueRequest(t,a){this.queue.push(t),this.processRequests(a)}}let vn=new class extends dn{constructor(o){super("appUserTurnstile"),this._customAccessToken=o}postTurnstileEvent(o,t){Y.EVENTS_URL&&Y.ACCESS_TOKEN&&Array.isArray(o)&&o.some(a=>Pe(a)||$e(a))&&this.queueRequest(Date.now(),t)}processRequests(o){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();let t=In(Y.ACCESS_TOKEN),a=t?t.u:Y.ACCESS_TOKEN,c=a!==this.eventData.tokenU;gs(this.anonId)||(this.anonId=Xs(),c=!0);let f=this.queue.shift();if(this.eventData.lastSuccess){let g=new Date(this.eventData.lastSuccess),v=new Date(f),C=(f-this.eventData.lastSuccess)/864e5;c=c||C>=1||C<-1||g.getDate()!==v.getDate()}else c=!0;c?this.postEvent(f,{sdkIdentifier:"mapbox-gl-js",sdkVersion:L,skuId:Ut,"enabled.telemetry":!1,userId:this.anonId},g=>{g||(this.eventData.lastSuccess=f,this.eventData.tokenU=a)},o):this.processRequests()}},On=vn.postTurnstileEvent.bind(vn),Ln=new class extends dn{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(o,t,a,c){this.skuToken=t,this.errorCb=c,Y.EVENTS_URL&&(a||Y.ACCESS_TOKEN?this.queueRequest({id:o,timestamp:Date.now()},a):this.errorCb(new Error(Ie)))}processRequests(o){if(this.pendingRequest||this.queue.length===0)return;let{id:t,timestamp:a}=this.queue.shift();t&&this.success[t]||(this.anonId||this.fetchEventData(),gs(this.anonId)||(this.anonId=Xs()),this.postEvent(a,{sdkIdentifier:"mapbox-gl-js",sdkVersion:L,skuId:Ut,skuToken:this.skuToken,userId:this.anonId},c=>{c?this.errorCb(c):t&&(this.success[t]=!0)},o))}},nr=Ln.postMapLoadEvent.bind(Ln),Hr=new class extends dn{constructor(){super("gljs.performance")}postPerformanceEvent(o,t){Y.EVENTS_URL&&(o||Y.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:t},o)}processRequests(o){if(this.pendingRequest||this.queue.length===0)return;let{timestamp:t,performanceData:a}=this.queue.shift(),c=function(f){let g=E.performance.getEntriesByType("resource"),v=E.performance.getEntriesByType("mark"),C=function($){let W={};if($){for(let q in $)if(q!=="other")for(let ee of $[q]){let ae=`${q}ResolveRangeMin`,me=`${q}ResolveRangeMax`,Ce=`${q}RequestCount`,ge=`${q}RequestCachedCount`;W[ae]=Math.min(W[ae]||1/0,ee.startTime),W[me]=Math.max(W[me]||-1/0,ee.responseEnd);let xe=Te=>{W[Te]===void 0&&(W[Te]=0),++W[Te]};ee.transferSize!==void 0&&ee.transferSize===0&&xe(ge),xe(Ce)}}return W}(function($,W){let q={};if($)for(let ee of $){let ae=W(ee);q[ae]===void 0&&(q[ae]=[]),q[ae].push(ee)}return q}(g,Lh)),I=E.devicePixelRatio,A=E.navigator.connection||E.navigator.mozConnection||E.navigator.webkitConnection,F={counters:[],metadata:[],attributes:[]},V=($,W,q)=>{q!=null&&$.push({name:W,value:q.toString()})};for(let $ in C)V(F.counters,$,C[$]);if(f.interactionRange[0]!==1/0&&f.interactionRange[1]!==-1/0&&(V(F.counters,"interactionRangeMin",f.interactionRange[0]),V(F.counters,"interactionRangeMax",f.interactionRange[1])),v)for(let $ of Object.keys(oc)){let W=oc[$],q=v.find(ee=>ee.name===W);q&&V(F.counters,W,q.startTime)}return V(F.counters,"visibilityHidden",f.visibilityHidden),V(F.attributes,"style",function($){if($)for(let W of $){let q=W.name.split("?")[0];if(Oe(q)){let ee=q.split("/").slice(-2);if(ee.length===2)return`mapbox://styles/${ee[0]}/${ee[1]}`}}}(g)),V(F.attributes,"terrainEnabled",f.terrainEnabled?"true":"false"),V(F.attributes,"fogEnabled",f.fogEnabled?"true":"false"),V(F.attributes,"projection",f.projection),V(F.attributes,"zoom",f.zoom),V(F.metadata,"devicePixelRatio",I),V(F.metadata,"connectionEffectiveType",A?A.effectiveType:void 0),V(F.metadata,"navigatorUserAgent",E.navigator.userAgent),V(F.metadata,"screenWidth",E.screen.width),V(F.metadata,"screenHeight",E.screen.height),V(F.metadata,"windowWidth",E.innerWidth),V(F.metadata,"windowHeight",E.innerHeight),V(F.metadata,"mapWidth",f.width/I),V(F.metadata,"mapHeight",f.height/I),V(F.metadata,"webglRenderer",f.renderer),V(F.metadata,"webglVendor",f.vendor),V(F.metadata,"sdkVersion",L),V(F.metadata,"sdkIdentifier","mapbox-gl-js"),F}(a);for(let f of c.metadata);for(let f of c.counters);for(let f of c.attributes);this.postEvent(t,c,()=>{},o)}},yr=Hr.postPerformanceEvent.bind(Hr),_s=new class extends dn{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(o,t,a,c){if(!Y.API_URL||!Y.SESSION_PATH)return;let f=Tt(Y.API_URL+Y.SESSION_PATH);f.params.push(`sku=${t||""}`),f.params.push(`access_token=${c||Y.ACCESS_TOKEN||""}`);let g={url:yt(f),headers:{"Content-Type":"text/plain"}};this.pendingRequest=function(v,C){return Sr(Bi(v,{method:"GET"}),C)}(g,v=>{this.pendingRequest=null,a(v),this.saveEventData(),this.processRequests(c)})}getSessionAPI(o,t,a,c){this.skuToken=t,this.errorCb=c,Y.SESSION_PATH&&Y.API_URL&&(a||Y.ACCESS_TOKEN?this.queueRequest({id:o,timestamp:Date.now()},a):this.errorCb(new Error(Ie)))}processRequests(o){if(this.pendingRequest||this.queue.length===0)return;let{id:t,timestamp:a}=this.queue.shift();t&&this.success[t]||this.getSession(a,this.skuToken,c=>{c?this.errorCb(c):t&&(this.success[t]=!0)},o)}},Ar=_s.getSessionAPI.bind(_s),Gr=new Set,oc={create:"create",load:"load",fullLoad:"fullLoad"},Dp={mark(o){E.performance.mark(o)},measure(o,t,a){E.performance.measure(o,t,a)}};function Lh(o){let t=o.name.split("?")[0];return Ve(t)&&t.includes("mapbox-gl.js")?"javascript":Ve(t)&&t.includes("mapbox-gl.css")?"css":function(a){return Y.API_FONTS_REGEX.test(a)}(t)?"fontRange":Xe(t)?"sprite":Oe(t)?"style":function(a){return Y.API_TILEJSON_REGEX.test(a)}(t)?"tilejson":"other"}let ri=E.performance;function iu(o){let t=o?o.url.toString():void 0;return ri.getEntriesByName(t)}let Sa,Fh,bi,Ko,vs={now:()=>bi!==void 0?bi:E.performance.now(),setNow(o){bi=o},restoreNow(){bi=void 0},frame(o){let t=E.requestAnimationFrame(o);return{cancel:()=>E.cancelAnimationFrame(t)}},getImageData(o,t=0){let{width:a,height:c}=o;Ko||(Ko=E.document.createElement("canvas"));let f=Ko.getContext("2d",{willReadFrequently:!0});if(!f)throw new Error("failed to create canvas 2d context");return(a>Ko.width||c>Ko.height)&&(Ko.width=a,Ko.height=c),f.clearRect(-t,-t,a+2*t,c+2*t),f.drawImage(o,0,0,a,c),f.getImageData(-t,-t,a+2*t,c+2*t)},resolveURL:o=>(Sa||(Sa=E.document.createElement("a")),Sa.href=o,Sa.href),get devicePixelRatio(){return E.devicePixelRatio},get prefersReducedMotion(){return!!E.matchMedia&&(Fh==null&&(Fh=E.matchMedia("(prefers-reduced-motion: reduce)")),Fh.matches)}};function Nh(o,t,a){a[o]&&a[o].indexOf(t)!==-1||(a[o]=a[o]||[],a[o].push(t))}function zh(o,t,a){if(a&&a[o]){let c=a[o].indexOf(t);c!==-1&&a[o].splice(c,1)}}class ol{constructor(t,a={}){Bi(this,a),this.type=t}}class ta extends ol{constructor(t,a={}){super("error",Bi({error:t},a))}}class sc{on(t,a){return this._listeners=this._listeners||{},Nh(t,a,this._listeners),this}off(t,a){return zh(t,a,this._listeners),zh(t,a,this._oneTimeListeners),this}once(t,a){return a?(this._oneTimeListeners=this._oneTimeListeners||{},Nh(t,a,this._oneTimeListeners),this):new Promise(c=>this.once(t,c))}fire(t,a){typeof t=="string"&&(t=new ol(t,a||{}));let c=t.type;if(this.listens(c)){t.target=this;let f=this._listeners&&this._listeners[c]?this._listeners[c].slice():[];for(let C of f)C.call(this,t);let g=this._oneTimeListeners&&this._oneTimeListeners[c]?this._oneTimeListeners[c].slice():[];for(let C of g)zh(c,C,this._oneTimeListeners),C.call(this,t);let v=this._eventedParent;v&&(Bi(t,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),v.fire(t))}else t instanceof ta&&console.error(t.error);return this}listens(t){return!!(this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t))}setEventedParent(t,a){return this._eventedParent=t,this._eventedParentData=a,this}}var Je=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360,"units":"degrees"},"pitch":{"type":"number","default":0,"units":"degrees"},"light":{"type":"light"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":{},"mapbox":{}},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":{}}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":{}}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":{}}},"url":{"required":true,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"background":{},"sky":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],"layout_background":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","private":true,"default":0,"minimum":0,"maximum":1,"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":{},"round":{},"square":{}},"default":"butt","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":{},"round":{},"miter":{}},"default":"miter","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"requires":[{"line-join":"miter"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"requires":[{"line-join":"round"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":{},"line":{},"line-center":{}},"default":"point","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"units":"pixels","requires":[{"symbol-placement":"line"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":{},"viewport-y":{},"source":{}},"default":"auto","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"units":"factor of the original icon size","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":{},"width":{},"height":{},"both":{}},"default":"none","requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"units":"pixels","requires":["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"requires":["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"units":"ems","requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":{},"left":{},"center":{},"right":{}},"default":"center","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","units":"ems","default":0,"requires":["text-field"],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["text-field",{"!":"text-variable-anchor"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"units":"degrees","requires":["text-field",{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":{},"vertical":{}},"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"requires":["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":{},"uppercase":{},"lowercase":{}},"default":"none","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","units":"ems","length":2,"default":[0,0],"requires":["text-field",{"!":"text-radial-offset"}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"requires":["text-field","icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},"in":{},"!in":{},"all":{},"any":{},"none":{},"has":{},"!has":{},"within":{}}},"geometry_type":{"type":"enum","values":{"Point":{},"LineString":{},"Polygon":{}}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":{},"exponential":{},"interval":{},"categorical":{}},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":{},"lab":{},"hcl":{}},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":{},"viewport":{}},"property-type":"data-constant","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":{},"equalEarth":{},"equirectangular":{},"lambertConformalConic":{},"mercator":{},"naturalEarth":{},"winkelTripel":{},"globe":{}},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["source"]}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"requires":[{"!":"fill-pattern"},{"fill-antialias":true}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-extrusion-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-extrusion-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"requires":["fill-extrusion-height"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["fill-extrusion-edge-radius"]},"fill-extrusion-rounded-roof":{"type":"boolean","default":true,"requires":["fill-extrusion-edge-radius"],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"line-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["line-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"transition":false,"units":"line widths","requires":[{"!":"line-pattern"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","transition":false,"requires":[{"!":"line-pattern"},{"source":"geojson","has":{"lineMetrics":true}}],"expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"transition":false,"requires":[{"source":"geojson","has":{"lineMetrics":true}}],"property-type":"constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["circle-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"transition":false,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"transition":false,"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["icon-image","icon-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["text-field","text-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"units":"degrees","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":{},"nearest":{}},"default":"linear","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"transition":false,"units":"milliseconds","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"transition":false,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"background-pattern"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":{},"atmosphere":{}},"default":"atmosphere","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"requires":[{"sky-type":"atmosphere"}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","requires":[{"sky-type":"atmosphere"}],"default":10,"minimum":0,"maximum":100,"transition":false,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","requires":[{"sky-type":"gradient"}],"value":"number","default":[0,0],"length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","requires":[{"sky-type":"gradient"}],"default":90,"minimum":0,"maximum":180,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"transition":false,"requires":[{"sky-type":"gradient"}],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0,"units":"milliseconds"},"delay":{"type":"number","default":0,"minimum":0,"units":"milliseconds"}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function na(o,...t){for(let a of t)for(let c in a)o[c]=a[c];return o}function ur(o){return o instanceof Number||o instanceof String||o instanceof Boolean?o.valueOf():o}function kr(o){if(Array.isArray(o))return o.map(kr);if(o instanceof Object&&!(o instanceof Number||o instanceof String||o instanceof Boolean)){let t={};for(let a in o)t[a]=kr(o[a]);return t}return ur(o)}class ru extends Error{constructor(t,a){super(a),this.message=a,this.key=t}}var Qo=ru;class _d{constructor(t,a=[]){this.parent=t,this.bindings={};for(let[c,f]of a)this.bindings[c]=f}concat(t){return new _d(this,t)}get(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(`${t} not found in scope.`)}has(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)}}var ou=_d;let sl={kind:"null"},Mt={kind:"number"},En={kind:"string"},kn={kind:"boolean"},Co={kind:"color"},Jo={kind:"object"},Dn={kind:"value"},Wr={kind:"collator"},su={kind:"formatted"},al={kind:"resolvedImage"};function Eo(o,t){return{kind:"array",itemType:o,N:t}}function Ti(o){if(o.kind==="array"){let t=Ti(o.itemType);return typeof o.N=="number"?`array<${t}, ${o.N}>`:o.itemType.kind==="value"?"array":`array<${t}>`}return o.kind}let ll=[sl,Mt,En,kn,Co,su,Jo,Eo(Dn),al];function ia(o,t){if(t.kind==="error")return null;if(o.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!ia(o.itemType,t.itemType))&&(typeof o.N!="number"||o.N===t.N))return null}else{if(o.kind===t.kind)return null;if(o.kind==="value"){for(let a of ll)if(!ia(a,t))return null}}return`Expected ${Ti(o)} but found ${Ti(t)} instead.`}function Aa(o,t){return t.some(a=>a.kind===o.kind)}function au(o,t){return t.some(a=>a==="null"?o===null:a==="array"?Array.isArray(o):a==="object"?o&&!Array.isArray(o)&&typeof o=="object":a===typeof o)}var Bh,Mp={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function cl(o){return(o=Math.round(o))<0?0:o>255?255:o}function lu(o){return cl(o[o.length-1]==="%"?parseFloat(o)/100*255:parseInt(o))}function ul(o){return(t=o[o.length-1]==="%"?parseFloat(o)/100:parseFloat(o))<0?0:t>1?1:t;var t}function dl(o,t,a){return a<0?a+=1:a>1&&(a-=1),6*a<1?o+(t-o)*a*6:2*a<1?t:3*a<2?o+(t-o)*(2/3-a)*6:o}try{Bh={}.parseCSSColor=function(o){var t,a=o.replace(/ /g,"").toLowerCase();if(a in Mp)return Mp[a].slice();if(a[0]==="#")return a.length===4?(t=parseInt(a.substr(1),16))>=0&&t<=4095?[(3840&t)>>4|(3840&t)>>8,240&t|(240&t)>>4,15&t|(15&t)<<4,1]:null:a.length===7&&(t=parseInt(a.substr(1),16))>=0&&t<=16777215?[(16711680&t)>>16,(65280&t)>>8,255&t,1]:null;var c=a.indexOf("("),f=a.indexOf(")");if(c!==-1&&f+1===a.length){var g=a.substr(0,c),v=a.substr(c+1,f-(c+1)).split(","),C=1;switch(g){case"rgba":if(v.length!==4)return null;C=ul(v.pop());case"rgb":return v.length!==3?null:[lu(v[0]),lu(v[1]),lu(v[2]),C];case"hsla":if(v.length!==4)return null;C=ul(v.pop());case"hsl":if(v.length!==3)return null;var I=(parseFloat(v[0])%360+360)%360/360,A=ul(v[1]),F=ul(v[2]),V=F<=.5?F*(A+1):F+A-F*A,$=2*F-V;return[cl(255*dl($,V,I+1/3)),cl(255*dl($,V,I)),cl(255*dl($,V,I-1/3)),C];default:return null}}return null}}catch{}class Wi{constructor(t,a,c,f=1){this.r=t,this.g=a,this.b=c,this.a=f}static parse(t){if(!t)return;if(t instanceof Wi)return t;if(typeof t!="string")return;let a=Bh(t);return a?new Wi(a[0]/255*a[3],a[1]/255*a[3],a[2]/255*a[3],a[3]):void 0}toString(){let[t,a,c,f]=this.toArray();return`rgba(${Math.round(t)},${Math.round(a)},${Math.round(c)},${f})`}toArray(){let{r:t,g:a,b:c,a:f}=this;return f===0?[0,0,0,0]:[255*t/f,255*a/f,255*c/f,f]}toArray01(){let{r:t,g:a,b:c,a:f}=this;return f===0?[0,0,0,0]:[t/f,a/f,c/f,f]}toArray01PremultipliedAlpha(){let{r:t,g:a,b:c,a:f}=this;return[t,a,c,f]}}Wi.black=new Wi(0,0,0,1),Wi.white=new Wi(1,1,1,1),Wi.transparent=new Wi(0,0,0,0),Wi.red=new Wi(1,0,0,1),Wi.blue=new Wi(0,0,1,1);var ir=Wi;class hl{constructor(t,a,c){this.sensitivity=t?a?"variant":"case":a?"accent":"base",this.locale=c,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(t,a){return this.collator.compare(t,a)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class cu{constructor(t,a,c,f,g){this.text=t.normalize?t.normalize():t,this.image=a,this.scale=c,this.fontStack=f,this.textColor=g}}class qr{constructor(t){this.sections=t}static fromString(t){return new qr([new cu(t,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(t=>t.text.length!==0||t.image&&t.image.name.length!==0)}static factory(t){return t instanceof qr?t:qr.fromString(t)}toString(){return this.sections.length===0?"":this.sections.map(t=>t.text).join("")}serialize(){let t=["format"];for(let a of this.sections){if(a.image){t.push(["image",a.image.name]);continue}t.push(a.text);let c={};a.fontStack&&(c["text-font"]=["literal",a.fontStack.split(",")]),a.scale&&(c["font-scale"]=a.scale),a.textColor&&(c["text-color"]=["rgba"].concat(a.textColor.toArray())),t.push(c)}return t}}class Do{constructor(t){this.name=t.name,this.available=t.available}toString(){return this.name}static fromString(t){return t?new Do({name:t,available:!1}):null}serialize(){return["image",this.name]}}function jh(o,t,a,c){return typeof o=="number"&&o>=0&&o<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof a=="number"&&a>=0&&a<=255?c===void 0||typeof c=="number"&&c>=0&&c<=1?null:`Invalid rgba value [${[o,t,a,c].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof c=="number"?[o,t,a,c]:[o,t,a]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function uu(o){if(o===null||typeof o=="string"||typeof o=="boolean"||typeof o=="number"||o instanceof ir||o instanceof hl||o instanceof qr||o instanceof Do)return!0;if(Array.isArray(o)){for(let t of o)if(!uu(t))return!1;return!0}if(typeof o=="object"){for(let t in o)if(!uu(o[t]))return!1;return!0}return!1}function qi(o){if(o===null)return sl;if(typeof o=="string")return En;if(typeof o=="boolean")return kn;if(typeof o=="number")return Mt;if(o instanceof ir)return Co;if(o instanceof hl)return Wr;if(o instanceof qr)return su;if(o instanceof Do)return al;if(Array.isArray(o)){let t=o.length,a;for(let c of o){let f=qi(c);if(a){if(a===f)continue;a=Dn;break}a=f}return Eo(a||Dn,t)}return Jo}function ac(o){let t=typeof o;return o===null?"":t==="string"||t==="number"||t==="boolean"?String(o):o instanceof ir||o instanceof qr||o instanceof Do?o.toString():JSON.stringify(o)}class du{constructor(t,a){this.type=t,this.value=a}static parse(t,a){if(t.length!==2)return a.error(`'literal' expression requires exactly one argument, but found ${t.length-1} instead.`);if(!uu(t[1]))return a.error("invalid value");let c=t[1],f=qi(c),g=a.expectedType;return f.kind!=="array"||f.N!==0||!g||g.kind!=="array"||typeof g.N=="number"&&g.N!==0||(f=g),new du(f,c)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof ir?["rgba"].concat(this.value.toArray()):this.value instanceof qr?this.value.serialize():this.value}}var Oo=du,Ii=class{constructor(o){this.name="ExpressionEvaluationError",this.message=o}toJSON(){return this.message}};let lc={string:En,number:Mt,boolean:kn,object:Jo};class Vh{constructor(t,a){this.type=t,this.args=a}static parse(t,a){if(t.length<2)return a.error("Expected at least one argument.");let c,f=1,g=t[0];if(g==="array"){let C,I;if(t.length>2){let A=t[1];if(typeof A!="string"||!(A in lc)||A==="object")return a.error('The item type argument of "array" must be one of string, number, boolean',1);C=lc[A],f++}else C=Dn;if(t.length>3){if(t[2]!==null&&(typeof t[2]!="number"||t[2]<0||t[2]!==Math.floor(t[2])))return a.error('The length argument to "array" must be a positive integer literal',2);I=t[2],f++}c=Eo(C,I)}else c=lc[g];let v=[];for(;f<t.length;f++){let C=a.parse(t[f],f,Dn);if(!C)return null;v.push(C)}return new Vh(c,v)}evaluate(t){for(let a=0;a<this.args.length;a++){let c=this.args[a].evaluate(t);if(!ia(this.type,qi(c)))return c;if(a===this.args.length-1)throw new Ii(`Expected value to be of type ${Ti(this.type)}, but found ${Ti(qi(c))} instead.`)}return null}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}serialize(){let t=this.type,a=[t.kind];if(t.kind==="array"){let c=t.itemType;if(c.kind==="string"||c.kind==="number"||c.kind==="boolean"){a.push(c.kind);let f=t.N;(typeof f=="number"||this.args.length>1)&&a.push(f)}}return a.concat(this.args.map(c=>c.serialize()))}}var ra=Vh;class ka{constructor(t){this.type=su,this.sections=t}static parse(t,a){if(t.length<2)return a.error("Expected at least one argument.");let c=t[1];if(!Array.isArray(c)&&typeof c=="object")return a.error("First argument must be an image or text section.");let f=[],g=!1;for(let v=1;v<=t.length-1;++v){let C=t[v];if(g&&typeof C=="object"&&!Array.isArray(C)){g=!1;let I=null;if(C["font-scale"]&&(I=a.parse(C["font-scale"],1,Mt),!I))return null;let A=null;if(C["text-font"]&&(A=a.parse(C["text-font"],1,Eo(En)),!A))return null;let F=null;if(C["text-color"]&&(F=a.parse(C["text-color"],1,Co),!F))return null;let V=f[f.length-1];V.scale=I,V.font=A,V.textColor=F}else{let I=a.parse(t[v],1,Dn);if(!I)return null;let A=I.type.kind;if(A!=="string"&&A!=="value"&&A!=="null"&&A!=="resolvedImage")return a.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");g=!0,f.push({content:I,scale:null,font:null,textColor:null})}}return new ka(f)}evaluate(t){return new qr(this.sections.map(a=>{let c=a.content.evaluate(t);return qi(c)===al?new cu("",c,null,null,null):new cu(ac(c),null,a.scale?a.scale.evaluate(t):null,a.font?a.font.evaluate(t).join(","):null,a.textColor?a.textColor.evaluate(t):null)}))}eachChild(t){for(let a of this.sections)t(a.content),a.scale&&t(a.scale),a.font&&t(a.font),a.textColor&&t(a.textColor)}outputDefined(){return!1}serialize(){let t=["format"];for(let a of this.sections){t.push(a.content.serialize());let c={};a.scale&&(c["font-scale"]=a.scale.serialize()),a.font&&(c["text-font"]=a.font.serialize()),a.textColor&&(c["text-color"]=a.textColor.serialize()),t.push(c)}return t}}class hu{constructor(t){this.type=al,this.input=t}static parse(t,a){if(t.length!==2)return a.error("Expected two arguments.");let c=a.parse(t[1],1,En);return c?new hu(c):a.error("No image name provided.")}evaluate(t){let a=this.input.evaluate(t),c=Do.fromString(a);return c&&t.availableImages&&(c.available=t.availableImages.indexOf(a)>-1),c}eachChild(t){t(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}let Cr={"to-boolean":kn,"to-color":Co,"to-number":Mt,"to-string":En};class Lo{constructor(t,a){this.type=t,this.args=a}static parse(t,a){if(t.length<2)return a.error("Expected at least one argument.");let c=t[0];if((c==="to-boolean"||c==="to-string")&&t.length!==2)return a.error("Expected one argument.");let f=Cr[c],g=[];for(let v=1;v<t.length;v++){let C=a.parse(t[v],v,Dn);if(!C)return null;g.push(C)}return new Lo(f,g)}evaluate(t){if(this.type.kind==="boolean")return!!this.args[0].evaluate(t);if(this.type.kind==="color"){let a,c;for(let f of this.args){if(a=f.evaluate(t),c=null,a instanceof ir)return a;if(typeof a=="string"){let g=t.parseColor(a);if(g)return g}else if(Array.isArray(a)&&(c=a.length<3||a.length>4?`Invalid rbga value ${JSON.stringify(a)}: expected an array containing either three or four numeric values.`:jh(a[0],a[1],a[2],a[3]),!c))return new ir(a[0]/255,a[1]/255,a[2]/255,a[3])}throw new Ii(c||`Could not parse color from value '${typeof a=="string"?a:String(JSON.stringify(a))}'`)}if(this.type.kind==="number"){let a=null;for(let c of this.args){if(a=c.evaluate(t),a===null)return 0;let f=Number(a);if(!isNaN(f))return f}throw new Ii(`Could not convert ${JSON.stringify(a)} to number.`)}return this.type.kind==="formatted"?qr.fromString(ac(this.args[0].evaluate(t))):this.type.kind==="resolvedImage"?Do.fromString(ac(this.args[0].evaluate(t))):ac(this.args[0].evaluate(t))}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}serialize(){if(this.type.kind==="formatted")return new ka([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new hu(this.args[0]).serialize();let t=[`to-${this.type.kind}`];return this.eachChild(a=>{t.push(a.serialize())}),t}}var fl=Lo;let bs=["Unknown","Point","LineString","Polygon"];var vd=class{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?bs[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){let o=this.featureDistanceData.center,t=this.featureDistanceData.scale,{x:a,y:c}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(a*t-o[0])+this.featureDistanceData.bearing[1]*(c*t-o[1])}return 0}parseColor(o){let t=this._parseColorCache[o];return t||(t=this._parseColorCache[o]=ir.parse(o)),t}};class es{constructor(t,a,c,f){this.name=t,this.type=a,this._evaluate=c,this.args=f}evaluate(t){return this._evaluate(t,this.args)}eachChild(t){this.args.forEach(t)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(t=>t.serialize()))}static parse(t,a){let c=t[0],f=es.definitions[c];if(!f)return a.error(`Unknown expression "${c}". If you wanted a literal array, use ["literal", [...]].`,0);let g=Array.isArray(f)?f[0]:f.type,v=Array.isArray(f)?[[f[1],f[2]]]:f.overloads,C=v.filter(([A])=>!Array.isArray(A)||A.length===t.length-1),I=null;for(let[A,F]of C){I=new Dd(a.registry,a.path,null,a.scope);let V=[],$=!1;for(let W=1;W<t.length;W++){let q=t[W],ee=Array.isArray(A)?A[W-1]:A.type,ae=I.parse(q,1+V.length,ee);if(!ae){$=!0;break}V.push(ae)}if(!$)if(Array.isArray(A)&&A.length!==V.length)I.error(`Expected ${A.length} arguments, but found ${V.length} instead.`);else{for(let W=0;W<V.length;W++){let q=Array.isArray(A)?A[W]:A.type,ee=V[W];I.concat(W+1).checkSubtype(q,ee.type)}if(I.errors.length===0)return new es(c,g,F,V)}}if(C.length===1)a.errors.push(...I.errors);else{let A=(C.length?C:v).map(([V])=>{return $=V,Array.isArray($)?`(${$.map(Ti).join(", ")})`:`(${Ti($.type)}...)`;var $}).join(" | "),F=[];for(let V=1;V<t.length;V++){let $=a.parse(t[V],1+F.length);if(!$)return null;F.push(Ti($.type))}a.error(`Expected arguments of type ${A}, but found (${F.join(", ")}) instead.`)}return null}static register(t,a){es.definitions=a;for(let c in a)t[c]=es}}var oa=es;class Ra{constructor(t,a,c){this.type=Wr,this.locale=c,this.caseSensitive=t,this.diacriticSensitive=a}static parse(t,a){if(t.length!==2)return a.error("Expected one argument.");let c=t[1];if(typeof c!="object"||Array.isArray(c))return a.error("Collator options argument must be an object.");let f=a.parse(c["case-sensitive"]!==void 0&&c["case-sensitive"],1,kn);if(!f)return null;let g=a.parse(c["diacritic-sensitive"]!==void 0&&c["diacritic-sensitive"],1,kn);if(!g)return null;let v=null;return c.locale&&(v=a.parse(c.locale,1,En),!v)?null:new Ra(f,g,v)}evaluate(t){return new hl(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)}eachChild(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)}outputDefined(){return!1}serialize(){let t={};return t["case-sensitive"]=this.caseSensitive.serialize(),t["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(t.locale=this.locale.serialize()),["collator",t]}}let xs=8192;function ws(o,t){o[0]=Math.min(o[0],t[0]),o[1]=Math.min(o[1],t[1]),o[2]=Math.max(o[2],t[0]),o[3]=Math.max(o[3],t[1])}function pl(o,t){return!(o[0]<=t[0]||o[2]>=t[2]||o[1]<=t[1]||o[3]>=t[3])}function fu(o,t){let a=(180+o[0])/360,c=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+o[1]*Math.PI/360)))/360,f=Math.pow(2,t.z);return[Math.round(a*f*xs),Math.round(c*f*xs)]}function cc(o,t,a){let c=o[0]-t[0],f=o[1]-t[1],g=o[0]-a[0],v=o[1]-a[1];return c*v-g*f==0&&c*g<=0&&f*v<=0}function pu(o,t){let a=!1;for(let v=0,C=t.length;v<C;v++){let I=t[v];for(let A=0,F=I.length;A<F-1;A++){if(cc(o,I[A],I[A+1]))return!1;(f=I[A])[1]>(c=o)[1]!=(g=I[A+1])[1]>c[1]&&c[0]<(g[0]-f[0])*(c[1]-f[1])/(g[1]-f[1])+f[0]&&(a=!a)}}var c,f,g;return a}function bd(o,t){for(let a=0;a<t.length;a++)if(pu(o,t[a]))return!0;return!1}function mu(o,t,a,c){let f=c[0]-a[0],g=c[1]-a[1],v=(o[0]-a[0])*g-f*(o[1]-a[1]),C=(t[0]-a[0])*g-f*(t[1]-a[1]);return v>0&&C<0||v<0&&C>0}function ml(o,t,a){for(let A of a)for(let F=0;F<A.length-1;++F)if((C=[(v=A[F+1])[0]-(g=A[F])[0],v[1]-g[1]])[0]*(I=[(f=t)[0]-(c=o)[0],f[1]-c[1]])[1]-C[1]*I[0]!=0&&mu(c,f,g,v)&&mu(g,v,c,f))return!0;var c,f,g,v,C,I;return!1}function Kn(o,t){for(let a=0;a<o.length;++a)if(!pu(o[a],t))return!1;for(let a=0;a<o.length-1;++a)if(ml(o[a],o[a+1],t))return!1;return!0}function Qg(o,t){for(let a=0;a<t.length;a++)if(Kn(o,t[a]))return!0;return!1}function xd(o,t,a){let c=[];for(let f=0;f<o.length;f++){let g=[];for(let v=0;v<o[f].length;v++){let C=fu(o[f][v],a);ws(t,C),g.push(C)}c.push(g)}return c}function wd(o,t,a){let c=[];for(let f=0;f<o.length;f++){let g=xd(o[f],t,a);c.push(g)}return c}function Uh(o,t,a,c){if(o[0]<a[0]||o[0]>a[2]){let f=.5*c,g=o[0]-a[0]>f?-c:a[0]-o[0]>f?c:0;g===0&&(g=o[0]-a[2]>f?-c:a[2]-o[0]>f?c:0),o[0]+=g}ws(t,o)}function Tp(o,t,a,c){let f=Math.pow(2,c.z)*xs,g=[c.x*xs,c.y*xs],v=[];if(!o)return v;for(let C of o)for(let I of C){let A=[I.x+g[0],I.y+g[1]];Uh(A,t,a,f),v.push(A)}return v}function $h(o,t,a,c){let f=Math.pow(2,c.z)*xs,g=[c.x*xs,c.y*xs],v=[];if(!o)return v;for(let I of o){let A=[];for(let F of I){let V=[F.x+g[0],F.y+g[1]];ws(t,V),A.push(V)}v.push(A)}if(t[2]-t[0]<=f/2){(C=t)[0]=C[1]=1/0,C[2]=C[3]=-1/0;for(let I of v)for(let A of I)Uh(A,t,a,f)}var C;return v}class uc{constructor(t,a){this.type=kn,this.geojson=t,this.geometries=a}static parse(t,a){if(t.length!==2)return a.error(`'within' expression requires exactly one argument, but found ${t.length-1} instead.`);if(uu(t[1])){let c=t[1];if(c.type==="FeatureCollection")for(let f=0;f<c.features.length;++f){let g=c.features[f].geometry.type;if(g==="Polygon"||g==="MultiPolygon")return new uc(c,c.features[f].geometry)}else if(c.type==="Feature"){let f=c.geometry.type;if(f==="Polygon"||f==="MultiPolygon")return new uc(c,c.geometry)}else if(c.type==="Polygon"||c.type==="MultiPolygon")return new uc(c,c)}return a.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return function(a,c){let f=[1/0,1/0,-1/0,-1/0],g=[1/0,1/0,-1/0,-1/0],v=a.canonicalID();if(!v)return!1;if(c.type==="Polygon"){let C=xd(c.coordinates,g,v),I=Tp(a.geometry(),f,g,v);if(!pl(f,g))return!1;for(let A of I)if(!pu(A,C))return!1}if(c.type==="MultiPolygon"){let C=wd(c.coordinates,g,v),I=Tp(a.geometry(),f,g,v);if(!pl(f,g))return!1;for(let A of I)if(!bd(A,C))return!1}return!0}(t,this.geometries);if(t.geometryType()==="LineString")return function(a,c){let f=[1/0,1/0,-1/0,-1/0],g=[1/0,1/0,-1/0,-1/0],v=a.canonicalID();if(!v)return!1;if(c.type==="Polygon"){let C=xd(c.coordinates,g,v),I=$h(a.geometry(),f,g,v);if(!pl(f,g))return!1;for(let A of I)if(!Kn(A,C))return!1}if(c.type==="MultiPolygon"){let C=wd(c.coordinates,g,v),I=$h(a.geometry(),f,g,v);if(!pl(f,g))return!1;for(let A of I)if(!Qg(A,C))return!1}return!0}(t,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var Cd=uc;function Pa(o){if(o instanceof oa&&(o.name==="get"&&o.args.length===1||o.name==="feature-state"||o.name==="has"&&o.args.length===1||o.name==="properties"||o.name==="geometry-type"||o.name==="id"||/^filter-/.test(o.name))||o instanceof Cd)return!1;let t=!0;return o.eachChild(a=>{t&&!Pa(a)&&(t=!1)}),t}function sa(o){if(o instanceof oa&&o.name==="feature-state")return!1;let t=!0;return o.eachChild(a=>{t&&!sa(a)&&(t=!1)}),t}function gl(o,t){if(o instanceof oa&&t.indexOf(o.name)>=0)return!1;let a=!0;return o.eachChild(c=>{a&&!gl(c,t)&&(a=!1)}),a}class Ed{constructor(t,a){this.type=a.type,this.name=t,this.boundExpression=a}static parse(t,a){if(t.length!==2||typeof t[1]!="string")return a.error("'var' expression requires exactly one string literal argument.");let c=t[1];return a.scope.has(c)?new Ed(c,a.scope.get(c)):a.error(`Unknown variable "${c}". Make sure "${c}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(t){return this.boundExpression.evaluate(t)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var Hh=Ed;class Cs{constructor(t,a=[],c,f=new ou,g=[]){this.registry=t,this.path=a,this.key=a.map(v=>`[${v}]`).join(""),this.scope=f,this.errors=g,this.expectedType=c}parse(t,a,c,f,g={}){return a?this.concat(a,c,f)._parse(t,g):this._parse(t,g)}_parse(t,a){function c(f,g,v){return v==="assert"?new ra(g,[f]):v==="coerce"?new fl(g,[f]):f}if(t!==null&&typeof t!="string"&&typeof t!="boolean"&&typeof t!="number"||(t=["literal",t]),Array.isArray(t)){if(t.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');let f=t[0];if(typeof f!="string")return this.error(`Expression name must be a string, but found ${typeof f} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;let g=this.registry[f];if(g){let v=g.parse(t,this);if(!v)return null;if(this.expectedType){let C=this.expectedType,I=v.type;if(C.kind!=="string"&&C.kind!=="number"&&C.kind!=="boolean"&&C.kind!=="object"&&C.kind!=="array"||I.kind!=="value")if(C.kind!=="color"&&C.kind!=="formatted"&&C.kind!=="resolvedImage"||I.kind!=="value"&&I.kind!=="string"){if(this.checkSubtype(C,I))return null}else v=c(v,C,a.typeAnnotation||"coerce");else v=c(v,C,a.typeAnnotation||"assert")}if(!(v instanceof Oo)&&v.type.kind!=="resolvedImage"&&Md(v)){let C=new vd;try{v=new Oo(v.type,v.evaluate(C))}catch(I){return this.error(I.message),null}}return v}return this.error(`Unknown expression "${f}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(t===void 0?"'undefined' value invalid. Use null instead.":typeof t=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof t} instead.`)}concat(t,a,c){let f=typeof t=="number"?this.path.concat(t):this.path,g=c?this.scope.concat(c):this.scope;return new Cs(this.registry,f,a||null,g,this.errors)}error(t,...a){let c=`${this.key}${a.map(f=>`[${f}]`).join("")}`;this.errors.push(new Qo(c,t))}checkSubtype(t,a){let c=ia(t,a);return c&&this.error(c),c}}var Dd=Cs;function Md(o){if(o instanceof Hh)return Md(o.boundExpression);if(o instanceof oa&&o.name==="error"||o instanceof Ra||o instanceof Cd)return!1;let t=o instanceof fl||o instanceof ra,a=!0;return o.eachChild(c=>{a=t?a&&Md(c):a&&c instanceof Oo}),!!a&&Pa(o)&&gl(o,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"])}function Td(o,t){let a=o.length-1,c,f,g=0,v=a,C=0;for(;g<=v;)if(C=Math.floor((g+v)/2),c=o[C],f=o[C+1],c<=t){if(C===a||t<f)return C;g=C+1}else{if(!(c>t))throw new Ii("Input is not a number.");v=C-1}return 0}class Id{constructor(t,a,c){this.type=t,this.input=a,this.labels=[],this.outputs=[];for(let[f,g]of c)this.labels.push(f),this.outputs.push(g)}static parse(t,a){if(t.length-1<4)return a.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return a.error("Expected an even number of arguments.");let c=a.parse(t[1],1,Mt);if(!c)return null;let f=[],g=null;a.expectedType&&a.expectedType.kind!=="value"&&(g=a.expectedType);for(let v=1;v<t.length;v+=2){let C=v===1?-1/0:t[v],I=t[v+1],A=v,F=v+1;if(typeof C!="number")return a.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',A);if(f.length&&f[f.length-1][0]>=C)return a.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',A);let V=a.parse(I,F,g);if(!V)return null;g=g||V.type,f.push([C,V])}return new Id(g,c,f)}evaluate(t){let a=this.labels,c=this.outputs;if(a.length===1)return c[0].evaluate(t);let f=this.input.evaluate(t);if(f<=a[0])return c[0].evaluate(t);let g=a.length;return f>=a[g-1]?c[g-1].evaluate(t):c[Td(a,f)].evaluate(t)}eachChild(t){t(this.input);for(let a of this.outputs)t(a)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}serialize(){let t=["step",this.input.serialize()];for(let a=0;a<this.labels.length;a++)a>0&&t.push(this.labels[a]),t.push(this.outputs[a].serialize());return t}}var Gh=Id;function Fn(o,t,a){return o*(1-a)+t*a}var yl=Object.freeze({__proto__:null,array:function(o,t,a){return o.map((c,f)=>Fn(c,t[f],a))},color:function(o,t,a){return new ir(Fn(o.r,t.r,a),Fn(o.g,t.g,a),Fn(o.b,t.b,a),Fn(o.a,t.a,a))},number:Fn});let gu=.95047,dc=1.08883,Ip=4/29,Oa=6/29,hc=3*Oa*Oa,_l=Oa*Oa*Oa,Jg=Math.PI/180,vl=180/Math.PI;function Wh(o){return o>_l?Math.pow(o,1/3):o/hc+Ip}function bl(o){return o>Oa?o*o*o:hc*(o-Ip)}function xl(o){return 255*(o<=.0031308?12.92*o:1.055*Math.pow(o,1/2.4)-.055)}function Sd(o){return(o/=255)<=.04045?o/12.92:Math.pow((o+.055)/1.055,2.4)}function Ad(o){let t=Sd(o.r),a=Sd(o.g),c=Sd(o.b),f=Wh((.4124564*t+.3575761*a+.1804375*c)/gu),g=Wh((.2126729*t+.7151522*a+.072175*c)/1);return{l:116*g-16,a:500*(f-g),b:200*(g-Wh((.0193339*t+.119192*a+.9503041*c)/dc)),alpha:o.a}}function kd(o){let t=(o.l+16)/116,a=isNaN(o.a)?t:t+o.a/500,c=isNaN(o.b)?t:t-o.b/200;return t=1*bl(t),a=gu*bl(a),c=dc*bl(c),new ir(xl(3.2404542*a-1.5371385*t-.4985314*c),xl(-.969266*a+1.8760108*t+.041556*c),xl(.0556434*a-.2040259*t+1.0572252*c),o.alpha)}function ey(o,t,a){let c=t-o;return o+a*(c>180||c<-180?c-360*Math.round(c/360):c)}let yu={forward:Ad,reverse:kd,interpolate:function(o,t,a){return{l:Fn(o.l,t.l,a),a:Fn(o.a,t.a,a),b:Fn(o.b,t.b,a),alpha:Fn(o.alpha,t.alpha,a)}}},fc={forward:function(o){let{l:t,a,b:c}=Ad(o),f=Math.atan2(c,a)*vl;return{h:f<0?f+360:f,c:Math.sqrt(a*a+c*c),l:t,alpha:o.a}},reverse:function(o){let t=o.h*Jg,a=o.c;return kd({l:o.l,a:Math.cos(t)*a,b:Math.sin(t)*a,alpha:o.alpha})},interpolate:function(o,t,a){return{h:ey(o.h,t.h,a),c:Fn(o.c,t.c,a),l:Fn(o.l,t.l,a),alpha:Fn(o.alpha,t.alpha,a)}}};var pc=Object.freeze({__proto__:null,hcl:fc,lab:yu});class _u{constructor(t,a,c,f,g){this.type=t,this.operator=a,this.interpolation=c,this.input=f,this.labels=[],this.outputs=[];for(let[v,C]of g)this.labels.push(v),this.outputs.push(C)}static interpolationFactor(t,a,c,f){let g=0;if(t.name==="exponential")g=qh(a,t.base,c,f);else if(t.name==="linear")g=qh(a,1,c,f);else if(t.name==="cubic-bezier"){let v=t.controlPoints;g=new Ro(v[0],v[1],v[2],v[3]).solve(qh(a,1,c,f))}return g}static parse(t,a){let[c,f,g,...v]=t;if(!Array.isArray(f)||f.length===0)return a.error("Expected an interpolation type expression.",1);if(f[0]==="linear")f={name:"linear"};else if(f[0]==="exponential"){let A=f[1];if(typeof A!="number")return a.error("Exponential interpolation requires a numeric base.",1,1);f={name:"exponential",base:A}}else{if(f[0]!=="cubic-bezier")return a.error(`Unknown interpolation type ${String(f[0])}`,1,0);{let A=f.slice(1);if(A.length!==4||A.some(F=>typeof F!="number"||F<0||F>1))return a.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);f={name:"cubic-bezier",controlPoints:A}}}if(t.length-1<4)return a.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return a.error("Expected an even number of arguments.");if(g=a.parse(g,2,Mt),!g)return null;let C=[],I=null;c==="interpolate-hcl"||c==="interpolate-lab"?I=Co:a.expectedType&&a.expectedType.kind!=="value"&&(I=a.expectedType);for(let A=0;A<v.length;A+=2){let F=v[A],V=v[A+1],$=A+3,W=A+4;if(typeof F!="number")return a.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',$);if(C.length&&C[C.length-1][0]>=F)return a.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',$);let q=a.parse(V,W,I);if(!q)return null;I=I||q.type,C.push([F,q])}return I.kind==="number"||I.kind==="color"||I.kind==="array"&&I.itemType.kind==="number"&&typeof I.N=="number"?new _u(I,c,f,g,C):a.error(`Type ${Ti(I)} is not interpolatable.`)}evaluate(t){let a=this.labels,c=this.outputs;if(a.length===1)return c[0].evaluate(t);let f=this.input.evaluate(t);if(f<=a[0])return c[0].evaluate(t);let g=a.length;if(f>=a[g-1])return c[g-1].evaluate(t);let v=Td(a,f),C=_u.interpolationFactor(this.interpolation,f,a[v],a[v+1]),I=c[v].evaluate(t),A=c[v+1].evaluate(t);return this.operator==="interpolate"?yl[this.type.kind.toLowerCase()](I,A,C):this.operator==="interpolate-hcl"?fc.reverse(fc.interpolate(fc.forward(I),fc.forward(A),C)):yu.reverse(yu.interpolate(yu.forward(I),yu.forward(A),C))}eachChild(t){t(this.input);for(let a of this.outputs)t(a)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}serialize(){let t;t=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);let a=[this.operator,t,this.input.serialize()];for(let c=0;c<this.labels.length;c++)a.push(this.labels[c],this.outputs[c].serialize());return a}}function qh(o,t,a,c){let f=c-a,g=o-a;return f===0?0:t===1?g/f:(Math.pow(t,g)-1)/(Math.pow(t,f)-1)}var io=_u;class Rd{constructor(t,a){this.type=t,this.args=a}static parse(t,a){if(t.length<2)return a.error("Expectected at least one argument.");let c=null,f=a.expectedType;f&&f.kind!=="value"&&(c=f);let g=[];for(let C of t.slice(1)){let I=a.parse(C,1+g.length,c,void 0,{typeAnnotation:"omit"});if(!I)return null;c=c||I.type,g.push(I)}let v=f&&g.some(C=>ia(f,C.type));return new Rd(v?Dn:c,g)}evaluate(t){let a,c=null,f=0;for(let g of this.args){if(f++,c=g.evaluate(t),c&&c instanceof Do&&!c.available&&(a||(a=c),c=null,f===this.args.length))return a;if(c!==null)break}return c}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}serialize(){let t=["coalesce"];return this.eachChild(a=>{t.push(a.serialize())}),t}}var Pd=Rd;class Od{constructor(t,a){this.type=a.type,this.bindings=[].concat(t),this.result=a}evaluate(t){return this.result.evaluate(t)}eachChild(t){for(let a of this.bindings)t(a[1]);t(this.result)}static parse(t,a){if(t.length<4)return a.error(`Expected at least 3 arguments, but found ${t.length-1} instead.`);let c=[];for(let g=1;g<t.length-1;g+=2){let v=t[g];if(typeof v!="string")return a.error(`Expected string, but found ${typeof v} instead.`,g);if(/[^a-zA-Z0-9_]/.test(v))return a.error("Variable names must contain only alphanumeric characters or '_'.",g);let C=a.parse(t[g+1],g+1);if(!C)return null;c.push([v,C])}let f=a.parse(t[t.length-1],t.length-1,a.expectedType,c);return f?new Od(c,f):null}outputDefined(){return this.result.outputDefined()}serialize(){let t=["let"];for(let[a,c]of this.bindings)t.push(a,c.serialize());return t.push(this.result.serialize()),t}}var Sp=Od;class Zh{constructor(t,a,c){this.type=t,this.index=a,this.input=c}static parse(t,a){if(t.length!==3)return a.error(`Expected 2 arguments, but found ${t.length-1} instead.`);let c=a.parse(t[1],1,Mt),f=a.parse(t[2],2,Eo(a.expectedType||Dn));return c&&f?new Zh(f.type.itemType,c,f):null}evaluate(t){let a=this.index.evaluate(t),c=this.input.evaluate(t);if(a<0)throw new Ii(`Array index out of bounds: ${a} < 0.`);if(a>=c.length)throw new Ii(`Array index out of bounds: ${a} > ${c.length-1}.`);if(a!==Math.floor(a))throw new Ii(`Array index must be an integer, but found ${a} instead.`);return c[a]}eachChild(t){t(this.index),t(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var ty=Zh;class Xh{constructor(t,a){this.type=kn,this.needle=t,this.haystack=a}static parse(t,a){if(t.length!==3)return a.error(`Expected 2 arguments, but found ${t.length-1} instead.`);let c=a.parse(t[1],1,Dn),f=a.parse(t[2],2,Dn);return c&&f?Aa(c.type,[kn,En,Mt,sl,Dn])?new Xh(c,f):a.error(`Expected first argument to be of type boolean, string, number or null, but found ${Ti(c.type)} instead`):null}evaluate(t){let a=this.needle.evaluate(t),c=this.haystack.evaluate(t);if(c==null)return!1;if(!au(a,["boolean","string","number","null"]))throw new Ii(`Expected first argument to be of type boolean, string, number or null, but found ${Ti(qi(a))} instead.`);if(!au(c,["string","array"]))throw new Ii(`Expected second argument to be of type array or string, but found ${Ti(qi(c))} instead.`);return c.indexOf(a)>=0}eachChild(t){t(this.needle),t(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var vu=Xh;class bu{constructor(t,a,c){this.type=Mt,this.needle=t,this.haystack=a,this.fromIndex=c}static parse(t,a){if(t.length<=2||t.length>=5)return a.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);let c=a.parse(t[1],1,Dn),f=a.parse(t[2],2,Dn);if(!c||!f)return null;if(!Aa(c.type,[kn,En,Mt,sl,Dn]))return a.error(`Expected first argument to be of type boolean, string, number or null, but found ${Ti(c.type)} instead`);if(t.length===4){let g=a.parse(t[3],3,Mt);return g?new bu(c,f,g):null}return new bu(c,f)}evaluate(t){let a=this.needle.evaluate(t),c=this.haystack.evaluate(t);if(!au(a,["boolean","string","number","null"]))throw new Ii(`Expected first argument to be of type boolean, string, number or null, but found ${Ti(qi(a))} instead.`);if(!au(c,["string","array"]))throw new Ii(`Expected second argument to be of type array or string, but found ${Ti(qi(c))} instead.`);if(this.fromIndex){let f=this.fromIndex.evaluate(t);return c.indexOf(a,f)}return c.indexOf(a)}eachChild(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){let t=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),t]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var mc=bu;class aa{constructor(t,a,c,f,g,v){this.inputType=t,this.type=a,this.input=c,this.cases=f,this.outputs=g,this.otherwise=v}static parse(t,a){if(t.length<5)return a.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if(t.length%2!=1)return a.error("Expected an even number of arguments.");let c,f;a.expectedType&&a.expectedType.kind!=="value"&&(f=a.expectedType);let g={},v=[];for(let A=2;A<t.length-1;A+=2){let F=t[A],V=t[A+1];Array.isArray(F)||(F=[F]);let $=a.concat(A);if(F.length===0)return $.error("Expected at least one branch label.");for(let q of F){if(typeof q!="number"&&typeof q!="string")return $.error("Branch labels must be numbers or strings.");if(typeof q=="number"&&Math.abs(q)>Number.MAX_SAFE_INTEGER)return $.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof q=="number"&&Math.floor(q)!==q)return $.error("Numeric branch labels must be integer values.");if(c){if($.checkSubtype(c,qi(q)))return null}else c=qi(q);if(g[String(q)]!==void 0)return $.error("Branch labels must be unique.");g[String(q)]=v.length}let W=a.parse(V,A,f);if(!W)return null;f=f||W.type,v.push(W)}let C=a.parse(t[1],1,Dn);if(!C)return null;let I=a.parse(t[t.length-1],t.length-1,f);return I?C.type.kind!=="value"&&a.concat(1).checkSubtype(c,C.type)?null:new aa(c,f,C,g,v,I):null}evaluate(t){let a=this.input.evaluate(t);return(qi(a)===this.inputType&&this.outputs[this.cases[a]]||this.otherwise).evaluate(t)}eachChild(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)}outputDefined(){return this.outputs.every(t=>t.outputDefined())&&this.otherwise.outputDefined()}serialize(){let t=["match",this.input.serialize()],a=Object.keys(this.cases).sort(),c=[],f={};for(let v of a){let C=f[this.cases[v]];C===void 0?(f[this.cases[v]]=c.length,c.push([this.cases[v],[v]])):c[C][1].push(v)}let g=v=>this.inputType.kind==="number"?Number(v):v;for(let[v,C]of c)t.push(C.length===1?g(C[0]):C.map(g)),t.push(this.outputs[v].serialize());return t.push(this.otherwise.serialize()),t}}var ny=aa;class Yh{constructor(t,a,c){this.type=t,this.branches=a,this.otherwise=c}static parse(t,a){if(t.length<4)return a.error(`Expected at least 3 arguments, but found only ${t.length-1}.`);if(t.length%2!=0)return a.error("Expected an odd number of arguments.");let c;a.expectedType&&a.expectedType.kind!=="value"&&(c=a.expectedType);let f=[];for(let v=1;v<t.length-1;v+=2){let C=a.parse(t[v],v,kn);if(!C)return null;let I=a.parse(t[v+1],v+1,c);if(!I)return null;f.push([C,I]),c=c||I.type}let g=a.parse(t[t.length-1],t.length-1,c);return g?new Yh(c,f,g):null}evaluate(t){for(let[a,c]of this.branches)if(a.evaluate(t))return c.evaluate(t);return this.otherwise.evaluate(t)}eachChild(t){for(let[a,c]of this.branches)t(a),t(c);t(this.otherwise)}outputDefined(){return this.branches.every(([t,a])=>a.outputDefined())&&this.otherwise.outputDefined()}serialize(){let t=["case"];return this.eachChild(a=>{t.push(a.serialize())}),t}}var Ap=Yh;class xu{constructor(t,a,c,f){this.type=t,this.input=a,this.beginIndex=c,this.endIndex=f}static parse(t,a){if(t.length<=2||t.length>=5)return a.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);let c=a.parse(t[1],1,Dn),f=a.parse(t[2],2,Mt);if(!c||!f)return null;if(!Aa(c.type,[Eo(Dn),En,Dn]))return a.error(`Expected first argument to be of type array or string, but found ${Ti(c.type)} instead`);if(t.length===4){let g=a.parse(t[3],3,Mt);return g?new xu(c.type,c,f,g):null}return new xu(c.type,c,f)}evaluate(t){let a=this.input.evaluate(t),c=this.beginIndex.evaluate(t);if(!au(a,["string","array"]))throw new Ii(`Expected first argument to be of type array or string, but found ${Ti(qi(a))} instead.`);if(this.endIndex){let f=this.endIndex.evaluate(t);return a.slice(c,f)}return a.slice(c)}eachChild(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){let t=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),t]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var kp=xu;function wl(o,t){return o==="=="||o==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function Ld(o,t,a,c){return c.compare(t,a)===0}function gc(o,t,a){let c=o!=="=="&&o!=="!=";return class KO{constructor(g,v,C){this.type=kn,this.lhs=g,this.rhs=v,this.collator=C,this.hasUntypedArgument=g.type.kind==="value"||v.type.kind==="value"}static parse(g,v){if(g.length!==3&&g.length!==4)return v.error("Expected two or three arguments.");let C=g[0],I=v.parse(g[1],1,Dn);if(!I)return null;if(!wl(C,I.type))return v.concat(1).error(`"${C}" comparisons are not supported for type '${Ti(I.type)}'.`);let A=v.parse(g[2],2,Dn);if(!A)return null;if(!wl(C,A.type))return v.concat(2).error(`"${C}" comparisons are not supported for type '${Ti(A.type)}'.`);if(I.type.kind!==A.type.kind&&I.type.kind!=="value"&&A.type.kind!=="value")return v.error(`Cannot compare types '${Ti(I.type)}' and '${Ti(A.type)}'.`);c&&(I.type.kind==="value"&&A.type.kind!=="value"?I=new ra(A.type,[I]):I.type.kind!=="value"&&A.type.kind==="value"&&(A=new ra(I.type,[A])));let F=null;if(g.length===4){if(I.type.kind!=="string"&&A.type.kind!=="string"&&I.type.kind!=="value"&&A.type.kind!=="value")return v.error("Cannot use collator to compare non-string types.");if(F=v.parse(g[3],3,Wr),!F)return null}return new KO(I,A,F)}evaluate(g){let v=this.lhs.evaluate(g),C=this.rhs.evaluate(g);if(c&&this.hasUntypedArgument){let I=qi(v),A=qi(C);if(I.kind!==A.kind||I.kind!=="string"&&I.kind!=="number")throw new Ii(`Expected arguments for "${o}" to be (string, string) or (number, number), but found (${I.kind}, ${A.kind}) instead.`)}if(this.collator&&!c&&this.hasUntypedArgument){let I=qi(v),A=qi(C);if(I.kind!=="string"||A.kind!=="string")return t(g,v,C)}return this.collator?a(g,v,C,this.collator.evaluate(g)):t(g,v,C)}eachChild(g){g(this.lhs),g(this.rhs),this.collator&&g(this.collator)}outputDefined(){return!0}serialize(){let g=[o];return this.eachChild(v=>{g.push(v.serialize())}),g}}}let Fd=gc("==",function(o,t,a){return t===a},Ld),Kh=gc("!=",function(o,t,a){return t!==a},function(o,t,a,c){return!Ld(0,t,a,c)}),iy=gc("<",function(o,t,a){return t<a},function(o,t,a,c){return c.compare(t,a)<0}),Rp=gc(">",function(o,t,a){return t>a},function(o,t,a,c){return c.compare(t,a)>0}),wu=gc("<=",function(o,t,a){return t<=a},function(o,t,a,c){return c.compare(t,a)<=0}),Pp=gc(">=",function(o,t,a){return t>=a},function(o,t,a,c){return c.compare(t,a)>=0});class Cl{constructor(t,a,c,f,g,v){this.type=En,this.number=t,this.locale=a,this.currency=c,this.unit=f,this.minFractionDigits=g,this.maxFractionDigits=v}static parse(t,a){if(t.length!==3)return a.error("Expected two arguments.");let c=a.parse(t[1],1,Mt);if(!c)return null;let f=t[2];if(typeof f!="object"||Array.isArray(f))return a.error("NumberFormat options argument must be an object.");let g=null;if(f.locale&&(g=a.parse(f.locale,1,En),!g))return null;let v=null;if(f.currency&&(v=a.parse(f.currency,1,En),!v))return null;let C=null;if(f.unit&&(C=a.parse(f.unit,1,En),!C))return null;let I=null;if(f["min-fraction-digits"]&&(I=a.parse(f["min-fraction-digits"],1,Mt),!I))return null;let A=null;return f["max-fraction-digits"]&&(A=a.parse(f["max-fraction-digits"],1,Mt),!A)?null:new Cl(c,g,v,C,I,A)}evaluate(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(t):void 0,unit:this.unit?this.unit.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))}eachChild(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.unit&&t(this.unit),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)}outputDefined(){return!1}serialize(){let t={};return this.locale&&(t.locale=this.locale.serialize()),this.currency&&(t.currency=this.currency.serialize()),this.unit&&(t.unit=this.unit.serialize()),this.minFractionDigits&&(t["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(t["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),t]}}class yc{constructor(t){this.type=Mt,this.input=t}static parse(t,a){if(t.length!==2)return a.error(`Expected 1 argument, but found ${t.length-1} instead.`);let c=a.parse(t[1],1);return c?c.type.kind!=="array"&&c.type.kind!=="string"&&c.type.kind!=="value"?a.error(`Expected argument of type string or array, but found ${Ti(c.type)} instead.`):new yc(c):null}evaluate(t){let a=this.input.evaluate(t);if(typeof a=="string"||Array.isArray(a))return a.length;throw new Ii(`Expected value to be of type string or array, but found ${Ti(qi(a))} instead.`)}eachChild(t){t(this.input)}outputDefined(){return!1}serialize(){let t=["length"];return this.eachChild(a=>{t.push(a.serialize())}),t}}let Op={"==":Fd,"!=":Kh,">":Rp,"<":iy,">=":Pp,"<=":wu,array:ra,at:ty,boolean:ra,case:Ap,coalesce:Pd,collator:Ra,format:ka,image:hu,in:vu,"index-of":mc,interpolate:io,"interpolate-hcl":io,"interpolate-lab":io,length:yc,let:Sp,literal:Oo,match:ny,number:ra,"number-format":Cl,object:ra,slice:kp,step:Gh,string:ra,"to-boolean":fl,"to-color":fl,"to-number":fl,"to-string":fl,var:Hh,within:Cd};function Fo(o,[t,a,c,f]){t=t.evaluate(o),a=a.evaluate(o),c=c.evaluate(o);let g=f?f.evaluate(o):1,v=jh(t,a,c,g);if(v)throw new Ii(v);return new ir(t/255*g,a/255*g,c/255*g,g)}function uo(o,t){return o in t}function Nd(o,t){let a=t[o];return a===void 0?null:a}function Mo(o){return{type:o}}oa.register(Op,{error:[{kind:"error"},[En],(o,[t])=>{throw new Ii(t.evaluate(o))}],typeof:[En,[Dn],(o,[t])=>Ti(qi(t.evaluate(o)))],"to-rgba":[Eo(Mt,4),[Co],(o,[t])=>t.evaluate(o).toArray()],rgb:[Co,[Mt,Mt,Mt],Fo],rgba:[Co,[Mt,Mt,Mt,Mt],Fo],has:{type:kn,overloads:[[[En],(o,[t])=>uo(t.evaluate(o),o.properties())],[[En,Jo],(o,[t,a])=>uo(t.evaluate(o),a.evaluate(o))]]},get:{type:Dn,overloads:[[[En],(o,[t])=>Nd(t.evaluate(o),o.properties())],[[En,Jo],(o,[t,a])=>Nd(t.evaluate(o),a.evaluate(o))]]},"feature-state":[Dn,[En],(o,[t])=>Nd(t.evaluate(o),o.featureState||{})],properties:[Jo,[],o=>o.properties()],"geometry-type":[En,[],o=>o.geometryType()],id:[Dn,[],o=>o.id()],zoom:[Mt,[],o=>o.globals.zoom],pitch:[Mt,[],o=>o.globals.pitch||0],"distance-from-center":[Mt,[],o=>o.distanceFromCenter()],"heatmap-density":[Mt,[],o=>o.globals.heatmapDensity||0],"line-progress":[Mt,[],o=>o.globals.lineProgress||0],"sky-radial-progress":[Mt,[],o=>o.globals.skyRadialProgress||0],accumulated:[Dn,[],o=>o.globals.accumulated===void 0?null:o.globals.accumulated],"+":[Mt,Mo(Mt),(o,t)=>{let a=0;for(let c of t)a+=c.evaluate(o);return a}],"*":[Mt,Mo(Mt),(o,t)=>{let a=1;for(let c of t)a*=c.evaluate(o);return a}],"-":{type:Mt,overloads:[[[Mt,Mt],(o,[t,a])=>t.evaluate(o)-a.evaluate(o)],[[Mt],(o,[t])=>-t.evaluate(o)]]},"/":[Mt,[Mt,Mt],(o,[t,a])=>t.evaluate(o)/a.evaluate(o)],"%":[Mt,[Mt,Mt],(o,[t,a])=>t.evaluate(o)%a.evaluate(o)],ln2:[Mt,[],()=>Math.LN2],pi:[Mt,[],()=>Math.PI],e:[Mt,[],()=>Math.E],"^":[Mt,[Mt,Mt],(o,[t,a])=>Math.pow(t.evaluate(o),a.evaluate(o))],sqrt:[Mt,[Mt],(o,[t])=>Math.sqrt(t.evaluate(o))],log10:[Mt,[Mt],(o,[t])=>Math.log(t.evaluate(o))/Math.LN10],ln:[Mt,[Mt],(o,[t])=>Math.log(t.evaluate(o))],log2:[Mt,[Mt],(o,[t])=>Math.log(t.evaluate(o))/Math.LN2],sin:[Mt,[Mt],(o,[t])=>Math.sin(t.evaluate(o))],cos:[Mt,[Mt],(o,[t])=>Math.cos(t.evaluate(o))],tan:[Mt,[Mt],(o,[t])=>Math.tan(t.evaluate(o))],asin:[Mt,[Mt],(o,[t])=>Math.asin(t.evaluate(o))],acos:[Mt,[Mt],(o,[t])=>Math.acos(t.evaluate(o))],atan:[Mt,[Mt],(o,[t])=>Math.atan(t.evaluate(o))],min:[Mt,Mo(Mt),(o,t)=>Math.min(...t.map(a=>a.evaluate(o)))],max:[Mt,Mo(Mt),(o,t)=>Math.max(...t.map(a=>a.evaluate(o)))],abs:[Mt,[Mt],(o,[t])=>Math.abs(t.evaluate(o))],round:[Mt,[Mt],(o,[t])=>{let a=t.evaluate(o);return a<0?-Math.round(-a):Math.round(a)}],floor:[Mt,[Mt],(o,[t])=>Math.floor(t.evaluate(o))],ceil:[Mt,[Mt],(o,[t])=>Math.ceil(t.evaluate(o))],"filter-==":[kn,[En,Dn],(o,[t,a])=>o.properties()[t.value]===a.value],"filter-id-==":[kn,[Dn],(o,[t])=>o.id()===t.value],"filter-type-==":[kn,[En],(o,[t])=>o.geometryType()===t.value],"filter-<":[kn,[En,Dn],(o,[t,a])=>{let c=o.properties()[t.value],f=a.value;return typeof c==typeof f&&c<f}],"filter-id-<":[kn,[Dn],(o,[t])=>{let a=o.id(),c=t.value;return typeof a==typeof c&&a<c}],"filter->":[kn,[En,Dn],(o,[t,a])=>{let c=o.properties()[t.value],f=a.value;return typeof c==typeof f&&c>f}],"filter-id->":[kn,[Dn],(o,[t])=>{let a=o.id(),c=t.value;return typeof a==typeof c&&a>c}],"filter-<=":[kn,[En,Dn],(o,[t,a])=>{let c=o.properties()[t.value],f=a.value;return typeof c==typeof f&&c<=f}],"filter-id-<=":[kn,[Dn],(o,[t])=>{let a=o.id(),c=t.value;return typeof a==typeof c&&a<=c}],"filter->=":[kn,[En,Dn],(o,[t,a])=>{let c=o.properties()[t.value],f=a.value;return typeof c==typeof f&&c>=f}],"filter-id->=":[kn,[Dn],(o,[t])=>{let a=o.id(),c=t.value;return typeof a==typeof c&&a>=c}],"filter-has":[kn,[Dn],(o,[t])=>t.value in o.properties()],"filter-has-id":[kn,[],o=>o.id()!==null&&o.id()!==void 0],"filter-type-in":[kn,[Eo(En)],(o,[t])=>t.value.indexOf(o.geometryType())>=0],"filter-id-in":[kn,[Eo(Dn)],(o,[t])=>t.value.indexOf(o.id())>=0],"filter-in-small":[kn,[En,Eo(Dn)],(o,[t,a])=>a.value.indexOf(o.properties()[t.value])>=0],"filter-in-large":[kn,[En,Eo(Dn)],(o,[t,a])=>function(c,f,g,v){for(;g<=v;){let C=g+v>>1;if(f[C]===c)return!0;f[C]>c?v=C-1:g=C+1}return!1}(o.properties()[t.value],a.value,0,a.value.length-1)],all:{type:kn,overloads:[[[kn,kn],(o,[t,a])=>t.evaluate(o)&&a.evaluate(o)],[Mo(kn),(o,t)=>{for(let a of t)if(!a.evaluate(o))return!1;return!0}]]},any:{type:kn,overloads:[[[kn,kn],(o,[t,a])=>t.evaluate(o)||a.evaluate(o)],[Mo(kn),(o,t)=>{for(let a of t)if(a.evaluate(o))return!0;return!1}]]},"!":[kn,[kn],(o,[t])=>!t.evaluate(o)],"is-supported-script":[kn,[En],(o,[t])=>{let a=o.globals&&o.globals.isSupportedScript;return!a||a(t.evaluate(o))}],upcase:[En,[En],(o,[t])=>t.evaluate(o).toUpperCase()],downcase:[En,[En],(o,[t])=>t.evaluate(o).toLowerCase()],concat:[En,Mo(Dn),(o,t)=>t.map(a=>ac(a.evaluate(o))).join("")],"resolved-locale":[En,[Wr],(o,[t])=>t.evaluate(o).resolvedLocale()]});var Cu=Op;function zd(o){return{result:"success",value:o}}function El(o){return{result:"error",value:o}}function _c(o){return o["property-type"]==="data-driven"}function Eu(o){return!!o.expression&&o.expression.parameters.indexOf("zoom")>-1}function Bd(o){return!!o.expression&&o.expression.interpolated}function Wn(o){return o instanceof Number?"number":o instanceof String?"string":o instanceof Boolean?"boolean":Array.isArray(o)?"array":o===null?"null":typeof o}function Fr(o){return typeof o=="object"&&o!==null&&!Array.isArray(o)}function pi(o){return o}function jd(o,t){let a=t.type==="color",c=o.stops&&typeof o.stops[0][0]=="object",f=c||!(c||o.property!==void 0),g=o.type||(Bd(t)?"exponential":"interval");if(a&&((o=na({},o)).stops&&(o.stops=o.stops.map(A=>[A[0],ir.parse(A[1])])),o.default=ir.parse(o.default?o.default:t.default)),o.colorSpace&&o.colorSpace!=="rgb"&&!pc[o.colorSpace])throw new Error(`Unknown color space: ${o.colorSpace}`);let v,C,I;if(g==="exponential")v=ci;else if(g==="interval")v=Ml;else if(g==="categorical"){v=Vd,C=Object.create(null);for(let A of o.stops)C[A[0]]=A[1];I=typeof o.stops[0][0]}else{if(g!=="identity")throw new Error(`Unknown function type "${g}"`);v=Qh}if(c){let A={},F=[];for(let W=0;W<o.stops.length;W++){let q=o.stops[W],ee=q[0].zoom;A[ee]===void 0&&(A[ee]={zoom:ee,type:o.type,property:o.property,default:o.default,stops:[]},F.push(ee)),A[ee].stops.push([q[0].value,q[1]])}let V=[];for(let W of F)V.push([A[W].zoom,jd(A[W],t)]);let $={name:"linear"};return{kind:"composite",interpolationType:$,interpolationFactor:io.interpolationFactor.bind(void 0,$),zoomStops:V.map(W=>W[0]),evaluate:({zoom:W},q)=>ci({stops:V,base:o.base},t,W).evaluate(W,q)}}if(f){let A=g==="exponential"?{name:"exponential",base:o.base!==void 0?o.base:1}:null;return{kind:"camera",interpolationType:A,interpolationFactor:io.interpolationFactor.bind(void 0,A),zoomStops:o.stops.map(F=>F[0]),evaluate:({zoom:F})=>v(o,t,F,C,I)}}return{kind:"source",evaluate(A,F){let V=F&&F.properties?F.properties[o.property]:void 0;return V===void 0?Dl(o.default,t.default):v(o,t,V,C,I)}}}function Dl(o,t,a){return o!==void 0?o:t!==void 0?t:a!==void 0?a:void 0}function Vd(o,t,a,c,f){return Dl(typeof a===f?c[a]:void 0,o.default,t.default)}function Ml(o,t,a){if(Wn(a)!=="number")return Dl(o.default,t.default);let c=o.stops.length;if(c===1||a<=o.stops[0][0])return o.stops[0][1];if(a>=o.stops[c-1][0])return o.stops[c-1][1];let f=Td(o.stops.map(g=>g[0]),a);return o.stops[f][1]}function ci(o,t,a){let c=o.base!==void 0?o.base:1;if(Wn(a)!=="number")return Dl(o.default,t.default);let f=o.stops.length;if(f===1||a<=o.stops[0][0])return o.stops[0][1];if(a>=o.stops[f-1][0])return o.stops[f-1][1];let g=Td(o.stops.map(F=>F[0]),a),v=function(F,V,$,W){let q=W-$,ee=F-$;return q===0?0:V===1?ee/q:(Math.pow(V,ee)-1)/(Math.pow(V,q)-1)}(a,c,o.stops[g][0],o.stops[g+1][0]),C=o.stops[g][1],I=o.stops[g+1][1],A=yl[t.type]||pi;if(o.colorSpace&&o.colorSpace!=="rgb"){let F=pc[o.colorSpace];A=(V,$)=>F.reverse(F.interpolate(F.forward(V),F.forward($),v))}return typeof C.evaluate=="function"?{evaluate(...F){let V=C.evaluate.apply(void 0,F),$=I.evaluate.apply(void 0,F);if(V!==void 0&&$!==void 0)return A(V,$,v)}}:A(C,I,v)}function Qh(o,t,a){return t.type==="color"?a=ir.parse(a):t.type==="formatted"?a=qr.fromString(a.toString()):t.type==="resolvedImage"?a=Do.fromString(a.toString()):Wn(a)===t.type||t.type==="enum"&&t.values[a]||(a=void 0),Dl(a,o.default,t.default)}class Ud{constructor(t,a){this.expression=t,this._warningHistory={},this._evaluator=new vd,this._defaultValue=a?function(c){return c.type==="color"&&(Fr(c.default)||Array.isArray(c.default))?new ir(0,0,0,0):c.type==="color"?ir.parse(c.default)||null:c.default===void 0?null:c.default}(a):null,this._enumValues=a&&a.type==="enum"?a.values:null}evaluateWithoutErrorHandling(t,a,c,f,g,v,C,I){return this._evaluator.globals=t,this._evaluator.feature=a,this._evaluator.featureState=c,this._evaluator.canonical=f||null,this._evaluator.availableImages=g||null,this._evaluator.formattedSection=v,this._evaluator.featureTileCoord=C||null,this._evaluator.featureDistanceData=I||null,this.expression.evaluate(this._evaluator)}evaluate(t,a,c,f,g,v,C,I){this._evaluator.globals=t,this._evaluator.feature=a||null,this._evaluator.featureState=c||null,this._evaluator.canonical=f||null,this._evaluator.availableImages=g||null,this._evaluator.formattedSection=v||null,this._evaluator.featureTileCoord=C||null,this._evaluator.featureDistanceData=I||null;try{let A=this.expression.evaluate(this._evaluator);if(A==null||typeof A=="number"&&A!=A)return this._defaultValue;if(this._enumValues&&!(A in this._enumValues))throw new Ii(`Expected value to be one of ${Object.keys(this._enumValues).map(F=>JSON.stringify(F)).join(", ")}, but found ${JSON.stringify(A)} instead.`);return A}catch(A){return this._warningHistory[A.message]||(this._warningHistory[A.message]=!0,typeof console<"u"&&console.warn(A.message)),this._defaultValue}}}function Tl(o){return Array.isArray(o)&&o.length>0&&typeof o[0]=="string"&&o[0]in Cu}function Kt(o,t){let a=new Dd(Cu,[],t?function(f){let g={color:Co,string:En,number:Mt,enum:En,boolean:kn,formatted:su,resolvedImage:al};return f.type==="array"?Eo(g[f.value]||Dn,f.length):g[f.type]}(t):void 0),c=a.parse(o,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return c?zd(new Ud(c,t)):El(a.errors)}class $d{constructor(t,a){this.kind=t,this._styleExpression=a,this.isStateDependent=t!=="constant"&&!sa(a.expression)}evaluateWithoutErrorHandling(t,a,c,f,g,v){return this._styleExpression.evaluateWithoutErrorHandling(t,a,c,f,g,v)}evaluate(t,a,c,f,g,v){return this._styleExpression.evaluate(t,a,c,f,g,v)}}class La{constructor(t,a,c,f){this.kind=t,this.zoomStops=c,this._styleExpression=a,this.isStateDependent=t!=="camera"&&!sa(a.expression),this.interpolationType=f}evaluateWithoutErrorHandling(t,a,c,f,g,v){return this._styleExpression.evaluateWithoutErrorHandling(t,a,c,f,g,v)}evaluate(t,a,c,f,g,v){return this._styleExpression.evaluate(t,a,c,f,g,v)}interpolationFactor(t,a,c){return this.interpolationType?io.interpolationFactor(this.interpolationType,t,a,c):0}}function Du(o,t){if((o=Kt(o,t)).result==="error")return o;let a=o.value.expression,c=Pa(a);if(!c&&!_c(t))return El([new Qo("","data expressions not supported")]);let f=gl(a,["zoom","pitch","distance-from-center"]);if(!f&&!Eu(t))return El([new Qo("","zoom expressions not supported")]);let g=bn(a);return g||f?g instanceof Qo?El([g]):g instanceof io&&!Bd(t)?El([new Qo("",'"interpolate" expressions cannot be used with this property')]):zd(g?new La(c?"camera":"composite",o.value,g.labels,g instanceof io?g.interpolation:void 0):new $d(c?"constant":"source",o.value)):El([new Qo("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Il{constructor(t,a){this._parameters=t,this._specification=a,na(this,jd(this._parameters,this._specification))}static deserialize(t){return new Il(t._parameters,t._specification)}static serialize(t){return{_parameters:t._parameters,_specification:t._specification}}}function bn(o){let t=null;if(o instanceof Sp)t=bn(o.result);else if(o instanceof Pd){for(let a of o.args)if(t=bn(a),t)break}else(o instanceof Gh||o instanceof io)&&o.input instanceof oa&&o.input.name==="zoom"&&(t=o);return t instanceof Qo||o.eachChild(a=>{let c=bn(a);c instanceof Qo?t=c:!t&&c?t=new Qo("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):t&&c&&t!==c&&(t=new Qo("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),t}class Rt{constructor(t,a,c,f){this.message=(t?`${t}: `:"")+c,f&&(this.identifier=f),a!=null&&a.__line__&&(this.line=a.__line__)}}function ts(o){let t=o.key,a=o.value,c=o.valueSpec||{},f=o.objectElementValidators||{},g=o.style,v=o.styleSpec,C=[],I=Wn(a);if(I!=="object")return[new Rt(t,a,`object expected, ${I} found`)];for(let A in a){let F=A.split(".")[0],V;f[F]?V=f[F]:c[F]?V=Zr:f["*"]?V=f["*"]:c["*"]&&(V=Zr),V?C=C.concat(V({key:(t&&`${t}.`)+A,value:a[A],valueSpec:c[F]||c["*"],style:g,styleSpec:v,object:a,objectKey:A},a)):C.push(new Rt(t,a[A],`unknown property "${A}"`))}for(let A in c)f[A]||c[A].required&&c[A].default===void 0&&a[A]===void 0&&C.push(new Rt(t,a,`missing required property "${A}"`));return C}function Lp(o){let t=o.value,a=o.valueSpec,c=o.style,f=o.styleSpec,g=o.key,v=o.arrayElementValidator||Zr;if(Wn(t)!=="array")return[new Rt(g,t,`array expected, ${Wn(t)} found`)];if(a.length&&t.length!==a.length)return[new Rt(g,t,`array length ${a.length} expected, length ${t.length} found`)];if(a["min-length"]&&t.length<a["min-length"])return[new Rt(g,t,`array length at least ${a["min-length"]} expected, length ${t.length} found`)];let C={type:a.value,values:a.values,minimum:a.minimum,maximum:a.maximum,function:void 0};f.$version<7&&(C.function=a.function),Wn(a.value)==="object"&&(C=a.value);let I=[];for(let A=0;A<t.length;A++)I=I.concat(v({array:t,arrayIndex:A,value:t[A],valueSpec:C,style:c,styleSpec:f,key:`${g}[${A}]`}));return I}function Mu(o){let t=o.key,a=o.value,c=o.valueSpec,f=Wn(a);if(f==="number"&&a!=a&&(f="NaN"),f!=="number")return[new Rt(t,a,`number expected, ${f} found`)];if("minimum"in c){let g=c.minimum;if(Wn(c.minimum)==="array"&&(g=c.minimum[o.arrayIndex]),a<g)return[new Rt(t,a,`${a} is less than the minimum value ${g}`)]}if("maximum"in c){let g=c.maximum;if(Wn(c.maximum)==="array"&&(g=c.maximum[o.arrayIndex]),a>g)return[new Rt(t,a,`${a} is greater than the maximum value ${g}`)]}return[]}function vc(o){let t=o.valueSpec,a=ur(o.value.type),c,f,g,v={},C=a!=="categorical"&&o.value.property===void 0,I=!C,A=Wn(o.value.stops)==="array"&&Wn(o.value.stops[0])==="array"&&Wn(o.value.stops[0][0])==="object",F=ts({key:o.key,value:o.value,valueSpec:o.styleSpec.function,style:o.style,styleSpec:o.styleSpec,objectElementValidators:{stops:function(W){if(a==="identity")return[new Rt(W.key,W.value,'identity function may not have a "stops" property')];let q=[],ee=W.value;return q=q.concat(Lp({key:W.key,value:ee,valueSpec:W.valueSpec,style:W.style,styleSpec:W.styleSpec,arrayElementValidator:V})),Wn(ee)==="array"&&ee.length===0&&q.push(new Rt(W.key,ee,"array must have at least one stop")),q},default:function(W){return Zr({key:W.key,value:W.value,valueSpec:t,style:W.style,styleSpec:W.styleSpec})}}});return a==="identity"&&C&&F.push(new Rt(o.key,o.value,'missing required property "property"')),a==="identity"||o.value.stops||F.push(new Rt(o.key,o.value,'missing required property "stops"')),a==="exponential"&&o.valueSpec.expression&&!Bd(o.valueSpec)&&F.push(new Rt(o.key,o.value,"exponential functions not supported")),o.styleSpec.$version>=8&&(I&&!_c(o.valueSpec)?F.push(new Rt(o.key,o.value,"property functions not supported")):C&&!Eu(o.valueSpec)&&F.push(new Rt(o.key,o.value,"zoom functions not supported"))),a!=="categorical"&&!A||o.value.property!==void 0||F.push(new Rt(o.key,o.value,'"property" property is required')),F;function V(W){let q=[],ee=W.value,ae=W.key;if(Wn(ee)!=="array")return[new Rt(ae,ee,`array expected, ${Wn(ee)} found`)];if(ee.length!==2)return[new Rt(ae,ee,`array length 2 expected, length ${ee.length} found`)];if(A){if(Wn(ee[0])!=="object")return[new Rt(ae,ee,`object expected, ${Wn(ee[0])} found`)];if(ee[0].zoom===void 0)return[new Rt(ae,ee,"object stop key must have zoom")];if(ee[0].value===void 0)return[new Rt(ae,ee,"object stop key must have value")];let me=ur(ee[0].zoom);if(typeof me!="number")return[new Rt(ae,ee[0].zoom,"stop zoom values must be numbers")];if(g&&g>me)return[new Rt(ae,ee[0].zoom,"stop zoom values must appear in ascending order")];me!==g&&(g=me,f=void 0,v={}),q=q.concat(ts({key:`${ae}[0]`,value:ee[0],valueSpec:{zoom:{}},style:W.style,styleSpec:W.styleSpec,objectElementValidators:{zoom:Mu,value:$}}))}else q=q.concat($({key:`${ae}[0]`,value:ee[0],valueSpec:{},style:W.style,styleSpec:W.styleSpec},ee));return Tl(kr(ee[1]))?q.concat([new Rt(`${ae}[1]`,ee[1],"expressions are not allowed in function stops.")]):q.concat(Zr({key:`${ae}[1]`,value:ee[1],valueSpec:t,style:W.style,styleSpec:W.styleSpec}))}function $(W,q){let ee=Wn(W.value),ae=ur(W.value),me=W.value!==null?W.value:q;if(c){if(ee!==c)return[new Rt(W.key,me,`${ee} stop domain type must match previous stop domain type ${c}`)]}else c=ee;if(ee!=="number"&&ee!=="string"&&ee!=="boolean"&&typeof ae!="number"&&typeof ae!="string"&&typeof ae!="boolean")return[new Rt(W.key,me,"stop domain value must be a number, string, or boolean")];if(ee!=="number"&&a!=="categorical"){let Ce=`number expected, ${ee} found`;return _c(t)&&a===void 0&&(Ce+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Rt(W.key,me,Ce)]}return a!=="categorical"||ee!=="number"||typeof ae=="number"&&isFinite(ae)&&Math.floor(ae)===ae?a!=="categorical"&&ee==="number"&&typeof ae=="number"&&typeof f=="number"&&f!==void 0&&ae<f?[new Rt(W.key,me,"stop domain values must appear in ascending order")]:(f=ae,a==="categorical"&&ae in v?[new Rt(W.key,me,"stop domain values must be unique")]:(v[ae]=!0,[])):[new Rt(W.key,me,`integer expected, found ${String(ae)}`)]}}function _r(o){let t=(o.expressionContext==="property"?Du:Kt)(kr(o.value),o.valueSpec);if(t.result==="error")return t.value.map(c=>new Rt(`${o.key}${c.key}`,o.value,c.message));let a=t.value.expression||t.value._styleExpression.expression;if(o.expressionContext==="property"&&o.propertyKey==="text-font"&&!a.outputDefined())return[new Rt(o.key,o.value,`Invalid data expression for "${o.propertyKey}". Output values must be contained as literals within the expression.`)];if(o.expressionContext==="property"&&o.propertyType==="layout"&&!sa(a))return[new Rt(o.key,o.value,'"feature-state" data expressions are not supported with layout properties.')];if(o.expressionContext==="filter")return Tu(a,o);if(o.expressionContext&&o.expressionContext.indexOf("cluster")===0){if(!gl(a,["zoom","feature-state"]))return[new Rt(o.key,o.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(o.expressionContext==="cluster-initial"&&!Pa(a))return[new Rt(o.key,o.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Tu(o,t){let a=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(t.valueSpec&&t.valueSpec.expression)for(let f of t.valueSpec.expression.parameters)a.delete(f);if(a.size===0)return[];let c=[];return o instanceof oa&&a.has(o.name)?[new Rt(t.key,t.value,`["${o.name}"] expression is not supported in a filter for a ${t.object.type} layer with id: ${t.object.id}`)]:(o.eachChild(f=>{c.push(...Tu(f,t))}),c)}function Hd(o){let t=o.key,a=o.value,c=o.valueSpec,f=[];return Array.isArray(c.values)?c.values.indexOf(ur(a))===-1&&f.push(new Rt(t,a,`expected one of [${c.values.join(", ")}], ${JSON.stringify(a)} found`)):Object.keys(c.values).indexOf(ur(a))===-1&&f.push(new Rt(t,a,`expected one of [${Object.keys(c.values).join(", ")}], ${JSON.stringify(a)} found`)),f}function Jh(o){if(o===!0||o===!1)return!0;if(!Array.isArray(o)||o.length===0)return!1;switch(o[0]){case"has":return o.length>=2&&o[1]!=="$id"&&o[1]!=="$type";case"in":return o.length>=3&&(typeof o[1]!="string"||Array.isArray(o[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return o.length!==3||Array.isArray(o[1])||Array.isArray(o[2]);case"any":case"all":for(let t of o.slice(1))if(!Jh(t)&&typeof t!="boolean")return!1;return!0;default:return!0}}function Sl(o,t="fill"){if(o==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};Jh(o)||(o=xc(o));let a=o,c=!0;try{c=function(A){if(!bc(A))return A;let F=kr(A);return Iu(F),F=Fp(F),F}(a)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(a,null,2)}
        `)}let f=Je[`filter_${t}`],g=Kt(c,f),v=null;if(g.result==="error")throw new Error(g.value.map(A=>`${A.key}: ${A.message}`).join(", "));v=(A,F,V)=>g.value.evaluate(A,F,{},V);let C=null,I=null;if(c!==a){let A=Kt(a,f);if(A.result==="error")throw new Error(A.value.map(F=>`${F.key}: ${F.message}`).join(", "));C=(F,V,$,W,q)=>A.value.evaluate(F,V,{},$,void 0,void 0,W,q),I=!Pa(A.value.expression)}return{filter:v,dynamicFilter:C||void 0,needGeometry:Np(c),needFeature:!!I}}function Fp(o){if(!Array.isArray(o))return o;let t=function(a){if(ef.has(a[0])){for(let c=1;c<a.length;c++)if(bc(a[c]))return!0}return a}(o);return t===!0?t:t.map(a=>Fp(a))}function Iu(o){let t=!1,a=[];if(o[0]==="case"){for(let c=1;c<o.length-1;c+=2)t=t||bc(o[c]),a.push(o[c+1]);a.push(o[o.length-1])}else if(o[0]==="match"){t=t||bc(o[1]);for(let c=2;c<o.length-1;c+=2)a.push(o[c+1]);a.push(o[o.length-1])}else if(o[0]==="step"){t=t||bc(o[1]);for(let c=1;c<o.length-1;c+=2)a.push(o[c+1])}t&&(o.length=0,o.push("any",...a));for(let c=1;c<o.length;c++)Iu(o[c])}function bc(o){if(!Array.isArray(o))return!1;if((t=o[0])==="pitch"||t==="distance-from-center")return!0;var t;for(let a=1;a<o.length;a++)if(bc(o[a]))return!0;return!1}let ef=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function ry(o,t){return o<t?-1:o>t?1:0}function Np(o){if(!Array.isArray(o))return!1;if(o[0]==="within")return!0;for(let t=1;t<o.length;t++)if(Np(o[t]))return!0;return!1}function xc(o){if(!o)return!0;let t=o[0];return o.length<=1?t!=="any":t==="=="?Gd(o[1],o[2],"=="):t==="!="?Su(Gd(o[1],o[2],"==")):t==="<"||t===">"||t==="<="||t===">="?Gd(o[1],o[2],t):t==="any"?(a=o.slice(1),["any"].concat(a.map(xc))):t==="all"?["all"].concat(o.slice(1).map(xc)):t==="none"?["all"].concat(o.slice(1).map(xc).map(Su)):t==="in"?tf(o[1],o.slice(2)):t==="!in"?Su(tf(o[1],o.slice(2))):t==="has"?nf(o[1]):t==="!has"?Su(nf(o[1])):t!=="within"||o;var a}function Gd(o,t,a){switch(o){case"$type":return[`filter-type-${a}`,t];case"$id":return[`filter-id-${a}`,t];default:return[`filter-${a}`,o,t]}}function tf(o,t){if(t.length===0)return!1;switch(o){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(a=>typeof a!=typeof t[0])?["filter-in-large",o,["literal",t.sort(ry)]]:["filter-in-small",o,["literal",t]]}}function nf(o){switch(o){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",o]}}function Su(o){return["!",o]}function wc(o){return Jh(kr(o.value))?_r(na({},o,{expressionContext:"filter",valueSpec:o.styleSpec[`filter_${o.layerType||"fill"}`]})):ho(o)}function ho(o){let t=o.value,a=o.key;if(Wn(t)!=="array")return[new Rt(a,t,`array expected, ${Wn(t)} found`)];let c=o.styleSpec,f,g=[];if(t.length<1)return[new Rt(a,t,"filter array must have at least 1 element")];switch(g=g.concat(Hd({key:`${a}[0]`,value:t[0],valueSpec:c.filter_operator,style:o.style,styleSpec:o.styleSpec})),ur(t[0])){case"<":case"<=":case">":case">=":t.length>=2&&ur(t[1])==="$type"&&g.push(new Rt(a,t,`"$type" cannot be use with operator "${t[0]}"`));case"==":case"!=":t.length!==3&&g.push(new Rt(a,t,`filter array for operator "${t[0]}" must have 3 elements`));case"in":case"!in":t.length>=2&&(f=Wn(t[1]),f!=="string"&&g.push(new Rt(`${a}[1]`,t[1],`string expected, ${f} found`)));for(let v=2;v<t.length;v++)f=Wn(t[v]),ur(t[1])==="$type"?g=g.concat(Hd({key:`${a}[${v}]`,value:t[v],valueSpec:c.geometry_type,style:o.style,styleSpec:o.styleSpec})):f!=="string"&&f!=="number"&&f!=="boolean"&&g.push(new Rt(`${a}[${v}]`,t[v],`string, number, or boolean expected, ${f} found`));break;case"any":case"all":case"none":for(let v=1;v<t.length;v++)g=g.concat(ho({key:`${a}[${v}]`,value:t[v],style:o.style,styleSpec:o.styleSpec}));break;case"has":case"!has":f=Wn(t[1]),t.length!==2?g.push(new Rt(a,t,`filter array for "${t[0]}" operator must have 2 elements`)):f!=="string"&&g.push(new Rt(`${a}[1]`,t[1],`string expected, ${f} found`));break;case"within":f=Wn(t[1]),t.length!==2?g.push(new Rt(a,t,`filter array for "${t[0]}" operator must have 2 elements`)):f!=="object"&&g.push(new Rt(`${a}[1]`,t[1],`object expected, ${f} found`))}return g}function rf(o,t){let a=o.key,c=o.style,f=o.styleSpec,g=o.value,v=o.objectKey,C=f[`${t}_${o.layerType}`];if(!C)return[];let I=v.match(/^(.*)-transition$/);if(t==="paint"&&I&&C[I[1]]&&C[I[1]].transition)return Zr({key:a,value:g,valueSpec:f.transition,style:c,styleSpec:f});let A=o.valueSpec||C[v];if(!A)return[new Rt(a,g,`unknown property "${v}"`)];let F;if(Wn(g)==="string"&&_c(A)&&!A.tokens&&(F=/^{([^}]+)}$/.exec(g))){let $=`\`{ "type": "identity", "property": ${F?JSON.stringify(F[1]):'"_"'} }\``;return[new Rt(a,g,`"${v}" does not support interpolation syntax
Use an identity property function instead: ${$}.`)]}let V=[];return o.layerType==="symbol"&&(v==="text-field"&&c&&!c.glyphs&&V.push(new Rt(a,g,'use of "text-field" requires a style "glyphs" property')),v==="text-font"&&Fr(kr(g))&&ur(g.type)==="identity"&&V.push(new Rt(a,g,'"text-font" does not support identity functions'))),V.concat(Zr({key:o.key,value:g,valueSpec:A,style:c,styleSpec:f,expressionContext:"property",propertyType:t,propertyKey:v}))}function zp(o){return rf(o,"paint")}function of(o){return rf(o,"layout")}function sf(o){let t=[],a=o.value,c=o.key,f=o.style,g=o.styleSpec;a.type||a.ref||t.push(new Rt(c,a,'either "type" or "ref" is required'));let v=ur(a.type),C=ur(a.ref);if(a.id){let I=ur(a.id);for(let A=0;A<o.arrayIndex;A++){let F=f.layers[A];ur(F.id)===I&&t.push(new Rt(c,a.id,`duplicate layer id "${a.id}", previously used at line ${F.id.__line__}`))}}if("ref"in a){let I;["type","source","source-layer","filter","layout"].forEach(A=>{A in a&&t.push(new Rt(c,a[A],`"${A}" is prohibited for ref layers`))}),f.layers.forEach(A=>{ur(A.id)===C&&(I=A)}),I?I.ref?t.push(new Rt(c,a.ref,"ref cannot reference another ref layer")):v=ur(I.type):typeof C=="string"&&t.push(new Rt(c,a.ref,`ref layer "${C}" not found`))}else if(v!=="background"&&v!=="sky")if(a.source){let I=f.sources&&f.sources[a.source],A=I&&ur(I.type);I?A==="vector"&&v==="raster"?t.push(new Rt(c,a.source,`layer "${a.id}" requires a raster source`)):A==="raster"&&v!=="raster"?t.push(new Rt(c,a.source,`layer "${a.id}" requires a vector source`)):A!=="vector"||a["source-layer"]?A==="raster-dem"&&v!=="hillshade"?t.push(new Rt(c,a.source,"raster-dem source can only be used with layer type 'hillshade'.")):v!=="line"||!a.paint||!a.paint["line-gradient"]&&!a.paint["line-trim-offset"]||A==="geojson"&&I.lineMetrics||t.push(new Rt(c,a,`layer "${a.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):t.push(new Rt(c,a,`layer "${a.id}" must specify a "source-layer"`)):t.push(new Rt(c,a.source,`source "${a.source}" not found`))}else t.push(new Rt(c,a,'missing required property "source"'));return t=t.concat(ts({key:c,value:a,valueSpec:g.layer,style:o.style,styleSpec:o.styleSpec,objectElementValidators:{"*":()=>[],type:()=>Zr({key:`${c}.type`,value:a.type,valueSpec:g.layer.type,style:o.style,styleSpec:o.styleSpec,object:a,objectKey:"type"}),filter:I=>wc(na({layerType:v},I)),layout:I=>ts({layer:a,key:I.key,value:I.value,valueSpec:{},style:I.style,styleSpec:I.styleSpec,objectElementValidators:{"*":A=>of(na({layerType:v},A))}}),paint:I=>ts({layer:a,key:I.key,value:I.value,valueSpec:{},style:I.style,styleSpec:I.styleSpec,objectElementValidators:{"*":A=>zp(na({layerType:v},A))}})}})),t}function Fa(o){let t=o.value,a=o.key,c=Wn(t);return c!=="string"?[new Rt(a,t,`string expected, ${c} found`)]:[]}let Bp={promoteId:function({key:o,value:t}){if(Wn(t)==="string")return Fa({key:o,value:t});{let a=[];for(let c in t)a.push(...Fa({key:`${o}.${c}`,value:t[c]}));return a}}};function Au(o){let t=o.value,a=o.key,c=o.styleSpec,f=o.style;if(!t.type)return[new Rt(a,t,'"type" is required')];let g=ur(t.type),v;switch(g){case"vector":case"raster":case"raster-dem":return v=ts({key:a,value:t,valueSpec:c[`source_${g.replace("-","_")}`],style:o.style,styleSpec:c,objectElementValidators:Bp}),v;case"geojson":if(v=ts({key:a,value:t,valueSpec:c.source_geojson,style:f,styleSpec:c,objectElementValidators:Bp}),t.cluster)for(let C in t.clusterProperties){let[I,A]=t.clusterProperties[C],F=typeof I=="string"?[I,["accumulated"],["get",C]]:I;v.push(..._r({key:`${a}.${C}.map`,value:A,expressionContext:"cluster-map"})),v.push(..._r({key:`${a}.${C}.reduce`,value:F,expressionContext:"cluster-reduce"}))}return v;case"video":return ts({key:a,value:t,valueSpec:c.source_video,style:f,styleSpec:c});case"image":return ts({key:a,value:t,valueSpec:c.source_image,style:f,styleSpec:c});case"canvas":return[new Rt(a,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Hd({key:`${a}.type`,value:t.type,valueSpec:{values:oy(c)},style:f,styleSpec:c})}}function oy(o){return o.source.reduce((t,a)=>{let c=o[a];return c.type.type==="enum"&&(t=t.concat(Object.keys(c.type.values))),t},[])}function af(o){let t=o.value,a=o.styleSpec,c=a.light,f=o.style,g=[],v=Wn(t);if(t===void 0)return g;if(v!=="object")return g=g.concat([new Rt("light",t,`object expected, ${v} found`)]),g;for(let C in t){let I=C.match(/^(.*)-transition$/);g=g.concat(I&&c[I[1]]&&c[I[1]].transition?Zr({key:C,value:t[C],valueSpec:a.transition,style:f,styleSpec:a}):c[C]?Zr({key:C,value:t[C],valueSpec:c[C],style:f,styleSpec:a}):[new Rt(C,t[C],`unknown property "${C}"`)])}return g}function lf(o){let t=o.value,a=o.key,c=o.style,f=o.styleSpec,g=f.terrain,v=[],C=Wn(t);if(t===void 0)return v;if(C!=="object")return v=v.concat([new Rt("terrain",t,`object expected, ${C} found`)]),v;for(let I in t){let A=I.match(/^(.*)-transition$/);v=v.concat(A&&g[A[1]]&&g[A[1]].transition?Zr({key:I,value:t[I],valueSpec:f.transition,style:c,styleSpec:f}):g[I]?Zr({key:I,value:t[I],valueSpec:g[I],style:c,styleSpec:f}):[new Rt(I,t[I],`unknown property "${I}"`)])}if(t.source){let I=c.sources&&c.sources[t.source],A=I&&ur(I.type);I?A!=="raster-dem"&&v.push(new Rt(a,t.source,`terrain cannot be used with a source of type ${String(A)}, it only be used with a "raster-dem" source type`)):v.push(new Rt(a,t.source,`source "${t.source}" not found`))}else v.push(new Rt(a,t,'terrain is missing required property "source"'));return v}function jp(o){let t=o.value,a=o.style,c=o.styleSpec,f=c.fog,g=[],v=Wn(t);if(t===void 0)return g;if(v!=="object")return g=g.concat([new Rt("fog",t,`object expected, ${v} found`)]),g;for(let C in t){let I=C.match(/^(.*)-transition$/);g=g.concat(I&&f[I[1]]&&f[I[1]].transition?Zr({key:C,value:t[C],valueSpec:c.transition,style:a,styleSpec:c}):f[C]?Zr({key:C,value:t[C],valueSpec:f[C],style:a,styleSpec:c}):[new Rt(C,t[C],`unknown property "${C}"`)])}return g}let cf={"*":()=>[],array:Lp,boolean:function(o){let t=o.value,a=o.key,c=Wn(t);return c!=="boolean"?[new Rt(a,t,`boolean expected, ${c} found`)]:[]},number:Mu,color:function(o){let t=o.key,a=o.value,c=Wn(a);return c!=="string"?[new Rt(t,a,`color expected, ${c} found`)]:Bh(a)===null?[new Rt(t,a,`color expected, "${a}" found`)]:[]},enum:Hd,filter:wc,function:vc,layer:sf,object:ts,source:Au,light:af,terrain:lf,fog:jp,string:Fa,formatted:function(o){return Fa(o).length===0?[]:_r(o)},resolvedImage:function(o){return Fa(o).length===0?[]:_r(o)},projection:function(o){let t=o.value,a=o.styleSpec,c=a.projection,f=o.style,g=[],v=Wn(t);if(v==="object")for(let C in t)g=g.concat(Zr({key:C,value:t[C],valueSpec:c[C],style:f,styleSpec:a}));else v!=="string"&&(g=g.concat([new Rt("projection",t,`object or string expected, ${v} found`)]));return g}};function Zr(o){let t=o.value,a=o.valueSpec,c=o.styleSpec;return a.expression&&Fr(ur(t))?vc(o):a.expression&&Tl(kr(t))?_r(o):a.type&&cf[a.type]?cf[a.type](o):ts(na({},o,{valueSpec:a.type?c[a.type]:a}))}function sy(o){let t=o.value,a=o.key,c=Fa(o);return c.length||(t.indexOf("{fontstack}")===-1&&c.push(new Rt(a,t,'"glyphs" url must include a "{fontstack}" token')),t.indexOf("{range}")===-1&&c.push(new Rt(a,t,'"glyphs" url must include a "{range}" token'))),c}function Vp(o,t=Je){return No(Zr({key:"",value:o,valueSpec:t.$root,styleSpec:t,style:o,objectElementValidators:{glyphs:sy,"*":()=>[]}}))}let Cc=o=>No(zp(o)),Up=o=>No(of(o));function No(o){return o.slice().sort((t,a)=>t.line&&a.line?t.line-a.line:0)}function $p(o,t){let a=!1;if(t&&t.length)for(let c of t)o.fire(new ta(new Error(c.message))),a=!0;return a}var Hp=Es,ns=3;function Es(o,t,a){var c=this.cells=[];if(o instanceof ArrayBuffer){this.arrayBuffer=o;var f=new Int32Array(this.arrayBuffer);o=f[0],this.d=(t=f[1])+2*(a=f[2]);for(var g=0;g<this.d*this.d;g++){var v=f[ns+g],C=f[ns+g+1];c.push(v===C?null:f.subarray(v,C))}var I=f[ns+c.length+1];this.keys=f.subarray(f[ns+c.length],I),this.bboxes=f.subarray(I),this.insert=this._insertReadonly}else{this.d=t+2*a;for(var A=0;A<this.d*this.d;A++)c.push([]);this.keys=[],this.bboxes=[]}this.n=t,this.extent=o,this.padding=a,this.scale=t/o,this.uid=0;var F=a/t*o;this.min=-F,this.max=o+F}Es.prototype.insert=function(o,t,a,c,f){this._forEachCell(t,a,c,f,this._insertCell,this.uid++),this.keys.push(o),this.bboxes.push(t),this.bboxes.push(a),this.bboxes.push(c),this.bboxes.push(f)},Es.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Es.prototype._insertCell=function(o,t,a,c,f,g){this.cells[f].push(g)},Es.prototype.query=function(o,t,a,c,f){var g=this.min,v=this.max;if(o<=g&&t<=g&&v<=a&&v<=c&&!f)return Array.prototype.slice.call(this.keys);var C=[];return this._forEachCell(o,t,a,c,this._queryCell,C,{},f),C},Es.prototype._queryCell=function(o,t,a,c,f,g,v,C){var I=this.cells[f];if(I!==null)for(var A=this.keys,F=this.bboxes,V=0;V<I.length;V++){var $=I[V];if(v[$]===void 0){var W=4*$;(C?C(F[W+0],F[W+1],F[W+2],F[W+3]):o<=F[W+2]&&t<=F[W+3]&&a>=F[W+0]&&c>=F[W+1])?(v[$]=!0,g.push(A[$])):v[$]=!1}}},Es.prototype._forEachCell=function(o,t,a,c,f,g,v,C){for(var I=this._convertToCellCoord(o),A=this._convertToCellCoord(t),F=this._convertToCellCoord(a),V=this._convertToCellCoord(c),$=I;$<=F;$++)for(var W=A;W<=V;W++){var q=this.d*W+$;if((!C||C(this._convertFromCellCoord($),this._convertFromCellCoord(W),this._convertFromCellCoord($+1),this._convertFromCellCoord(W+1)))&&f.call(this,o,t,a,c,q,g,v,C))return}},Es.prototype._convertFromCellCoord=function(o){return(o-this.padding)/this.scale},Es.prototype._convertToCellCoord=function(o){return Math.max(0,Math.min(this.d-1,Math.floor(o*this.scale)+this.padding))},Es.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var o=this.cells,t=ns+this.cells.length+1+1,a=0,c=0;c<this.cells.length;c++)a+=this.cells[c].length;var f=new Int32Array(t+a+this.keys.length+this.bboxes.length);f[0]=this.extent,f[1]=this.n,f[2]=this.padding;for(var g=t,v=0;v<o.length;v++){var C=o[v];f[ns+v]=g,f.set(C,g),g+=C.length}return f[ns+o.length]=g,f.set(this.keys,g),f[ns+o.length+1]=g+=this.keys.length,f.set(this.bboxes,g),g+=this.bboxes.length,f.buffer};var Al=Qt(Hp);let Ec={};function Ot(o,t,a={}){Object.defineProperty(o,"_classRegistryKey",{value:t,writeable:!1}),Ec[t]={klass:o,omit:a.omit||[]}}Ot(Object,"Object"),Al.serialize=function(o,t){let a=o.toArrayBuffer();return t&&t.push(a),{buffer:a}},Al.deserialize=function(o){return new Al(o.buffer)},Object.defineProperty(Al,"name",{value:"Grid"}),Ot(Al,"Grid"),Ot(ir,"Color"),Ot(Error,"Error"),Ot(wo,"AJAXError"),Ot(Do,"ResolvedImage"),Ot(Il,"StylePropertyFunction"),Ot(Ud,"StyleExpression",{omit:["_evaluator"]}),Ot(La,"ZoomDependentExpression"),Ot($d,"ZoomConstantExpression"),Ot(oa,"CompoundExpression",{omit:["_evaluate"]});for(let o in Cu)Ec[Cu[o]._classRegistryKey]||Ot(Cu[o],`Expression${o}`);function Na(o){return o&&typeof ArrayBuffer<"u"&&(o instanceof ArrayBuffer||o.constructor&&o.constructor.name==="ArrayBuffer")}function uf(o){return E.ImageBitmap&&o instanceof E.ImageBitmap}function za(o,t){if(o==null||typeof o=="boolean"||typeof o=="number"||typeof o=="string"||o instanceof Boolean||o instanceof Number||o instanceof String||o instanceof Date||o instanceof RegExp)return o;if(Na(o)||uf(o))return t&&t.push(o),o;if(ArrayBuffer.isView(o)){let a=o;return t&&t.push(a.buffer),a}if(o instanceof E.ImageData)return t&&t.push(o.data.buffer),o;if(Array.isArray(o)){let a=[];for(let c of o)a.push(za(c,t));return a}if(typeof o=="object"){let a=o.constructor,c=a._classRegistryKey;if(!c)throw new Error(`can't serialize object of unregistered class ${c}`);let f=a.serialize?a.serialize(o,t):{};if(!a.serialize){for(let g in o)o.hasOwnProperty(g)&&(Ec[c].omit.indexOf(g)>=0||(f[g]=za(o[g],t)));o instanceof Error&&(f.message=o.message)}if(f.$name)throw new Error("$name property is reserved for worker serialization logic.");return c!=="Object"&&(f.$name=c),f}throw new Error("can't serialize object of type "+typeof o)}function kl(o){if(o==null||typeof o=="boolean"||typeof o=="number"||typeof o=="string"||o instanceof Boolean||o instanceof Number||o instanceof String||o instanceof Date||o instanceof RegExp||Na(o)||uf(o)||ArrayBuffer.isView(o)||o instanceof E.ImageData)return o;if(Array.isArray(o))return o.map(kl);if(typeof o=="object"){let t=o.$name||"Object",{klass:a}=Ec[t];if(!a)throw new Error(`can't deserialize unregistered class ${t}`);if(a.deserialize)return a.deserialize(o);let c=Object.create(a.prototype);for(let f of Object.keys(o))f!=="$name"&&(c[f]=kl(o[f]));return c}throw new Error("can't deserialize object of type "+typeof o)}let At={"Latin-1 Supplement":o=>o>=128&&o<=255,Arabic:o=>o>=1536&&o<=1791,"Arabic Supplement":o=>o>=1872&&o<=1919,"Arabic Extended-A":o=>o>=2208&&o<=2303,"Hangul Jamo":o=>o>=4352&&o<=4607,"Unified Canadian Aboriginal Syllabics":o=>o>=5120&&o<=5759,Khmer:o=>o>=6016&&o<=6143,"Unified Canadian Aboriginal Syllabics Extended":o=>o>=6320&&o<=6399,"General Punctuation":o=>o>=8192&&o<=8303,"Letterlike Symbols":o=>o>=8448&&o<=8527,"Number Forms":o=>o>=8528&&o<=8591,"Miscellaneous Technical":o=>o>=8960&&o<=9215,"Control Pictures":o=>o>=9216&&o<=9279,"Optical Character Recognition":o=>o>=9280&&o<=9311,"Enclosed Alphanumerics":o=>o>=9312&&o<=9471,"Geometric Shapes":o=>o>=9632&&o<=9727,"Miscellaneous Symbols":o=>o>=9728&&o<=9983,"Miscellaneous Symbols and Arrows":o=>o>=11008&&o<=11263,"CJK Radicals Supplement":o=>o>=11904&&o<=12031,"Kangxi Radicals":o=>o>=12032&&o<=12255,"Ideographic Description Characters":o=>o>=12272&&o<=12287,"CJK Symbols and Punctuation":o=>o>=12288&&o<=12351,Hiragana:o=>o>=12352&&o<=12447,Katakana:o=>o>=12448&&o<=12543,Bopomofo:o=>o>=12544&&o<=12591,"Hangul Compatibility Jamo":o=>o>=12592&&o<=12687,Kanbun:o=>o>=12688&&o<=12703,"Bopomofo Extended":o=>o>=12704&&o<=12735,"CJK Strokes":o=>o>=12736&&o<=12783,"Katakana Phonetic Extensions":o=>o>=12784&&o<=12799,"Enclosed CJK Letters and Months":o=>o>=12800&&o<=13055,"CJK Compatibility":o=>o>=13056&&o<=13311,"CJK Unified Ideographs Extension A":o=>o>=13312&&o<=19903,"Yijing Hexagram Symbols":o=>o>=19904&&o<=19967,"CJK Unified Ideographs":o=>o>=19968&&o<=40959,"Yi Syllables":o=>o>=40960&&o<=42127,"Yi Radicals":o=>o>=42128&&o<=42191,"Hangul Jamo Extended-A":o=>o>=43360&&o<=43391,"Hangul Syllables":o=>o>=44032&&o<=55215,"Hangul Jamo Extended-B":o=>o>=55216&&o<=55295,"Private Use Area":o=>o>=57344&&o<=63743,"CJK Compatibility Ideographs":o=>o>=63744&&o<=64255,"Arabic Presentation Forms-A":o=>o>=64336&&o<=65023,"Vertical Forms":o=>o>=65040&&o<=65055,"CJK Compatibility Forms":o=>o>=65072&&o<=65103,"Small Form Variants":o=>o>=65104&&o<=65135,"Arabic Presentation Forms-B":o=>o>=65136&&o<=65279,"Halfwidth and Fullwidth Forms":o=>o>=65280&&o<=65519};function Wd(o){for(let t of o)if(df(t.charCodeAt(0)))return!0;return!1}function ay(o){for(let t of o)if(!Gp(t.charCodeAt(0)))return!1;return!0}function Gp(o){return!(At.Arabic(o)||At["Arabic Supplement"](o)||At["Arabic Extended-A"](o)||At["Arabic Presentation Forms-A"](o)||At["Arabic Presentation Forms-B"](o))}function df(o){return!(o!==746&&o!==747&&(o<4352||!(At["Bopomofo Extended"](o)||At.Bopomofo(o)||At["CJK Compatibility Forms"](o)&&!(o>=65097&&o<=65103)||At["CJK Compatibility Ideographs"](o)||At["CJK Compatibility"](o)||At["CJK Radicals Supplement"](o)||At["CJK Strokes"](o)||!(!At["CJK Symbols and Punctuation"](o)||o>=12296&&o<=12305||o>=12308&&o<=12319||o===12336)||At["CJK Unified Ideographs Extension A"](o)||At["CJK Unified Ideographs"](o)||At["Enclosed CJK Letters and Months"](o)||At["Hangul Compatibility Jamo"](o)||At["Hangul Jamo Extended-A"](o)||At["Hangul Jamo Extended-B"](o)||At["Hangul Jamo"](o)||At["Hangul Syllables"](o)||At.Hiragana(o)||At["Ideographic Description Characters"](o)||At.Kanbun(o)||At["Kangxi Radicals"](o)||At["Katakana Phonetic Extensions"](o)||At.Katakana(o)&&o!==12540||!(!At["Halfwidth and Fullwidth Forms"](o)||o===65288||o===65289||o===65293||o>=65306&&o<=65310||o===65339||o===65341||o===65343||o>=65371&&o<=65503||o===65507||o>=65512&&o<=65519)||!(!At["Small Form Variants"](o)||o>=65112&&o<=65118||o>=65123&&o<=65126)||At["Unified Canadian Aboriginal Syllabics"](o)||At["Unified Canadian Aboriginal Syllabics Extended"](o)||At["Vertical Forms"](o)||At["Yijing Hexagram Symbols"](o)||At["Yi Syllables"](o)||At["Yi Radicals"](o))))}function Wp(o){return!(df(o)||function(t){return!!(At["Latin-1 Supplement"](t)&&(t===167||t===169||t===174||t===177||t===188||t===189||t===190||t===215||t===247)||At["General Punctuation"](t)&&(t===8214||t===8224||t===8225||t===8240||t===8241||t===8251||t===8252||t===8258||t===8263||t===8264||t===8265||t===8273)||At["Letterlike Symbols"](t)||At["Number Forms"](t)||At["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||t===9003||t>=9085&&t<=9114||t>=9150&&t<=9165||t===9167||t>=9169&&t<=9179||t>=9186&&t<=9215)||At["Control Pictures"](t)&&t!==9251||At["Optical Character Recognition"](t)||At["Enclosed Alphanumerics"](t)||At["Geometric Shapes"](t)||At["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||At["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||At["CJK Symbols and Punctuation"](t)||At.Katakana(t)||At["Private Use Area"](t)||At["CJK Compatibility Forms"](t)||At["Small Form Variants"](t)||At["Halfwidth and Fullwidth Forms"](t)||t===8734||t===8756||t===8757||t>=9984&&t<=10087||t>=10102&&t<=10131||t===65532||t===65533)}(o))}function qp(o){return o>=1424&&o<=2303||At["Arabic Presentation Forms-A"](o)||At["Arabic Presentation Forms-B"](o)}function ly(o,t){return!(!t&&qp(o)||o>=2304&&o<=3583||o>=3840&&o<=4255||At.Khmer(o))}function qd(o){for(let t of o)if(qp(t.charCodeAt(0)))return!0;return!1}let ku="deferred",hf="loading",ff="loaded",Dc=null,m="unavailable",l=null,h=function(o){o&&typeof o=="string"&&o.indexOf("NetworkError")>-1&&(m="error"),Dc&&Dc(o)};function _(){x.fire(new ol("pluginStateChange",{pluginStatus:m,pluginURL:l}))}let x=new sc,D=function(){return m},k=function(){if(m!==ku||!l)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");m=hf,_(),l&&ea({url:l},o=>{o?h(o):(m=ff,_())})},R={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>m===ff||R.applyArabicShaping!=null,isLoading:()=>m===hf,setState(o){m=o.pluginStatus,l=o.pluginURL},isParsed:()=>R.applyArabicShaping!=null&&R.processBidirectionalText!=null&&R.processStyledBidirectionalText!=null,getPluginURL:()=>l};class z{constructor(t,a){this.zoom=t,a?(this.now=a.now,this.fadeDuration=a.fadeDuration,this.transition=a.transition,this.pitch=a.pitch):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0)}isSupportedScript(t){return function(a,c){for(let f of a)if(!ly(f.charCodeAt(0),c))return!1;return!0}(t,R.isLoaded())}}class G{constructor(t,a){this.property=t,this.value=a,this.expression=function(c,f){if(Fr(c))return new Il(c,f);if(Tl(c)){let g=Du(c,f);if(g.result==="error")throw new Error(g.value.map(v=>`${v.key}: ${v.message}`).join(", "));return g.value}{let g=c;return typeof c=="string"&&f.type==="color"&&(g=ir.parse(c)),{kind:"constant",evaluate:()=>g}}}(a===void 0?t.specification.default:a,t.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(t,a,c){return this.property.possiblyEvaluate(this,t,a,c)}}class H{constructor(t){this.property=t,this.value=new G(t,void 0)}transitioned(t,a){return new se(this.property,this.value,a,Bi({},t.transition,this.transition),t.now)}untransitioned(){return new se(this.property,this.value,null,{},0)}}class K{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)}getValue(t){return bo(this._values[t].value.value)}setValue(t,a){this._values.hasOwnProperty(t)||(this._values[t]=new H(this._values[t].property)),this._values[t].value=new G(this._values[t].property,a===null?void 0:bo(a))}getTransition(t){return bo(this._values[t].transition)}setTransition(t,a){this._values.hasOwnProperty(t)||(this._values[t]=new H(this._values[t].property)),this._values[t].transition=bo(a)||void 0}serialize(){let t={};for(let a of Object.keys(this._values)){let c=this.getValue(a);c!==void 0&&(t[a]=c);let f=this.getTransition(a);f!==void 0&&(t[`${a}-transition`]=f)}return t}transitioned(t,a){let c=new le(this._properties);for(let f of Object.keys(this._values))c._values[f]=this._values[f].transitioned(t,a._values[f]);return c}untransitioned(){let t=new le(this._properties);for(let a of Object.keys(this._values))t._values[a]=this._values[a].untransitioned();return t}}class se{constructor(t,a,c,f,g){let v=f.delay||0,C=f.duration||0;g=g||0,this.property=t,this.value=a,this.begin=g+v,this.end=this.begin+C,t.specification.transition&&(f.delay||f.duration)&&(this.prior=c)}possiblyEvaluate(t,a,c){let f=t.now||0,g=this.value.possiblyEvaluate(t,a,c),v=this.prior;if(v){if(f>this.end)return this.prior=null,g;if(this.value.isDataDriven())return this.prior=null,g;if(f<this.begin)return v.possiblyEvaluate(t,a,c);{let C=(f-this.begin)/(this.end-this.begin);return this.property.interpolate(v.possiblyEvaluate(t,a,c),g,Zs(C))}}return g}}class le{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)}possiblyEvaluate(t,a,c){let f=new pe(this._properties);for(let g of Object.keys(this._values))f._values[g]=this._values[g].possiblyEvaluate(t,a,c);return f}hasTransition(){for(let t of Object.keys(this._values))if(this._values[t].prior)return!0;return!1}}class fe{constructor(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)}getValue(t){return bo(this._values[t].value)}setValue(t,a){this._values[t]=new G(this._values[t].property,a===null?void 0:bo(a))}serialize(){let t={};for(let a of Object.keys(this._values)){let c=this.getValue(a);c!==void 0&&(t[a]=c)}return t}possiblyEvaluate(t,a,c){let f=new pe(this._properties);for(let g of Object.keys(this._values))f._values[g]=this._values[g].possiblyEvaluate(t,a,c);return f}}class he{constructor(t,a,c){this.property=t,this.value=a,this.parameters=c}isConstant(){return this.value.kind==="constant"}constantOr(t){return this.value.kind==="constant"?this.value.value:t}evaluate(t,a,c,f){return this.property.evaluate(this.value,this.parameters,t,a,c,f)}}class pe{constructor(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)}get(t){return this._values[t]}}class Q{constructor(t){this.specification=t}possiblyEvaluate(t,a){return t.expression.evaluate(a)}interpolate(t,a,c){let f=yl[this.specification.type];return f?f(t,a,c):t}}class ue{constructor(t,a){this.specification=t,this.overrides=a}possiblyEvaluate(t,a,c,f){return new he(this,t.expression.kind==="constant"||t.expression.kind==="camera"?{kind:"constant",value:t.expression.evaluate(a,null,{},c,f)}:t.expression,a)}interpolate(t,a,c){if(t.value.kind!=="constant"||a.value.kind!=="constant")return t;if(t.value.value===void 0||a.value.value===void 0)return new he(this,{kind:"constant",value:void 0},t.parameters);let f=yl[this.specification.type];return f?new he(this,{kind:"constant",value:f(t.value.value,a.value.value,c)},t.parameters):t}evaluate(t,a,c,f,g,v){return t.kind==="constant"?t.value:t.evaluate(a,c,f,g,v)}}class ye{constructor(t){this.specification=t}possiblyEvaluate(t,a,c,f){return!!t.expression.evaluate(a,null,{},c,f)}interpolate(){return!1}}class _e{constructor(t){this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];let a=new z(0,{});for(let c in t){let f=t[c];f.specification.overridable&&this.overridableProperties.push(c);let g=this.defaultPropertyValues[c]=new G(f,void 0),v=this.defaultTransitionablePropertyValues[c]=new H(f);this.defaultTransitioningPropertyValues[c]=v.untransitioned(),this.defaultPossiblyEvaluatedValues[c]=g.possiblyEvaluate(a)}}}function Ae(o,t){return 256*(o=Tn(Math.floor(o),0,255))+Tn(Math.floor(t),0,255)}Ot(ue,"DataDrivenProperty"),Ot(Q,"DataConstantProperty"),Ot(ye,"ColorRampProperty");let Re={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Me{constructor(t,a){this._structArray=t,this._pos1=a*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Be{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(t,a){return t._trim(),a&&(t.isTransferred=!0,a.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}}static deserialize(t){let a=Object.create(this.prototype);return a.arrayBuffer=t.arrayBuffer,a.length=t.length,a.capacity=t.arrayBuffer.byteLength/a.bytesPerElement,a._refreshViews(),a}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(t){this.reserve(t),this.length=t}reserve(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);let a=this.uint8;this._refreshViews(),a&&this.uint8.set(a)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function Fe(o,t=1){let a=0,c=0;return{members:o.map(f=>{let g=Re[f.type].BYTES_PER_ELEMENT,v=a=je(a,Math.max(t,g)),C=f.components||1;return c=Math.max(c,g),a+=g*C,{name:f.name,type:f.type,components:C,offset:v}}),size:je(a,Math.max(c,t)),alignment:t}}function je(o,t){return Math.ceil(o/t)*t}class mt extends Be{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,a){let c=this.length;return this.resize(c+1),this.emplace(c,t,a)}emplace(t,a,c){let f=2*t;return this.int16[f+0]=a,this.int16[f+1]=c,t}}mt.prototype.bytesPerElement=4,Ot(mt,"StructArrayLayout2i4");class He extends Be{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,a,c){let f=this.length;return this.resize(f+1),this.emplace(f,t,a,c)}emplace(t,a,c,f){let g=3*t;return this.int16[g+0]=a,this.int16[g+1]=c,this.int16[g+2]=f,t}}He.prototype.bytesPerElement=6,Ot(He,"StructArrayLayout3i6");class it extends Be{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,a,c,f){let g=this.length;return this.resize(g+1),this.emplace(g,t,a,c,f)}emplace(t,a,c,f,g){let v=4*t;return this.int16[v+0]=a,this.int16[v+1]=c,this.int16[v+2]=f,this.int16[v+3]=g,t}}it.prototype.bytesPerElement=8,Ot(it,"StructArrayLayout4i8");class Ze extends Be{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,a,c,f,g,v,C){let I=this.length;return this.resize(I+1),this.emplace(I,t,a,c,f,g,v,C)}emplace(t,a,c,f,g,v,C,I){let A=6*t,F=12*t,V=3*t;return this.int16[A+0]=a,this.int16[A+1]=c,this.uint8[F+4]=f,this.uint8[F+5]=g,this.uint8[F+6]=v,this.uint8[F+7]=C,this.float32[V+2]=I,t}}Ze.prototype.bytesPerElement=12,Ot(Ze,"StructArrayLayout2i4ub1f12");class ht extends Be{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,a,c,f){let g=this.length;return this.resize(g+1),this.emplace(g,t,a,c,f)}emplace(t,a,c,f,g){let v=4*t;return this.float32[v+0]=a,this.float32[v+1]=c,this.float32[v+2]=f,this.float32[v+3]=g,t}}ht.prototype.bytesPerElement=16,Ot(ht,"StructArrayLayout4f16");class Ge extends Be{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,a,c,f,g){let v=this.length;return this.resize(v+1),this.emplace(v,t,a,c,f,g)}emplace(t,a,c,f,g,v){let C=6*t,I=3*t;return this.uint16[C+0]=a,this.uint16[C+1]=c,this.uint16[C+2]=f,this.uint16[C+3]=g,this.float32[I+2]=v,t}}Ge.prototype.bytesPerElement=12,Ot(Ge,"StructArrayLayout4ui1f12");class tt extends Be{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,a,c,f){let g=this.length;return this.resize(g+1),this.emplace(g,t,a,c,f)}emplace(t,a,c,f,g){let v=4*t;return this.uint16[v+0]=a,this.uint16[v+1]=c,this.uint16[v+2]=f,this.uint16[v+3]=g,t}}tt.prototype.bytesPerElement=8,Ot(tt,"StructArrayLayout4ui8");class gt extends Be{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,a,c,f,g,v){let C=this.length;return this.resize(C+1),this.emplace(C,t,a,c,f,g,v)}emplace(t,a,c,f,g,v,C){let I=6*t;return this.int16[I+0]=a,this.int16[I+1]=c,this.int16[I+2]=f,this.int16[I+3]=g,this.int16[I+4]=v,this.int16[I+5]=C,t}}gt.prototype.bytesPerElement=12,Ot(gt,"StructArrayLayout6i12");class at extends Be{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,a,c,f,g,v,C,I,A,F,V,$){let W=this.length;return this.resize(W+1),this.emplace(W,t,a,c,f,g,v,C,I,A,F,V,$)}emplace(t,a,c,f,g,v,C,I,A,F,V,$,W){let q=12*t;return this.int16[q+0]=a,this.int16[q+1]=c,this.int16[q+2]=f,this.int16[q+3]=g,this.uint16[q+4]=v,this.uint16[q+5]=C,this.uint16[q+6]=I,this.uint16[q+7]=A,this.int16[q+8]=F,this.int16[q+9]=V,this.int16[q+10]=$,this.int16[q+11]=W,t}}at.prototype.bytesPerElement=24,Ot(at,"StructArrayLayout4i4ui4i24");class _t extends Be{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,a,c,f,g,v){let C=this.length;return this.resize(C+1),this.emplace(C,t,a,c,f,g,v)}emplace(t,a,c,f,g,v,C){let I=10*t,A=5*t;return this.int16[I+0]=a,this.int16[I+1]=c,this.int16[I+2]=f,this.float32[A+2]=g,this.float32[A+3]=v,this.float32[A+4]=C,t}}_t.prototype.bytesPerElement=20,Ot(_t,"StructArrayLayout3i3f20");class $t extends Be{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t){let a=this.length;return this.resize(a+1),this.emplace(a,t)}emplace(t,a){return this.uint32[1*t+0]=a,t}}$t.prototype.bytesPerElement=4,Ot($t,"StructArrayLayout1ul4");class sn extends Be{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,a,c,f,g,v,C,I,A,F,V,$,W){let q=this.length;return this.resize(q+1),this.emplace(q,t,a,c,f,g,v,C,I,A,F,V,$,W)}emplace(t,a,c,f,g,v,C,I,A,F,V,$,W,q){let ee=20*t,ae=10*t;return this.int16[ee+0]=a,this.int16[ee+1]=c,this.int16[ee+2]=f,this.int16[ee+3]=g,this.int16[ee+4]=v,this.float32[ae+3]=C,this.float32[ae+4]=I,this.float32[ae+5]=A,this.float32[ae+6]=F,this.int16[ee+14]=V,this.uint32[ae+8]=$,this.uint16[ee+18]=W,this.uint16[ee+19]=q,t}}sn.prototype.bytesPerElement=40,Ot(sn,"StructArrayLayout5i4f1i1ul2ui40");class Ft extends Be{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,a,c,f,g,v,C){let I=this.length;return this.resize(I+1),this.emplace(I,t,a,c,f,g,v,C)}emplace(t,a,c,f,g,v,C,I){let A=8*t;return this.int16[A+0]=a,this.int16[A+1]=c,this.int16[A+2]=f,this.int16[A+4]=g,this.int16[A+5]=v,this.int16[A+6]=C,this.int16[A+7]=I,t}}Ft.prototype.bytesPerElement=16,Ot(Ft,"StructArrayLayout3i2i2i16");class Xt extends Be{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,a,c,f,g){let v=this.length;return this.resize(v+1),this.emplace(v,t,a,c,f,g)}emplace(t,a,c,f,g,v){let C=4*t,I=8*t;return this.float32[C+0]=a,this.float32[C+1]=c,this.float32[C+2]=f,this.int16[I+6]=g,this.int16[I+7]=v,t}}Xt.prototype.bytesPerElement=16,Ot(Xt,"StructArrayLayout2f1f2i16");class Gt extends Be{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,a,c,f){let g=this.length;return this.resize(g+1),this.emplace(g,t,a,c,f)}emplace(t,a,c,f,g){let v=12*t,C=3*t;return this.uint8[v+0]=a,this.uint8[v+1]=c,this.float32[C+1]=f,this.float32[C+2]=g,t}}Gt.prototype.bytesPerElement=12,Ot(Gt,"StructArrayLayout2ub2f12");class Mn extends Be{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,a,c){let f=this.length;return this.resize(f+1),this.emplace(f,t,a,c)}emplace(t,a,c,f){let g=3*t;return this.float32[g+0]=a,this.float32[g+1]=c,this.float32[g+2]=f,t}}Mn.prototype.bytesPerElement=12,Ot(Mn,"StructArrayLayout3f12");class Vt extends Be{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,a,c){let f=this.length;return this.resize(f+1),this.emplace(f,t,a,c)}emplace(t,a,c,f){let g=3*t;return this.uint16[g+0]=a,this.uint16[g+1]=c,this.uint16[g+2]=f,t}}Vt.prototype.bytesPerElement=6,Ot(Vt,"StructArrayLayout3ui6");class Qn extends Be{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t,a,c,f,g,v,C,I,A,F,V,$,W,q,ee,ae,me,Ce,ge,xe,Te){let De=this.length;return this.resize(De+1),this.emplace(De,t,a,c,f,g,v,C,I,A,F,V,$,W,q,ee,ae,me,Ce,ge,xe,Te)}emplace(t,a,c,f,g,v,C,I,A,F,V,$,W,q,ee,ae,me,Ce,ge,xe,Te,De){let qe=30*t,We=15*t,et=60*t;return this.int16[qe+0]=a,this.int16[qe+1]=c,this.int16[qe+2]=f,this.float32[We+2]=g,this.float32[We+3]=v,this.uint16[qe+8]=C,this.uint16[qe+9]=I,this.uint32[We+5]=A,this.uint32[We+6]=F,this.uint32[We+7]=V,this.uint16[qe+16]=$,this.uint16[qe+17]=W,this.uint16[qe+18]=q,this.float32[We+10]=ee,this.float32[We+11]=ae,this.uint8[et+48]=me,this.uint8[et+49]=Ce,this.uint8[et+50]=ge,this.uint32[We+13]=xe,this.int16[qe+28]=Te,this.uint8[et+58]=De,t}}Qn.prototype.bytesPerElement=60,Ot(Qn,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class ui extends Be{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t,a,c,f,g,v,C,I,A,F,V,$,W,q,ee,ae,me,Ce,ge,xe,Te,De,qe,We,et,vt,Ke,ot,st,ft){let wt=this.length;return this.resize(wt+1),this.emplace(wt,t,a,c,f,g,v,C,I,A,F,V,$,W,q,ee,ae,me,Ce,ge,xe,Te,De,qe,We,et,vt,Ke,ot,st,ft)}emplace(t,a,c,f,g,v,C,I,A,F,V,$,W,q,ee,ae,me,Ce,ge,xe,Te,De,qe,We,et,vt,Ke,ot,st,ft,wt){let Qe=38*t,kt=19*t;return this.int16[Qe+0]=a,this.int16[Qe+1]=c,this.int16[Qe+2]=f,this.float32[kt+2]=g,this.float32[kt+3]=v,this.int16[Qe+8]=C,this.int16[Qe+9]=I,this.int16[Qe+10]=A,this.int16[Qe+11]=F,this.int16[Qe+12]=V,this.int16[Qe+13]=$,this.uint16[Qe+14]=W,this.uint16[Qe+15]=q,this.uint16[Qe+16]=ee,this.uint16[Qe+17]=ae,this.uint16[Qe+18]=me,this.uint16[Qe+19]=Ce,this.uint16[Qe+20]=ge,this.uint16[Qe+21]=xe,this.uint16[Qe+22]=Te,this.uint16[Qe+23]=De,this.uint16[Qe+24]=qe,this.uint16[Qe+25]=We,this.uint16[Qe+26]=et,this.uint16[Qe+27]=vt,this.uint16[Qe+28]=Ke,this.uint32[kt+15]=ot,this.float32[kt+16]=st,this.float32[kt+17]=ft,this.float32[kt+18]=wt,t}}ui.prototype.bytesPerElement=76,Ot(ui,"StructArrayLayout3i2f6i15ui1ul3f76");class di extends Be{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t){let a=this.length;return this.resize(a+1),this.emplace(a,t)}emplace(t,a){return this.float32[1*t+0]=a,t}}di.prototype.bytesPerElement=4,Ot(di,"StructArrayLayout1f4");class hi extends Be{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,a,c,f,g){let v=this.length;return this.resize(v+1),this.emplace(v,t,a,c,f,g)}emplace(t,a,c,f,g,v){let C=5*t;return this.float32[C+0]=a,this.float32[C+1]=c,this.float32[C+2]=f,this.float32[C+3]=g,this.float32[C+4]=v,t}}hi.prototype.bytesPerElement=20,Ot(hi,"StructArrayLayout5f20");class dr extends Be{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,a,c,f){let g=this.length;return this.resize(g+1),this.emplace(g,t,a,c,f)}emplace(t,a,c,f,g){let v=6*t;return this.uint32[3*t+0]=a,this.uint16[v+2]=c,this.uint16[v+3]=f,this.uint16[v+4]=g,t}}dr.prototype.bytesPerElement=12,Ot(dr,"StructArrayLayout1ul3ui12");class vr extends Be{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,a){let c=this.length;return this.resize(c+1),this.emplace(c,t,a)}emplace(t,a,c){let f=2*t;return this.uint16[f+0]=a,this.uint16[f+1]=c,t}}vr.prototype.bytesPerElement=4,Ot(vr,"StructArrayLayout2ui4");class To extends Be{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t){let a=this.length;return this.resize(a+1),this.emplace(a,t)}emplace(t,a){return this.uint16[1*t+0]=a,t}}To.prototype.bytesPerElement=2,Ot(To,"StructArrayLayout1ui2");class is extends Be{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,a){let c=this.length;return this.resize(c+1),this.emplace(c,t,a)}emplace(t,a,c){let f=2*t;return this.float32[f+0]=a,this.float32[f+1]=c,t}}is.prototype.bytesPerElement=8,Ot(is,"StructArrayLayout2f8");class Si extends Me{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}Si.prototype.size=40;class fi extends sn{get(t){return new Si(this,t)}}Ot(fi,"CollisionBoxArray");class rn extends Me{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(t){this._structArray.uint8[this._pos1+49]=t}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(t){this._structArray.uint8[this._pos1+50]=t}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(t){this._structArray.uint32[this._pos4+13]=t}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(t){this._structArray.uint8[this._pos1+58]=t}}rn.prototype.size=60;class hr extends Qn{get(t){return new rn(this,t)}}Ot(hr,"PlacedSymbolArray");class ro extends Me{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+11]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+13]}get key(){return this._structArray.uint16[this._pos2+14]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+17]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+19]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+21]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+22]}get featureIndex(){return this._structArray.uint16[this._pos2+23]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+25]}get numIconVertices(){return this._structArray.uint16[this._pos2+26]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+27]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+28]}get crossTileID(){return this._structArray.uint32[this._pos4+15]}set crossTileID(t){this._structArray.uint32[this._pos4+15]=t}get textOffset0(){return this._structArray.float32[this._pos4+16]}get textOffset1(){return this._structArray.float32[this._pos4+17]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+18]}}ro.prototype.size=76;class xi extends ui{get(t){return new ro(this,t)}}Ot(xi,"SymbolInstanceArray");class Nr extends di{getoffsetX(t){return this.float32[1*t+0]}}Ot(Nr,"GlyphOffsetArray");class la extends mt{getx(t){return this.int16[2*t+0]}gety(t){return this.int16[2*t+1]}}Ot(la,"SymbolLineVertexArray");class Rl extends Me{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}Rl.prototype.size=12;class mi extends dr{get(t){return new Rl(this,t)}}Ot(mi,"FeatureIndexArray");class ca extends vr{geta_centroid_pos0(t){return this.uint16[2*t+0]}geta_centroid_pos1(t){return this.uint16[2*t+1]}}Ot(ca,"FillExtrusionCentroidArray");let ua=Fe([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),Ba=Fe([{name:"a_dash",components:4,type:"Uint16"}]);var Ru={exports:{}},rr={exports:{}};rr.exports=function(o,t){var a,c,f,g,v,C,I,A;for(c=o.length-(a=3&o.length),f=t,v=3432918353,C=461845907,A=0;A<c;)I=255&o.charCodeAt(A)|(255&o.charCodeAt(++A))<<8|(255&o.charCodeAt(++A))<<16|(255&o.charCodeAt(++A))<<24,++A,f=27492+(65535&(g=5*(65535&(f=(f^=I=(65535&(I=(I=(65535&I)*v+(((I>>>16)*v&65535)<<16)&4294967295)<<15|I>>>17))*C+(((I>>>16)*C&65535)<<16)&4294967295)<<13|f>>>19))+((5*(f>>>16)&65535)<<16)&4294967295))+((58964+(g>>>16)&65535)<<16);switch(I=0,a){case 3:I^=(255&o.charCodeAt(A+2))<<16;case 2:I^=(255&o.charCodeAt(A+1))<<8;case 1:f^=I=(65535&(I=(I=(65535&(I^=255&o.charCodeAt(A)))*v+(((I>>>16)*v&65535)<<16)&4294967295)<<15|I>>>17))*C+(((I>>>16)*C&65535)<<16)&4294967295}return f^=o.length,f=2246822507*(65535&(f^=f>>>16))+((2246822507*(f>>>16)&65535)<<16)&4294967295,f=3266489909*(65535&(f^=f>>>13))+((3266489909*(f>>>16)&65535)<<16)&4294967295,(f^=f>>>16)>>>0};var pf=rr.exports,Pu={exports:{}};Pu.exports=function(o,t){for(var a,c=o.length,f=t^c,g=0;c>=4;)a=1540483477*(65535&(a=255&o.charCodeAt(g)|(255&o.charCodeAt(++g))<<8|(255&o.charCodeAt(++g))<<16|(255&o.charCodeAt(++g))<<24))+((1540483477*(a>>>16)&65535)<<16),f=1540483477*(65535&f)+((1540483477*(f>>>16)&65535)<<16)^(a=1540483477*(65535&(a^=a>>>24))+((1540483477*(a>>>16)&65535)<<16)),c-=4,++g;switch(c){case 3:f^=(255&o.charCodeAt(g+2))<<16;case 2:f^=(255&o.charCodeAt(g+1))<<8;case 1:f=1540483477*(65535&(f^=255&o.charCodeAt(g)))+((1540483477*(f>>>16)&65535)<<16)}return f=1540483477*(65535&(f^=f>>>13))+((1540483477*(f>>>16)&65535)<<16),(f^=f>>>15)>>>0};var Zp=pf,Zi=Pu.exports;Ru.exports=Zp,Ru.exports.murmur3=Zp,Ru.exports.murmur2=Zi;var cy=Qt(Ru.exports);class mf{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(t,a,c,f){this.ids.push(Ou(t)),this.positions.push(a,c,f)}getPositions(t){let a=Ou(t),c=0,f=this.ids.length-1;for(;c<f;){let v=c+f>>1;this.ids[v]>=a?f=v:c=v+1}let g=[];for(;this.ids[c]===a;)g.push({index:this.positions[3*c],start:this.positions[3*c+1],end:this.positions[3*c+2]}),c++;return g}static serialize(t,a){let c=new Float64Array(t.ids),f=new Uint32Array(t.positions);return Io(c,f,0,c.length-1),a&&a.push(c.buffer,f.buffer),{ids:c,positions:f}}static deserialize(t){let a=new mf;return a.ids=t.ids,a.positions=t.positions,a.indexed=!0,a}}function Ou(o){let t=+o;return!isNaN(t)&&Number.MIN_SAFE_INTEGER<=t&&t<=Number.MAX_SAFE_INTEGER?t:cy(String(o))}function Io(o,t,a,c){for(;a<c;){let f=o[a+c>>1],g=a-1,v=c+1;for(;;){do g++;while(o[g]<f);do v--;while(o[v]>f);if(g>=v)break;Xp(o,g,v),Xp(t,3*g,3*v),Xp(t,3*g+1,3*v+1),Xp(t,3*g+2,3*v+2)}v-a<c-v?(Io(o,t,a,v),a=v+1):(Io(o,t,v+1,c),c=v)}}function Xp(o,t,a){let c=o[t];o[t]=o[a],o[a]=c}Ot(mf,"FeaturePositionMap");class Pl{constructor(t){this.gl=t.gl,this.initialized=!1}fetchUniformLocation(t,a){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(t,a),this.initialized=!0),!!this.location}}class gf extends Pl{constructor(t){super(t),this.current=0}set(t,a,c){this.fetchUniformLocation(t,a)&&this.current!==c&&(this.current=c,this.gl.uniform1f(this.location,c))}}class Iv extends Pl{constructor(t){super(t),this.current=[0,0,0,0]}set(t,a,c){this.fetchUniformLocation(t,a)&&(c[0]===this.current[0]&&c[1]===this.current[1]&&c[2]===this.current[2]&&c[3]===this.current[3]||(this.current=c,this.gl.uniform4f(this.location,c[0],c[1],c[2],c[3])))}}class uy extends Pl{constructor(t){super(t),this.current=ir.transparent}set(t,a,c){this.fetchUniformLocation(t,a)&&(c.r===this.current.r&&c.g===this.current.g&&c.b===this.current.b&&c.a===this.current.a||(this.current=c,this.gl.uniform4f(this.location,c.r,c.g,c.b,c.a)))}}let kw=new Float32Array(16),Rw=new Float32Array(9),Yp=new Float32Array(4);function dy(o){return[Ae(255*o.r,255*o.g),Ae(255*o.b,255*o.a)]}class yf{constructor(t,a,c){this.value=t,this.uniformNames=a.map(f=>`u_${f}`),this.type=c}setUniform(t,a,c,f,g){a.set(t,g,f.constantOr(this.value))}getBinding(t,a){return this.type==="color"?new uy(t):new gf(t)}}class Mc{constructor(t,a){this.uniformNames=a.map(c=>`u_${c}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(t){this.pixelRatio=t.pixelRatio||1,this.pattern=t.tl.concat(t.br)}setUniform(t,a,c,f,g){let v=g==="u_pattern"||g==="u_dash"?this.pattern:g==="u_pixel_ratio"?this.pixelRatio:null;v&&a.set(t,g,v)}getBinding(t,a){return a==="u_pattern"||a==="u_dash"?new Iv(t):new gf(t)}}class Ol{constructor(t,a,c,f){this.expression=t,this.type=c,this.maxValue=0,this.paintVertexAttributes=a.map(g=>({name:`a_${g}`,type:"Float32",components:c==="color"?2:1,offset:0})),this.paintVertexArray=new f}populatePaintArray(t,a,c,f,g,v){let C=this.paintVertexArray.length,I=this.expression.evaluate(new z(0),a,{},g,f,v);this.paintVertexArray.resize(t),this._setPaintValue(C,t,I)}updatePaintArray(t,a,c,f,g){let v=this.expression.evaluate({zoom:0},c,f,void 0,g);this._setPaintValue(t,a,v)}_setPaintValue(t,a,c){if(this.type==="color"){let f=dy(c);for(let g=t;g<a;g++)this.paintVertexArray.emplace(g,f[0],f[1])}else{for(let f=t;f<a;f++)this.paintVertexArray.emplace(f,c);this.maxValue=Math.max(this.maxValue,Math.abs(c))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class da{constructor(t,a,c,f,g,v){this.expression=t,this.uniformNames=a.map(C=>`u_${C}_t`),this.type=c,this.useIntegerZoom=f,this.zoom=g,this.maxValue=0,this.paintVertexAttributes=a.map(C=>({name:`a_${C}`,type:"Float32",components:c==="color"?4:2,offset:0})),this.paintVertexArray=new v}populatePaintArray(t,a,c,f,g,v){let C=this.expression.evaluate(new z(this.zoom),a,{},g,f,v),I=this.expression.evaluate(new z(this.zoom+1),a,{},g,f,v),A=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(A,t,C,I)}updatePaintArray(t,a,c,f,g){let v=this.expression.evaluate({zoom:this.zoom},c,f,void 0,g),C=this.expression.evaluate({zoom:this.zoom+1},c,f,void 0,g);this._setPaintValue(t,a,v,C)}_setPaintValue(t,a,c,f){if(this.type==="color"){let g=dy(c),v=dy(f);for(let C=t;C<a;C++)this.paintVertexArray.emplace(C,g[0],g[1],v[0],v[1])}else{for(let g=t;g<a;g++)this.paintVertexArray.emplace(g,c,f);this.maxValue=Math.max(this.maxValue,Math.abs(c),Math.abs(f))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(t,a,c,f,g){let v=this.useIntegerZoom?Math.floor(c.zoom):c.zoom,C=Tn(this.expression.interpolationFactor(v,this.zoom,this.zoom+1),0,1);a.set(t,g,C)}getBinding(t,a){return new gf(t)}}class fo{constructor(t,a,c,f,g){this.expression=t,this.layerId=g,this.paintVertexAttributes=(c==="array"?Ba:ua).members;for(let v=0;v<a.length;++v);this.paintVertexArray=new f}populatePaintArray(t,a,c){let f=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValues(f,t,a.patterns&&a.patterns[this.layerId],c)}updatePaintArray(t,a,c,f,g,v){this._setPaintValues(t,a,c.patterns&&c.patterns[this.layerId],v)}_setPaintValues(t,a,c,f){if(!f||!c)return;let g=f[c];if(!g)return;let{tl:v,br:C,pixelRatio:I}=g;for(let A=t;A<a;A++)this.paintVertexArray.emplace(A,v[0],v[1],C[0],C[1],I)}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Ll{constructor(t,a,c=()=>!0){this.binders={},this._buffers=[];let f=[];for(let g in t.paint._values){if(!c(g))continue;let v=t.paint.get(g);if(!(v instanceof he&&_c(v.property.specification)))continue;let C=Pw(g,t.type),I=v.value,A=v.property.specification.type,F=!!v.property.useIntegerZoom,V=g==="line-dasharray"||g.endsWith("pattern"),$=g==="line-dasharray"&&t.layout.get("line-cap").value.kind!=="constant";if(I.kind!=="constant"||$)if(I.kind==="source"||$||V){let W=Sv(g,A,"source");this.binders[g]=V?new fo(I,C,A,W,t.id):new Ol(I,C,A,W),f.push(`/a_${g}`)}else{let W=Sv(g,A,"composite");this.binders[g]=new da(I,C,A,F,a,W),f.push(`/z_${g}`)}else this.binders[g]=V?new Mc(I.value,C):new yf(I.value,C,A),f.push(`/u_${g}`)}this.cacheKey=f.sort().join("")}getMaxValue(t){let a=this.binders[t];return a instanceof Ol||a instanceof da?a.maxValue:0}populatePaintArrays(t,a,c,f,g,v){for(let C in this.binders){let I=this.binders[C];(I instanceof Ol||I instanceof da||I instanceof fo)&&I.populatePaintArray(t,a,c,f,g,v)}}setConstantPatternPositions(t){for(let a in this.binders){let c=this.binders[a];c instanceof Mc&&c.setConstantPatternPositions(t)}}updatePaintArrays(t,a,c,f,g,v){let C=!1;for(let I in t){let A=a.getPositions(I);for(let F of A){let V=c.feature(F.index);for(let $ in this.binders){let W=this.binders[$];if((W instanceof Ol||W instanceof da||W instanceof fo)&&W.expression.isStateDependent===!0){let q=f.paint.get($);W.expression=q.value,W.updatePaintArray(F.start,F.end,V,t[I],g,v),C=!0}}}}return C}defines(){let t=[];for(let a in this.binders){let c=this.binders[a];(c instanceof yf||c instanceof Mc)&&t.push(...c.uniformNames.map(f=>`#define HAS_UNIFORM_${f}`))}return t}getBinderAttributes(){let t=[];for(let a in this.binders){let c=this.binders[a];if(c instanceof Ol||c instanceof da||c instanceof fo)for(let f=0;f<c.paintVertexAttributes.length;f++)t.push(c.paintVertexAttributes[f].name)}return t}getBinderUniforms(){let t=[];for(let a in this.binders){let c=this.binders[a];if(c instanceof yf||c instanceof Mc||c instanceof da)for(let f of c.uniformNames)t.push(f)}return t}getPaintVertexBuffers(){return this._buffers}getUniforms(t){let a=[];for(let c in this.binders){let f=this.binders[c];if(f instanceof yf||f instanceof Mc||f instanceof da)for(let g of f.uniformNames)a.push({name:g,property:c,binding:f.getBinding(t,g)})}return a}setUniforms(t,a,c,f,g){for(let{name:v,property:C,binding:I}of c)this.binders[C].setUniform(t,I,g,f.get(C),v)}updatePaintBuffers(){this._buffers=[];for(let t in this.binders){let a=this.binders[t];(a instanceof Ol||a instanceof da||a instanceof fo)&&a.paintVertexBuffer&&this._buffers.push(a.paintVertexBuffer)}}upload(t){for(let a in this.binders){let c=this.binders[a];(c instanceof Ol||c instanceof da||c instanceof fo)&&c.upload(t)}this.updatePaintBuffers()}destroy(){for(let t in this.binders){let a=this.binders[t];(a instanceof Ol||a instanceof da||a instanceof fo)&&a.destroy()}}}class rs{constructor(t,a,c=()=>!0){this.programConfigurations={};for(let f of t)this.programConfigurations[f.id]=new Ll(f,a,c);this.needsUpload=!1,this._featureMap=new mf,this._bufferOffset=0}populatePaintArrays(t,a,c,f,g,v,C){for(let I in this.programConfigurations)this.programConfigurations[I].populatePaintArrays(t,a,f,g,v,C);a.id!==void 0&&this._featureMap.add(a.id,c,this._bufferOffset,t),this._bufferOffset=t,this.needsUpload=!0}updatePaintArrays(t,a,c,f,g){for(let v of c)this.needsUpload=this.programConfigurations[v.id].updatePaintArrays(t,this._featureMap,a,v,f,g)||this.needsUpload}get(t){return this.programConfigurations[t]}upload(t){if(this.needsUpload){for(let a in this.programConfigurations)this.programConfigurations[a].upload(t);this.needsUpload=!1}}destroy(){for(let t in this.programConfigurations)this.programConfigurations[t].destroy()}}let Ds={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function Pw(o,t){return Ds[o]||[o.replace(`${t}-`,"").replace(/-/g,"_")]}let Ow={"line-pattern":{source:Ge,composite:Ge},"fill-pattern":{source:Ge,composite:Ge},"fill-extrusion-pattern":{source:Ge,composite:Ge},"line-dasharray":{source:tt,composite:tt}},Lw={color:{source:is,composite:ht},number:{source:di,composite:is}};function Sv(o,t,a){let c=Ow[o];return c&&c[a]||Lw[t][a]}Ot(yf,"ConstantBinder"),Ot(Mc,"PatternConstantBinder"),Ot(Ol,"SourceExpressionBinder"),Ot(fo,"PatternCompositeBinder"),Ot(da,"CompositeExpressionBinder"),Ot(Ll,"ProgramConfiguration",{omit:["_buffers"]}),Ot(rs,"ProgramConfigurationSet");let Kp="-transition";class Ms extends sc{constructor(t,a){if(super(),this.id=t.id,this.type=t.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,t.type!=="custom"&&(this.metadata=t.metadata,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,t.type!=="background"&&t.type!=="sky"&&(this.source=t.source,this.sourceLayer=t["source-layer"],this.filter=t.filter),a.layout&&(this._unevaluatedLayout=new fe(a.layout)),a.paint)){this._transitionablePaint=new K(a.paint);for(let c in t.paint)this.setPaintProperty(c,t.paint[c],{validate:!1});for(let c in t.layout)this.setLayoutProperty(c,t.layout[c],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new pe(a.paint)}}getLayoutProperty(t){return t==="visibility"?this.visibility:this._unevaluatedLayout.getValue(t)}setLayoutProperty(t,a,c={}){a!=null&&this._validate(Up,`layers.${this.id}.layout.${t}`,t,a,c)||(t!=="visibility"?this._unevaluatedLayout.setValue(t,a):this.visibility=a)}getPaintProperty(t){return nl(t,Kp)?this._transitionablePaint.getTransition(t.slice(0,-11)):this._transitionablePaint.getValue(t)}setPaintProperty(t,a,c={}){if(a!=null&&this._validate(Cc,`layers.${this.id}.paint.${t}`,t,a,c))return!1;if(nl(t,Kp))return this._transitionablePaint.setTransition(t.slice(0,-11),a||void 0),!1;{let f=this._transitionablePaint._values[t],g=f.value.isDataDriven(),v=f.value;this._transitionablePaint.setValue(t,a),this._handleSpecialPaintPropertyUpdate(t);let C=this._transitionablePaint._values[t].value,I=C.isDataDriven(),A=nl(t,"pattern")||t==="line-dasharray";return I||g||A||this._handleOverridablePaintPropertyUpdate(t,v,C)}}_handleSpecialPaintPropertyUpdate(t){}getProgramIds(){return null}getProgramConfiguration(t){return null}_handleOverridablePaintPropertyUpdate(t,a,c){return!1}isHidden(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||this.visibility==="none"}updateTransitions(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(t,a){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t,void 0,a)),this.paint=this._transitioningPaint.possiblyEvaluate(t,void 0,a)}serialize(){let t={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(t.layout=t.layout||{},t.layout.visibility=this.visibility),Zt(t,(a,c)=>!(a===void 0||c==="layout"&&!Object.keys(a).length||c==="paint"&&!Object.keys(a).length))}_validate(t,a,c,f,g={}){return(!g||g.validate!==!1)&&$p(this,t.call(Vp,{key:a,layerType:this.type,objectKey:c,value:f,styleSpec:Je,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(let t in this.paint._values){let a=this.paint.get(t);if(a instanceof he&&_c(a.property.specification)&&(a.value.kind==="source"||a.value.kind==="composite")&&a.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=Sl(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}}let hy=Fe([{name:"a_pos",components:2,type:"Int16"}],4),Fw=Fe([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class Xi{constructor(t=[]){this.segments=t}prepareSegment(t,a,c,f){let g=this.segments[this.segments.length-1];return t>Xi.MAX_VERTEX_ARRAY_LENGTH&&vi(`Max vertices per segment is ${Xi.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${t}`),(!g||g.vertexLength+t>Xi.MAX_VERTEX_ARRAY_LENGTH||g.sortKey!==f)&&(g={vertexOffset:a.length,primitiveOffset:c.length,vertexLength:0,primitiveLength:0},f!==void 0&&(g.sortKey=f),this.segments.push(g)),g}get(){return this.segments}destroy(){for(let t of this.segments)for(let a in t.vaos)t.vaos[a].destroy()}static simpleSegment(t,a,c,f){return new Xi([{vertexOffset:t,primitiveOffset:a,vertexLength:c,primitiveLength:f,vaos:{},sortKey:0}])}}Xi.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Ot(Xi,"SegmentVector");var Wt=8192;class Tc{constructor(t,a){t&&(a?this.setSouthWest(t).setNorthEast(a):t.length===4?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1]))}setNorthEast(t){return this._ne=t instanceof ai?new ai(t.lng,t.lat):ai.convert(t),this}setSouthWest(t){return this._sw=t instanceof ai?new ai(t.lng,t.lat):ai.convert(t),this}extend(t){let a=this._sw,c=this._ne,f,g;if(t instanceof ai)f=t,g=t;else{if(!(t instanceof Tc))return Array.isArray(t)?t.length===4||t.every(Array.isArray)?this.extend(Tc.convert(t)):this.extend(ai.convert(t)):typeof t=="object"&&t!==null&&t.hasOwnProperty("lat")&&(t.hasOwnProperty("lon")||t.hasOwnProperty("lng"))?this.extend(ai.convert(t)):this;if(f=t._sw,g=t._ne,!f||!g)return this}return a||c?(a.lng=Math.min(f.lng,a.lng),a.lat=Math.min(f.lat,a.lat),c.lng=Math.max(g.lng,c.lng),c.lat=Math.max(g.lat,c.lat)):(this._sw=new ai(f.lng,f.lat),this._ne=new ai(g.lng,g.lat)),this}getCenter(){return new ai((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new ai(this.getWest(),this.getNorth())}getSouthEast(){return new ai(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(t){let{lng:a,lat:c}=ai.convert(t),f=this._sw.lng<=a&&a<=this._ne.lng;return this._sw.lng>this._ne.lng&&(f=this._sw.lng>=a&&a>=this._ne.lng),this._sw.lat<=c&&c<=this._ne.lat&&f}static convert(t){return!t||t instanceof Tc?t:new Tc(t)}}var _f=1e-6,Rr=typeof Float32Array<"u"?Float32Array:Array;function Zd(){var o=new Rr(9);return Rr!=Float32Array&&(o[1]=0,o[2]=0,o[3]=0,o[5]=0,o[6]=0,o[7]=0),o[0]=1,o[4]=1,o[8]=1,o}function fy(o,t,a){var c=t[0],f=t[1],g=t[2],v=t[3],C=t[4],I=t[5],A=t[6],F=t[7],V=t[8],$=a[0],W=a[1],q=a[2],ee=a[3],ae=a[4],me=a[5],Ce=a[6],ge=a[7],xe=a[8];return o[0]=$*c+W*v+q*A,o[1]=$*f+W*C+q*F,o[2]=$*g+W*I+q*V,o[3]=ee*c+ae*v+me*A,o[4]=ee*f+ae*C+me*F,o[5]=ee*g+ae*I+me*V,o[6]=Ce*c+ge*v+xe*A,o[7]=Ce*f+ge*C+xe*F,o[8]=Ce*g+ge*I+xe*V,o}function ha(o){return o[0]=1,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=1,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=1,o[11]=0,o[12]=0,o[13]=0,o[14]=0,o[15]=1,o}function Qp(o,t){var a=t[0],c=t[1],f=t[2],g=t[3],v=t[4],C=t[5],I=t[6],A=t[7],F=t[8],V=t[9],$=t[10],W=t[11],q=t[12],ee=t[13],ae=t[14],me=t[15],Ce=a*C-c*v,ge=a*I-f*v,xe=a*A-g*v,Te=c*I-f*C,De=c*A-g*C,qe=f*A-g*I,We=F*ee-V*q,et=F*ae-$*q,vt=F*me-W*q,Ke=V*ae-$*ee,ot=V*me-W*ee,st=$*me-W*ae,ft=Ce*st-ge*ot+xe*Ke+Te*vt-De*et+qe*We;return ft?(o[0]=(C*st-I*ot+A*Ke)*(ft=1/ft),o[1]=(f*ot-c*st-g*Ke)*ft,o[2]=(ee*qe-ae*De+me*Te)*ft,o[3]=($*De-V*qe-W*Te)*ft,o[4]=(I*vt-v*st-A*et)*ft,o[5]=(a*st-f*vt+g*et)*ft,o[6]=(ae*xe-q*qe-me*ge)*ft,o[7]=(F*qe-$*xe+W*ge)*ft,o[8]=(v*ot-C*vt+A*We)*ft,o[9]=(c*vt-a*ot-g*We)*ft,o[10]=(q*De-ee*xe+me*Ce)*ft,o[11]=(V*xe-F*De-W*Ce)*ft,o[12]=(C*et-v*Ke-I*We)*ft,o[13]=(a*Ke-c*et+f*We)*ft,o[14]=(ee*ge-q*Te-ae*Ce)*ft,o[15]=(F*Te-V*ge+$*Ce)*ft,o):null}function Fl(o,t,a){var c=t[0],f=t[1],g=t[2],v=t[3],C=t[4],I=t[5],A=t[6],F=t[7],V=t[8],$=t[9],W=t[10],q=t[11],ee=t[12],ae=t[13],me=t[14],Ce=t[15],ge=a[0],xe=a[1],Te=a[2],De=a[3];return o[0]=ge*c+xe*C+Te*V+De*ee,o[1]=ge*f+xe*I+Te*$+De*ae,o[2]=ge*g+xe*A+Te*W+De*me,o[3]=ge*v+xe*F+Te*q+De*Ce,o[4]=(ge=a[4])*c+(xe=a[5])*C+(Te=a[6])*V+(De=a[7])*ee,o[5]=ge*f+xe*I+Te*$+De*ae,o[6]=ge*g+xe*A+Te*W+De*me,o[7]=ge*v+xe*F+Te*q+De*Ce,o[8]=(ge=a[8])*c+(xe=a[9])*C+(Te=a[10])*V+(De=a[11])*ee,o[9]=ge*f+xe*I+Te*$+De*ae,o[10]=ge*g+xe*A+Te*W+De*me,o[11]=ge*v+xe*F+Te*q+De*Ce,o[12]=(ge=a[12])*c+(xe=a[13])*C+(Te=a[14])*V+(De=a[15])*ee,o[13]=ge*f+xe*I+Te*$+De*ae,o[14]=ge*g+xe*A+Te*W+De*me,o[15]=ge*v+xe*F+Te*q+De*Ce,o}function Lu(o,t,a){var c,f,g,v,C,I,A,F,V,$,W,q,ee=a[0],ae=a[1],me=a[2];return t===o?(o[12]=t[0]*ee+t[4]*ae+t[8]*me+t[12],o[13]=t[1]*ee+t[5]*ae+t[9]*me+t[13],o[14]=t[2]*ee+t[6]*ae+t[10]*me+t[14],o[15]=t[3]*ee+t[7]*ae+t[11]*me+t[15]):(f=t[1],g=t[2],v=t[3],C=t[4],I=t[5],A=t[6],F=t[7],V=t[8],$=t[9],W=t[10],q=t[11],o[0]=c=t[0],o[1]=f,o[2]=g,o[3]=v,o[4]=C,o[5]=I,o[6]=A,o[7]=F,o[8]=V,o[9]=$,o[10]=W,o[11]=q,o[12]=c*ee+C*ae+V*me+t[12],o[13]=f*ee+I*ae+$*me+t[13],o[14]=g*ee+A*ae+W*me+t[14],o[15]=v*ee+F*ae+q*me+t[15]),o}function Ic(o,t,a){var c=a[0],f=a[1],g=a[2];return o[0]=t[0]*c,o[1]=t[1]*c,o[2]=t[2]*c,o[3]=t[3]*c,o[4]=t[4]*f,o[5]=t[5]*f,o[6]=t[6]*f,o[7]=t[7]*f,o[8]=t[8]*g,o[9]=t[9]*g,o[10]=t[10]*g,o[11]=t[11]*g,o[12]=t[12],o[13]=t[13],o[14]=t[14],o[15]=t[15],o}function vf(o,t,a){var c=Math.sin(a),f=Math.cos(a),g=t[4],v=t[5],C=t[6],I=t[7],A=t[8],F=t[9],V=t[10],$=t[11];return t!==o&&(o[0]=t[0],o[1]=t[1],o[2]=t[2],o[3]=t[3],o[12]=t[12],o[13]=t[13],o[14]=t[14],o[15]=t[15]),o[4]=g*f+A*c,o[5]=v*f+F*c,o[6]=C*f+V*c,o[7]=I*f+$*c,o[8]=A*f-g*c,o[9]=F*f-v*c,o[10]=V*f-C*c,o[11]=$*f-I*c,o}function zo(o,t,a){var c=Math.sin(a),f=Math.cos(a),g=t[0],v=t[1],C=t[2],I=t[3],A=t[8],F=t[9],V=t[10],$=t[11];return t!==o&&(o[4]=t[4],o[5]=t[5],o[6]=t[6],o[7]=t[7],o[12]=t[12],o[13]=t[13],o[14]=t[14],o[15]=t[15]),o[0]=g*f-A*c,o[1]=v*f-F*c,o[2]=C*f-V*c,o[3]=I*f-$*c,o[8]=g*c+A*f,o[9]=v*c+F*f,o[10]=C*c+V*f,o[11]=I*c+$*f,o}function Nl(o,t){return o[0]=t[0],o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=t[1],o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=t[2],o[11]=0,o[12]=0,o[13]=0,o[14]=0,o[15]=1,o}function py(o,t,a){var c,f,g,v=a[0],C=a[1],I=a[2],A=Math.hypot(v,C,I);return A<_f?null:(v*=A=1/A,C*=A,I*=A,c=Math.sin(t),f=Math.cos(t),o[0]=v*v*(g=1-f)+f,o[1]=C*v*g+I*c,o[2]=I*v*g-C*c,o[3]=0,o[4]=v*C*g-I*c,o[5]=C*C*g+f,o[6]=I*C*g+v*c,o[7]=0,o[8]=v*I*g+C*c,o[9]=C*I*g-v*c,o[10]=I*I*g+f,o[11]=0,o[12]=0,o[13]=0,o[14]=0,o[15]=1,o)}Math.hypot||(Math.hypot=function(){for(var o=0,t=arguments.length;t--;)o+=arguments[t]*arguments[t];return Math.sqrt(o)});var Nw=Fl;function my(){var o=new Rr(3);return Rr!=Float32Array&&(o[0]=0,o[1]=0,o[2]=0),o}function Jp(o){var t=new Rr(3);return t[0]=o[0],t[1]=o[1],t[2]=o[2],t}function Ts(o){return Math.hypot(o[0],o[1],o[2])}function Sc(o,t,a){var c=new Rr(3);return c[0]=o,c[1]=t,c[2]=a,c}function Nn(o,t,a){return o[0]=t[0]+a[0],o[1]=t[1]+a[1],o[2]=t[2]+a[2],o}function gy(o,t,a){return o[0]=t[0]-a[0],o[1]=t[1]-a[1],o[2]=t[2]-a[2],o}function em(o,t,a){return o[0]=t[0]*a[0],o[1]=t[1]*a[1],o[2]=t[2]*a[2],o}function bf(o,t,a){return o[0]=Math.min(t[0],a[0]),o[1]=Math.min(t[1],a[1]),o[2]=Math.min(t[2],a[2]),o}function ja(o,t,a){return o[0]=Math.max(t[0],a[0]),o[1]=Math.max(t[1],a[1]),o[2]=Math.max(t[2],a[2]),o}function os(o,t,a){return o[0]=t[0]*a,o[1]=t[1]*a,o[2]=t[2]*a,o}function Ac(o,t,a,c){return o[0]=t[0]+a[0]*c,o[1]=t[1]+a[1]*c,o[2]=t[2]+a[2]*c,o}function or(o,t){var a=t[0],c=t[1],f=t[2],g=a*a+c*c+f*f;return g>0&&(g=1/Math.sqrt(g)),o[0]=t[0]*g,o[1]=t[1]*g,o[2]=t[2]*g,o}function Bo(o,t){return o[0]*t[0]+o[1]*t[1]+o[2]*t[2]}function zr(o,t,a){var c=t[0],f=t[1],g=t[2],v=a[0],C=a[1],I=a[2];return o[0]=f*I-g*C,o[1]=g*v-c*I,o[2]=c*C-f*v,o}function sr(o,t,a){var c=t[0],f=t[1],g=t[2],v=a[3]*c+a[7]*f+a[11]*g+a[15];return o[0]=(a[0]*c+a[4]*f+a[8]*g+a[12])/(v=v||1),o[1]=(a[1]*c+a[5]*f+a[9]*g+a[13])/v,o[2]=(a[2]*c+a[6]*f+a[10]*g+a[14])/v,o}function yy(o,t,a){var c=a[0],f=a[1],g=a[2],v=t[0],C=t[1],I=t[2],A=f*I-g*C,F=g*v-c*I,V=c*C-f*v,$=f*V-g*F,W=g*A-c*V,q=c*F-f*A,ee=2*a[3];return F*=ee,V*=ee,W*=2,q*=2,o[0]=v+(A*=ee)+($*=2),o[1]=C+F+W,o[2]=I+V+q,o}var Xd,jo=gy,zw=em,Bw=Ts;function zl(o,t,a){return o[0]=t[0]*a,o[1]=t[1]*a,o[2]=t[2]*a,o[3]=t[3]*a,o}function Av(o,t){var a=t[0],c=t[1],f=t[2],g=t[3],v=a*a+c*c+f*f+g*g;return v>0&&(v=1/Math.sqrt(v)),o[0]=a*v,o[1]=c*v,o[2]=f*v,o[3]=g*v,o}function Fu(o,t,a){var c=t[0],f=t[1],g=t[2],v=t[3];return o[0]=a[0]*c+a[4]*f+a[8]*g+a[12]*v,o[1]=a[1]*c+a[5]*f+a[9]*g+a[13]*v,o[2]=a[2]*c+a[6]*f+a[10]*g+a[14]*v,o[3]=a[3]*c+a[7]*f+a[11]*g+a[15]*v,o}function Bl(){var o=new Rr(4);return Rr!=Float32Array&&(o[0]=0,o[1]=0,o[2]=0),o[3]=1,o}function xf(o){return o[0]=0,o[1]=0,o[2]=0,o[3]=1,o}function tm(o,t,a){a*=.5;var c=t[0],f=t[1],g=t[2],v=t[3],C=Math.sin(a),I=Math.cos(a);return o[0]=c*I+v*C,o[1]=f*I+g*C,o[2]=g*I-f*C,o[3]=v*I-c*C,o}function nm(o,t,a){a*=.5;var c=t[0],f=t[1],g=t[2],v=t[3],C=Math.sin(a),I=Math.cos(a);return o[0]=c*I-g*C,o[1]=f*I+v*C,o[2]=g*I+c*C,o[3]=v*I-f*C,o}my(),Xd=new Rr(4),Rr!=Float32Array&&(Xd[0]=0,Xd[1]=0,Xd[2]=0,Xd[3]=0);var jw=Av;my(),Sc(1,0,0),Sc(0,1,0),Bl(),Bl(),Zd();let kv=Fe([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:_y}=kv,Rv=Fe([{name:"a_pos_3",components:3,type:"Int16"}]);var Yd=Fe([{name:"a_pos",type:"Int16",components:2}]);class im{constructor(t,a){this.pos=t,this.dir=a}intersectsPlane(t,a,c){let f=Bo(a,this.dir);if(Math.abs(f)<1e-6)return!1;let g=((t[0]-this.pos[0])*a[0]+(t[1]-this.pos[1])*a[1]+(t[2]-this.pos[2])*a[2])/f;return c[0]=this.pos[0]+this.dir[0]*g,c[1]=this.pos[1]+this.dir[1]*g,c[2]=this.pos[2]+this.dir[2]*g,!0}closestPointOnSphere(t,a,c){if(function(W,q){var ee=W[0],ae=W[1],me=W[2],Ce=q[0],ge=q[1],xe=q[2];return Math.abs(ee-Ce)<=_f*Math.max(1,Math.abs(ee),Math.abs(Ce))&&Math.abs(ae-ge)<=_f*Math.max(1,Math.abs(ae),Math.abs(ge))&&Math.abs(me-xe)<=_f*Math.max(1,Math.abs(me),Math.abs(xe))}(this.pos,t)||a===0)return c[0]=c[1]=c[2]=0,!1;let[f,g,v]=this.dir,C=this.pos[0]-t[0],I=this.pos[1]-t[1],A=this.pos[2]-t[2],F=f*f+g*g+v*v,V=2*(C*f+I*g+A*v),$=V*V-4*F*(C*C+I*I+A*A-a*a);if($<0){let W=Math.max(-V/2,0),q=C+f*W,ee=I+g*W,ae=A+v*W,me=Math.hypot(q,ee,ae);return c[0]=q*a/me,c[1]=ee*a/me,c[2]=ae*a/me,!1}{let W=(-V-Math.sqrt($))/(2*F);if(W<0){let q=Math.hypot(C,I,A);return c[0]=C*a/q,c[1]=I*a/q,c[2]=A*a/q,!1}return c[0]=C+f*W,c[1]=I+g*W,c[2]=A+v*W,!0}}}class vy{constructor(t,a,c,f,g){this.TL=t,this.TR=a,this.BR=c,this.BL=f,this.horizon=g}static fromInvProjectionMatrix(t,a,c){let f=[-1,1,1],g=[1,1,1],v=[1,-1,1],C=[-1,-1,1],I=sr(f,f,t),A=sr(g,g,t),F=sr(v,v,t),V=sr(C,C,t);return new vy(I,A,F,V,a/c)}}class by{constructor(t,a){this.points=t,this.planes=a}static fromInvProjectionMatrix(t,a,c,f){let g=Math.pow(2,c),v=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(I=>{let A=Fu([],I,t),F=1/A[3]/a*g;return function(V,$,W){return V[0]=$[0]*W[0],V[1]=$[1]*W[1],V[2]=$[2]*W[2],V[3]=$[3]*W[3],V}(A,A,[F,F,f?1/A[3]:F,F])}),C=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(I=>{let A=or([],zr([],jo([],v[I[0]],v[I[1]]),jo([],v[I[2]],v[I[1]]))),F=-Bo(A,v[I[1]]);return A.concat(F)});return new by(v,C)}}class po{static fromPoints(t){let a=[1/0,1/0,1/0],c=[-1/0,-1/0,-1/0];for(let f of t)bf(a,a,f),ja(c,c,f);return new po(a,c)}static applyTransform(t,a){let c=t.getCorners();for(let f=0;f<c.length;++f)sr(c[f],c[f],a);return po.fromPoints(c)}constructor(t,a){this.min=t,this.max=a,this.center=os([],Nn([],this.min,this.max),.5)}quadrant(t){let a=[t%2==0,t<2],c=Jp(this.min),f=Jp(this.max);for(let g=0;g<a.length;g++)c[g]=a[g]?this.min[g]:this.center[g],f[g]=a[g]?this.center[g]:this.max[g];return f[2]=this.max[2],new po(c,f)}distanceX(t){return Math.max(Math.min(this.max[0],t[0]),this.min[0])-t[0]}distanceY(t){return Math.max(Math.min(this.max[1],t[1]),this.min[1])-t[1]}distanceZ(t){return Math.max(Math.min(this.max[2],t[2]),this.min[2])-t[2]}getCorners(){let t=this.min,a=this.max;return[[t[0],t[1],t[2]],[a[0],t[1],t[2]],[a[0],a[1],t[2]],[t[0],a[1],t[2]],[t[0],t[1],a[2]],[a[0],t[1],a[2]],[a[0],a[1],a[2]],[t[0],a[1],a[2]]]}intersects(t){let a=this.getCorners(),c=!0;for(let f=0;f<t.planes.length;f++){let g=t.planes[f],v=0;for(let C=0;C<a.length;C++)v+=Bo(g,a[C])+g[3]>=0;if(v===0)return 0;v!==a.length&&(c=!1)}if(c)return 2;for(let f=0;f<3;f++){let g=Number.MAX_VALUE,v=-Number.MAX_VALUE;for(let C=0;C<t.points.length;C++){let I=t.points[C][f]-this.min[f];g=Math.min(g,I),v=Math.max(v,I)}if(v<0||g>this.max[f]-this.min[f])return 0}return 1}}let rm=5,om=6,Is=Wt/Math.PI/2,wf=16383,kc=64,Cf=[kc,32,16],Ss=-Is,ss=Is,Ef=[new po([Ss,Ss,Ss],[ss,ss,ss]),new po([Ss,Ss,Ss],[0,0,ss]),new po([0,Ss,Ss],[ss,0,ss]),new po([Ss,0,Ss],[0,ss,ss]),new po([0,0,Ss],[ss,ss,ss])];function Df(o){return o*Is/zu}function Pv(o,t,a,c=!0){let f=os([],o._camera.position,o.worldSize),g=[t,a,1,1];Fu(g,g,o.pixelMatrixInverse),zl(g,g,1/g[3]);let v=or([],jo([],g,f)),C=o.globeMatrix,I=[C[12],C[13],C[14]],A=jo([],I,f),F=Ts(A),V=or([],A),$=o.worldSize/(2*Math.PI),W=Bo(V,v),q=Math.asin($/F);if(q<Math.acos(W)){if(!c)return null;let vt=[],Ke=[];os(vt,v,F/W),or(Ke,jo(Ke,vt,A)),or(v,Nn(v,A,os(v,Ke,Math.tan(q)*F)))}let ee=[];new im(f,v).closestPointOnSphere(I,$,ee);let ae=or([],no(C,0)),me=or([],no(C,1)),Ce=or([],no(C,2)),ge=Bo(ae,ee),xe=Bo(me,ee),Te=Bo(Ce,ee),De=tr(Math.asin(-xe/$)),qe=tr(Math.atan2(ge,Te));qe=o.center.lng+function(vt,Ke){let ot=(Ke-vt+180)%360-180;return ot<-180?ot+360:ot}(o.center.lng,qe);let We=fa(qe),et=Tn(Va(De),0,1);return new Jd(We,et)}class Vw{constructor(t,a,c){this.a=jo([],t,c),this.b=jo([],a,c),this.center=c;let f=or([],this.a),g=or([],this.b);this.angle=Math.acos(Bo(f,g))}}function Mf(o,t){if(o.angle===0)return null;let a;return a=o.a[t]===0?1/o.angle*.5*Math.PI:1/o.angle*Math.atan(o.b[t]/o.a[t]/Math.sin(o.angle)-1/Math.tan(o.angle)),a<0||a>1?null:function(c,f,g,v){let C=Math.sin(g);return c*(Math.sin((1-v)*g)/C)+f*(Math.sin(v*g)/C)}(o.a[t],o.b[t],o.angle,Tn(a,0,1))+o.center[t]}function mo(o){if(o.z<=1)return Ef[o.z+2*o.y+o.x];let t=xy(sm(o));return po.fromPoints(t)}function jl(o,t,a){return os(o,o,1-a),Ac(o,o,t,a)}function Ov(o,t){let a=Nu(t.zoom);if(a===0)return mo(o);let c=sm(o),f=xy(c),g=fa(c.getWest())*t.worldSize,v=fa(c.getEast())*t.worldSize,C=Va(c.getNorth())*t.worldSize,I=Va(c.getSouth())*t.worldSize,A=[g,C,0],F=[v,C,0],V=[g,I,0],$=[v,I,0],W=Qp([],t.globeMatrix);return sr(A,A,W),sr(F,F,W),sr(V,V,W),sr($,$,W),f[0]=jl(f[0],V,a),f[1]=jl(f[1],$,a),f[2]=jl(f[2],F,a),f[3]=jl(f[3],A,a),po.fromPoints(f)}function Lv(o,t,a){for(let c of o)sr(c,c,t),os(c,c,a)}function Uw(o,t,a){let c=t/o.worldSize,f=o.globeMatrix;if(a.z<=1){let We=mo(a).getCorners();return Lv(We,f,c),po.fromPoints(We)}let g=sm(a),v=xy(g);Lv(v,f,c);let C=Number.MAX_VALUE,I=[-C,-C,-C],A=[C,C,C];if(g.contains(o.center)){for(let vt of v)bf(A,A,vt),ja(I,I,vt);I[2]=0;let We=o.point,et=[We.x*c,We.y*c,0];return bf(A,A,et),ja(I,I,et),new po(A,I)}let F=[f[12]*c,f[13]*c,f[14]*c],V=g.getCenter(),$=Tn(o.center.lat,-Yr,Yr),W=Tn(V.lat,-Yr,Yr),q=fa(o.center.lng),ee=Va($),ae=q-fa(V.lng),me=ee-Va(W);ae>.5?ae-=1:ae<-.5&&(ae+=1);let Ce=0;Math.abs(ae)>Math.abs(me)?Ce=ae>=0?1:3:(Ce=me>=0?0:2,Ac(F,F,[f[4]*c,f[5]*c,f[6]*c],-Math.sin(Pn(me>=0?g.getSouth():g.getNorth()))*Is));let ge=v[Ce],xe=v[(Ce+1)%4],Te=new Vw(ge,xe,F),De=[Mf(Te,0)||ge[0],Mf(Te,1)||ge[1],Mf(Te,2)||ge[2]],qe=Nu(o.zoom);if(qe>0){let We=function({x:vt,y:Ke,z:ot},st,ft,wt,Qe){let kt=1/(1<<ot),Nt=vt*kt,Pt=Nt+kt,mn=Ke*kt,Et=mn+kt,qt=0,gn=(Nt+Pt)/2-wt;return gn>.5?qt=-1:gn<-.5&&(qt=1),Nt=((Nt+qt)*st-(wt*=st))*ft+wt,Pt=((Pt+qt)*st-wt)*ft+wt,mn=(mn*st-(Qe*=st))*ft+Qe,Et=(Et*st-Qe)*ft+Qe,[[Nt,Et,0],[Pt,Et,0],[Pt,mn,0],[Nt,mn,0]]}(a,t,o._pixelsPerMercatorPixel,q,ee);for(let vt=0;vt<v.length;vt++)jl(v[vt],We[vt],qe);let et=Nn([],We[Ce],We[(Ce+1)%4]);os(et,et,.5),jl(De,et,qe)}for(let We of v)bf(A,A,We),ja(I,I,We);return A[2]=Math.min(ge[2],xe[2]),bf(A,A,De),ja(I,I,De),new po(A,I)}function sm({x:o,y:t,z:a}){let c=1/(1<<a),f=new ai(ls(o*c),Xr((t+1)*c)),g=new ai(ls((o+1)*c),Xr(t*c));return new Tc(f,g)}function xy(o){let t=Pn(o.getNorth()),a=Pn(o.getSouth()),c=Math.cos(t),f=Math.cos(a),g=Math.sin(t),v=Math.sin(a),C=o.getWest(),I=o.getEast();return[Kd(f,v,C),Kd(f,v,I),Kd(c,g,I),Kd(c,g,C)]}function Kd(o,t,a,c=Is){return a=Pn(a),[o*Math.sin(a)*c,-t*c,o*Math.cos(a)*c]}function Qd(o,t,a){return Kd(Math.cos(Pn(o)),Math.sin(Pn(o)),t,a)}function Tf(o,t,a,c){let f=1<<a.z,g=(o/Wt+a.x)/f;return Qd(Xr((t/Wt+a.y)/f),ls(g),c)}function am({min:o,max:t}){return wf/Math.max(t[0]-o[0],t[1]-o[1],t[2]-o[2])}let Fv=new Float64Array(16);function If(o){let t=am(o),a=Nl(Fv,[t,t,t]);return Lu(a,a,((c=[])[0]=-(f=o.min)[0],c[1]=-f[1],c[2]=-f[2],c));var c,f}function lm(o){let t=(c=o.min,(a=Fv)[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=c[0],a[13]=c[1],a[14]=c[2],a[15]=1,a);var a,c;let f=1/am(o);return Ic(t,t,[f,f,f])}function Nv(o,t,a,c,f){let g=function(I){let A=Wt/(2*Math.PI);return I/(2*Math.PI)/A}(a),v=[o,t,-a/(2*Math.PI)],C=ha(new Float64Array(16));return Lu(C,C,v),Ic(C,C,[g,g,g]),vf(C,C,Pn(-f)),zo(C,C,Pn(-c)),C}function Nu(o){return Yo(rm,om,o)}function cm(o,t){let a=Qd(t.lat,t.lng),c=function(q){let ee=Qd(q._center.lat,q._center.lng),ae=zr([],Sc(0,1,0),ee),me=py([],-q.angle,ee);ae=sr(ae,ae,me),py(me,-q._pitch,ae);let Ce=or([],ee);return os(Ce,Ce,Df(q.cameraToCenterDistance/q.pixelsPerMeter)),sr(Ce,Ce,me),Nn([],ee,Ce)}(o);return v=(f=gy([],c,a))[0],C=f[1],I=f[2],A=(g=a)[0],F=g[1],V=g[2],W=($=Math.sqrt(v*v+C*C+I*I)*Math.sqrt(A*A+F*F+V*V))&&Bo(f,g)/$,Math.acos(Math.min(Math.max(W,-1),1));var f,g,v,C,I,A,F,V,$,W}function wy(o,t){return cm(o,t)>Math.PI/2*1.01}let zv=Pn(85),$w=Math.cos(zv),um=Math.sin(zv),zu=63710088e-1,Cy=2*Math.PI*zu;class Rc{constructor(t,a){if(isNaN(t)||isNaN(a))throw new Error(`Invalid LngLat object: (${t}, ${a})`);if(this.lng=+t,this.lat=+a,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Rc(gr(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(t){let a=Math.PI/180,c=this.lat*a,f=t.lat*a,g=Math.sin(c)*Math.sin(f)+Math.cos(c)*Math.cos(f)*Math.cos((t.lng-this.lng)*a);return zu*Math.acos(Math.min(g,1))}toBounds(t=0){let a=360*t/40075017,c=a/Math.cos(Math.PI/180*this.lat);return new Tc(new Rc(this.lng-c,this.lat-a),new Rc(this.lng+c,this.lat+a))}toEcef(t){let a=Df(t);return Qd(this.lat,this.lng,Is+a)}static convert(t){if(t instanceof Rc)return t;if(Array.isArray(t)&&(t.length===2||t.length===3))return new Rc(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&typeof t=="object"&&t!==null)return new Rc(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}var ai=Rc;function Sf(o){return Cy*Math.cos(o*Math.PI/180)}function fa(o){return(180+o)/360}function Va(o){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+o*Math.PI/360)))/360}function as(o,t){return o/Sf(t)}function ls(o){return 360*o-180}function Xr(o){return 360/Math.PI*Math.atan(Math.exp((180-360*o)*Math.PI/180))-90}function dm(o,t){return o*Sf(Xr(t))}let Yr=85.051129;function Bv(o){return 1/Math.cos(o*Math.PI/180)}class Jd{constructor(t,a,c=0){this.x=+t,this.y=+a,this.z=+c}static fromLngLat(t,a=0){let c=ai.convert(t);return new Jd(fa(c.lng),Va(c.lat),as(a,c.lat))}toLngLat(){return new ai(ls(this.x),Xr(this.y))}toAltitude(){return dm(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/Cy*Bv(Xr(this.y))}}function eh(o,t,a,c,f,g,v,C,I){let A=(t+c)/2,F=(a+f)/2,V=new It(A,F);C(V),function($,W,q,ee,ae,me){let Ce=q-ae,ge=ee-me;return Math.abs((ee-W)*Ce-(q-$)*ge)/Math.hypot(Ce,ge)}(V.x,V.y,g.x,g.y,v.x,v.y)>=I?(eh(o,t,a,A,F,g,V,C,I),eh(o,A,F,c,f,V,v,C,I)):o.push(v)}function Af(o,t,a){let c=o[0],f=c.x,g=c.y;t(c);let v=[c];for(let C=1;C<o.length;C++){let I=o[C],{x:A,y:F}=I;t(I),eh(v,f,g,A,F,c,I,t,a),f=A,g=F,c=I}return v}function hm(o,t,a,c){if(c(t,a)){let f=t.add(a)._mult(.5);hm(o,t,f,c),hm(o,f,a,c)}else o.push(a)}function jv(o,t){let a=o[0],c=[a];for(let f=1;f<o.length;f++){let g=o[f];hm(c,a,g,t),a=g}return c}let fm=Math.pow(2,14)-1,Ey=-fm-1;function pm(o,t){let a=Math.round(o.x*t),c=Math.round(o.y*t);return o.x=Tn(a,Ey,fm),o.y=Tn(c,Ey,fm),(a<o.x||a>o.x+1||c<o.y||c>o.y+1)&&vi("Geometry exceeds allowed extent, reduce your vector tile buffer size"),o}function pa(o,t,a){let c=o.loadGeometry(),f=o.extent,g=Wt/f;if(t&&a&&a.projection.isReprojectedInTileSpace){let v=1<<t.z,{scale:C,x:I,y:A,projection:F}=a,V=$=>{let W=ls((t.x+$.x/f)/v),q=Xr((t.y+$.y/f)/v),ee=F.project(W,q);$.x=(ee.x*C-I)*f,$.y=(ee.y*C-A)*f};for(let $=0;$<c.length;$++)if(o.type!==1)c[$]=Af(c[$],V,1);else{let W=[];for(let q of c[$])q.x<0||q.x>=f||q.y<0||q.y>=f||(V(q),W.push(q));c[$]=W}}for(let v of c)for(let C of v)pm(C,g);return c}function As(o,t){return{type:o.type,id:o.id,properties:o.properties,geometry:t?pa(o):[]}}function mm(o,t,a,c,f){o.emplaceBack(2*t+(c+1)/2,2*a+(f+1)/2)}function Bu(o,t,a){o.emplaceBack(t.x,t.y,t.z,a[0]*16384,a[1]*16384,a[2]*16384)}class th{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(a=>a.id),this.index=t.index,this.hasPattern=!1,this.projection=t.projection,this.layoutVertexArray=new mt,this.indexArray=new Vt,this.segments=new Xi,this.programConfigurations=new rs(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id)}populate(t,a,c,f){let g=this.layers[0],v=[],C=null;g.type==="circle"&&(C=g.layout.get("circle-sort-key"));for(let{feature:A,id:F,index:V,sourceLayerIndex:$}of t){let W=this.layers[0]._featureFilter.needGeometry,q=As(A,W);if(!this.layers[0]._featureFilter.filter(new z(this.zoom),q,c))continue;let ee=C?C.evaluate(q,{},c):void 0,ae={id:F,properties:A.properties,type:A.type,sourceLayerIndex:$,index:V,geometry:W?q.geometry:pa(A,c,f),patterns:{},sortKey:ee};v.push(ae)}C&&v.sort((A,F)=>A.sortKey-F.sortKey);let I=null;f.projection.name==="globe"&&(this.globeExtVertexArray=new gt,I=f.projection);for(let A of v){let{geometry:F,index:V,sourceLayerIndex:$}=A,W=t[V].feature;this.addFeature(A,F,V,a.availableImages,c,I),a.featureIndex.insert(W,F,V,$,this.index)}}update(t,a,c,f){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,a,this.stateDependentLayers,c,f)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,hy.members),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=t.createVertexBuffer(this.globeExtVertexArray,Fw.members))),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(t,a,c,f,g,v){for(let C of a)for(let I of C){let A=I.x,F=I.y;if(A<0||A>=Wt||F<0||F>=Wt)continue;if(v){let W=v.projectTilePoint(A,F,g),q=v.upVector(g,A,F),ee=this.globeExtVertexArray;Bu(ee,W,q),Bu(ee,W,q),Bu(ee,W,q),Bu(ee,W,q)}let V=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,t.sortKey),$=V.vertexLength;mm(this.layoutVertexArray,A,F,-1,-1),mm(this.layoutVertexArray,A,F,1,-1),mm(this.layoutVertexArray,A,F,1,1),mm(this.layoutVertexArray,A,F,-1,1),this.indexArray.emplaceBack($,$+1,$+2),this.indexArray.emplaceBack($,$+2,$+3),V.vertexLength+=4,V.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,c,{},f,g)}}function Vv(o,t){for(let a=0;a<o.length;a++)if(ju(t,o[a]))return!0;for(let a=0;a<t.length;a++)if(ju(o,t[a]))return!0;return!!kf(o,t)}function Hw(o,t,a){return!!ju(o,t)||!!Ua(t,o,a)}function Pc(o,t){if(o.length===1)return nh(t,o[0]);for(let a=0;a<t.length;a++){let c=t[a];for(let f=0;f<c.length;f++)if(ju(o,c[f]))return!0}for(let a=0;a<o.length;a++)if(nh(t,o[a]))return!0;for(let a=0;a<t.length;a++)if(kf(o,t[a]))return!0;return!1}function Uv(o,t,a){if(o.length>1){if(kf(o,t))return!0;for(let c=0;c<t.length;c++)if(Ua(t[c],o,a))return!0}for(let c=0;c<o.length;c++)if(Ua(o[c],t,a))return!0;return!1}function kf(o,t){if(o.length===0||t.length===0)return!1;for(let a=0;a<o.length-1;a++){let c=o[a],f=o[a+1];for(let g=0;g<t.length-1;g++)if($v(c,f,t[g],t[g+1]))return!0}return!1}function $v(o,t,a,c){return xo(o,a,c)!==xo(t,a,c)&&xo(o,t,a)!==xo(o,t,c)}function Ua(o,t,a){let c=a*a;if(t.length===1)return o.distSqr(t[0])<c;for(let f=1;f<t.length;f++)if(gm(o,t[f-1],t[f])<c)return!0;return!1}function gm(o,t,a){let c=t.distSqr(a);if(c===0)return o.distSqr(t);let f=((o.x-t.x)*(a.x-t.x)+(o.y-t.y)*(a.y-t.y))/c;return o.distSqr(f<0?t:f>1?a:a.sub(t)._mult(f)._add(t))}function nh(o,t){let a,c,f,g=!1;for(let v=0;v<o.length;v++){a=o[v];for(let C=0,I=a.length-1;C<a.length;I=C++)c=a[C],f=a[I],c.y>t.y!=f.y>t.y&&t.x<(f.x-c.x)*(t.y-c.y)/(f.y-c.y)+c.x&&(g=!g)}return g}function ju(o,t){let a=!1;for(let c=0,f=o.length-1;c<o.length;f=c++){let g=o[c],v=o[f];g.y>t.y!=v.y>t.y&&t.x<(v.x-g.x)*(t.y-g.y)/(v.y-g.y)+g.x&&(a=!a)}return a}function ih(o,t,a,c,f){for(let v of o)if(t<=v.x&&a<=v.y&&c>=v.x&&f>=v.y)return!0;let g=[new It(t,a),new It(t,f),new It(c,f),new It(c,a)];if(o.length>2){for(let v of g)if(ju(o,v))return!0}for(let v=0;v<o.length-1;v++)if(Gw(o[v],o[v+1],g))return!0;return!1}function Gw(o,t,a){let c=a[0],f=a[2];if(o.x<c.x&&t.x<c.x||o.x>f.x&&t.x>f.x||o.y<c.y&&t.y<c.y||o.y>f.y&&t.y>f.y)return!1;let g=xo(o,t,a[0]);return g!==xo(o,t,a[1])||g!==xo(o,t,a[2])||g!==xo(o,t,a[3])}function Vu(o,t,a){let c=t.paint.get(o).value;return c.kind==="constant"?c.value:a.programConfigurations.get(t.id).getMaxValue(o)}function Uu(o){return Math.sqrt(o[0]*o[0]+o[1]*o[1])}function Hv(o,t,a,c,f){if(!t[0]&&!t[1])return o;let g=It.convert(t)._mult(f);a==="viewport"&&g._rotate(-c);let v=[];for(let C=0;C<o.length;C++)v.push(o[C].sub(g));return v}function Dy(o,t,a,c){let f=It.convert(o)._mult(c);return t==="viewport"&&f._rotate(-a),f}Ot(th,"CircleBucket",{omit:["layers"]});let Ww=new _e({"circle-sort-key":new ue(Je.layout_circle["circle-sort-key"])});var Rf={paint:new _e({"circle-radius":new ue(Je.paint_circle["circle-radius"]),"circle-color":new ue(Je.paint_circle["circle-color"]),"circle-blur":new ue(Je.paint_circle["circle-blur"]),"circle-opacity":new ue(Je.paint_circle["circle-opacity"]),"circle-translate":new Q(Je.paint_circle["circle-translate"]),"circle-translate-anchor":new Q(Je.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Q(Je.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Q(Je.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new ue(Je.paint_circle["circle-stroke-width"]),"circle-stroke-color":new ue(Je.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new ue(Je.paint_circle["circle-stroke-opacity"])}),layout:Ww};function Gv(o,t,a,c,f,g,v,C,I){if(g&&o.queryGeometry.isAboveHorizon)return!1;g&&(I*=o.pixelToTileUnitsFactor);let A=o.tileID.canonical,F=a.projection.upVectorScale(A,a.center.lat,a.worldSize).metersToTile;for(let V of t)for(let $ of V){let W=$.add(C),q=f&&a.elevation?a.elevation.exaggeration()*f.getElevationAt(W.x,W.y,!0):0,ee=a.projection.projectTilePoint(W.x,W.y,A);if(q>0){let ge=a.projection.upVector(A,W.x,W.y);ee.x+=ge[0]*F*q,ee.y+=ge[1]*F*q,ee.z+=ge[2]*F*q}let ae=g?W:qw(ee.x,ee.y,ee.z,c),me=g?o.tilespaceRays.map(ge=>My(ge,q)):o.queryGeometry.screenGeometry,Ce=Fu([],[ee.x,ee.y,ee.z,1],c);if(!v&&g?I*=Ce[3]/a.cameraToCenterDistance:v&&!g&&(I*=a.cameraToCenterDistance/Ce[3]),g){let ge=Xr(($.y/Wt+A.y)/(1<<A.z));I/=a.projection.pixelsPerMeter(ge,1)/as(1,ge)}if(Hw(me,ae,I))return!0}return!1}function qw(o,t,a,c){let f=Fu([],[o,t,a,1],c);return new It(f[0]/f[3],f[1]/f[3])}let Wv=Sc(0,0,0),Zw=Sc(0,0,1);function My(o,t){let a=my();return Wv[2]=t,o.intersectsPlane(Wv,Zw,a),new It(a[0],a[1])}class qv extends th{}function Ty(o,{width:t,height:a},c,f){if(f){if(f instanceof Uint8ClampedArray)f=new Uint8Array(f.buffer);else if(f.length!==t*a*c)throw new RangeError("mismatched image size")}else f=new Uint8Array(t*a*c);return o.width=t,o.height=a,o.data=f,o}function Zv(o,t,a){let{width:c,height:f}=t;c===o.width&&f===o.height||(Iy(o,t,{x:0,y:0},{x:0,y:0},{width:Math.min(o.width,c),height:Math.min(o.height,f)},a),o.width=c,o.height=f,o.data=t.data)}function Iy(o,t,a,c,f,g){if(f.width===0||f.height===0)return t;if(f.width>o.width||f.height>o.height||a.x>o.width-f.width||a.y>o.height-f.height)throw new RangeError("out of range source coordinates for image copy");if(f.width>t.width||f.height>t.height||c.x>t.width-f.width||c.y>t.height-f.height)throw new RangeError("out of range destination coordinates for image copy");let v=o.data,C=t.data;for(let I=0;I<f.height;I++){let A=((a.y+I)*o.width+a.x)*g,F=((c.y+I)*t.width+c.x)*g;for(let V=0;V<f.width*g;V++)C[F+V]=v[A+V]}return t}Ot(qv,"HeatmapBucket",{omit:["layers"]});class Vl{constructor(t,a){Ty(this,t,1,a)}resize(t){Zv(this,new Vl(t),1)}clone(){return new Vl({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,a,c,f,g){Iy(t,a,c,f,g,1)}}class oo{constructor(t,a){Ty(this,t,4,a)}resize(t){Zv(this,new oo(t),4)}replace(t,a){a?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t}clone(){return new oo({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,a,c,f,g){Iy(t,a,c,f,g,4)}}Ot(Vl,"AlphaImage"),Ot(oo,"RGBAImage");var Xv={paint:new _e({"heatmap-radius":new ue(Je.paint_heatmap["heatmap-radius"]),"heatmap-weight":new ue(Je.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Q(Je.paint_heatmap["heatmap-intensity"]),"heatmap-color":new ye(Je.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Q(Je.paint_heatmap["heatmap-opacity"])})};function Sy(o){let t={},a=o.resolution||256,c=o.clips?o.clips.length:1,f=o.image||new oo({width:a,height:c}),g=(v,C,I)=>{t[o.evaluationKey]=I;let A=o.expression.evaluate(t);f.data[v+C+0]=Math.floor(255*A.r/A.a),f.data[v+C+1]=Math.floor(255*A.g/A.a),f.data[v+C+2]=Math.floor(255*A.b/A.a),f.data[v+C+3]=Math.floor(255*A.a)};if(o.clips)for(let v=0,C=0;v<c;++v,C+=4*a)for(let I=0,A=0;I<a;I++,A+=4){let F=I/(a-1),{start:V,end:$}=o.clips[v];g(C,A,V*(1-F)+$*F)}else for(let v=0,C=0;v<a;v++,C+=4)g(0,C,v/(a-1));return f}var Ay={paint:new _e({"hillshade-illumination-direction":new Q(Je.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Q(Je.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Q(Je.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Q(Je.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Q(Je.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Q(Je.paint_hillshade["hillshade-accent-color"])})};let ym=Fe([{name:"a_pos",components:2,type:"Int16"}],4),{members:Xw}=ym;var _m={exports:{}};function vm(o,t,a){a=a||2;var c,f,g,v,C,I,A,F=t&&t.length,V=F?t[0]*a:o.length,$=ky(o,0,V,a,!0),W=[];if(!$||$.next===$.prev)return W;if(F&&($=function(ee,ae,me,Ce){var ge,xe,Te,De=[];for(ge=0,xe=ae.length;ge<xe;ge++)(Te=ky(ee,ae[ge]*Ce,ge<xe-1?ae[ge+1]*Ce:ee.length,Ce,!1))===Te.next&&(Te.steiner=!0),De.push(Qv(Te));for(De.sort(Jw),ge=0;ge<De.length;ge++)me=Kv(De[ge],me);return me}(o,t,$,a)),o.length>80*a){c=g=o[0],f=v=o[1];for(var q=a;q<V;q+=a)(C=o[q])<c&&(c=C),(I=o[q+1])<f&&(f=I),C>g&&(g=C),I>v&&(v=I);A=(A=Math.max(g-c,v-f))!==0?32767/A:0}return Pf($,W,a,c,f,A,0),W}function ky(o,t,a,c,f){var g,v;if(f===wm(o,t,a,c)>0)for(g=t;g<a;g+=c)v=Oy(g,o[g],o[g+1],v);else for(g=a-c;g>=t;g-=c)v=Oy(g,o[g],o[g+1],v);return v&&bm(v,v.next)&&(Ff(v),v=v.next),v}function $u(o,t){if(!o)return o;t||(t=o);var a,c=o;do if(a=!1,c.steiner||!bm(c,c.next)&&Yi(c.prev,c,c.next)!==0)c=c.next;else{if(Ff(c),(c=t=c.prev)===c.next)break;a=!0}while(a||c!==t);return t}function Pf(o,t,a,c,f,g,v){if(o){!v&&g&&function(F,V,$,W){var q=F;do q.z===0&&(q.z=Ry(q.x,q.y,V,$,W)),q.prevZ=q.prev,q.nextZ=q.next,q=q.next;while(q!==F);q.prevZ.nextZ=null,q.prevZ=null,function(ee){var ae,me,Ce,ge,xe,Te,De,qe,We=1;do{for(me=ee,ee=null,xe=null,Te=0;me;){for(Te++,Ce=me,De=0,ae=0;ae<We&&(De++,Ce=Ce.nextZ);ae++);for(qe=We;De>0||qe>0&&Ce;)De!==0&&(qe===0||!Ce||me.z<=Ce.z)?(ge=me,me=me.nextZ,De--):(ge=Ce,Ce=Ce.nextZ,qe--),xe?xe.nextZ=ge:ee=ge,ge.prevZ=xe,xe=ge;me=Ce}xe.nextZ=null,We*=2}while(Te>1)}(q)}(o,c,f,g);for(var C,I,A=o;o.prev!==o.next;)if(C=o.prev,I=o.next,g?Kw(o,c,f,g):Yw(o))t.push(C.i/a|0),t.push(o.i/a|0),t.push(I.i/a|0),Ff(o),o=I.next,A=I.next;else if((o=I)===A){v?v===1?Pf(o=Qw($u(o),t,a),t,a,c,f,g,2):v===2&&Yv(o,t,a,c,f,g):Pf($u(o),t,a,c,f,g,1);break}}}function Yw(o){var t=o.prev,a=o,c=o.next;if(Yi(t,a,c)>=0)return!1;for(var f=t.x,g=a.x,v=c.x,C=t.y,I=a.y,A=c.y,F=f<g?f<v?f:v:g<v?g:v,V=C<I?C<A?C:A:I<A?I:A,$=f>g?f>v?f:v:g>v?g:v,W=C>I?C>A?C:A:I>A?I:A,q=c.next;q!==t;){if(q.x>=F&&q.x<=$&&q.y>=V&&q.y<=W&&Oc(f,C,g,I,v,A,q.x,q.y)&&Yi(q.prev,q,q.next)>=0)return!1;q=q.next}return!0}function Kw(o,t,a,c){var f=o.prev,g=o,v=o.next;if(Yi(f,g,v)>=0)return!1;for(var C=f.x,I=g.x,A=v.x,F=f.y,V=g.y,$=v.y,W=C<I?C<A?C:A:I<A?I:A,q=F<V?F<$?F:$:V<$?V:$,ee=C>I?C>A?C:A:I>A?I:A,ae=F>V?F>$?F:$:V>$?V:$,me=Ry(W,q,t,a,c),Ce=Ry(ee,ae,t,a,c),ge=o.prevZ,xe=o.nextZ;ge&&ge.z>=me&&xe&&xe.z<=Ce;){if(ge.x>=W&&ge.x<=ee&&ge.y>=q&&ge.y<=ae&&ge!==f&&ge!==v&&Oc(C,F,I,V,A,$,ge.x,ge.y)&&Yi(ge.prev,ge,ge.next)>=0||(ge=ge.prevZ,xe.x>=W&&xe.x<=ee&&xe.y>=q&&xe.y<=ae&&xe!==f&&xe!==v&&Oc(C,F,I,V,A,$,xe.x,xe.y)&&Yi(xe.prev,xe,xe.next)>=0))return!1;xe=xe.nextZ}for(;ge&&ge.z>=me;){if(ge.x>=W&&ge.x<=ee&&ge.y>=q&&ge.y<=ae&&ge!==f&&ge!==v&&Oc(C,F,I,V,A,$,ge.x,ge.y)&&Yi(ge.prev,ge,ge.next)>=0)return!1;ge=ge.prevZ}for(;xe&&xe.z<=Ce;){if(xe.x>=W&&xe.x<=ee&&xe.y>=q&&xe.y<=ae&&xe!==f&&xe!==v&&Oc(C,F,I,V,A,$,xe.x,xe.y)&&Yi(xe.prev,xe,xe.next)>=0)return!1;xe=xe.nextZ}return!0}function Qw(o,t,a){var c=o;do{var f=c.prev,g=c.next.next;!bm(f,g)&&Jv(f,c,c.next,g)&&Lf(f,g)&&Lf(g,f)&&(t.push(f.i/a|0),t.push(c.i/a|0),t.push(g.i/a|0),Ff(c),Ff(c.next),c=o=g),c=c.next}while(c!==o);return $u(c)}function Yv(o,t,a,c,f,g){var v=o;do{for(var C=v.next.next;C!==v.prev;){if(v.i!==C.i&&t1(v,C)){var I=Py(v,C);return v=$u(v,v.next),I=$u(I,I.next),Pf(v,t,a,c,f,g,0),void Pf(I,t,a,c,f,g,0)}C=C.next}v=v.next}while(v!==o)}function Jw(o,t){return o.x-t.x}function Kv(o,t){var a=function(f,g){var v,C=g,I=f.x,A=f.y,F=-1/0;do{if(A<=C.y&&A>=C.next.y&&C.next.y!==C.y){var V=C.x+(A-C.y)*(C.next.x-C.x)/(C.next.y-C.y);if(V<=I&&V>F&&(F=V,v=C.x<C.next.x?C:C.next,V===I))return v}C=C.next}while(C!==g);if(!v)return null;var $,W=v,q=v.x,ee=v.y,ae=1/0;C=v;do I>=C.x&&C.x>=q&&I!==C.x&&Oc(A<ee?I:F,A,q,ee,A<ee?F:I,A,C.x,C.y)&&($=Math.abs(A-C.y)/(I-C.x),Lf(C,f)&&($<ae||$===ae&&(C.x>v.x||C.x===v.x&&e1(v,C)))&&(v=C,ae=$)),C=C.next;while(C!==W);return v}(o,t);if(!a)return t;var c=Py(a,o);return $u(c,c.next),$u(a,a.next)}function e1(o,t){return Yi(o.prev,o,t.prev)<0&&Yi(t.next,o,o.next)<0}function Ry(o,t,a,c,f){return(o=1431655765&((o=858993459&((o=252645135&((o=16711935&((o=(o-a)*f|0)|o<<8))|o<<4))|o<<2))|o<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-c)*f|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function Qv(o){var t=o,a=o;do(t.x<a.x||t.x===a.x&&t.y<a.y)&&(a=t),t=t.next;while(t!==o);return a}function Oc(o,t,a,c,f,g,v,C){return(f-v)*(t-C)>=(o-v)*(g-C)&&(o-v)*(c-C)>=(a-v)*(t-C)&&(a-v)*(g-C)>=(f-v)*(c-C)}function t1(o,t){return o.next.i!==t.i&&o.prev.i!==t.i&&!function(a,c){var f=a;do{if(f.i!==a.i&&f.next.i!==a.i&&f.i!==c.i&&f.next.i!==c.i&&Jv(f,f.next,a,c))return!0;f=f.next}while(f!==a);return!1}(o,t)&&(Lf(o,t)&&Lf(t,o)&&function(a,c){var f=a,g=!1,v=(a.x+c.x)/2,C=(a.y+c.y)/2;do f.y>C!=f.next.y>C&&f.next.y!==f.y&&v<(f.next.x-f.x)*(C-f.y)/(f.next.y-f.y)+f.x&&(g=!g),f=f.next;while(f!==a);return g}(o,t)&&(Yi(o.prev,o,t.prev)||Yi(o,t.prev,t))||bm(o,t)&&Yi(o.prev,o,o.next)>0&&Yi(t.prev,t,t.next)>0)}function Yi(o,t,a){return(t.y-o.y)*(a.x-t.x)-(t.x-o.x)*(a.y-t.y)}function bm(o,t){return o.x===t.x&&o.y===t.y}function Jv(o,t,a,c){var f=Of(Yi(o,t,a)),g=Of(Yi(o,t,c)),v=Of(Yi(a,c,o)),C=Of(Yi(a,c,t));return f!==g&&v!==C||!(f!==0||!xm(o,a,t))||!(g!==0||!xm(o,c,t))||!(v!==0||!xm(a,o,c))||!(C!==0||!xm(a,t,c))}function xm(o,t,a){return t.x<=Math.max(o.x,a.x)&&t.x>=Math.min(o.x,a.x)&&t.y<=Math.max(o.y,a.y)&&t.y>=Math.min(o.y,a.y)}function Of(o){return o>0?1:o<0?-1:0}function Lf(o,t){return Yi(o.prev,o,o.next)<0?Yi(o,t,o.next)>=0&&Yi(o,o.prev,t)>=0:Yi(o,t,o.prev)<0||Yi(o,o.next,t)<0}function Py(o,t){var a=new Ly(o.i,o.x,o.y),c=new Ly(t.i,t.x,t.y),f=o.next,g=t.prev;return o.next=t,t.prev=o,a.next=f,f.prev=a,c.next=a,a.prev=c,g.next=c,c.prev=g,c}function Oy(o,t,a,c){var f=new Ly(o,t,a);return c?(f.next=c.next,f.prev=c,c.next.prev=f,c.next=f):(f.prev=f,f.next=f),f}function Ff(o){o.next.prev=o.prev,o.prev.next=o.next,o.prevZ&&(o.prevZ.nextZ=o.nextZ),o.nextZ&&(o.nextZ.prevZ=o.prevZ)}function Ly(o,t,a){this.i=o,this.x=t,this.y=a,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function wm(o,t,a,c){for(var f=0,g=t,v=a-c;g<a;g+=c)f+=(o[v]-o[g])*(o[g+1]+o[v+1]),v=g;return f}_m.exports=vm,_m.exports.default=vm,vm.deviation=function(o,t,a,c){var f=t&&t.length,g=Math.abs(wm(o,0,f?t[0]*a:o.length,a));if(f)for(var v=0,C=t.length;v<C;v++)g-=Math.abs(wm(o,t[v]*a,v<C-1?t[v+1]*a:o.length,a));var I=0;for(v=0;v<c.length;v+=3){var A=c[v]*a,F=c[v+1]*a,V=c[v+2]*a;I+=Math.abs((o[A]-o[V])*(o[F+1]-o[A+1])-(o[A]-o[F])*(o[V+1]-o[A+1]))}return g===0&&I===0?0:Math.abs((I-g)/g)},vm.flatten=function(o){for(var t=o[0][0].length,a={vertices:[],holes:[],dimensions:t},c=0,f=0;f<o.length;f++){for(var g=0;g<o[f].length;g++)for(var v=0;v<t;v++)a.vertices.push(o[f][g][v]);f>0&&a.holes.push(c+=o[f-1].length)}return a};var Fy=Qt(_m.exports);function n1(o,t,a,c,f){eb(o,t,a||0,c||o.length-1,f||tb)}function eb(o,t,a,c,f){for(;c>a;){if(c-a>600){var g=c-a+1,v=t-a+1,C=Math.log(g),I=.5*Math.exp(2*C/3),A=.5*Math.sqrt(C*I*(g-I)/g)*(v-g/2<0?-1:1);eb(o,t,Math.max(a,Math.floor(t-v*I/g+A)),Math.min(c,Math.floor(t+(g-v)*I/g+A)),f)}var F=o[t],V=a,$=c;for(rh(o,a,t),f(o[c],F)>0&&rh(o,a,c);V<$;){for(rh(o,V,$),V++,$--;f(o[V],F)<0;)V++;for(;f(o[$],F)>0;)$--}f(o[a],F)===0?rh(o,a,$):rh(o,++$,c),$<=t&&(a=$+1),t<=$&&(c=$-1)}}function rh(o,t,a){var c=o[t];o[t]=o[a],o[a]=c}function tb(o,t){return o<t?-1:o>t?1:0}function Ny(o,t){let a=o.length;if(a<=1)return[o];let c=[],f,g;for(let v=0;v<a;v++){let C=il(o[v]);C!==0&&(o[v].area=Math.abs(C),g===void 0&&(g=C<0),g===C<0?(f&&c.push(f),f=[o[v]]):f.push(o[v]))}if(f&&c.push(f),t>1)for(let v=0;v<c.length;v++)c[v].length<=t||(n1(c[v],t,1,c[v].length-1,i1),c[v]=c[v].slice(0,t));return c}function i1(o,t){return t.area-o.area}function Cm(o,t,a){let c=a.patternDependencies,f=!1;for(let g of t){let v=g.paint.get(`${o}-pattern`);v.isConstant()||(f=!0);let C=v.constantOr(null);C&&(f=!0,c[C]=!0)}return f}function zy(o,t,a,c,f){let g=f.patternDependencies;for(let v of t){let C=v.paint.get(`${o}-pattern`).value;if(C.kind!=="constant"){let I=C.evaluate({zoom:c},a,{},f.availableImages);I=I&&I.name?I.name:I,g[I]=!0,a.patterns[v.id]=I}}return a}class Nf{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(a=>a.id),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new mt,this.indexArray=new Vt,this.indexArray2=new vr,this.programConfigurations=new rs(t.layers,t.zoom),this.segments=new Xi,this.segments2=new Xi,this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id),this.projection=t.projection}populate(t,a,c,f){this.hasPattern=Cm("fill",this.layers,a);let g=this.layers[0].layout.get("fill-sort-key"),v=[];for(let{feature:C,id:I,index:A,sourceLayerIndex:F}of t){let V=this.layers[0]._featureFilter.needGeometry,$=As(C,V);if(!this.layers[0]._featureFilter.filter(new z(this.zoom),$,c))continue;let W=g?g.evaluate($,{},c,a.availableImages):void 0,q={id:I,properties:C.properties,type:C.type,sourceLayerIndex:F,index:A,geometry:V?$.geometry:pa(C,c,f),patterns:{},sortKey:W};v.push(q)}g&&v.sort((C,I)=>C.sortKey-I.sortKey);for(let C of v){let{geometry:I,index:A,sourceLayerIndex:F}=C;if(this.hasPattern){let V=zy("fill",this.layers,C,this.zoom,a);this.patternFeatures.push(V)}else this.addFeature(C,I,A,c,{},a.availableImages);a.featureIndex.insert(t[A].feature,I,A,F,this.index)}}update(t,a,c,f){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,a,this.stateDependentLayers,c,f)}addFeatures(t,a,c,f,g){for(let v of this.patternFeatures)this.addFeature(v,v.geometry,v.index,a,c,f)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Xw),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(t,a,c,f,g,v=[]){for(let C of Ny(a,500)){let I=0;for(let q of C)I+=q.length;let A=this.segments.prepareSegment(I,this.layoutVertexArray,this.indexArray),F=A.vertexLength,V=[],$=[];for(let q of C){if(q.length===0)continue;q!==C[0]&&$.push(V.length/2);let ee=this.segments2.prepareSegment(q.length,this.layoutVertexArray,this.indexArray2),ae=ee.vertexLength;this.layoutVertexArray.emplaceBack(q[0].x,q[0].y),this.indexArray2.emplaceBack(ae+q.length-1,ae),V.push(q[0].x),V.push(q[0].y);for(let me=1;me<q.length;me++)this.layoutVertexArray.emplaceBack(q[me].x,q[me].y),this.indexArray2.emplaceBack(ae+me-1,ae+me),V.push(q[me].x),V.push(q[me].y);ee.vertexLength+=q.length,ee.primitiveLength+=q.length}let W=Fy(V,$);for(let q=0;q<W.length;q+=3)this.indexArray.emplaceBack(F+W[q],F+W[q+1],F+W[q+2]);A.vertexLength+=I,A.primitiveLength+=W.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,c,g,v,f)}}Ot(Nf,"FillBucket",{omit:["layers","patternFeatures"]});let r1=new _e({"fill-sort-key":new ue(Je.layout_fill["fill-sort-key"])});var nb={paint:new _e({"fill-antialias":new Q(Je.paint_fill["fill-antialias"]),"fill-opacity":new ue(Je.paint_fill["fill-opacity"]),"fill-color":new ue(Je.paint_fill["fill-color"]),"fill-outline-color":new ue(Je.paint_fill["fill-outline-color"]),"fill-translate":new Q(Je.paint_fill["fill-translate"]),"fill-translate-anchor":new Q(Je.paint_fill["fill-translate-anchor"]),"fill-pattern":new ue(Je.paint_fill["fill-pattern"])}),layout:r1};let ib=Fe([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),o1=Fe([{name:"a_centroid_pos",components:2,type:"Uint16"}]),rb=Fe([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:s1}=ib;var oh={},a1=lt,By=Hu;function Hu(o,t,a,c,f){this.properties={},this.extent=a,this.type=0,this._pbf=o,this._geometry=-1,this._keys=c,this._values=f,o.readFields(l1,this,t)}function l1(o,t,a){o==1?t.id=a.readVarint():o==2?function(c,f){for(var g=c.readVarint()+c.pos;c.pos<g;){var v=f._keys[c.readVarint()],C=f._values[c.readVarint()];f.properties[v]=C}}(a,t):o==3?t.type=a.readVarint():o==4&&(t._geometry=a.pos)}function c1(o){for(var t,a,c=0,f=0,g=o.length,v=g-1;f<g;v=f++)c+=((a=o[v]).x-(t=o[f]).x)*(t.y+a.y);return c}Hu.types=["Unknown","Point","LineString","Polygon"],Hu.prototype.loadGeometry=function(){var o=this._pbf;o.pos=this._geometry;for(var t,a=o.readVarint()+o.pos,c=1,f=0,g=0,v=0,C=[];o.pos<a;){if(f<=0){var I=o.readVarint();c=7&I,f=I>>3}if(f--,c===1||c===2)g+=o.readSVarint(),v+=o.readSVarint(),c===1&&(t&&C.push(t),t=[]),t.push(new a1(g,v));else{if(c!==7)throw new Error("unknown command "+c);t&&t.push(t[0].clone())}}return t&&C.push(t),C},Hu.prototype.bbox=function(){var o=this._pbf;o.pos=this._geometry;for(var t=o.readVarint()+o.pos,a=1,c=0,f=0,g=0,v=1/0,C=-1/0,I=1/0,A=-1/0;o.pos<t;){if(c<=0){var F=o.readVarint();a=7&F,c=F>>3}if(c--,a===1||a===2)(f+=o.readSVarint())<v&&(v=f),f>C&&(C=f),(g+=o.readSVarint())<I&&(I=g),g>A&&(A=g);else if(a!==7)throw new Error("unknown command "+a)}return[v,I,C,A]},Hu.prototype.toGeoJSON=function(o,t,a){var c,f,g=this.extent*Math.pow(2,a),v=this.extent*o,C=this.extent*t,I=this.loadGeometry(),A=Hu.types[this.type];function F(W){for(var q=0;q<W.length;q++){var ee=W[q];W[q]=[360*(ee.x+v)/g-180,360/Math.PI*Math.atan(Math.exp((180-360*(ee.y+C)/g)*Math.PI/180))-90]}}switch(this.type){case 1:var V=[];for(c=0;c<I.length;c++)V[c]=I[c][0];F(I=V);break;case 2:for(c=0;c<I.length;c++)F(I[c]);break;case 3:for(I=function(W){var q=W.length;if(q<=1)return[W];for(var ee,ae,me=[],Ce=0;Ce<q;Ce++){var ge=c1(W[Ce]);ge!==0&&(ae===void 0&&(ae=ge<0),ae===ge<0?(ee&&me.push(ee),ee=[W[Ce]]):ee.push(W[Ce]))}return ee&&me.push(ee),me}(I),c=0;c<I.length;c++)for(f=0;f<I[c].length;f++)F(I[c][f])}I.length===1?I=I[0]:A="Multi"+A;var $={type:"Feature",geometry:{type:A,coordinates:I},properties:this.properties};return"id"in this&&($.id=this.id),$};var jy=By,ob=sb;function sb(o,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=o,this._keys=[],this._values=[],this._features=[],o.readFields(u1,this,t),this.length=this._features.length}function u1(o,t,a){o===15?t.version=a.readVarint():o===1?t.name=a.readString():o===5?t.extent=a.readVarint():o===2?t._features.push(a.pos):o===3?t._keys.push(a.readString()):o===4&&t._values.push(function(c){for(var f=null,g=c.readVarint()+c.pos;c.pos<g;){var v=c.readVarint()>>3;f=v===1?c.readString():v===2?c.readFloat():v===3?c.readDouble():v===4?c.readVarint64():v===5?c.readVarint():v===6?c.readSVarint():v===7?c.readBoolean():null}return f}(a))}sb.prototype.feature=function(o){if(o<0||o>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[o];var t=this._pbf.readVarint()+this._pbf.pos;return new jy(this._pbf,t,this.extent,this._keys,this._values)};var d1=ob;function h1(o,t,a){if(o===3){var c=new d1(a,a.readVarint()+a.pos);c.length&&(t[c.name]=c)}}var Vy=oh.VectorTile=function(o,t){this.layers=o.readFields(h1,{},t)},Gu=oh.VectorTileFeature=By;function Em(o,t,a,c){let f=[],g=c===0?(v,C,I,A,F,V)=>{v.push(new It(V,I+(V-C)/(A-C)*(F-I)))}:(v,C,I,A,F,V)=>{v.push(new It(C+(V-I)/(F-I)*(A-C),V))};for(let v of o){let C=[];for(let I of v){if(I.length<=2)continue;let A=[];for(let $=0;$<I.length-1;$++){let W=I[$].x,q=I[$].y,ee=I[$+1].x,ae=I[$+1].y,me=c===0?W:q,Ce=c===0?ee:ae;me<t?Ce>t&&g(A,W,q,ee,ae,t):me>a?Ce<a&&g(A,W,q,ee,ae,a):A.push(I[$]),Ce<t&&me>=t&&g(A,W,q,ee,ae,t),Ce>a&&me<=a&&g(A,W,q,ee,ae,a)}let F=I[I.length-1],V=c===0?F.x:F.y;V>=t&&V<=a&&A.push(F),A.length&&(F=A[A.length-1],A[0].x===F.x&&A[0].y===F.y||A.push(A[0]),C.push(A))}C.length&&f.push(C)}return f}oh.VectorTileLayer=ob;let f1=Gu.types,p1=Math.pow(2,13);function P(o,t,a,c,f,g,v,C){o.emplaceBack((t<<1)+v,(a<<1)+g,(Math.floor(c*p1)<<1)+f,Math.round(C))}function d(o,t,a){o.emplaceBack(t.x,t.y,t.z,a[0]*16384,a[1]*16384,a[2]*16384)}class p{constructor(){this.acc=new It(0,0),this.polyCount=[]}startRing(t){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new It(t.x,t.y),this.max=new It(t.x,t.y))}append(t,a){this.currentPolyCount.edges++,this.acc._add(t);let c=this.min,f=this.max;t.x<c.x?c.x=t.x:t.x>f.x&&(f.x=t.x),t.y<c.y?c.y=t.y:t.y>f.y&&(f.y=t.y),((t.x===0||t.x===Wt)&&t.x===a.x)!=((t.y===0||t.y===Wt)&&t.y===a.y)&&this.processBorderOverlap(t,a),a.x<0!=t.x<0&&this.addBorderIntersection(0,Fn(a.y,t.y,(0-a.x)/(t.x-a.x))),a.x>Wt!=t.x>Wt&&this.addBorderIntersection(1,Fn(a.y,t.y,(Wt-a.x)/(t.x-a.x))),a.y<0!=t.y<0&&this.addBorderIntersection(2,Fn(a.x,t.x,(0-a.y)/(t.y-a.y))),a.y>Wt!=t.y>Wt&&this.addBorderIntersection(3,Fn(a.x,t.x,(Wt-a.y)/(t.y-a.y)))}addBorderIntersection(t,a){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);let c=this.borders[t];a<c[0]&&(c[0]=a),a>c[1]&&(c[1]=a)}processBorderOverlap(t,a){if(t.x===a.x){if(t.y===a.y)return;let c=t.x===0?0:1;this.addBorderIntersection(c,a.y),this.addBorderIntersection(c,t.y)}else{let c=t.y===0?2:3;this.addBorderIntersection(c,a.x),this.addBorderIntersection(c,t.x)}}centroid(){let t=this.polyCount.reduce((a,c)=>a+c.edges,0);return t!==0?this.acc.div(t)._round():new It(0,0)}span(){return new It(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce((t,a)=>t+ +(a[0]!==Number.MAX_VALUE),0)}}class y{constructor(t){this.zoom=t.zoom,this.canonical=t.canonical,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(a=>a.id),this.index=t.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=t.projection,this.layoutVertexArray=new it,this.centroidVertexArray=new ca,this.indexArray=new Vt,this.programConfigurations=new rs(t.layers,t.zoom),this.segments=new Xi,this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id),this.enableTerrain=t.enableTerrain}populate(t,a,c,f){this.features=[],this.hasPattern=Cm("fill-extrusion",this.layers,a),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=function(g){let v=Math.exp(Math.PI*(1-g.y/(1<<g.z)*2));return 80150034*v/(v*v+1)/Wt/(1<<g.z)}(c),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;for(let{feature:g,id:v,index:C,sourceLayerIndex:I}of t){let A=this.layers[0]._featureFilter.needGeometry,F=As(g,A);if(!this.layers[0]._featureFilter.filter(new z(this.zoom),F,c))continue;let V={id:v,sourceLayerIndex:I,index:C,geometry:A?F.geometry:pa(g,c,f),properties:g.properties,type:g.type,patterns:{}},$=this.layoutVertexArray.length;this.hasPattern?this.features.push(zy("fill-extrusion",this.layers,V,this.zoom,a)):this.addFeature(V,V.geometry,C,c,{},a.availableImages,f),a.featureIndex.insert(g,V.geometry,C,I,this.index,$)}this.sortBorders()}addFeatures(t,a,c,f,g){for(let v of this.features){let{geometry:C}=v;this.addFeature(v,C,v.index,a,c,f,g)}this.sortBorders()}update(t,a,c,f){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,a,this.stateDependentLayers,c,f)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,s1),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=t.createVertexBuffer(this.layoutVertexExtArray,rb.members,!0))),this.programConfigurations.upload(t),this.uploaded=!0}uploadCentroid(t){this.centroidVertexArray.length!==0&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=t.createVertexBuffer(this.centroidVertexArray,o1.members,!0),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(t,a,c,f,g,v,C){let I=[new It(0,0),new It(Wt,Wt)],A=C.projection,F=A.name==="globe",V=this.enableTerrain&&!F?new p:null,$=f1[t.type]==="Polygon";F&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new gt);let W=Ny(a,500);for(let me=W.length-1;me>=0;me--){let Ce=W[me];(Ce.length===0||(q=Ce[0]).every(ge=>ge.x<=0)||q.every(ge=>ge.x>=Wt)||q.every(ge=>ge.y<=0)||q.every(ge=>ge.y>=Wt))&&W.splice(me,1)}var q;let ee;if(F)ee=N(W,I,f);else{ee=[];for(let me of W)ee.push({polygon:me,bounds:I})}let ae=$?this.edgeRadius:0;for(let{polygon:me,bounds:Ce}of ee){let ge=0,xe=0;for(let De of me)$&&!De[0].equals(De[De.length-1])&&De.push(De[0]),xe+=$?De.length-1:De.length;let Te=this.segments.prepareSegment(($?5:4)*xe,this.layoutVertexArray,this.indexArray);if($){let De=[],qe=[];ge=Te.vertexLength;for(let et of me){let vt,Ke;et.length&&et!==me[0]&&qe.push(De.length/2),vt=et[1].sub(et[0])._perp()._unit();for(let ot=1;ot<et.length;ot++){let st=et[ot],ft=et[ot===et.length-1?1:ot+1],{x:wt,y:Qe}=st;if(ae){Ke=ft.sub(st)._perp()._unit();let kt=vt.add(Ke)._unit(),Nt=ae*Math.min(4,1/(vt.x*kt.x+vt.y*kt.y));wt+=Nt*kt.x,Qe+=Nt*kt.y,vt=Ke}P(this.layoutVertexArray,wt,Qe,0,0,1,1,0),Te.vertexLength++,De.push(st.x,st.y),F&&d(this.layoutVertexExtArray,A.projectTilePoint(wt,Qe,f),A.upVector(f,wt,Qe))}}let We=Fy(De,qe);for(let et=0;et<We.length;et+=3)this.indexArray.emplaceBack(ge+We[et],ge+We[et+2],ge+We[et+1]),Te.primitiveLength++}for(let De of me){V&&De.length&&V.startRing(De[0]);let qe,We,et,vt=De.length>4&&S(De[De.length-2],De[0],De[1]),Ke=ae?w(De[De.length-2],De[0],De[1],ae):0;We=De[1].sub(De[0])._perp()._unit();let ot=!0;for(let st=1,ft=0;st<De.length;st++){let wt=De[st-1],Qe=De[st],kt=De[st===De.length-1?1:st+1];if(V&&$&&V.currentPolyCount.top++,T(Qe,wt,Ce)){ae&&(We=kt.sub(Qe)._perp()._unit(),ot=!ot);continue}V&&V.append(Qe,wt);let Nt=Qe.sub(wt)._perp(),Pt=Nt.x/(Math.abs(Nt.x)+Math.abs(Nt.y)),mn=Nt.y>0?1:0,Et=wt.dist(Qe);if(ft+Et>32768&&(ft=0),ae){et=kt.sub(Qe)._perp()._unit();let yn=M(wt,Qe,kt,b(We,et),ae);isNaN(yn)&&(yn=0);let tn=Qe.sub(wt)._unit();wt=wt.add(tn.mult(Ke))._round(),Qe=Qe.add(tn.mult(-yn))._round(),Ke=yn,We=et}let qt=Te.vertexLength,gn=De.length>4&&S(wt,Qe,kt),oi=O(ft,vt,ot);if(P(this.layoutVertexArray,wt.x,wt.y,Pt,mn,0,0,oi),P(this.layoutVertexArray,wt.x,wt.y,Pt,mn,0,1,oi),ft+=Et,oi=O(ft,gn,!ot),vt=gn,P(this.layoutVertexArray,Qe.x,Qe.y,Pt,mn,0,0,oi),P(this.layoutVertexArray,Qe.x,Qe.y,Pt,mn,0,1,oi),Te.vertexLength+=4,this.indexArray.emplaceBack(qt+0,qt+1,qt+2),this.indexArray.emplaceBack(qt+1,qt+3,qt+2),Te.primitiveLength+=2,ae){let yn=ge+(st===1?De.length-2:st-2),tn=st===1?ge:yn+1;if(this.indexArray.emplaceBack(qt+1,yn,qt+3),this.indexArray.emplaceBack(yn,tn,qt+3),Te.primitiveLength+=2,qe===void 0&&(qe=qt),!T(kt,De[st],Ce)){let Fi=st===De.length-1?qe:Te.vertexLength;this.indexArray.emplaceBack(qt+2,qt+3,Fi),this.indexArray.emplaceBack(qt+3,Fi+1,Fi),this.indexArray.emplaceBack(qt+3,tn,Fi+1),Te.primitiveLength+=3}ot=!ot}if(F){let yn=this.layoutVertexExtArray,tn=A.projectTilePoint(wt.x,wt.y,f),Fi=A.projectTilePoint(Qe.x,Qe.y,f),xn=A.upVector(f,wt.x,wt.y),wn=A.upVector(f,Qe.x,Qe.y);d(yn,tn,xn),d(yn,tn,xn),d(yn,Fi,wn),d(yn,Fi,wn)}}$&&(ge+=De.length-1)}}if(V&&V.polyCount.length>0){if(V.borders){V.vertexArrayOffset=this.centroidVertexArray.length;let me=V.borders,Ce=this.featuresOnBorder.push(V)-1;for(let ge=0;ge<4;ge++)me[ge][0]!==Number.MAX_VALUE&&this.borders[ge].push(Ce)}this.encodeCentroid(V.borders?void 0:V.centroid(),V)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,c,g,v,f)}sortBorders(){for(let t=0;t<4;t++)this.borders[t].sort((a,c)=>this.featuresOnBorder[a].borders[t][0]-this.featuresOnBorder[c].borders[t][0])}encodeCentroid(t,a,c=!0){let f,g;if(t)if(t.y!==0){let C=a.span()._mult(this.tileToMeter);f=(Math.max(t.x,1)<<3)+Math.min(7,Math.round(C.x/10)),g=(Math.max(t.y,1)<<3)+Math.min(7,Math.round(C.y/10))}else f=Math.ceil(7*(t.x+450)),g=0;else f=0,g=+c;let v=c?this.centroidVertexArray.length:a.vertexArrayOffset;for(let C of a.polyCount){c&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*C.edges+C.top);for(let I=0;I<C.top;I++)this.centroidVertexArray.emplace(v++,f,g);for(let I=0;I<2*C.edges;I++)this.centroidVertexArray.emplace(v++,0,g),this.centroidVertexArray.emplace(v++,f,g)}}}function b(o,t){let a=o.add(t)._unit();return o.x*a.x+o.y*a.y}function w(o,t,a,c){let f=t.sub(o)._perp()._unit(),g=a.sub(t)._perp()._unit();return M(o,t,a,b(f,g),c)}function M(o,t,a,c,f){let g=Math.sqrt(1-c*c);return Math.min(o.dist(t)/3,t.dist(a)/3,f*g/c)}function T(o,t,a){return o.x<a[0].x&&t.x<a[0].x||o.x>a[1].x&&t.x>a[1].x||o.y<a[0].y&&t.y<a[0].y||o.y>a[1].y&&t.y>a[1].y}function S(o,t,a){if(o.x<0||o.x>=Wt||t.x<0||t.x>=Wt||a.x<0||a.x>=Wt)return!1;let c=a.sub(t),f=c.perp(),g=o.sub(t);return(c.x*g.x+c.y*g.y)/Math.sqrt((c.x*c.x+c.y*c.y)*(g.x*g.x+g.y*g.y))>-.866&&f.x*g.x+f.y*g.y<0}function O(o,t,a){let c=t?2|o:-3&o;return a?1|c:-2&c}function B(){let o=Math.PI/32,t=Math.tan(o),a=zu;return a*Math.sqrt(1+2*t*t)-a}function N(o,t,a){let c=1<<a.z,f=ls(a.x/c),g=ls((a.x+1)/c),v=Xr(a.y/c),C=Xr((a.y+1)/c);return function(I,A,F,V,$=0,W){let q=[];if(!I.length||!F||!V)return q;let ee=(De,qe)=>{for(let We of De)q.push({polygon:We,bounds:qe})},ae=Math.ceil(Math.log2(F)),me=Math.ceil(Math.log2(V)),Ce=ae-me,ge=[];for(let De=0;De<Math.abs(Ce);De++)ge.push(Ce>0?0:1);for(let De=0;De<Math.min(ae,me);De++)ge.push(0),ge.push(1);let xe=I;if(xe=Em(xe,A[0].y-$,A[1].y+$,1),xe=Em(xe,A[0].x-$,A[1].x+$,0),!xe.length)return q;let Te=[];for(ge.length?Te.push({polygons:xe,bounds:A,depth:0}):ee(xe,A);Te.length;){let De=Te.pop(),qe=De.depth,We=ge[qe],et=De.bounds[0],vt=De.bounds[1],Ke=We===0?et.x:et.y,ot=We===0?vt.x:vt.y,st=W?W(We,Ke,ot):.5*(Ke+ot),ft=Em(De.polygons,Ke-$,st+$,We),wt=Em(De.polygons,st-$,ot+$,We);if(ft.length){let Qe=[et,new It(We===0?st:vt.x,We===1?st:vt.y)];ge.length>qe+1?Te.push({polygons:ft,bounds:Qe,depth:qe+1}):ee(ft,Qe)}if(wt.length){let Qe=[new It(We===0?st:et.x,We===1?st:et.y),vt];ge.length>qe+1?Te.push({polygons:wt,bounds:Qe,depth:qe+1}):ee(wt,Qe)}}return q}(o,t,Math.ceil((g-f)/11.25),Math.ceil((v-C)/11.25),1,(I,A,F)=>{if(I===0)return .5*(A+F);{let V=Xr((a.y+A/Wt)/c);return(Va(.5*(Xr((a.y+F/Wt)/c)+V))*c-a.y)*Wt}})}Ot(y,"FillExtrusionBucket",{omit:["layers","features"]}),Ot(p,"PartMetadata");let U=new _e({"fill-extrusion-edge-radius":new Q(Je["layout_fill-extrusion"]["fill-extrusion-edge-radius"])});var X={paint:new _e({"fill-extrusion-opacity":new Q(Je["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new ue(Je["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Q(Je["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Q(Je["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new ue(Je["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new ue(Je["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new ue(Je["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Q(Je["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new Q(Je["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new Q(Je["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-rounded-roof":new Q(Je["paint_fill-extrusion"]["fill-extrusion-rounded-roof"])}),layout:U};function Z(o,t,a){var c=2*Math.PI*6378137/256/Math.pow(2,a);return[o*c-2*Math.PI*6378137/2,t*c-2*Math.PI*6378137/2]}class te{constructor(t,a,c){this.z=t,this.x=a,this.y=c,this.key=ce(0,t,t,a,c)}equals(t){return this.z===t.z&&this.x===t.x&&this.y===t.y}url(t,a){let c=function(g,v,C){var I=Z(256*g,256*(v=Math.pow(2,C)-v-1),C),A=Z(256*(g+1),256*(v+1),C);return I[0]+","+I[1]+","+A[0]+","+A[1]}(this.x,this.y,this.z),f=function(g,v,C){let I,A="";for(let F=g;F>0;F--)I=1<<F-1,A+=(v&I?1:0)+(C&I?2:0);return A}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(a==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",f).replace("{bbox-epsg-3857}",c)}toString(){return`${this.z}/${this.x}/${this.y}`}}class ne{constructor(t,a){this.wrap=t,this.canonical=a,this.key=ce(t,a.z,a.z,a.x,a.y)}}class J{constructor(t,a,c,f,g){this.overscaledZ=t,this.wrap=a,this.canonical=new te(c,+f,+g),this.key=a===0&&t===c?this.canonical.key:ce(a,t,c,f,g)}equals(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)}scaledTo(t){let a=this.canonical.z-t;return t>this.canonical.z?new J(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new J(t,this.wrap,t,this.canonical.x>>a,this.canonical.y>>a)}calculateScaledKey(t,a=!0){if(this.overscaledZ===t&&a)return this.key;if(t>this.canonical.z)return ce(this.wrap*+a,t,this.canonical.z,this.canonical.x,this.canonical.y);{let c=this.canonical.z-t;return ce(this.wrap*+a,t,t,this.canonical.x>>c,this.canonical.y>>c)}}isChildOf(t){if(t.wrap!==this.wrap)return!1;let a=this.canonical.z-t.canonical.z;return t.overscaledZ===0||t.overscaledZ<this.overscaledZ&&t.canonical.x===this.canonical.x>>a&&t.canonical.y===this.canonical.y>>a}children(t){if(this.overscaledZ>=t)return[new J(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];let a=this.canonical.z+1,c=2*this.canonical.x,f=2*this.canonical.y;return[new J(a,this.wrap,a,c,f),new J(a,this.wrap,a,c+1,f),new J(a,this.wrap,a,c,f+1),new J(a,this.wrap,a,c+1,f+1)]}isLessThan(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))}wrapped(){return new J(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(t){return new J(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new ne(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function ce(o,t,a,c,f){let g=1<<Math.min(a,22),v=g*(f%g)+c%g;return o&&a<22&&(v+=g*g*((o<0?-2*o-1:2*o)%(1<<2*(22-a)))),16*(32*v+a)+(t-a)}Ot(te,"CanonicalTileID"),Ot(J,"OverscaledTileID",{omit:["projMatrix"]});class de extends It{constructor(t,a,c){super(t,a),this.z=c}}function ke(o,t){return o.x*t.x+o.y*t.y}function Ue(o,t){if(o.length===1){let a=0,c=t[a++],f;for(;!f||c.equals(f);)if(f=t[a++],!f)return 1/0;for(;a<t.length;a++){let g=t[a],v=o[0],C=f.sub(c),I=g.sub(c),A=v.sub(c),F=ke(C,C),V=ke(C,I),$=ke(I,I),W=ke(A,C),q=ke(A,I),ee=F*$-V*V,ae=($*W-V*q)/ee,me=(F*q-V*W)/ee,Ce=c.z*(1-ae-me)+f.z*ae+g.z*me;if(isFinite(Ce))return Ce}return 1/0}{let a=1/0;for(let c of t)a=Math.min(a,c.z);return a}}function Le(o,t,a,c,f,g,v,C){let I=v*f.getElevationAt(o,t,!0,!0),A=g[0]!==0,F=A?g[1]===0?v*(g[0]/7-450):v*function(V,$,W){let q=Math.floor($[0]/8),ee=Math.floor($[1]/8),ae=10*($[0]-8*q),me=10*($[1]-8*ee),Ce=V.getElevationAt(q,ee,!0,!0),ge=V.getMeterToDEM(W),xe=Math.floor(.5*(ae*ge-1)),Te=Math.floor(.5*(me*ge-1)),De=V.tileCoordToPixel(q,ee),qe=2*xe+1,We=2*Te+1,et=function(wt,Qe,kt,Nt,Pt){return[wt.getElevationAtPixel(Qe,kt,!0),wt.getElevationAtPixel(Qe+Pt,kt,!0),wt.getElevationAtPixel(Qe,kt+Pt,!0),wt.getElevationAtPixel(Qe+Nt,kt+Pt,!0)]}(V,De.x-xe,De.y-Te,qe,We),vt=Math.abs(et[0]-et[1]),Ke=Math.abs(et[2]-et[3]),ot=Math.abs(et[0]-et[2])+Math.abs(et[1]-et[3]),st=Math.min(.25,.5*ge*(vt+Ke)/qe),ft=Math.min(.25,.5*ge*ot/We);return Ce+Math.max(st*ae,ft*me)}(f,g,C):I;return{base:I+(a===0)?-1:a,top:A?Math.max(F+c,I+a+2):I+c}}let Se=Fe([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:ze}=Se,nt=Fe([{name:"a_packed",components:4,type:"Float32"}]),{members:rt}=nt,pt=Gu.types,Bt=Math.cos(Math.PI/180*37.5);class Lt{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(a=>a.id),this.index=t.index,this.projection=t.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(a=>{this.gradients[a.id]={}}),this.layoutVertexArray=new Ze,this.layoutVertexArray2=new ht,this.indexArray=new Vt,this.programConfigurations=new rs(t.layers,t.zoom),this.segments=new Xi,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id)}populate(t,a,c,f){this.hasPattern=Cm("line",this.layers,a);let g=this.layers[0].layout.get("line-sort-key"),v=[];for(let{feature:F,id:V,index:$,sourceLayerIndex:W}of t){let q=this.layers[0]._featureFilter.needGeometry,ee=As(F,q);if(!this.layers[0]._featureFilter.filter(new z(this.zoom),ee,c))continue;let ae=g?g.evaluate(ee,{},c):void 0,me={id:V,properties:F.properties,type:F.type,sourceLayerIndex:W,index:$,geometry:q?ee.geometry:pa(F,c,f),patterns:{},sortKey:ae};v.push(me)}g&&v.sort((F,V)=>F.sortKey-V.sortKey);let{lineAtlas:C,featureIndex:I}=a,A=this.addConstantDashes(C);for(let F of v){let{geometry:V,index:$,sourceLayerIndex:W}=F;if(A&&this.addFeatureDashes(F,C),this.hasPattern){let q=zy("line",this.layers,F,this.zoom,a);this.patternFeatures.push(q)}else this.addFeature(F,V,$,c,C.positions,a.availableImages);I.insert(t[$].feature,V,$,W,this.index)}}addConstantDashes(t){let a=!1;for(let c of this.layers){let f=c.paint.get("line-dasharray").value,g=c.layout.get("line-cap").value;if(f.kind!=="constant"||g.kind!=="constant")a=!0;else{let v=g.value,C=f.value;if(!C)continue;t.addDash(C,v)}}return a}addFeatureDashes(t,a){let c=this.zoom;for(let f of this.layers){let g=f.paint.get("line-dasharray").value,v=f.layout.get("line-cap").value;if(g.kind==="constant"&&v.kind==="constant")continue;let C,I;if(g.kind==="constant"){if(C=g.value,!C)continue}else C=g.evaluate({zoom:c},t);I=v.kind==="constant"?v.value:v.evaluate({zoom:c},t),a.addDash(C,I),t.patterns[f.id]=a.getKey(C,I)}}update(t,a,c,f){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,a,this.stateDependentLayers,c,f)}addFeatures(t,a,c,f,g){for(let v of this.patternFeatures)this.addFeature(v,v.geometry,v.index,a,c,f)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,rt)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,ze),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(t){if(t.properties&&t.properties.hasOwnProperty("mapbox_clip_start")&&t.properties.hasOwnProperty("mapbox_clip_end"))return{start:+t.properties.mapbox_clip_start,end:+t.properties.mapbox_clip_end}}addFeature(t,a,c,f,g,v){let C=this.layers[0].layout,I=C.get("line-join").evaluate(t,{}),A=C.get("line-cap").evaluate(t,{}),F=C.get("line-miter-limit"),V=C.get("line-round-limit");this.lineClips=this.lineFeatureClips(t);for(let $ of a)this.addLine($,t,I,A,F,V);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,c,g,v,f)}addLine(t,a,c,f,g,v){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let me=0;me<t.length-1;me++)this.totalDistance+=t[me].dist(t[me+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}let C=pt[a.type]==="Polygon",I=t.length;for(;I>=2&&t[I-1].equals(t[I-2]);)I--;let A=0;for(;A<I-1&&t[A].equals(t[A+1]);)A++;if(I<(C?3:2))return;c==="bevel"&&(g=1.05);let F=this.overscaling<=16?15*Wt/(512*this.overscaling):0,V=this.segments.prepareSegment(10*I,this.layoutVertexArray,this.indexArray),$,W,q,ee,ae;this.e1=this.e2=-1,C&&($=t[I-2],ae=t[A].sub($)._unit()._perp());for(let me=A;me<I;me++){if(q=me===I-1?C?t[A+1]:void 0:t[me+1],q&&t[me].equals(q))continue;ae&&(ee=ae),$&&(W=$),$=t[me],ae=q?q.sub($)._unit()._perp():ee,ee=ee||ae;let Ce=ee.add(ae);Ce.x===0&&Ce.y===0||Ce._unit();let ge=ee.x*ae.x+ee.y*ae.y,xe=Ce.x*ae.x+Ce.y*ae.y,Te=xe!==0?1/xe:1/0,De=2*Math.sqrt(2-2*xe),qe=xe<Bt&&W&&q,We=ee.x*ae.y-ee.y*ae.x>0;if(qe&&me>A){let Ke=$.dist(W);if(Ke>2*F){let ot=$.sub($.sub(W)._mult(F/Ke)._round());this.updateDistance(W,ot),this.addCurrentVertex(ot,ee,0,0,V),W=ot}}let et=W&&q,vt=et?c:C?"butt":f;if(et&&vt==="round"&&(Te<v?vt="miter":Te<=2&&(vt="fakeround")),vt==="miter"&&Te>g&&(vt="bevel"),vt==="bevel"&&(Te>2&&(vt="flipbevel"),Te<g&&(vt="miter")),W&&this.updateDistance(W,$),vt==="miter")Ce._mult(Te),this.addCurrentVertex($,Ce,0,0,V);else if(vt==="flipbevel"){if(Te>100)Ce=ae.mult(-1);else{let Ke=Te*ee.add(ae).mag()/ee.sub(ae).mag();Ce._perp()._mult(Ke*(We?-1:1))}this.addCurrentVertex($,Ce,0,0,V),this.addCurrentVertex($,Ce.mult(-1),0,0,V)}else if(vt==="bevel"||vt==="fakeround"){let Ke=-Math.sqrt(Te*Te-1),ot=We?Ke:0,st=We?0:Ke;if(W&&this.addCurrentVertex($,ee,ot,st,V),vt==="fakeround"){let ft=Math.round(180*De/Math.PI/20);for(let wt=1;wt<ft;wt++){let Qe=wt/ft;if(Qe!==.5){let Nt=Qe-.5;Qe+=Qe*Nt*(Qe-1)*((1.0904+ge*(ge*(3.55645-1.43519*ge)-3.2452))*Nt*Nt+(.848013+ge*(.215638*ge-1.06021)))}let kt=ae.sub(ee)._mult(Qe)._add(ee)._unit()._mult(We?-1:1);this.addHalfVertex($,kt.x,kt.y,!1,We,0,V)}}q&&this.addCurrentVertex($,ae,-ot,-st,V)}else if(vt==="butt")this.addCurrentVertex($,Ce,0,0,V);else if(vt==="square"){let Ke=W?1:-1;W||this.addCurrentVertex($,Ce,Ke,Ke,V),this.addCurrentVertex($,Ce,0,0,V),W&&this.addCurrentVertex($,Ce,Ke,Ke,V)}else vt==="round"&&(W&&(this.addCurrentVertex($,ee,0,0,V),this.addCurrentVertex($,ee,1,1,V,!0)),q&&(this.addCurrentVertex($,ae,-1,-1,V,!0),this.addCurrentVertex($,ae,0,0,V)));if(qe&&me<I-1){let Ke=$.dist(q);if(Ke>2*F){let ot=$.add(q.sub($)._mult(F/Ke)._round());this.updateDistance($,ot),this.addCurrentVertex(ot,ae,0,0,V),$=ot}}}}addCurrentVertex(t,a,c,f,g,v=!1){let C=a.y*f-a.x,I=-a.y-a.x*f;this.addHalfVertex(t,a.x+a.y*c,a.y-a.x*c,v,!1,c,g),this.addHalfVertex(t,C,I,v,!0,-f,g)}addHalfVertex({x:t,y:a},c,f,g,v,C,I){this.layoutVertexArray.emplaceBack((t<<1)+(g?1:0),(a<<1)+(v?1:0),Math.round(63*c)+128,Math.round(63*f)+128,1+(C===0?0:C<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);let A=I.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,A),I.primitiveLength++),v?this.e2=A:this.e1=A}updateScaledDistance(){if(this.lineClips){let t=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=t*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(t,a){this.distance+=t.dist(a),this.updateScaledDistance()}}Ot(Lt,"LineBucket",{omit:["layers","patternFeatures"]});let jt=new _e({"line-cap":new ue(Je.layout_line["line-cap"]),"line-join":new ue(Je.layout_line["line-join"]),"line-miter-limit":new Q(Je.layout_line["line-miter-limit"]),"line-round-limit":new Q(Je.layout_line["line-round-limit"]),"line-sort-key":new ue(Je.layout_line["line-sort-key"])});var Yt={paint:new _e({"line-opacity":new ue(Je.paint_line["line-opacity"]),"line-color":new ue(Je.paint_line["line-color"]),"line-translate":new Q(Je.paint_line["line-translate"]),"line-translate-anchor":new Q(Je.paint_line["line-translate-anchor"]),"line-width":new ue(Je.paint_line["line-width"]),"line-gap-width":new ue(Je.paint_line["line-gap-width"]),"line-offset":new ue(Je.paint_line["line-offset"]),"line-blur":new ue(Je.paint_line["line-blur"]),"line-dasharray":new ue(Je.paint_line["line-dasharray"]),"line-pattern":new ue(Je.paint_line["line-pattern"]),"line-gradient":new ye(Je.paint_line["line-gradient"]),"line-trim-offset":new Q(Je.paint_line["line-trim-offset"])}),layout:jt};let zt=new class extends ue{possiblyEvaluate(o,t){return t=new z(Math.floor(t.zoom),{now:t.now,fadeDuration:t.fadeDuration,transition:t.transition}),super.possiblyEvaluate(o,t)}evaluate(o,t,a,c){return t=Bi({},t,{zoom:Math.floor(t.zoom)}),super.evaluate(o,t,a,c)}}(Yt.paint.properties["line-width"].specification);function Sn(o,t){return t>0?t+2*o:o}zt.useIntegerZoom=!0;let hn=Fe([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),fn=Fe([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),qn=Fe([{name:"a_projected_pos",components:4,type:"Float32"}],4);Fe([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);let an=Fe([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),br=Fe([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);Fe([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);let Ki=Fe([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),ei=Fe([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);Fe([{name:"triangle",components:3,type:"Uint16"}]),Fe([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),Fe([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Fe([{type:"Float32",name:"offsetX"}]),Fe([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var An=24;let wi=128;function ji(o,t){let{expression:a}=t;if(a.kind==="constant")return{kind:"constant",layoutSize:a.evaluate(new z(o+1))};if(a.kind==="source")return{kind:"source"};{let{zoomStops:c,interpolationType:f}=a,g=0;for(;g<c.length&&c[g]<=o;)g++;g=Math.max(0,g-1);let v=g;for(;v<c.length&&c[v]<o+1;)v++;v=Math.min(c.length-1,v);let C=c[g],I=c[v];return a.kind==="composite"?{kind:"composite",minZoom:C,maxZoom:I,interpolationType:f}:{kind:"camera",minZoom:C,maxZoom:I,minSize:a.evaluate(new z(C)),maxSize:a.evaluate(new z(I)),interpolationType:f}}}function Pr(o,{uSize:t,uSizeT:a},{lowerSize:c,upperSize:f}){return o.kind==="source"?c/wi:o.kind==="composite"?Fn(c/wi,f/wi,a):t}function Qi(o,t){let a=0,c=0;if(o.kind==="constant")c=o.layoutSize;else if(o.kind!=="source"){let{interpolationType:f,minZoom:g,maxZoom:v}=o,C=f?Tn(io.interpolationFactor(f,t,g,v),0,1):0;o.kind==="camera"?c=Fn(o.minSize,o.maxSize,C):a=C}return{uSizeT:a,uSize:c}}var So=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:wi,evaluateSizeForFeature:Pr,evaluateSizeForZoom:Qi,getSizeData:ji});function $a(o,t,a){return o.sections.forEach(c=>{c.text=function(f,g,v){let C=g.layout.get("text-transform").evaluate(v,{});return C==="uppercase"?f=f.toLocaleUpperCase():C==="lowercase"&&(f=f.toLocaleLowerCase()),R.applyArabicShaping&&(f=R.applyArabicShaping(f)),f}(c.text,t,a)}),o}let ks={"!":"\uFE15","#":"\uFF03",$:"\uFF04","%":"\uFF05","&":"\uFF06","(":"\uFE35",")":"\uFE36","*":"\uFF0A","+":"\uFF0B",",":"\uFE10","-":"\uFE32",".":"\u30FB","/":"\uFF0F",":":"\uFE13",";":"\uFE14","<":"\uFE3F","=":"\uFF1D",">":"\uFE40","?":"\uFE16","@":"\uFF20","[":"\uFE47","\\":"\uFF3C","]":"\uFE48","^":"\uFF3E",_:"\uFE33","`":"\uFF40","{":"\uFE37","|":"\u2015","}":"\uFE38","~":"\uFF5E","\xA2":"\uFFE0","\xA3":"\uFFE1","\xA5":"\uFFE5","\xA6":"\uFFE4","\xAC":"\uFFE2","\xAF":"\uFFE3","\u2013":"\uFE32","\u2014":"\uFE31","\u2018":"\uFE43","\u2019":"\uFE44","\u201C":"\uFE41","\u201D":"\uFE42","\u2026":"\uFE19","\u2027":"\u30FB","\u20A9":"\uFFE6","\u3001":"\uFE11","\u3002":"\uFE12","\u3008":"\uFE3F","\u3009":"\uFE40","\u300A":"\uFE3D","\u300B":"\uFE3E","\u300C":"\uFE41","\u300D":"\uFE42","\u300E":"\uFE43","\u300F":"\uFE44","\u3010":"\uFE3B","\u3011":"\uFE3C","\u3014":"\uFE39","\u3015":"\uFE3A","\u3016":"\uFE17","\u3017":"\uFE18","\uFF01":"\uFE15","\uFF08":"\uFE35","\uFF09":"\uFE36","\uFF0C":"\uFE10","\uFF0D":"\uFE32","\uFF0E":"\u30FB","\uFF1A":"\uFE13","\uFF1B":"\uFE14","\uFF1C":"\uFE3F","\uFF1E":"\uFE40","\uFF1F":"\uFE16","\uFF3B":"\uFE47","\uFF3D":"\uFE48","\uFF3F":"\uFE33","\uFF5B":"\uFE37","\uFF5C":"\u2015","\uFF5D":"\uFE38","\uFF5F":"\uFE35","\uFF60":"\uFE36","\uFF61":"\uFE12","\uFF62":"\uFE41","\uFF63":"\uFE42","\u2190":"\u2191","\u2192":"\u2193"};function zf(o){return o==="\uFE36"||o==="\uFE48"||o==="\uFE38"||o==="\uFE44"||o==="\uFE42"||o==="\uFE3E"||o==="\uFE3C"||o==="\uFE3A"||o==="\uFE18"||o==="\uFE40"||o==="\uFE10"||o==="\uFE13"||o==="\uFE14"||o==="\uFF40"||o==="\uFFE3"||o==="\uFE11"||o==="\uFE12"}function Dm(o){return o==="\uFE35"||o==="\uFE47"||o==="\uFE37"||o==="\uFE43"||o==="\uFE41"||o==="\uFE3D"||o==="\uFE3B"||o==="\uFE39"||o==="\uFE17"||o==="\uFE3F"}var Wu=Ai,Uy=function(o,t,a,c,f){var g,v,C=8*f-c-1,I=(1<<C)-1,A=I>>1,F=-7,V=a?f-1:0,$=a?-1:1,W=o[t+V];for(V+=$,g=W&(1<<-F)-1,W>>=-F,F+=C;F>0;g=256*g+o[t+V],V+=$,F-=8);for(v=g&(1<<-F)-1,g>>=-F,F+=c;F>0;v=256*v+o[t+V],V+=$,F-=8);if(g===0)g=1-A;else{if(g===I)return v?NaN:1/0*(W?-1:1);v+=Math.pow(2,c),g-=A}return(W?-1:1)*v*Math.pow(2,g-c)},$y=function(o,t,a,c,f,g){var v,C,I,A=8*g-f-1,F=(1<<A)-1,V=F>>1,$=f===23?Math.pow(2,-24)-Math.pow(2,-77):0,W=c?0:g-1,q=c?1:-1,ee=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(C=isNaN(t)?1:0,v=F):(v=Math.floor(Math.log(t)/Math.LN2),t*(I=Math.pow(2,-v))<1&&(v--,I*=2),(t+=v+V>=1?$/I:$*Math.pow(2,1-V))*I>=2&&(v++,I/=2),v+V>=F?(C=0,v=F):v+V>=1?(C=(t*I-1)*Math.pow(2,f),v+=V):(C=t*Math.pow(2,V-1)*Math.pow(2,f),v=0));f>=8;o[a+W]=255&C,W+=q,C/=256,f-=8);for(v=v<<f|C,A+=f;A>0;o[a+W]=255&v,W+=q,v/=256,A-=8);o[a+W-q]|=128*ee};function Ai(o){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(o)?o:new Uint8Array(o||0),this.pos=0,this.type=0,this.length=this.buf.length}Ai.Varint=0,Ai.Fixed64=1,Ai.Bytes=2,Ai.Fixed32=5;var m1=4294967296,AT=1/m1,kT=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function qu(o){return o.type===Ai.Bytes?o.readVarint()+o.pos:o.pos+1}function Mm(o,t,a){return a?4294967296*t+(o>>>0):4294967296*(t>>>0)+(o>>>0)}function RT(o,t,a){var c=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));a.realloc(c);for(var f=a.pos-1;f>=o;f--)a.buf[f+c]=a.buf[f]}function KL(o,t){for(var a=0;a<o.length;a++)t.writeVarint(o[a])}function QL(o,t){for(var a=0;a<o.length;a++)t.writeSVarint(o[a])}function JL(o,t){for(var a=0;a<o.length;a++)t.writeFloat(o[a])}function eF(o,t){for(var a=0;a<o.length;a++)t.writeDouble(o[a])}function tF(o,t){for(var a=0;a<o.length;a++)t.writeBoolean(o[a])}function nF(o,t){for(var a=0;a<o.length;a++)t.writeFixed32(o[a])}function iF(o,t){for(var a=0;a<o.length;a++)t.writeSFixed32(o[a])}function rF(o,t){for(var a=0;a<o.length;a++)t.writeFixed64(o[a])}function oF(o,t){for(var a=0;a<o.length;a++)t.writeSFixed64(o[a])}function ab(o,t){return(o[t]|o[t+1]<<8|o[t+2]<<16)+16777216*o[t+3]}function Tm(o,t,a){o[a]=t,o[a+1]=t>>>8,o[a+2]=t>>>16,o[a+3]=t>>>24}function PT(o,t){return(o[t]|o[t+1]<<8|o[t+2]<<16)+(o[t+3]<<24)}Ai.prototype={destroy:function(){this.buf=null},readFields:function(o,t,a){for(a=a||this.length;this.pos<a;){var c=this.readVarint(),f=c>>3,g=this.pos;this.type=7&c,o(f,t,this),this.pos===g&&this.skip(c)}return t},readMessage:function(o,t){return this.readFields(o,t,this.readVarint()+this.pos)},readFixed32:function(){var o=ab(this.buf,this.pos);return this.pos+=4,o},readSFixed32:function(){var o=PT(this.buf,this.pos);return this.pos+=4,o},readFixed64:function(){var o=ab(this.buf,this.pos)+ab(this.buf,this.pos+4)*m1;return this.pos+=8,o},readSFixed64:function(){var o=ab(this.buf,this.pos)+PT(this.buf,this.pos+4)*m1;return this.pos+=8,o},readFloat:function(){var o=Uy(this.buf,this.pos,!0,23,4);return this.pos+=4,o},readDouble:function(){var o=Uy(this.buf,this.pos,!0,52,8);return this.pos+=8,o},readVarint:function(o){var t,a,c=this.buf;return t=127&(a=c[this.pos++]),a<128?t:(t|=(127&(a=c[this.pos++]))<<7,a<128?t:(t|=(127&(a=c[this.pos++]))<<14,a<128?t:(t|=(127&(a=c[this.pos++]))<<21,a<128?t:function(f,g,v){var C,I,A=v.buf;if(C=(112&(I=A[v.pos++]))>>4,I<128||(C|=(127&(I=A[v.pos++]))<<3,I<128)||(C|=(127&(I=A[v.pos++]))<<10,I<128)||(C|=(127&(I=A[v.pos++]))<<17,I<128)||(C|=(127&(I=A[v.pos++]))<<24,I<128)||(C|=(1&(I=A[v.pos++]))<<31,I<128))return Mm(f,C,g);throw new Error("Expected varint not more than 10 bytes")}(t|=(15&(a=c[this.pos]))<<28,o,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var o=this.readVarint();return o%2==1?(o+1)/-2:o/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var o=this.readVarint()+this.pos,t=this.pos;return this.pos=o,o-t>=12&&kT?function(a,c,f){return kT.decode(a.subarray(c,f))}(this.buf,t,o):function(a,c,f){for(var g="",v=c;v<f;){var C,I,A,F=a[v],V=null,$=F>239?4:F>223?3:F>191?2:1;if(v+$>f)break;$===1?F<128&&(V=F):$===2?(192&(C=a[v+1]))==128&&(V=(31&F)<<6|63&C)<=127&&(V=null):$===3?(I=a[v+2],(192&(C=a[v+1]))==128&&(192&I)==128&&((V=(15&F)<<12|(63&C)<<6|63&I)<=2047||V>=55296&&V<=57343)&&(V=null)):$===4&&(I=a[v+2],A=a[v+3],(192&(C=a[v+1]))==128&&(192&I)==128&&(192&A)==128&&((V=(15&F)<<18|(63&C)<<12|(63&I)<<6|63&A)<=65535||V>=1114112)&&(V=null)),V===null?(V=65533,$=1):V>65535&&(V-=65536,g+=String.fromCharCode(V>>>10&1023|55296),V=56320|1023&V),g+=String.fromCharCode(V),v+=$}return g}(this.buf,t,o)},readBytes:function(){var o=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,o);return this.pos=o,t},readPackedVarint:function(o,t){if(this.type!==Ai.Bytes)return o.push(this.readVarint(t));var a=qu(this);for(o=o||[];this.pos<a;)o.push(this.readVarint(t));return o},readPackedSVarint:function(o){if(this.type!==Ai.Bytes)return o.push(this.readSVarint());var t=qu(this);for(o=o||[];this.pos<t;)o.push(this.readSVarint());return o},readPackedBoolean:function(o){if(this.type!==Ai.Bytes)return o.push(this.readBoolean());var t=qu(this);for(o=o||[];this.pos<t;)o.push(this.readBoolean());return o},readPackedFloat:function(o){if(this.type!==Ai.Bytes)return o.push(this.readFloat());var t=qu(this);for(o=o||[];this.pos<t;)o.push(this.readFloat());return o},readPackedDouble:function(o){if(this.type!==Ai.Bytes)return o.push(this.readDouble());var t=qu(this);for(o=o||[];this.pos<t;)o.push(this.readDouble());return o},readPackedFixed32:function(o){if(this.type!==Ai.Bytes)return o.push(this.readFixed32());var t=qu(this);for(o=o||[];this.pos<t;)o.push(this.readFixed32());return o},readPackedSFixed32:function(o){if(this.type!==Ai.Bytes)return o.push(this.readSFixed32());var t=qu(this);for(o=o||[];this.pos<t;)o.push(this.readSFixed32());return o},readPackedFixed64:function(o){if(this.type!==Ai.Bytes)return o.push(this.readFixed64());var t=qu(this);for(o=o||[];this.pos<t;)o.push(this.readFixed64());return o},readPackedSFixed64:function(o){if(this.type!==Ai.Bytes)return o.push(this.readSFixed64());var t=qu(this);for(o=o||[];this.pos<t;)o.push(this.readSFixed64());return o},skip:function(o){var t=7&o;if(t===Ai.Varint)for(;this.buf[this.pos++]>127;);else if(t===Ai.Bytes)this.pos=this.readVarint()+this.pos;else if(t===Ai.Fixed32)this.pos+=4;else{if(t!==Ai.Fixed64)throw new Error("Unimplemented type: "+t);this.pos+=8}},writeTag:function(o,t){this.writeVarint(o<<3|t)},realloc:function(o){for(var t=this.length||16;t<this.pos+o;)t*=2;if(t!==this.length){var a=new Uint8Array(t);a.set(this.buf),this.buf=a,this.length=t}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(o){this.realloc(4),Tm(this.buf,o,this.pos),this.pos+=4},writeSFixed32:function(o){this.realloc(4),Tm(this.buf,o,this.pos),this.pos+=4},writeFixed64:function(o){this.realloc(8),Tm(this.buf,-1&o,this.pos),Tm(this.buf,Math.floor(o*AT),this.pos+4),this.pos+=8},writeSFixed64:function(o){this.realloc(8),Tm(this.buf,-1&o,this.pos),Tm(this.buf,Math.floor(o*AT),this.pos+4),this.pos+=8},writeVarint:function(o){(o=+o||0)>268435455||o<0?function(t,a){var c,f;if(t>=0?(c=t%4294967296|0,f=t/4294967296|0):(f=~(-t/4294967296),4294967295^(c=~(-t%4294967296))?c=c+1|0:(c=0,f=f+1|0)),t>=18446744073709552e3||t<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");a.realloc(10),function(g,v,C){C.buf[C.pos++]=127&g|128,g>>>=7,C.buf[C.pos++]=127&g|128,g>>>=7,C.buf[C.pos++]=127&g|128,g>>>=7,C.buf[C.pos++]=127&g|128,C.buf[C.pos]=127&(g>>>=7)}(c,0,a),function(g,v){var C=(7&g)<<4;v.buf[v.pos++]|=C|((g>>>=3)?128:0),g&&(v.buf[v.pos++]=127&g|((g>>>=7)?128:0),g&&(v.buf[v.pos++]=127&g|((g>>>=7)?128:0),g&&(v.buf[v.pos++]=127&g|((g>>>=7)?128:0),g&&(v.buf[v.pos++]=127&g|((g>>>=7)?128:0),g&&(v.buf[v.pos++]=127&g)))))}(f,a)}(o,this):(this.realloc(4),this.buf[this.pos++]=127&o|(o>127?128:0),o<=127||(this.buf[this.pos++]=127&(o>>>=7)|(o>127?128:0),o<=127||(this.buf[this.pos++]=127&(o>>>=7)|(o>127?128:0),o<=127||(this.buf[this.pos++]=o>>>7&127))))},writeSVarint:function(o){this.writeVarint(o<0?2*-o-1:2*o)},writeBoolean:function(o){this.writeVarint(!!o)},writeString:function(o){o=String(o),this.realloc(4*o.length),this.pos++;var t=this.pos;this.pos=function(c,f,g){for(var v,C,I=0;I<f.length;I++){if((v=f.charCodeAt(I))>55295&&v<57344){if(!C){v>56319||I+1===f.length?(c[g++]=239,c[g++]=191,c[g++]=189):C=v;continue}if(v<56320){c[g++]=239,c[g++]=191,c[g++]=189,C=v;continue}v=C-55296<<10|v-56320|65536,C=null}else C&&(c[g++]=239,c[g++]=191,c[g++]=189,C=null);v<128?c[g++]=v:(v<2048?c[g++]=v>>6|192:(v<65536?c[g++]=v>>12|224:(c[g++]=v>>18|240,c[g++]=v>>12&63|128),c[g++]=v>>6&63|128),c[g++]=63&v|128)}return g}(this.buf,o,this.pos);var a=this.pos-t;a>=128&&RT(t,a,this),this.pos=t-1,this.writeVarint(a),this.pos+=a},writeFloat:function(o){this.realloc(4),$y(this.buf,o,this.pos,!0,23,4),this.pos+=4},writeDouble:function(o){this.realloc(8),$y(this.buf,o,this.pos,!0,52,8),this.pos+=8},writeBytes:function(o){var t=o.length;this.writeVarint(t),this.realloc(t);for(var a=0;a<t;a++)this.buf[this.pos++]=o[a]},writeRawMessage:function(o,t){this.pos++;var a=this.pos;o(t,this);var c=this.pos-a;c>=128&&RT(a,c,this),this.pos=a-1,this.writeVarint(c),this.pos+=c},writeMessage:function(o,t,a){this.writeTag(o,Ai.Bytes),this.writeRawMessage(t,a)},writePackedVarint:function(o,t){t.length&&this.writeMessage(o,KL,t)},writePackedSVarint:function(o,t){t.length&&this.writeMessage(o,QL,t)},writePackedBoolean:function(o,t){t.length&&this.writeMessage(o,tF,t)},writePackedFloat:function(o,t){t.length&&this.writeMessage(o,JL,t)},writePackedDouble:function(o,t){t.length&&this.writeMessage(o,eF,t)},writePackedFixed32:function(o,t){t.length&&this.writeMessage(o,nF,t)},writePackedSFixed32:function(o,t){t.length&&this.writeMessage(o,iF,t)},writePackedFixed64:function(o,t){t.length&&this.writeMessage(o,rF,t)},writePackedSFixed64:function(o,t){t.length&&this.writeMessage(o,oF,t)},writeBytesField:function(o,t){this.writeTag(o,Ai.Bytes),this.writeBytes(t)},writeFixed32Field:function(o,t){this.writeTag(o,Ai.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(o,t){this.writeTag(o,Ai.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(o,t){this.writeTag(o,Ai.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(o,t){this.writeTag(o,Ai.Fixed64),this.writeSFixed64(t)},writeVarintField:function(o,t){this.writeTag(o,Ai.Varint),this.writeVarint(t)},writeSVarintField:function(o,t){this.writeTag(o,Ai.Varint),this.writeSVarint(t)},writeStringField:function(o,t){this.writeTag(o,Ai.Bytes),this.writeString(t)},writeFloatField:function(o,t){this.writeTag(o,Ai.Fixed32),this.writeFloat(t)},writeDoubleField:function(o,t){this.writeTag(o,Ai.Fixed64),this.writeDouble(t)},writeBooleanField:function(o,t){this.writeVarintField(o,!!t)}};var lb=Qt(Wu);let g1=3;function sF(o,t,a){t.glyphs=[],o===1&&a.readMessage(aF,t)}function aF(o,t,a){if(o===3){let{id:c,bitmap:f,width:g,height:v,left:C,top:I,advance:A}=a.readMessage(lF,{});t.glyphs.push({id:c,bitmap:new Vl({width:g+2*g1,height:v+2*g1},f),metrics:{width:g,height:v,left:C,top:I,advance:A}})}else o===4?t.ascender=a.readSVarint():o===5&&(t.descender=a.readSVarint())}function lF(o,t,a){o===1?t.id=a.readVarint():o===2?t.bitmap=a.readBytes():o===3?t.width=a.readVarint():o===4?t.height=a.readVarint():o===5?t.left=a.readSVarint():o===6?t.top=a.readSVarint():o===7&&(t.advance=a.readVarint())}let OT=g1;function y1(o){let t=0,a=0;for(let v of o)t+=v.w*v.h,a=Math.max(a,v.w);o.sort((v,C)=>C.h-v.h);let c=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),a),h:1/0}],f=0,g=0;for(let v of o)for(let C=c.length-1;C>=0;C--){let I=c[C];if(!(v.w>I.w||v.h>I.h)){if(v.x=I.x,v.y=I.y,g=Math.max(g,v.y+v.h),f=Math.max(f,v.x+v.w),v.w===I.w&&v.h===I.h){let A=c.pop();C<c.length&&(c[C]=A)}else v.h===I.h?(I.x+=v.w,I.w-=v.w):v.w===I.w?(I.y+=v.h,I.h-=v.h):(c.push({x:I.x+v.w,y:I.y,w:I.w-v.w,h:v.h}),I.y+=v.h,I.h-=v.h);break}}return{w:f,h:g,fill:t/(f*g)||0}}let cs=1;class _1{constructor(t,{pixelRatio:a,version:c,stretchX:f,stretchY:g,content:v}){this.paddedRect=t,this.pixelRatio=a,this.stretchX=f,this.stretchY=g,this.content=v,this.version=c}get tl(){return[this.paddedRect.x+cs,this.paddedRect.y+cs]}get br(){return[this.paddedRect.x+this.paddedRect.w-cs,this.paddedRect.y+this.paddedRect.h-cs]}get displaySize(){return[(this.paddedRect.w-2*cs)/this.pixelRatio,(this.paddedRect.h-2*cs)/this.pixelRatio]}}class LT{constructor(t,a){let c={},f={};this.haveRenderCallbacks=[];let g=[];this.addImages(t,c,g),this.addImages(a,f,g);let{w:v,h:C}=y1(g),I=new oo({width:v||1,height:C||1});for(let A in t){let F=t[A],V=c[A].paddedRect;oo.copy(F.data,I,{x:0,y:0},{x:V.x+cs,y:V.y+cs},F.data)}for(let A in a){let F=a[A],V=f[A].paddedRect,$=V.x+cs,W=V.y+cs,q=F.data.width,ee=F.data.height;oo.copy(F.data,I,{x:0,y:0},{x:$,y:W},F.data),oo.copy(F.data,I,{x:0,y:ee-1},{x:$,y:W-1},{width:q,height:1}),oo.copy(F.data,I,{x:0,y:0},{x:$,y:W+ee},{width:q,height:1}),oo.copy(F.data,I,{x:q-1,y:0},{x:$-1,y:W},{width:1,height:ee}),oo.copy(F.data,I,{x:0,y:0},{x:$+q,y:W},{width:1,height:ee})}this.image=I,this.iconPositions=c,this.patternPositions=f}addImages(t,a,c){for(let f in t){let g=t[f],v={x:0,y:0,w:g.data.width+2*cs,h:g.data.height+2*cs};c.push(v),a[f]=new _1(v,g),g.hasRenderCallback&&this.haveRenderCallbacks.push(f)}}patchUpdatedImages(t,a){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(c=>t.hasImage(c)),t.dispatchRenderCallbacks(this.haveRenderCallbacks);for(let c in t.updatedImages)this.patchUpdatedImage(this.iconPositions[c],t.getImage(c),a),this.patchUpdatedImage(this.patternPositions[c],t.getImage(c),a)}patchUpdatedImage(t,a,c){if(!t||!a||t.version===a.version)return;t.version=a.version;let[f,g]=t.tl;c.update(a.data,void 0,{x:f,y:g})}}Ot(_1,"ImagePosition"),Ot(LT,"ImageAtlas");let ma={horizontal:1,vertical:2,horizontalOnly:3},FT=-17;class Hy{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(t,a){let c=new Hy;return c.scale=t||1,c.fontStack=a,c}static forImage(t){let a=new Hy;return a.imageName=t,a}}class Im{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(t,a){let c=new Im;for(let f=0;f<t.sections.length;f++){let g=t.sections[f];g.image?c.addImageSection(g):c.addTextSection(g,a)}return c}length(){return this.text.length}getSection(t){return this.sections[this.sectionIndex[t]]}getSections(){return this.sections}getSectionIndex(t){return this.sectionIndex[t]}getCharCode(t){return this.text.charCodeAt(t)}verticalizePunctuation(t){this.text=function(a,c){let f="";for(let g=0;g<a.length;g++){let v=a.charCodeAt(g+1)||null,C=a.charCodeAt(g-1)||null;f+=!c&&(v&&Wp(v)&&!ks[a[g+1]]||C&&Wp(C)&&!ks[a[g-1]])||!ks[a[g]]?a[g]:ks[a[g]]}return f}(this.text,t)}trim(){let t=0;for(let c=0;c<this.text.length&&cb[this.text.charCodeAt(c)];c++)t++;let a=this.text.length;for(let c=this.text.length-1;c>=0&&c>=t&&cb[this.text.charCodeAt(c)];c--)a--;this.text=this.text.substring(t,a),this.sectionIndex=this.sectionIndex.slice(t,a)}substring(t,a){let c=new Im;return c.text=this.text.substring(t,a),c.sectionIndex=this.sectionIndex.slice(t,a),c.sections=this.sections,c}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((t,a)=>Math.max(t,this.sections[a].scale),0)}addTextSection(t,a){this.text+=t.text,this.sections.push(Hy.forText(t.scale,t.fontStack||a));let c=this.sections.length-1;for(let f=0;f<t.text.length;++f)this.sectionIndex.push(c)}addImageSection(t){let a=t.image?t.image.name:"";if(a.length===0)return void vi("Can't add FormattedSection with an empty image.");let c=this.getNextImageSectionCharCode();c?(this.text+=String.fromCharCode(c),this.sections.push(Hy.forImage(a)),this.sectionIndex.push(this.sections.length-1)):vi("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function v1(o,t,a,c,f,g,v,C,I,A,F,V,$,W,q){let ee=Im.fromFeature(o,f);V===ma.vertical&&ee.verticalizePunctuation($);let ae=[],me=function(De,qe,We,et,vt,Ke){if(!De)return[];let ot=[],st=function(kt,Nt,Pt,mn,Et,qt){let gn=0;for(let oi=0;oi<kt.length();oi++){let yn=kt.getSection(oi);gn+=NT(kt.getCharCode(oi),yn,mn,Et,Nt,qt)}return gn/Math.max(1,Math.ceil(gn/Pt))}(De,qe,We,et,vt,Ke),ft=De.text.indexOf("\u200B")>=0,wt=0;for(let kt=0;kt<De.length();kt++){let Nt=De.getSection(kt),Pt=De.getCharCode(kt);if(cb[Pt]||(wt+=NT(Pt,Nt,et,vt,qe,Ke)),kt<De.length()-1){let mn=!((Qe=Pt)<11904||!(At["Bopomofo Extended"](Qe)||At.Bopomofo(Qe)||At["CJK Compatibility Forms"](Qe)||At["CJK Compatibility Ideographs"](Qe)||At["CJK Compatibility"](Qe)||At["CJK Radicals Supplement"](Qe)||At["CJK Strokes"](Qe)||At["CJK Symbols and Punctuation"](Qe)||At["CJK Unified Ideographs Extension A"](Qe)||At["CJK Unified Ideographs"](Qe)||At["Enclosed CJK Letters and Months"](Qe)||At["Halfwidth and Fullwidth Forms"](Qe)||At.Hiragana(Qe)||At["Ideographic Description Characters"](Qe)||At["Kangxi Radicals"](Qe)||At["Katakana Phonetic Extensions"](Qe)||At.Katakana(Qe)||At["Vertical Forms"](Qe)||At["Yi Radicals"](Qe)||At["Yi Syllables"](Qe)));(cF[Pt]||mn||Nt.imageName)&&ot.push(BT(kt+1,wt,st,ot,uF(Pt,De.getCharCode(kt+1),mn&&ft),!1))}}var Qe;return jT(BT(De.length(),wt,st,ot,0,!0))}(ee,A,g,t,c,W),{processBidirectionalText:Ce,processStyledBidirectionalText:ge}=R;if(Ce&&ee.sections.length===1){let De=Ce(ee.toString(),me);for(let qe of De){let We=new Im;We.text=qe,We.sections=ee.sections;for(let et=0;et<qe.length;et++)We.sectionIndex.push(0);ae.push(We)}}else if(ge){let De=ge(ee.text,ee.sectionIndex,me);for(let qe of De){let We=new Im;We.text=qe[0],We.sectionIndex=qe[1],We.sections=ee.sections,ae.push(We)}}else ae=function(De,qe){let We=[],et=De.text,vt=0;for(let Ke of qe)We.push(De.substring(vt,Ke)),vt=Ke;return vt<et.length&&We.push(De.substring(vt,et.length)),We}(ee,me);let xe=[],Te={positionedLines:xe,text:ee.toString(),top:F[1],bottom:F[1],left:F[0],right:F[0],writingMode:V,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(De,qe,We,et,vt,Ke,ot,st,ft,wt,Qe,kt){let Nt=0,Pt=0,mn=0,Et=st==="right"?1:st==="left"?0:.5,qt=!1;for(let xn of vt){let wn=xn.getSections();for(let Ci of wn){if(Ci.imageName)continue;let ki=qe[Ci.fontStack];if(ki&&(qt=ki.ascender!==void 0&&ki.descender!==void 0,!qt))break}if(!qt)break}let gn=0;for(let xn of vt){xn.trim();let wn=xn.getMaxScale(),Ci=(wn-1)*An,ki={positionedGlyphs:[],lineOffset:0};De.positionedLines[gn]=ki;let Ri=ki.positionedGlyphs,Ei=0;if(!xn.length()){Pt+=Ke,++gn;continue}let Ji=0,fr=0;for(let Di=0;Di<xn.length();Di++){let Or=xn.getSection(Di),Dr=xn.getSectionIndex(Di),ar=xn.getCharCode(Di),li=Or.scale,Mr=null,Pi=null,Vo=null,Tr=An,so=0,Kr=!(ft===ma.horizontal||!Qe&&!df(ar)||Qe&&(cb[ar]||(oi=ar,At.Arabic(oi)||At["Arabic Supplement"](oi)||At["Arabic Extended-A"](oi)||At["Arabic Presentation Forms-A"](oi)||At["Arabic Presentation Forms-B"](oi))));if(Or.imageName){let Uo=et[Or.imageName];if(!Uo)continue;Vo=Or.imageName,De.iconsInText=De.iconsInText||!0,Pi=Uo.paddedRect;let Qr=Uo.displaySize;li=li*An/kt,Mr={width:Qr[0],height:Qr[1],left:cs,top:-OT,advance:Kr?Qr[1]:Qr[0],localGlyph:!1},so=qt?-Mr.height*li:FT+wn*An-Qr[1]*li,Tr=Mr.advance;let Hl=(Kr?Qr[0]:Qr[1])*li-An*wn;Hl>0&&Hl>Ei&&(Ei=Hl)}else{let Uo=We[Or.fontStack];if(!Uo)continue;Uo[ar]&&(Pi=Uo[ar]);let Qr=qe[Or.fontStack];if(!Qr)continue;let Hl=Qr.glyphs[ar];if(!Hl)continue;if(Mr=Hl.metrics,Tr=ar!==8203?An:0,qt){let Lm=Qr.ascender!==void 0?Math.abs(Qr.ascender):0,e_=Qr.descender!==void 0?Math.abs(Qr.descender):0,t_=(Lm+e_)*li;Ji<t_&&(Ji=t_,fr=(Lm-e_)/2*li),so=-Lm*li}else so=FT+(wn-li)*An}Kr?(De.verticalizable=!0,Ri.push({glyph:ar,imageName:Vo,x:Nt,y:Pt+so,vertical:Kr,scale:li,localGlyph:Mr.localGlyph,fontStack:Or.fontStack,sectionIndex:Dr,metrics:Mr,rect:Pi}),Nt+=Tr*li+wt):(Ri.push({glyph:ar,imageName:Vo,x:Nt,y:Pt+so,vertical:Kr,scale:li,localGlyph:Mr.localGlyph,fontStack:Or.fontStack,sectionIndex:Dr,metrics:Mr,rect:Pi}),Nt+=Mr.advance*li+wt)}Ri.length!==0&&(mn=Math.max(Nt-wt,mn),qt?VT(Ri,Et,Ei,fr,Ke*wn/2):VT(Ri,Et,Ei,0,Ke/2)),Nt=0;let Er=Ke*wn+Ei;ki.lineOffset=Math.max(Ei,Ci),Pt+=Er,++gn}var oi;let yn=Pt,{horizontalAlign:tn,verticalAlign:Fi}=b1(ot);(function(xn,wn,Ci,ki,Ri,Ei){let Ji=(wn-Ci)*Ri,fr=-Ei*ki;for(let Er of xn)for(let Di of Er.positionedGlyphs)Di.x+=Ji,Di.y+=fr})(De.positionedLines,Et,tn,Fi,mn,yn),De.top+=-Fi*yn,De.bottom=De.top+yn,De.left+=-tn*mn,De.right=De.left+mn,De.hasBaseline=qt}(Te,t,a,c,ae,v,C,I,V,A,$,q),!function(De){for(let qe of De)if(qe.positionedGlyphs.length!==0)return!1;return!0}(xe)&&Te}let cb={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},cF={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function NT(o,t,a,c,f,g){if(t.imageName){let v=c[t.imageName];return v?v.displaySize[0]*t.scale*An/g+f:0}{let v=a[t.fontStack],C=v&&v.glyphs[o];return C?C.metrics.advance*t.scale+f:0}}function zT(o,t,a,c){let f=Math.pow(o-t,2);return c?o<t?f/2:2*f:f+Math.abs(a)*a}function uF(o,t,a){let c=0;return o===10&&(c-=1e4),a&&(c+=150),o!==40&&o!==65288||(c+=50),t!==41&&t!==65289||(c+=50),c}function BT(o,t,a,c,f,g){let v=null,C=zT(t,a,f,g);for(let I of c){let A=zT(t-I.x,a,f,g)+I.badness;A<=C&&(v=I,C=A)}return{index:o,x:t,priorBreak:v,badness:C}}function jT(o){return o?jT(o.priorBreak).concat(o.index):[]}function b1(o){let t=.5,a=.5;switch(o){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(o){case"bottom":case"bottom-right":case"bottom-left":a=1;break;case"top":case"top-right":case"top-left":a=0}return{horizontalAlign:t,verticalAlign:a}}function VT(o,t,a,c,f){if(!(t||a||c||f))return;let g=o.length-1,v=o[g],C=(v.x+v.metrics.advance*v.scale)*t;for(let I=0;I<=g;I++)o[I].x-=C,o[I].y+=a+c+f}function dF(o,t,a){let{horizontalAlign:c,verticalAlign:f}=b1(a),g=t[0]-o.displaySize[0]*c,v=t[1]-o.displaySize[1]*f;return{image:o,top:v,bottom:v+o.displaySize[1],left:g,right:g+o.displaySize[0]}}function UT(o,t,a,c,f,g){let v=o.image,C;if(v.content){let ae=v.content,me=v.pixelRatio||1;C=[ae[0]/me,ae[1]/me,v.displaySize[0]-ae[2]/me,v.displaySize[1]-ae[3]/me]}let I=t.left*g,A=t.right*g,F,V,$,W;a==="width"||a==="both"?(W=f[0]+I-c[3],V=f[0]+A+c[1]):(W=f[0]+(I+A-v.displaySize[0])/2,V=W+v.displaySize[0]);let q=t.top*g,ee=t.bottom*g;return a==="height"||a==="both"?(F=f[1]+q-c[0],$=f[1]+ee+c[2]):(F=f[1]+(q+ee-v.displaySize[1])/2,$=F+v.displaySize[1]),{image:v,top:F,right:V,bottom:$,left:W,collisionPadding:C}}class Zu extends It{constructor(t,a,c,f,g){super(t,a),this.angle=f,this.z=c,g!==void 0&&(this.segment=g)}clone(){return new Zu(this.x,this.y,this.z,this.angle,this.segment)}}function $T(o,t,a,c,f){if(t.segment===void 0)return!0;let g=t,v=t.segment+1,C=0;for(;C>-a/2;){if(v--,v<0)return!1;C-=o[v].dist(g),g=o[v]}C+=o[v].dist(o[v+1]),v++;let I=[],A=0;for(;C<a/2;){let F=o[v],V=o[v+1];if(!V)return!1;let $=o[v-1].angleTo(F)-F.angleTo(V);for($=Math.abs(($+3*Math.PI)%(2*Math.PI)-Math.PI),I.push({distance:C,angleDelta:$}),A+=$;C-I[0].distance>c;)A-=I.shift().angleDelta;if(A>f)return!1;v++,C+=F.dist(V)}return!0}function HT(o){let t=0;for(let a=0;a<o.length-1;a++)t+=o[a].dist(o[a+1]);return t}function GT(o,t,a){return o?.6*t*a:0}function WT(o,t){return Math.max(o?o.right-o.left:0,t?t.right-t.left:0)}function hF(o,t,a,c,f,g){let v=GT(a,f,g),C=WT(a,c)*g,I=0,A=HT(o)/2;for(let F=0;F<o.length-1;F++){let V=o[F],$=o[F+1],W=V.dist($);if(I+W>A){let q=(A-I)/W,ee=Fn(V.x,$.x,q),ae=Fn(V.y,$.y,q),me=new Zu(ee,ae,0,$.angleTo(V),F);return!v||$T(o,me,C,v,t)?me:void 0}I+=W}}function fF(o,t,a,c,f,g,v,C,I){let A=GT(c,g,v),F=WT(c,f),V=F*v,$=o[0].x===0||o[0].x===I||o[0].y===0||o[0].y===I;return t-V<t/4&&(t=V+t/4),qT(o,$?t/2*C%t:(F/2+2*g)*v*C%t,t,A,a,V,$,!1,I)}function qT(o,t,a,c,f,g,v,C,I){let A=g/2,F=HT(o),V=0,$=t-a,W=[];for(let q=0;q<o.length-1;q++){let ee=o[q],ae=o[q+1],me=ee.dist(ae),Ce=ae.angleTo(ee);for(;$+a<V+me;){$+=a;let ge=($-V)/me,xe=Fn(ee.x,ae.x,ge),Te=Fn(ee.y,ae.y,ge);if(xe>=0&&xe<I&&Te>=0&&Te<I&&$-A>=0&&$+A<=F){let De=new Zu(xe,Te,0,Ce,q);De._round(),c&&!$T(o,De,g,c,f)||W.push(De)}}V+=me}return C||W.length||v||(W=qT(o,V/2,a,c,f,g,v,!0,I)),W}function ZT(o,t,a,c,f){let g=[];for(let v=0;v<o.length;v++){let C=o[v],I;for(let A=0;A<C.length-1;A++){let F=C[A],V=C[A+1];F.x<t&&V.x<t||(F.x<t?F=new It(t,F.y+(t-F.x)/(V.x-F.x)*(V.y-F.y))._round():V.x<t&&(V=new It(t,F.y+(t-F.x)/(V.x-F.x)*(V.y-F.y))._round()),F.y<a&&V.y<a||(F.y<a?F=new It(F.x+(a-F.y)/(V.y-F.y)*(V.x-F.x),a)._round():V.y<a&&(V=new It(F.x+(a-F.y)/(V.y-F.y)*(V.x-F.x),a)._round()),F.x>=c&&V.x>=c||(F.x>=c?F=new It(c,F.y+(c-F.x)/(V.x-F.x)*(V.y-F.y))._round():V.x>=c&&(V=new It(c,F.y+(c-F.x)/(V.x-F.x)*(V.y-F.y))._round()),F.y>=f&&V.y>=f||(F.y>=f?F=new It(F.x+(f-F.y)/(V.y-F.y)*(V.x-F.x),f)._round():V.y>=f&&(V=new It(F.x+(f-F.y)/(V.y-F.y)*(V.x-F.x),f)._round()),I&&F.equals(I[I.length-1])||(I=[F],g.push(I)),I.push(V)))))}}return g}Ot(Zu,"Anchor");let Gy=1e20;function XT(o,t,a,c,f,g,v,C,I){for(let A=t;A<t+c;A++)YT(o,a*g+A,g,f,v,C,I);for(let A=a;A<a+f;A++)YT(o,A*g+t,1,c,v,C,I)}function YT(o,t,a,c,f,g,v){g[0]=0,v[0]=-Gy,v[1]=Gy,f[0]=o[t];for(let C=1,I=0,A=0;C<c;C++){f[C]=o[t+C*a];let F=C*C;do{let V=g[I];A=(f[C]-f[V]+F-V*V)/(C-V)/2}while(A<=v[I]&&--I>-1);I++,g[I]=C,v[I]=A,v[I+1]=Gy}for(let C=0,I=0;C<c;C++){for(;v[I+1]<C;)I++;let A=g[I],F=C-A;o[t+C*a]=f[A]+F*F}}let Ul=2,x1={none:0,ideographs:1,all:2};class Sm{constructor(t,a,c){this.requestManager=t,this.localGlyphMode=a,this.localFontFamily=c,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(t){this.url=t}getGlyphs(t,a){let c=[];for(let f in t)for(let g of t[f])c.push({stack:f,id:g});wr(c,({stack:f,id:g},v)=>{let C=this.entries[f];C||(C=this.entries[f]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let I=C.glyphs[g];if(I!==void 0)return void v(null,{stack:f,id:g,glyph:I});if(I=this._tinySDF(C,f,g),I)return C.glyphs[g]=I,void v(null,{stack:f,id:g,glyph:I});let A=Math.floor(g/256);if(256*A>65535)return void v(new Error("glyphs > 65535 not supported"));if(C.ranges[A])return void v(null,{stack:f,id:g,glyph:I});let F=C.requests[A];F||(F=C.requests[A]=[],Sm.loadGlyphRange(f,A,this.url,this.requestManager,(V,$)=>{if($){C.ascender=$.ascender,C.descender=$.descender;for(let W in $.glyphs)this._doesCharSupportLocalGlyph(+W)||(C.glyphs[+W]=$.glyphs[+W]);C.ranges[A]=!0}for(let W of F)W(V,$);delete C.requests[A]})),F.push((V,$)=>{V?v(V):$&&v(null,{stack:f,id:g,glyph:$.glyphs[g]||null})})},(f,g)=>{if(f)a(f);else if(g){let v={};for(let{stack:C,id:I,glyph:A}of g)v[C]===void 0&&(v[C]={}),v[C].glyphs===void 0&&(v[C].glyphs={}),v[C].glyphs[I]=A&&{id:A.id,bitmap:A.bitmap.clone(),metrics:A.metrics},v[C].ascender=this.entries[C].ascender,v[C].descender=this.entries[C].descender;a(null,v)}})}_doesCharSupportLocalGlyph(t){return this.localGlyphMode!==x1.none&&(this.localGlyphMode===x1.all?!!this.localFontFamily:!!this.localFontFamily&&(At["CJK Unified Ideographs"](t)||At["Hangul Syllables"](t)||At.Hiragana(t)||At.Katakana(t)||At["CJK Symbols and Punctuation"](t)))}_tinySDF(t,a,c){let f=this.localFontFamily;if(!f||!this._doesCharSupportLocalGlyph(c))return;let g=t.tinySDF;if(!g){let ee="400";/bold/i.test(a)?ee="900":/medium/i.test(a)?ee="500":/light/i.test(a)&&(ee="200"),g=t.tinySDF=new Sm.TinySDF({fontFamily:f,fontWeight:ee,fontSize:24*Ul,buffer:3*Ul,radius:8*Ul}),g.fontWeight=ee}if(this.localGlyphs[g.fontWeight][c])return this.localGlyphs[g.fontWeight][c];let v=String.fromCharCode(c),{data:C,width:I,height:A,glyphWidth:F,glyphHeight:V,glyphLeft:$,glyphTop:W,glyphAdvance:q}=g.draw(v);return this.localGlyphs[g.fontWeight][c]={id:c,bitmap:new Vl({width:I,height:A},C),metrics:{width:F/Ul,height:V/Ul,left:$/Ul,top:W/Ul-27,advance:q/Ul,localGlyph:!0}}}}Sm.loadGlyphRange=function(o,t,a,c,f){let g=256*t,v=g+255,C=c.transformRequest(c.normalizeGlyphsURL(a).replace("{fontstack}",o).replace("{range}",`${g}-${v}`),rl.Glyphs);ea(C,(I,A)=>{if(I)f(I);else if(A){let F={},V=function($){return new lb($).readFields(sF,{})}(A);for(let $ of V.glyphs)F[$.id]=$;f(null,{glyphs:F,ascender:V.ascender,descender:V.descender})}})},Sm.TinySDF=class{constructor({fontSize:o=24,buffer:t=3,radius:a=8,cutoff:c=.25,fontFamily:f="sans-serif",fontWeight:g="normal",fontStyle:v="normal"}={}){this.buffer=t,this.cutoff=c,this.radius=a;let C=this.size=o+4*t,I=this._createCanvas(C),A=this.ctx=I.getContext("2d",{willReadFrequently:!0});A.font=`${v} ${g} ${o}px ${f}`,A.textBaseline="alphabetic",A.textAlign="left",A.fillStyle="black",this.gridOuter=new Float64Array(C*C),this.gridInner=new Float64Array(C*C),this.f=new Float64Array(C),this.z=new Float64Array(C+1),this.v=new Uint16Array(C)}_createCanvas(o){let t=document.createElement("canvas");return t.width=t.height=o,t}draw(o){let{width:t,actualBoundingBoxAscent:a,actualBoundingBoxDescent:c,actualBoundingBoxLeft:f,actualBoundingBoxRight:g}=this.ctx.measureText(o),v=Math.ceil(a),C=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(g-f))),I=Math.min(this.size-this.buffer,v+Math.ceil(c)),A=C+2*this.buffer,F=I+2*this.buffer,V=Math.max(A*F,0),$=new Uint8ClampedArray(V),W={data:$,width:A,height:F,glyphWidth:C,glyphHeight:I,glyphTop:v,glyphLeft:0,glyphAdvance:t};if(C===0||I===0)return W;let{ctx:q,buffer:ee,gridInner:ae,gridOuter:me}=this;q.clearRect(ee,ee,C,I),q.fillText(o,ee,ee+v);let Ce=q.getImageData(ee,ee,C,I);me.fill(Gy,0,V),ae.fill(0,0,V);for(let ge=0;ge<I;ge++)for(let xe=0;xe<C;xe++){let Te=Ce.data[4*(ge*C+xe)+3]/255;if(Te===0)continue;let De=(ge+ee)*A+xe+ee;if(Te===1)me[De]=0,ae[De]=Gy;else{let qe=.5-Te;me[De]=qe>0?qe*qe:0,ae[De]=qe<0?qe*qe:0}}XT(me,0,0,A,F,A,this.f,this.v,this.z),XT(ae,ee,ee,C,I,A,this.f,this.v,this.z);for(let ge=0;ge<V;ge++){let xe=Math.sqrt(me[ge])-Math.sqrt(ae[ge]);$[ge]=Math.round(255-255*(xe/this.radius+this.cutoff))}return W}};let Am=cs;function KT(o,t,a,c){let f=[],g=o.image,v=g.pixelRatio,C=g.paddedRect.w-2*Am,I=g.paddedRect.h-2*Am,A=o.right-o.left,F=o.bottom-o.top,V=g.stretchX||[[0,C]],$=g.stretchY||[[0,I]],W=(Ke,ot)=>Ke+ot[1]-ot[0],q=V.reduce(W,0),ee=$.reduce(W,0),ae=C-q,me=I-ee,Ce=0,ge=q,xe=0,Te=ee,De=0,qe=ae,We=0,et=me;if(g.content&&c){let Ke=g.content;Ce=ub(V,0,Ke[0]),xe=ub($,0,Ke[1]),ge=ub(V,Ke[0],Ke[2]),Te=ub($,Ke[1],Ke[3]),De=Ke[0]-Ce,We=Ke[1]-xe,qe=Ke[2]-Ke[0]-ge,et=Ke[3]-Ke[1]-Te}let vt=(Ke,ot,st,ft)=>{let wt=db(Ke.stretch-Ce,ge,A,o.left),Qe=hb(Ke.fixed-De,qe,Ke.stretch,q),kt=db(ot.stretch-xe,Te,F,o.top),Nt=hb(ot.fixed-We,et,ot.stretch,ee),Pt=db(st.stretch-Ce,ge,A,o.left),mn=hb(st.fixed-De,qe,st.stretch,q),Et=db(ft.stretch-xe,Te,F,o.top),qt=hb(ft.fixed-We,et,ft.stretch,ee),gn=new It(wt,kt),oi=new It(Pt,kt),yn=new It(Pt,Et),tn=new It(wt,Et),Fi=new It(Qe/v,Nt/v),xn=new It(mn/v,qt/v),wn=t*Math.PI/180;if(wn){let Ri=Math.sin(wn),Ei=Math.cos(wn),Ji=[Ei,-Ri,Ri,Ei];gn._matMult(Ji),oi._matMult(Ji),tn._matMult(Ji),yn._matMult(Ji)}let Ci=Ke.stretch+Ke.fixed,ki=ot.stretch+ot.fixed;return{tl:gn,tr:oi,bl:tn,br:yn,tex:{x:g.paddedRect.x+Am+Ci,y:g.paddedRect.y+Am+ki,w:st.stretch+st.fixed-Ci,h:ft.stretch+ft.fixed-ki},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Fi,pixelOffsetBR:xn,minFontScaleX:qe/v/A,minFontScaleY:et/v/F,isSDF:a}};if(c&&(g.stretchX||g.stretchY)){let Ke=QT(V,ae,q),ot=QT($,me,ee);for(let st=0;st<Ke.length-1;st++){let ft=Ke[st],wt=Ke[st+1];for(let Qe=0;Qe<ot.length-1;Qe++)f.push(vt(ft,ot[Qe],wt,ot[Qe+1]))}}else f.push(vt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:C+1},{fixed:0,stretch:I+1}));return f}function ub(o,t,a){let c=0;for(let f of o)c+=Math.max(t,Math.min(a,f[1]))-Math.max(t,Math.min(a,f[0]));return c}function QT(o,t,a){let c=[{fixed:-Am,stretch:0}];for(let[f,g]of o){let v=c[c.length-1];c.push({fixed:f-v.stretch,stretch:v.stretch}),c.push({fixed:f-v.stretch,stretch:v.stretch+(g-f)})}return c.push({fixed:t+Am,stretch:a}),c}function db(o,t,a,c){return o/t*a+c}function hb(o,t,a,c){return o-t*a/c}function pF(o,t,a,c){let f=t+o.positionedLines[c].lineOffset;return c===0?a+f/2:a+(f+(t+o.positionedLines[c-1].lineOffset))/2}class mF{constructor(t=[],a=gF){if(this.data=t,this.length=this.data.length,this.compare=a,this.length>0)for(let c=(this.length>>1)-1;c>=0;c--)this._down(c)}push(t){this.data.push(t),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;let t=this.data[0],a=this.data.pop();return this.length--,this.length>0&&(this.data[0]=a,this._down(0)),t}peek(){return this.data[0]}_up(t){let{data:a,compare:c}=this,f=a[t];for(;t>0;){let g=t-1>>1,v=a[g];if(c(f,v)>=0)break;a[t]=v,t=g}a[t]=f}_down(t){let{data:a,compare:c}=this,f=this.length>>1,g=a[t];for(;t<f;){let v=1+(t<<1),C=a[v],I=v+1;if(I<this.length&&c(a[I],C)<0&&(v=I,C=a[I]),c(C,g)>=0)break;a[t]=C,t=v}a[t]=g}}function gF(o,t){return o<t?-1:o>t?1:0}function yF(o,t=1,a=!1){let c=1/0,f=1/0,g=-1/0,v=-1/0,C=o[0];for(let W=0;W<C.length;W++){let q=C[W];(!W||q.x<c)&&(c=q.x),(!W||q.y<f)&&(f=q.y),(!W||q.x>g)&&(g=q.x),(!W||q.y>v)&&(v=q.y)}let I=Math.min(g-c,v-f),A=I/2,F=new mF([],_F);if(I===0)return new It(c,f);for(let W=c;W<g;W+=I)for(let q=f;q<v;q+=I)F.push(new km(W+A,q+A,A,o));let V=function(W){let q=0,ee=0,ae=0,me=W[0];for(let Ce=0,ge=me.length,xe=ge-1;Ce<ge;xe=Ce++){let Te=me[Ce],De=me[xe],qe=Te.x*De.y-De.x*Te.y;ee+=(Te.x+De.x)*qe,ae+=(Te.y+De.y)*qe,q+=3*qe}return new km(ee/q,ae/q,0,W)}(o),$=F.length;for(;F.length;){let W=F.pop();(W.d>V.d||!V.d)&&(V=W,a&&console.log("found best %d after %d probes",Math.round(1e4*W.d)/1e4,$)),W.max-V.d<=t||(A=W.h/2,F.push(new km(W.p.x-A,W.p.y-A,A,o)),F.push(new km(W.p.x+A,W.p.y-A,A,o)),F.push(new km(W.p.x-A,W.p.y+A,A,o)),F.push(new km(W.p.x+A,W.p.y+A,A,o)),$+=4)}return a&&(console.log(`num probes: ${$}`),console.log(`best distance: ${V.d}`)),V.p}function _F(o,t){return t.max-o.max}class km{constructor(t,a,c,f){this.p=new It(t,a),this.h=c,this.d=function(g,v){let C=!1,I=1/0;for(let A=0;A<v.length;A++){let F=v[A];for(let V=0,$=F.length,W=$-1;V<$;W=V++){let q=F[V],ee=F[W];q.y>g.y!=ee.y>g.y&&g.x<(ee.x-q.x)*(g.y-q.y)/(ee.y-q.y)+q.x&&(C=!C),I=Math.min(I,gm(g,q,ee))}}return(C?1:-1)*Math.sqrt(I)}(this.p,f),this.max=this.d+this.h*Math.SQRT2}}let Rm=7,w1=Number.POSITIVE_INFINITY,vF=Math.sqrt(2);function JT(o,[t,a]){let c=0,f=0;if(a===w1){t<0&&(t=0);let g=t/vF;switch(o){case"top-right":case"top-left":f=g-Rm;break;case"bottom-right":case"bottom-left":f=-g+Rm;break;case"bottom":f=-t+Rm;break;case"top":f=t-Rm}switch(o){case"top-right":case"bottom-right":c=-g;break;case"top-left":case"bottom-left":c=g;break;case"left":c=t;break;case"right":c=-t}}else{switch(t=Math.abs(t),a=Math.abs(a),o){case"top-right":case"top-left":case"top":f=a-Rm;break;case"bottom-right":case"bottom-left":case"bottom":f=-a+Rm}switch(o){case"top-right":case"bottom-right":case"right":c=-t;break;case"top-left":case"bottom-left":case"left":c=t}}return[c,f]}function bF(o,t,a,c,f,g,v,C,I,A){o.createArrays(),o.tilePixelRatio=Wt/(512*o.overscaling),o.compareText={},o.iconsNeedLinear=!1;let F=o.layers[0].layout,V=o.layers[0]._unevaluatedLayout._values,$={};if(o.textSizeData.kind==="composite"){let{minZoom:ee,maxZoom:ae}=o.textSizeData;$.compositeTextSizes=[V["text-size"].possiblyEvaluate(new z(ee),C),V["text-size"].possiblyEvaluate(new z(ae),C)]}if(o.iconSizeData.kind==="composite"){let{minZoom:ee,maxZoom:ae}=o.iconSizeData;$.compositeIconSizes=[V["icon-size"].possiblyEvaluate(new z(ee),C),V["icon-size"].possiblyEvaluate(new z(ae),C)]}$.layoutTextSize=V["text-size"].possiblyEvaluate(new z(I+1),C),$.layoutIconSize=V["icon-size"].possiblyEvaluate(new z(I+1),C),$.textMaxSize=V["text-size"].possiblyEvaluate(new z(18),C);let W=F.get("text-rotation-alignment")==="map"&&F.get("symbol-placement")!=="point",q=F.get("text-size");for(let ee of o.features){let ae=F.get("text-font").evaluate(ee,{},C).join(","),me=q.evaluate(ee,{},C),Ce=$.layoutTextSize.evaluate(ee,{},C),ge=($.layoutIconSize.evaluate(ee,{},C),{horizontal:{},vertical:void 0}),xe=ee.text,Te,De=[0,0];if(xe){let et=xe.toString(),vt=F.get("text-letter-spacing").evaluate(ee,{},C)*An,Ke=F.get("text-line-height").evaluate(ee,{},C)*An,ot=ay(et)?vt:0,st=F.get("text-anchor").evaluate(ee,{},C),ft=F.get("text-variable-anchor");if(!ft){let Pt=F.get("text-radial-offset").evaluate(ee,{},C);De=Pt?JT(st,[Pt*An,w1]):F.get("text-offset").evaluate(ee,{},C).map(mn=>mn*An)}let wt=W?"center":F.get("text-justify").evaluate(ee,{},C),Qe=F.get("symbol-placement")==="point",kt=Qe?F.get("text-max-width").evaluate(ee,{},C)*An:1/0,Nt=Pt=>{o.allowVerticalPlacement&&Wd(et)&&(ge.vertical=v1(xe,t,a,f,ae,kt,Ke,st,Pt,ot,De,ma.vertical,!0,Ce,me))};if(!W&&ft){let Pt=wt==="auto"?ft.map(Et=>C1(Et)):[wt],mn=!1;for(let Et=0;Et<Pt.length;Et++){let qt=Pt[Et];if(!ge.horizontal[qt])if(mn)ge.horizontal[qt]=ge.horizontal[0];else{let gn=v1(xe,t,a,f,ae,kt,Ke,"center",qt,ot,De,ma.horizontal,!1,Ce,me);gn&&(ge.horizontal[qt]=gn,mn=gn.positionedLines.length===1)}}Nt("left")}else{if(wt==="auto"&&(wt=C1(st)),Qe||F.get("text-writing-mode").indexOf("horizontal")>=0||!Wd(et)){let Pt=v1(xe,t,a,f,ae,kt,Ke,st,wt,ot,De,ma.horizontal,!1,Ce,me);Pt&&(ge.horizontal[wt]=Pt)}Nt(Qe?"left":wt)}}let qe=!1;if(ee.icon&&ee.icon.name){let et=c[ee.icon.name];et&&(Te=dF(f[ee.icon.name],F.get("icon-offset").evaluate(ee,{},C),F.get("icon-anchor").evaluate(ee,{},C)),qe=et.sdf,o.sdfIcons===void 0?o.sdfIcons=et.sdf:o.sdfIcons!==et.sdf&&vi("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(et.pixelRatio!==o.pixelRatio||F.get("icon-rotate").constantOr(1)!==0)&&(o.iconsNeedLinear=!0))}let We=tI(ge.horizontal)||ge.vertical;o.iconsInText||(o.iconsInText=!!We&&We.iconsInText),(We||Te)&&xF(o,ee,ge,Te,c,$,Ce,0,De,qe,v,C,A)}g&&o.generateCollisionDebugBuffers(I,o.collisionBoxArray)}function C1(o){switch(o){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function xF(o,t,a,c,f,g,v,C,I,A,F,V,$){let W=g.textMaxSize.evaluate(t,{},V);W===void 0&&(W=v);let q=o.layers[0].layout,ee=q.get("icon-offset").evaluate(t,{},V),ae=tI(a.horizontal)||a.vertical,me=$.name==="globe",Ce=An,ge=v/Ce,xe=o.tilePixelRatio*W/Ce,Te=(st=o.overscaling,o.zoom>18&&st>2&&(st>>=1),Math.max(Wt/(512*st),1)*q.get("symbol-spacing")),De=q.get("text-padding")*o.tilePixelRatio,qe=q.get("icon-padding")*o.tilePixelRatio,We=Pn(q.get("text-max-angle")),et=q.get("text-rotation-alignment")==="map"&&q.get("symbol-placement")!=="point",vt=q.get("icon-rotation-alignment")==="map"&&q.get("symbol-placement")!=="point",Ke=q.get("symbol-placement"),ot=Te/2;var st;let ft=q.get("icon-text-fit"),wt;c&&ft!=="none"&&(o.allowVerticalPlacement&&a.vertical&&(wt=UT(c,a.vertical,ft,q.get("icon-text-fit-padding"),ee,ge)),ae&&(c=UT(c,ae,ft,q.get("icon-text-fit-padding"),ee,ge)));let Qe=(kt,Nt,Pt)=>{if(Nt.x<0||Nt.x>=Wt||Nt.y<0||Nt.y>=Wt)return;let mn=null;if(me){let{x:Et,y:qt,z:gn}=$.projectTilePoint(Nt.x,Nt.y,Pt);mn={anchor:new Zu(Et,qt,gn,0,void 0),up:$.upVector(Pt,Nt.x,Nt.y)}}(function(Et,qt,gn,oi,yn,tn,Fi,xn,wn,Ci,ki,Ri,Ei,Ji,fr,Er,Di,Or,Dr,ar,li,Mr,Pi,Vo,Tr){let so=Et.addToLineVertexArray(qt,oi),Kr,Uo,Qr,Hl,Lm,e_,t_,OI=0,LI=0,FI=0,NI=0,z1=-1,B1=-1,zc={},zI=cy(""),Vf=gn?gn.anchor:qt,j1=0,V1=0;if(wn._unevaluatedLayout.getValue("text-radial-offset")===void 0?[j1,V1]=wn.layout.get("text-offset").evaluate(li,{},Tr).map(Rs=>Rs*An):(j1=wn.layout.get("text-radial-offset").evaluate(li,{},Tr)*An,V1=w1),Et.allowVerticalPlacement&&yn.vertical){let Rs=yn.vertical;if(fr)e_=E1(Rs),xn&&(t_=E1(xn));else{let Ps=wn.layout.get("text-rotate").evaluate(li,{},Tr)+90;Qr=fb(Ci,Vf,qt,ki,Ri,Ei,Rs,Ji,Ps,Er),xn&&(Hl=fb(Ci,Vf,qt,ki,Ri,Ei,xn,Or,Ps))}}if(tn){let Rs=wn.layout.get("icon-rotate").evaluate(li,{},Tr),Ps=wn.layout.get("icon-text-fit")!=="none",n_=KT(tn,Rs,Pi,Ps),$1=xn?KT(xn,Rs,Pi,Ps):void 0;Uo=fb(Ci,Vf,qt,ki,Ri,Ei,tn,Or,Rs),OI=4*n_.length;let BI=Et.iconSizeData,Uf=null;BI.kind==="source"?(Uf=[wi*wn.layout.get("icon-size").evaluate(li,{},Tr)],Uf[0]>sh&&vi(`${Et.layerIds[0]}: Value for "icon-size" is >= ${Wy}. Reduce your "icon-size".`)):BI.kind==="composite"&&(Uf=[wi*Mr.compositeIconSizes[0].evaluate(li,{},Tr),wi*Mr.compositeIconSizes[1].evaluate(li,{},Tr)],(Uf[0]>sh||Uf[1]>sh)&&vi(`${Et.layerIds[0]}: Value for "icon-size" is >= ${Wy}. Reduce your "icon-size".`)),Et.addSymbols(Et.icon,n_,Uf,ar,Dr,li,!1,gn,qt,so.lineStartIndex,so.lineLength,-1,Vo,Tr),z1=Et.icon.placedSymbolArray.length-1,$1&&(LI=4*$1.length,Et.addSymbols(Et.icon,$1,Uf,ar,Dr,li,ma.vertical,gn,qt,so.lineStartIndex,so.lineLength,-1,Vo,Tr),B1=Et.icon.placedSymbolArray.length-1)}for(let Rs in yn.horizontal){let Ps=yn.horizontal[Rs];Kr||(zI=cy(Ps.text),fr?Lm=E1(Ps):Kr=fb(Ci,Vf,qt,ki,Ri,Ei,Ps,Ji,wn.layout.get("text-rotate").evaluate(li,{},Tr),Er));let n_=Ps.positionedLines.length===1;if(FI+=eI(Et,gn,qt,Ps,Fi,wn,fr,li,Er,so,yn.vertical?ma.horizontal:ma.horizontalOnly,n_?Object.keys(yn.horizontal):[Rs],zc,z1,Mr,Vo,Tr),n_)break}yn.vertical&&(NI+=eI(Et,gn,qt,yn.vertical,Fi,wn,fr,li,Er,so,ma.vertical,["vertical"],zc,B1,Mr,Vo,Tr));let hh=-1,U1=(Rs,Ps)=>Rs?Math.max(Rs,Ps):Ps;hh=U1(Lm,hh),hh=U1(e_,hh),hh=U1(t_,hh);let XF=hh>-1?1:0;Et.glyphOffsetArray.length>=lh.MAX_GLYPHS&&vi("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),li.sortKey!==void 0&&Et.addToSortKeyRanges(Et.symbolInstances.length,li.sortKey),Et.symbolInstances.emplaceBack(Vf.x,Vf.y,Vf.z,qt.x,qt.y,zc.right>=0?zc.right:-1,zc.center>=0?zc.center:-1,zc.left>=0?zc.left:-1,zc.vertical>=0?zc.vertical:-1,z1,B1,zI,Kr!==void 0?Kr:Et.collisionBoxArray.length,Kr!==void 0?Kr+1:Et.collisionBoxArray.length,Qr!==void 0?Qr:Et.collisionBoxArray.length,Qr!==void 0?Qr+1:Et.collisionBoxArray.length,Uo!==void 0?Uo:Et.collisionBoxArray.length,Uo!==void 0?Uo+1:Et.collisionBoxArray.length,Hl||Et.collisionBoxArray.length,Hl?Hl+1:Et.collisionBoxArray.length,ki,FI,NI,OI,LI,XF,0,j1,V1,hh)})(o,Nt,mn,kt,a,c,f,wt,o.layers[0],o.collisionBoxArray,t.index,t.sourceLayerIndex,o.index,De,et,I,0,qe,vt,ee,t,g,A,F,V)};if(Ke==="line")for(let kt of ZT(t.geometry,0,0,Wt,Wt)){let Nt=fF(kt,Te,We,a.vertical||ae,c,Ce,xe,o.overscaling,Wt);for(let Pt of Nt)ae&&wF(o,ae.text,ot,Pt)||Qe(kt,Pt,V)}else if(Ke==="line-center"){for(let kt of t.geometry)if(kt.length>1){let Nt=hF(kt,We,a.vertical||ae,c,Ce,xe);Nt&&Qe(kt,Nt,V)}}else if(t.type==="Polygon")for(let kt of Ny(t.geometry,0)){let Nt=yF(kt,16);Qe(kt[0],new Zu(Nt.x,Nt.y,0,0,void 0),V)}else if(t.type==="LineString")for(let kt of t.geometry)Qe(kt,new Zu(kt[0].x,kt[0].y,0,0,void 0),V);else if(t.type==="Point")for(let kt of t.geometry)for(let Nt of kt)Qe([Nt],new Zu(Nt.x,Nt.y,0,0,void 0),V)}let Wy=255,sh=Wy*wi;function eI(o,t,a,c,f,g,v,C,I,A,F,V,$,W,q,ee,ae){let me=function(xe,Te,De,qe,We,et,vt,Ke){let ot=[];if(Te.positionedLines.length===0)return ot;let st=qe.layout.get("text-rotate").evaluate(et,{})*Math.PI/180,ft=function(Pt){let mn=Pt[0],Et=Pt[1],qt=mn*Et;return qt>0?[mn,-Et]:qt<0?[-mn,Et]:mn===0?[Et,mn]:[Et,-mn]}(De),wt=Math.abs(Te.top-Te.bottom);for(let Pt of Te.positionedLines)wt-=Pt.lineOffset;let Qe=Te.positionedLines.length,kt=wt/Qe,Nt=Te.top-De[1];for(let Pt=0;Pt<Qe;++Pt){let mn=Te.positionedLines[Pt];Nt=pF(Te,kt,Nt,Pt);for(let Et of mn.positionedGlyphs){if(!Et.rect)continue;let qt=Et.rect||{},gn=OT+1,oi=!0,yn=1,tn=0;if(Et.imageName){let Pi=vt[Et.imageName];if(!Pi)continue;if(Pi.sdf){vi("SDF images are not supported in formatted text and will be ignored.");continue}oi=!1,yn=Pi.pixelRatio,gn=cs/yn}let Fi=(We||Ke)&&Et.vertical,xn=Et.metrics.advance*Et.scale/2,wn=Et.metrics,Ci=Et.rect;if(Ci===null)continue;Ke&&Te.verticalizable&&(tn=Et.imageName?xn-Et.metrics.width*Et.scale/2:0);let ki=We?[Et.x+xn,Et.y]:[0,0],Ri=[0,0],Ei=[0,0],Ji=!1;We||(Fi?(Ei=[Et.x+xn+ft[0],Et.y+ft[1]-tn],Ji=!0):Ri=[Et.x+xn+De[0],Et.y+De[1]-tn]);let fr=Ci.w*Et.scale/(yn*(Et.localGlyph?Ul:1)),Er=Ci.h*Et.scale/(yn*(Et.localGlyph?Ul:1)),Di,Or,Dr,ar;if(Fi){let Pi=Et.y-Nt,Vo=new It(-xn,xn-Pi),Tr=-Math.PI/2,so=new It(...Ei);Di=new It(-xn+Ri[0],Ri[1]),Di._rotateAround(Tr,Vo)._add(so),Di.x+=-Pi+xn,Di.y-=(wn.left-gn)*Et.scale;let Kr=Et.imageName?wn.advance*Et.scale:An*Et.scale,Uo=String.fromCharCode(Et.glyph);zf(Uo)?Di.x+=(1-gn)*Et.scale:Dm(Uo)?Di.x+=Kr-wn.height*Et.scale+(-gn-1)*Et.scale:Di.x+=Et.imageName||wn.width+2*gn===Ci.w&&wn.height+2*gn===Ci.h?(Kr-Er)/2:(Kr-(wn.height+2*gn)*Et.scale)/2,Or=new It(Di.x,Di.y-fr),Dr=new It(Di.x+Er,Di.y),ar=new It(Di.x+Er,Di.y-fr)}else{let Pi=(wn.left-gn)*Et.scale-xn+Ri[0],Vo=(-wn.top-gn)*Et.scale+Ri[1],Tr=Pi+fr,so=Vo+Er;Di=new It(Pi,Vo),Or=new It(Tr,Vo),Dr=new It(Pi,so),ar=new It(Tr,so)}if(st){let Pi;Pi=We?new It(0,0):Ji?new It(ft[0],ft[1]):new It(De[0],De[1]),Di._rotateAround(st,Pi),Or._rotateAround(st,Pi),Dr._rotateAround(st,Pi),ar._rotateAround(st,Pi)}let li=new It(0,0),Mr=new It(0,0);ot.push({tl:Di,tr:Or,bl:Dr,br:ar,tex:qt,writingMode:Te.writingMode,glyphOffset:ki,sectionIndex:Et.sectionIndex,isSDF:oi,pixelOffsetTL:li,pixelOffsetBR:Mr,minFontScaleX:0,minFontScaleY:0})}}return ot}(0,c,I,g,v,C,f,o.allowVerticalPlacement),Ce=o.textSizeData,ge=null;Ce.kind==="source"?(ge=[wi*g.layout.get("text-size").evaluate(C,{},ae)],ge[0]>sh&&vi(`${o.layerIds[0]}: Value for "text-size" is >= ${Wy}. Reduce your "text-size".`)):Ce.kind==="composite"&&(ge=[wi*q.compositeTextSizes[0].evaluate(C,{},ae),wi*q.compositeTextSizes[1].evaluate(C,{},ae)],(ge[0]>sh||ge[1]>sh)&&vi(`${o.layerIds[0]}: Value for "text-size" is >= ${Wy}. Reduce your "text-size".`)),o.addSymbols(o.text,me,ge,I,v,C,F,t,a,A.lineStartIndex,A.lineLength,W,ee,ae);for(let xe of V)$[xe]=o.text.placedSymbolArray.length-1;return 4*me.length}function tI(o){for(let t in o)return o[t];return null}function fb(o,t,a,c,f,g,v,C,I,A){let F=v.top,V=v.bottom,$=v.left,W=v.right,q=v.collisionPadding;if(q&&($-=q[0],F-=q[1],W+=q[2],V+=q[3]),I){let ee=new It($,F),ae=new It(W,F),me=new It($,V),Ce=new It(W,V),ge=Pn(I),xe=new It(0,0);A&&(xe=new It(A[0],A[1])),ee._rotateAround(ge,xe),ae._rotateAround(ge,xe),me._rotateAround(ge,xe),Ce._rotateAround(ge,xe),$=Math.min(ee.x,ae.x,me.x,Ce.x),W=Math.max(ee.x,ae.x,me.x,Ce.x),F=Math.min(ee.y,ae.y,me.y,Ce.y),V=Math.max(ee.y,ae.y,me.y,Ce.y)}return o.emplaceBack(t.x,t.y,t.z,a.x,a.y,$,F,W,V,C,c,f,g),o.length-1}function E1(o){o.collisionPadding&&(o.top-=o.collisionPadding[1],o.bottom+=o.collisionPadding[3]);let t=o.bottom-o.top;return t>0?Math.max(10,t):null}function wF(o,t,a,c){let f=o.compareText;if(t in f){let g=f[t];for(let v=g.length-1;v>=0;v--)if(c.dist(g[v])<a)return!0}else f[t]=[];return f[t].push(c),!1}function nI(o,t){let a=o.fovAboveCenter,c=o.elevation?o.elevation.getMinElevationBelowMSL()*t:0,f=(o._camera.position[2]*o.worldSize-c)/Math.cos(o._pitch),g=Math.sin(a)*f/Math.sin(Math.max(Math.PI/2-o._pitch-a,.01)),v=Math.sin(o._pitch)*g+f;return Math.min(1.01*v,f*(1/o._horizonShift))}function Bf(o,t){if(!t.isReprojectedInTileSpace)return{scale:1<<o.z,x:o.x,y:o.y,x2:o.x+1,y2:o.y+1,projection:t};let a=Math.pow(2,-o.z),c=o.x*a,f=(o.x+1)*a,g=o.y*a,v=(o.y+1)*a,C=ls(c),I=ls(f),A=Xr(g),F=Xr(v),V=t.project(C,A),$=t.project(I,A),W=t.project(I,F),q=t.project(C,F),ee=Math.min(V.x,$.x,W.x,q.x),ae=Math.min(V.y,$.y,W.y,q.y),me=Math.max(V.x,$.x,W.x,q.x),Ce=Math.max(V.y,$.y,W.y,q.y),ge=a/16;function xe(De,qe,We,et,vt,Ke){let ot=(We+vt)/2,st=(et+Ke)/2,ft=t.project(ls(ot),Xr(st)),wt=Math.max(0,ee-ft.x,ae-ft.y,ft.x-me,ft.y-Ce);ee=Math.min(ee,ft.x),me=Math.max(me,ft.x),ae=Math.min(ae,ft.y),Ce=Math.max(Ce,ft.y),wt>ge&&(xe(De,ft,We,et,ot,st),xe(ft,qe,ot,st,vt,Ke))}xe(V,$,c,g,f,g),xe($,W,f,g,f,v),xe(W,q,f,v,c,v),xe(q,V,c,v,c,g),ee-=ge,ae-=ge,me+=ge,Ce+=ge;let Te=1/Math.max(me-ee,Ce-ae);return{scale:Te,x:ee*Te,y:ae*Te,x2:me*Te,y2:Ce*Te,projection:t}}let CF=ha(new Float32Array(16));class ah{constructor(t){this.spec=t,this.name=t.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(t,a){return{x:0,y:0,z:0}}unproject(t,a){return new ai(0,0)}projectTilePoint(t,a,c){return{x:t,y:a,z:0}}locationPoint(t,a,c=!0){return t._coordinatePoint(t.locationCoordinate(a),c)}pixelsPerMeter(t,a){return as(1,t)*a}pixelSpaceConversion(t,a,c){return 1}farthestPixelDistance(t){return nI(t,t.pixelsPerMeter)}pointCoordinate(t,a,c,f){let g=t.horizonLineFromTop(!1),v=new It(a,Math.max(g,c));return t.rayIntersectionCoordinate(t.pointRayIntersection(v,f))}pointCoordinate3D(t,a,c){let f=new It(a,c);if(t.elevation)return t.elevation.pointCoordinate(f);{let g=this.pointCoordinate(t,f.x,f.y,0);return[g.x,g.y,g.z]}}isPointAboveHorizon(t,a){if(t.elevation)return!this.pointCoordinate3D(t,a.x,a.y);let c=t.horizonLineFromTop();return a.y<c}createInversionMatrix(t,a){return CF}createTileMatrix(t,a,c){let f,g,v,C=c.canonical,I=ha(new Float64Array(16));if(this.isReprojectedInTileSpace){let A=Bf(C,this);f=1,g=A.x+c.wrap*A.scale,v=A.y,Ic(I,I,[f/A.scale,f/A.scale,t.pixelsPerMeter/a])}else f=a/t.zoomScale(C.z),g=(C.x+Math.pow(2,C.z)*c.wrap)*f,v=C.y*f;return Lu(I,I,[g,v,0]),Ic(I,I,[f/Wt,f/Wt,1]),I}upVector(t,a,c){return[0,0,1]}upVectorScale(t,a,c){return{metersToTile:1}}}class EF extends ah{constructor(t){super(t),this.range=[4,7],this.center=t.center||[-96,37.5];let[a,c]=this.parallels=t.parallels||[29.5,45.5],f=Math.sin(Pn(a));this.n=(f+Math.sin(Pn(c)))/2,this.c=1+f*(2*this.n-f),this.r0=Math.sqrt(this.c)/this.n}project(t,a){let{n:c,c:f,r0:g}=this,v=Pn(t-this.center[0]),C=Pn(a),I=Math.sqrt(f-2*c*Math.sin(C))/c;return{x:I*Math.sin(v*c),y:I*Math.cos(v*c)-g,z:0}}unproject(t,a){let{n:c,c:f,r0:g}=this,v=g+a,C=Math.atan2(t,Math.abs(v))*Math.sign(v);v*c<0&&(C-=Math.PI*Math.sign(t)*Math.sign(v));let I=Pn(this.center[0])*c;C=gr(C,-Math.PI-I,Math.PI-I);let A=Tn(tr(C/c)+this.center[0],-180,180),F=Math.asin(Tn((f-(t*t+v*v)*c*c)/(2*c),-1,1)),V=Tn(tr(F),-Yr,Yr);return new ai(A,V)}}let qy=1.340264,Zy=-.081106,Xy=893e-6,Yy=.003796,pb=Math.sqrt(3)/2;class DF extends ah{project(t,a){a=a/180*Math.PI,t=t/180*Math.PI;let c=Math.asin(pb*Math.sin(a)),f=c*c,g=f*f*f;return{x:.5*(t*Math.cos(c)/(pb*(qy+3*Zy*f+g*(7*Xy+9*Yy*f)))/Math.PI+.5),y:1-.5*(c*(qy+Zy*f+g*(Xy+Yy*f))/Math.PI+1),z:0}}unproject(t,a){t=(2*t-.5)*Math.PI;let c=a=(2*(1-a)-1)*Math.PI,f=c*c,g=f*f*f;for(let F,V,$,W=0;W<12&&(V=c*(qy+Zy*f+g*(Xy+Yy*f))-a,$=qy+3*Zy*f+g*(7*Xy+9*Yy*f),F=V/$,c=Tn(c-F,-Math.PI/3,Math.PI/3),f=c*c,g=f*f*f,!(Math.abs(F)<1e-12));++W);let v=pb*t*(qy+3*Zy*f+g*(7*Xy+9*Yy*f))/Math.cos(c),C=Math.asin(Math.sin(c)/pb),I=Tn(180*v/Math.PI,-180,180),A=Tn(180*C/Math.PI,-Yr,Yr);return new ai(I,A)}}class MF extends ah{constructor(t){super(t),this.wrap=!0,this.supportsWorldCopies=!0}project(t,a){return{x:.5+t/360,y:.5-a/360,z:0}}unproject(t,a){let c=360*(t-.5),f=Tn(360*(.5-a),-Yr,Yr);return new ai(c,f)}}let Pm=Math.PI/2;function mb(o){return Math.tan((Pm+o)/2)}class TF extends ah{constructor(t){super(t),this.center=t.center||[0,30];let[a,c]=this.parallels=t.parallels||[30,30],f=Pn(a),g=Pn(c);this.southernCenter=f+g<0,this.southernCenter&&(f=-f,g=-g);let v=Math.cos(f),C=mb(f);this.n=f===g?Math.sin(f):Math.log(v/Math.cos(g))/Math.log(mb(g)/C),this.f=v*Math.pow(mb(f),this.n)/this.n}project(t,a){a=Pn(a),this.southernCenter&&(a=-a),t=Pn(t-this.center[0]);let c=1e-6,{n:f,f:g}=this;g>0?a<-Pm+c&&(a=-Pm+c):a>Pm-c&&(a=Pm-c);let v=g/Math.pow(mb(a),f),C=v*Math.sin(f*t),I=g-v*Math.cos(f*t);return C=.5*(C/Math.PI+.5),I=.5*(I/Math.PI+.5),{x:C,y:this.southernCenter?I:1-I,z:0}}unproject(t,a){t=(2*t-.5)*Math.PI,this.southernCenter&&(a=1-a),a=(2*(1-a)-.5)*Math.PI;let{n:c,f}=this,g=f-a,v=Math.sign(g),C=Math.sign(c)*Math.sqrt(t*t+g*g),I=Math.atan2(t,Math.abs(g))*v;g*c<0&&(I-=Math.PI*Math.sign(t)*v);let A=Tn(tr(I/c)+this.center[0],-180,180),F=Tn(tr(2*Math.atan(Math.pow(f/C,1/c))-Pm),-Yr,Yr);return new ai(A,this.southernCenter?-F:F)}}class iI extends ah{constructor(t){super(t),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(t,a){return{x:fa(t),y:Va(a),z:0}}unproject(t,a){let c=ls(t),f=Xr(a);return new ai(c,f)}}let rI=Pn(Yr);class IF extends ah{project(t,a){let c=(a=Pn(a))*a,f=c*c;return{x:.5*((t=Pn(t))*(.8707-.131979*c+f*(f*(.003971*c-.001529*f)-.013791))/Math.PI+.5),y:1-.5*(a*(1.007226+c*(.015085+f*(.028874*c-.044475-.005916*f)))/Math.PI+1),z:0}}unproject(t,a){t=(2*t-.5)*Math.PI;let c=a=(2*(1-a)-1)*Math.PI,f=25,g=0,v=c*c;do{v=c*c;let A=v*v;g=(c*(1.007226+v*(.015085+A*(.028874*v-.044475-.005916*A)))-a)/(1.007226+v*(.045255+A*(.259866*v-.311325-.005916*11*A))),c=Tn(c-g,-rI,rI)}while(Math.abs(g)>1e-6&&--f>0);v=c*c;let C=Tn(tr(t/(.8707+v*(v*(v*v*v*(.003971-.001529*v)-.013791)-.131979))),-180,180),I=tr(c);return new ai(C,I)}}let oI=Pn(Yr);class SF extends ah{project(t,a){a=Pn(a),t=Pn(t);let c=Math.cos(a),f=2/Math.PI,g=Math.acos(c*Math.cos(t/2)),v=Math.sin(g)/g,C=.5*(t*f+2*c*Math.sin(t/2)/v)||0,I=.5*(a+Math.sin(a)/v)||0;return{x:.5*(C/Math.PI+.5),y:1-.5*(I/Math.PI+1),z:0}}unproject(t,a){let c=t=(2*t-.5)*Math.PI,f=a=(2*(1-a)-1)*Math.PI,g=25,v=1e-6,C=0,I=0;do{let A=Math.cos(f),F=Math.sin(f),V=2*F*A,$=F*F,W=A*A,q=Math.cos(c/2),ee=Math.sin(c/2),ae=2*q*ee,me=ee*ee,Ce=1-W*q*q,ge=Ce?1/Ce:0,xe=Ce?Math.acos(A*q)*Math.sqrt(1/Ce):0,Te=.5*(2*xe*A*ee+2*c/Math.PI)-t,De=.5*(xe*F+f)-a,qe=.5*ge*(W*me+xe*A*q*$)+1/Math.PI,We=ge*(ae*V/4-xe*F*ee),et=.125*ge*(V*ee-xe*F*W*ae),vt=.5*ge*($*q+xe*me*A)+.5,Ke=We*et-vt*qe;C=(De*We-Te*vt)/Ke,I=(Te*et-De*qe)/Ke,c=Tn(c-C,-Math.PI,Math.PI),f=Tn(f-I,-oI,oI)}while((Math.abs(C)>v||Math.abs(I)>v)&&--g>0);return new ai(tr(c),tr(f))}}class sI extends ah{constructor(t){super(t),this.center=t.center||[0,0],this.parallels=t.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(Pn(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(t,a){let{scale:c,cosPhi:f}=this;return{x:Pn(t)*f*c+.5,y:-Math.sin(Pn(a))/f*c+.5,z:0}}unproject(t,a){let{scale:c,cosPhi:f}=this,g=-(a-.5)/c,v=Tn(tr((t-.5)/c)/f,-180,180),C=Math.asin(Tn(g*f,-1,1)),I=Tn(tr(C),-Yr,Yr);return new ai(v,I)}}class AF extends iI{constructor(t){super(t),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(t,a,c){let f=Tf(t,a,c);return sr(f,f,If(mo(c))),{x:f[0],y:f[1],z:f[2]}}locationPoint(t,a){let c=Qd(a.lat,a.lng),f=or([],c),g=t.elevation?t.elevation.getAtPointOrZero(t.locationCoordinate(a),t._centerAltitude):t._centerAltitude;Ac(c,c,f,as(1,0)*Wt*g);let v=ha(new Float64Array(16));return Fl(v,t.pixelMatrix,t.globeMatrix),sr(c,c,v),new It(c[0],c[1])}pixelsPerMeter(t,a){return as(1,0)*a}pixelSpaceConversion(t,a,c){let f=as(1,t)*a,g=Fn(as(1,45)*a,f,c);return this.pixelsPerMeter(t,a)/g}createTileMatrix(t,a,c){let f=lm(mo(c.canonical));return Fl(new Float64Array(16),t.globeMatrix,f)}createInversionMatrix(t,a){let{center:c}=t,f=If(mo(a));return zo(f,f,Pn(c.lng)),vf(f,f,Pn(c.lat)),Ic(f,f,[t._pixelsPerMercatorPixel,t._pixelsPerMercatorPixel,1]),Float32Array.from(f)}pointCoordinate(t,a,c,f){return Pv(t,a,c,!0)||new Jd(0,0)}pointCoordinate3D(t,a,c){let f=this.pointCoordinate(t,a,c,0);return[f.x,f.y,f.z]}isPointAboveHorizon(t,a){return!Pv(t,a.x,a.y,!1)}farthestPixelDistance(t){let a=function(f,g){let v=f.cameraToCenterDistance,C=f._centerAltitude*g,I=f._camera,A=f._camera.forward(),F=Nn([],os([],A,-v),[0,0,C]),V=f.worldSize/(2*Math.PI),$=[0,0,-V],W=f.width/f.height,q=Math.tan(f.fovAboveCenter),ee=os([],I.up(),q),ae=os([],I.right(),q*W),me=or([],Nn([],Nn([],A,ee),ae)),Ce=[],ge;if(new im(F,me).closestPointOnSphere($,V,Ce)){let xe=Nn([],Ce,$),Te=jo([],xe,F);ge=Math.cos(f.fovAboveCenter)*Ts(Te)}else{let xe=jo([],F,$),Te=jo([],$,F);or(Te,Te);let De=Ts(xe)-V;ge=Math.sqrt(De*(De+2*V));let qe=Math.acos(ge/(V+De))-Math.acos(Bo(A,Te));ge*=Math.cos(qe)}return 1.01*ge}(t,this.pixelsPerMeter(t.center.lat,t.worldSize)),c=Nu(t.zoom);if(c>0){let f=nI(t,as(1,t.center.lat)*t.worldSize),g=t.worldSize/(2*Math.PI),v=Math.max(t.width,t.height)/t.worldSize*Math.PI;return Fn(a,f+g*(1-Math.cos(v)),Math.pow(c,10))}return a}upVector(t,a,c){return Tf(a,c,t,1)}upVectorScale(t){return{metersToTile:Df(am(mo(t)))}}}function aI(o){let t=o.parallels,a=!!t&&Math.abs(t[0]+t[1])<.01;switch(o.name){case"mercator":return new iI(o);case"equirectangular":return new MF(o);case"naturalEarth":return new IF(o);case"equalEarth":return new DF(o);case"winkelTripel":return new SF(o);case"albers":return a?new sI(o):new EF(o);case"lambertConformalConic":return a?new sI(o):new TF(o);case"globe":return new AF(o)}throw new Error(`Invalid projection name: ${o.name}`)}let kF=Gu.types,RF=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function gb(o,t,a,c,f,g,v,C,I,A,F,V,$){let W=C?Math.min(sh,Math.round(C[0])):0,q=C?Math.min(sh,Math.round(C[1])):0;o.emplaceBack(t,a,Math.round(32*c),Math.round(32*f),g,v,(W<<1)+(I?1:0),q,16*A,16*F,256*V,256*$)}function yb(o,t,a,c,f,g,v){o.emplaceBack(t,a,c,f,g,v)}function _b(o,t,a,c,f){o.emplaceBack(t,a,c,f),o.emplaceBack(t,a,c,f),o.emplaceBack(t,a,c,f),o.emplaceBack(t,a,c,f)}function PF(o){for(let t of o.sections)if(qd(t.text))return!0;return!1}class D1{constructor(t){this.layoutVertexArray=new at,this.indexArray=new Vt,this.programConfigurations=t,this.segments=new Xi,this.dynamicLayoutVertexArray=new ht,this.opacityVertexArray=new $t,this.placedSymbolArray=new hr,this.globeExtVertexArray=new _t}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(t,a,c,f){this.isEmpty()||(c&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,hn.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,a),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,qn.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,RF,!0),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=t.createVertexBuffer(this.globeExtVertexArray,fn.members,!0)),this.opacityVertexBuffer.itemSize=1),(c||f)&&this.programConfigurations.upload(t))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}}Ot(D1,"SymbolBuffers");class M1{constructor(t,a,c){this.layoutVertexArray=new t,this.layoutAttributes=a,this.indexArray=new c,this.segments=new Xi,this.collisionVertexArray=new Gt,this.collisionVertexArrayExt=new Mn}upload(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,an.members,!0),this.collisionVertexBufferExt=t.createVertexBuffer(this.collisionVertexArrayExt,br.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}Ot(M1,"CollisionBuffers");class lh{constructor(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(v=>v.id),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=ha([]),this.placementViewportMatrix=ha([]);let a=this.layers[0]._unevaluatedLayout._values;this.textSizeData=ji(this.zoom,a["text-size"]),this.iconSizeData=ji(this.zoom,a["icon-size"]);let c=this.layers[0].layout,f=c.get("symbol-sort-key"),g=c.get("symbol-z-order");this.canOverlap=c.get("text-allow-overlap")||c.get("icon-allow-overlap")||c.get("text-ignore-placement")||c.get("icon-ignore-placement"),this.sortFeaturesByKey=g!=="viewport-y"&&f.constantOr(1)!==void 0,this.sortFeaturesByY=(g==="viewport-y"||g==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=c.get("text-writing-mode").map(v=>ma[v]),this.stateDependentLayerIds=this.layers.filter(v=>v.isStateDependent()).map(v=>v.id),this.sourceID=t.sourceID,this.projection=t.projection}createArrays(){this.text=new D1(new rs(this.layers,this.zoom,t=>/^text/.test(t))),this.icon=new D1(new rs(this.layers,this.zoom,t=>/^icon/.test(t))),this.glyphOffsetArray=new Nr,this.lineVertexArray=new la,this.symbolInstances=new xi}calculateGlyphDependencies(t,a,c,f,g){for(let v=0;v<t.length;v++)if(a[t.charCodeAt(v)]=!0,f&&g){let C=ks[t.charAt(v)];C&&(a[C.charCodeAt(0)]=!0)}}populate(t,a,c,f){let g=this.layers[0],v=g.layout,C=this.projection.name==="globe",I=v.get("text-font"),A=v.get("text-field"),F=v.get("icon-image"),V=(A.value.kind!=="constant"||A.value.value instanceof qr&&!A.value.value.isEmpty()||A.value.value.toString().length>0)&&(I.value.kind!=="constant"||I.value.value.length>0),$=F.value.kind!=="constant"||!!F.value.value||Object.keys(F.parameters).length>0,W=v.get("symbol-sort-key");if(this.features=[],!V&&!$)return;let q=a.iconDependencies,ee=a.glyphDependencies,ae=a.availableImages,me=new z(this.zoom);for(let{feature:Ce,id:ge,index:xe,sourceLayerIndex:Te}of t){let De=g._featureFilter.needGeometry,qe=As(Ce,De);if(!g._featureFilter.filter(me,qe,c))continue;if(De||(qe.geometry=pa(Ce,c,f)),C&&Ce.type!==1&&c.z<=5){let Ke=qe.geometry,ot=.98078528056,st=(ft,wt)=>Bo(Tf(ft.x,ft.y,c,1),Tf(wt.x,wt.y,c,1))<ot;for(let ft=0;ft<Ke.length;ft++)Ke[ft]=jv(Ke[ft],st)}let We,et;if(V){let Ke=g.getValueAndResolveTokens("text-field",qe,c,ae),ot=qr.factory(Ke);PF(ot)&&(this.hasRTLText=!0),(!this.hasRTLText||D()==="unavailable"||this.hasRTLText&&R.isParsed())&&(We=$a(ot,g,qe))}if($){let Ke=g.getValueAndResolveTokens("icon-image",qe,c,ae);et=Ke instanceof Do?Ke:Do.fromString(Ke)}if(!We&&!et)continue;let vt=this.sortFeaturesByKey?W.evaluate(qe,{},c):void 0;if(this.features.push({id:ge,text:We,icon:et,index:xe,sourceLayerIndex:Te,geometry:qe.geometry,properties:Ce.properties,type:kF[Ce.type],sortKey:vt}),et&&(q[et.name]=!0),We){let Ke=I.evaluate(qe,{},c).join(","),ot=v.get("text-rotation-alignment")==="map"&&v.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(ma.vertical)>=0;for(let st of We.sections)if(st.image)q[st.image.name]=!0;else{let ft=Wd(We.toString()),wt=st.fontStack||Ke,Qe=ee[wt]=ee[wt]||{};this.calculateGlyphDependencies(st.text,Qe,ot,this.allowVerticalPlacement,ft)}}}v.get("symbol-placement")==="line"&&(this.features=function(Ce){let ge={},xe={},Te=[],De=0;function qe(Ke){Te.push(Ce[Ke]),De++}function We(Ke,ot,st){let ft=xe[Ke];return delete xe[Ke],xe[ot]=ft,Te[ft].geometry[0].pop(),Te[ft].geometry[0]=Te[ft].geometry[0].concat(st[0]),ft}function et(Ke,ot,st){let ft=ge[ot];return delete ge[ot],ge[Ke]=ft,Te[ft].geometry[0].shift(),Te[ft].geometry[0]=st[0].concat(Te[ft].geometry[0]),ft}function vt(Ke,ot,st){let ft=st?ot[0][ot[0].length-1]:ot[0][0];return`${Ke}:${ft.x}:${ft.y}`}for(let Ke=0;Ke<Ce.length;Ke++){let ot=Ce[Ke],st=ot.geometry,ft=ot.text?ot.text.toString():null;if(!ft){qe(Ke);continue}let wt=vt(ft,st),Qe=vt(ft,st,!0);if(wt in xe&&Qe in ge&&xe[wt]!==ge[Qe]){let kt=et(wt,Qe,st),Nt=We(wt,Qe,Te[kt].geometry);delete ge[wt],delete xe[Qe],xe[vt(ft,Te[Nt].geometry,!0)]=Nt,Te[kt].geometry=null}else wt in xe?We(wt,Qe,st):Qe in ge?et(wt,Qe,st):(qe(Ke),ge[wt]=De-1,xe[Qe]=De-1)}return Te.filter(Ke=>Ke.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((Ce,ge)=>Ce.sortKey-ge.sortKey)}update(t,a,c,f){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(t,a,this.layers,c,f),this.icon.programConfigurations.updatePaintArrays(t,a,this.layers,c,f))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=aI(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(t,a){let c=this.lineVertexArray.length;if(t.segment!==void 0)for(let{x:f,y:g}of a)this.lineVertexArray.emplaceBack(f,g);return{lineStartIndex:c,lineLength:this.lineVertexArray.length-c}}addSymbols(t,a,c,f,g,v,C,I,A,F,V,$,W,q){let ee=t.indexArray,ae=t.layoutVertexArray,me=t.globeExtVertexArray,Ce=t.segments.prepareSegment(4*a.length,ae,ee,this.canOverlap?v.sortKey:void 0),ge=this.glyphOffsetArray.length,xe=Ce.vertexLength,Te=this.allowVerticalPlacement&&C===ma.vertical?Math.PI/2:0,De=v.text&&v.text.sections;for(let We=0;We<a.length;We++){let{tl:et,tr:vt,bl:Ke,br:ot,tex:st,pixelOffsetTL:ft,pixelOffsetBR:wt,minFontScaleX:Qe,minFontScaleY:kt,glyphOffset:Nt,isSDF:Pt,sectionIndex:mn}=a[We],Et=Ce.vertexLength,qt=Nt[1];if(gb(ae,A.x,A.y,et.x,qt+et.y,st.x,st.y,c,Pt,ft.x,ft.y,Qe,kt),gb(ae,A.x,A.y,vt.x,qt+vt.y,st.x+st.w,st.y,c,Pt,wt.x,ft.y,Qe,kt),gb(ae,A.x,A.y,Ke.x,qt+Ke.y,st.x,st.y+st.h,c,Pt,ft.x,wt.y,Qe,kt),gb(ae,A.x,A.y,ot.x,qt+ot.y,st.x+st.w,st.y+st.h,c,Pt,wt.x,wt.y,Qe,kt),I){let{x:gn,y:oi,z:yn}=I.anchor,[tn,Fi,xn]=I.up;yb(me,gn,oi,yn,tn,Fi,xn),yb(me,gn,oi,yn,tn,Fi,xn),yb(me,gn,oi,yn,tn,Fi,xn),yb(me,gn,oi,yn,tn,Fi,xn),_b(t.dynamicLayoutVertexArray,gn,oi,yn,Te)}else _b(t.dynamicLayoutVertexArray,A.x,A.y,A.z,Te);ee.emplaceBack(Et,Et+1,Et+2),ee.emplaceBack(Et+1,Et+2,Et+3),Ce.vertexLength+=4,Ce.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Nt[0]),We!==a.length-1&&mn===a[We+1].sectionIndex||t.programConfigurations.populatePaintArrays(ae.length,v,v.index,{},W,q,De&&De[mn])}let qe=I?I.anchor:A;t.placedSymbolArray.emplaceBack(qe.x,qe.y,qe.z,A.x,A.y,ge,this.glyphOffsetArray.length-ge,xe,F,V,A.segment,c?c[0]:0,c?c[1]:0,f[0],f[1],C,0,!1,0,$,0)}_commitLayoutVertex(t,a,c,f,g,v,C){t.emplaceBack(a,c,f,g,v,Math.round(C.x),Math.round(C.y))}_addCollisionDebugVertices(t,a,c,f,g,v,C){let I=c.segments.prepareSegment(4,c.layoutVertexArray,c.indexArray),A=I.vertexLength,F=C.tileAnchorX,V=C.tileAnchorY;for(let W=0;W<4;W++)c.collisionVertexArray.emplaceBack(0,0,0,0);c.collisionVertexArrayExt.emplaceBack(a,-t.padding,-t.padding),c.collisionVertexArrayExt.emplaceBack(a,t.padding,-t.padding),c.collisionVertexArrayExt.emplaceBack(a,t.padding,t.padding),c.collisionVertexArrayExt.emplaceBack(a,-t.padding,t.padding),this._commitLayoutVertex(c.layoutVertexArray,f,g,v,F,V,new It(t.x1,t.y1)),this._commitLayoutVertex(c.layoutVertexArray,f,g,v,F,V,new It(t.x2,t.y1)),this._commitLayoutVertex(c.layoutVertexArray,f,g,v,F,V,new It(t.x2,t.y2)),this._commitLayoutVertex(c.layoutVertexArray,f,g,v,F,V,new It(t.x1,t.y2)),I.vertexLength+=4;let $=c.indexArray;$.emplaceBack(A,A+1),$.emplaceBack(A+1,A+2),$.emplaceBack(A+2,A+3),$.emplaceBack(A+3,A),I.primitiveLength+=4}_addTextDebugCollisionBoxes(t,a,c,f,g,v){for(let C=f;C<g;C++){let I=c.get(C),A=this.getSymbolInstanceTextSize(t,v,a,C);this._addCollisionDebugVertices(I,A,this.textCollisionBox,I.projectedAnchorX,I.projectedAnchorY,I.projectedAnchorZ,v)}}_addIconDebugCollisionBoxes(t,a,c,f,g,v){for(let C=f;C<g;C++){let I=c.get(C),A=this.getSymbolInstanceIconSize(t,a,v.placedIconSymbolIndex);this._addCollisionDebugVertices(I,A,this.iconCollisionBox,I.projectedAnchorX,I.projectedAnchorY,I.projectedAnchorZ,v)}}generateCollisionDebugBuffers(t,a){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new M1(Ft,Ki.members,vr),this.iconCollisionBox=new M1(Ft,Ki.members,vr);let c=Qi(this.iconSizeData,t),f=Qi(this.textSizeData,t);for(let g=0;g<this.symbolInstances.length;g++){let v=this.symbolInstances.get(g);this._addTextDebugCollisionBoxes(f,t,a,v.textBoxStartIndex,v.textBoxEndIndex,v),this._addTextDebugCollisionBoxes(f,t,a,v.verticalTextBoxStartIndex,v.verticalTextBoxEndIndex,v),this._addIconDebugCollisionBoxes(c,t,a,v.iconBoxStartIndex,v.iconBoxEndIndex,v),this._addIconDebugCollisionBoxes(c,t,a,v.verticalIconBoxStartIndex,v.verticalIconBoxEndIndex,v)}}getSymbolInstanceTextSize(t,a,c,f){let g=this.text.placedSymbolArray.get(a.rightJustifiedTextSymbolIndex>=0?a.rightJustifiedTextSymbolIndex:a.centerJustifiedTextSymbolIndex>=0?a.centerJustifiedTextSymbolIndex:a.leftJustifiedTextSymbolIndex>=0?a.leftJustifiedTextSymbolIndex:a.verticalPlacedTextSymbolIndex>=0?a.verticalPlacedTextSymbolIndex:f),v=Pr(this.textSizeData,t,g)/An;return this.tilePixelRatio*v}getSymbolInstanceIconSize(t,a,c){let f=this.icon.placedSymbolArray.get(c),g=Pr(this.iconSizeData,t,f);return this.tilePixelRatio*g}_commitDebugCollisionVertexUpdate(t,a,c){t.emplaceBack(a,-c,-c),t.emplaceBack(a,c,-c),t.emplaceBack(a,c,c),t.emplaceBack(a,-c,c)}_updateTextDebugCollisionBoxes(t,a,c,f,g,v){for(let C=f;C<g;C++){let I=c.get(C),A=this.getSymbolInstanceTextSize(t,v,a,C);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,A,I.padding)}}_updateIconDebugCollisionBoxes(t,a,c,f,g,v){for(let C=f;C<g;C++){let I=c.get(C),A=this.getSymbolInstanceIconSize(t,a,v);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,A,I.padding)}}updateCollisionDebugBuffers(t,a){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();let c=Qi(this.iconSizeData,t),f=Qi(this.textSizeData,t);for(let g=0;g<this.symbolInstances.length;g++){let v=this.symbolInstances.get(g);this._updateTextDebugCollisionBoxes(f,t,a,v.textBoxStartIndex,v.textBoxEndIndex,v),this._updateTextDebugCollisionBoxes(f,t,a,v.verticalTextBoxStartIndex,v.verticalTextBoxEndIndex,v),this._updateIconDebugCollisionBoxes(c,t,a,v.iconBoxStartIndex,v.iconBoxEndIndex,v.placedIconSymbolIndex),this._updateIconDebugCollisionBoxes(c,t,a,v.verticalIconBoxStartIndex,v.verticalIconBoxEndIndex,v.placedIconSymbolIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(t,a,c,f,g,v,C,I,A){let F={};if(a<c){let{x1:V,y1:$,x2:W,y2:q,padding:ee,projectedAnchorX:ae,projectedAnchorY:me,projectedAnchorZ:Ce,tileAnchorX:ge,tileAnchorY:xe,featureIndex:Te}=t.get(a);F.textBox={x1:V,y1:$,x2:W,y2:q,padding:ee,projectedAnchorX:ae,projectedAnchorY:me,projectedAnchorZ:Ce,tileAnchorX:ge,tileAnchorY:xe},F.textFeatureIndex=Te}if(f<g){let{x1:V,y1:$,x2:W,y2:q,padding:ee,projectedAnchorX:ae,projectedAnchorY:me,projectedAnchorZ:Ce,tileAnchorX:ge,tileAnchorY:xe,featureIndex:Te}=t.get(f);F.verticalTextBox={x1:V,y1:$,x2:W,y2:q,padding:ee,projectedAnchorX:ae,projectedAnchorY:me,projectedAnchorZ:Ce,tileAnchorX:ge,tileAnchorY:xe},F.verticalTextFeatureIndex=Te}if(v<C){let{x1:V,y1:$,x2:W,y2:q,padding:ee,projectedAnchorX:ae,projectedAnchorY:me,projectedAnchorZ:Ce,tileAnchorX:ge,tileAnchorY:xe,featureIndex:Te}=t.get(v);F.iconBox={x1:V,y1:$,x2:W,y2:q,padding:ee,projectedAnchorX:ae,projectedAnchorY:me,projectedAnchorZ:Ce,tileAnchorX:ge,tileAnchorY:xe},F.iconFeatureIndex=Te}if(I<A){let{x1:V,y1:$,x2:W,y2:q,padding:ee,projectedAnchorX:ae,projectedAnchorY:me,projectedAnchorZ:Ce,tileAnchorX:ge,tileAnchorY:xe,featureIndex:Te}=t.get(I);F.verticalIconBox={x1:V,y1:$,x2:W,y2:q,padding:ee,projectedAnchorX:ae,projectedAnchorY:me,projectedAnchorZ:Ce,tileAnchorX:ge,tileAnchorY:xe},F.verticalIconFeatureIndex=Te}return F}deserializeCollisionBoxes(t){this.collisionArrays=[];for(let a=0;a<this.symbolInstances.length;a++){let c=this.symbolInstances.get(a);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,c.textBoxStartIndex,c.textBoxEndIndex,c.verticalTextBoxStartIndex,c.verticalTextBoxEndIndex,c.iconBoxStartIndex,c.iconBoxEndIndex,c.verticalIconBoxStartIndex,c.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(t,a){let c=t.placedSymbolArray.get(a),f=c.vertexStartIndex+4*c.numGlyphs;for(let g=c.vertexStartIndex;g<f;g+=4)t.indexArray.emplaceBack(g,g+1,g+2),t.indexArray.emplaceBack(g+1,g+2,g+3)}getSortedSymbolIndexes(t){if(this.sortedAngle===t&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;let a=Math.sin(t),c=Math.cos(t),f=[],g=[],v=[];for(let C=0;C<this.symbolInstances.length;++C){v.push(C);let I=this.symbolInstances.get(C);f.push(0|Math.round(a*I.tileAnchorX+c*I.tileAnchorY)),g.push(I.featureIndex)}return v.sort((C,I)=>f[C]-f[I]||g[I]-g[C]),v}addToSortKeyRanges(t,a){let c=this.sortKeyRanges[this.sortKeyRanges.length-1];c&&c.sortKey===a?c.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:a,symbolInstanceStart:t,symbolInstanceEnd:t+1})}sortFeatures(t){if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(let a of this.symbolInstanceIndexes){let c=this.symbolInstances.get(a);this.featureSortOrder.push(c.featureIndex);let{rightJustifiedTextSymbolIndex:f,centerJustifiedTextSymbolIndex:g,leftJustifiedTextSymbolIndex:v,verticalPlacedTextSymbolIndex:C,placedIconSymbolIndex:I,verticalPlacedIconSymbolIndex:A}=c;f>=0&&this.addIndicesForPlacedSymbol(this.text,f),g>=0&&g!==f&&this.addIndicesForPlacedSymbol(this.text,g),v>=0&&v!==g&&v!==f&&this.addIndicesForPlacedSymbol(this.text,v),C>=0&&this.addIndicesForPlacedSymbol(this.text,C),I>=0&&this.addIndicesForPlacedSymbol(this.icon,I),A>=0&&this.addIndicesForPlacedSymbol(this.icon,A)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}Ot(lh,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),lh.MAX_GLYPHS=65535,lh.addDynamicAttributes=_b;let OF=new _e({"symbol-placement":new Q(Je.layout_symbol["symbol-placement"]),"symbol-spacing":new Q(Je.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Q(Je.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new ue(Je.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Q(Je.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Q(Je.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Q(Je.layout_symbol["icon-ignore-placement"]),"icon-optional":new Q(Je.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Q(Je.layout_symbol["icon-rotation-alignment"]),"icon-size":new ue(Je.layout_symbol["icon-size"]),"icon-text-fit":new Q(Je.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Q(Je.layout_symbol["icon-text-fit-padding"]),"icon-image":new ue(Je.layout_symbol["icon-image"]),"icon-rotate":new ue(Je.layout_symbol["icon-rotate"]),"icon-padding":new Q(Je.layout_symbol["icon-padding"]),"icon-keep-upright":new Q(Je.layout_symbol["icon-keep-upright"]),"icon-offset":new ue(Je.layout_symbol["icon-offset"]),"icon-anchor":new ue(Je.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Q(Je.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Q(Je.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Q(Je.layout_symbol["text-rotation-alignment"]),"text-field":new ue(Je.layout_symbol["text-field"]),"text-font":new ue(Je.layout_symbol["text-font"]),"text-size":new ue(Je.layout_symbol["text-size"]),"text-max-width":new ue(Je.layout_symbol["text-max-width"]),"text-line-height":new ue(Je.layout_symbol["text-line-height"]),"text-letter-spacing":new ue(Je.layout_symbol["text-letter-spacing"]),"text-justify":new ue(Je.layout_symbol["text-justify"]),"text-radial-offset":new ue(Je.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Q(Je.layout_symbol["text-variable-anchor"]),"text-anchor":new ue(Je.layout_symbol["text-anchor"]),"text-max-angle":new Q(Je.layout_symbol["text-max-angle"]),"text-writing-mode":new Q(Je.layout_symbol["text-writing-mode"]),"text-rotate":new ue(Je.layout_symbol["text-rotate"]),"text-padding":new Q(Je.layout_symbol["text-padding"]),"text-keep-upright":new Q(Je.layout_symbol["text-keep-upright"]),"text-transform":new ue(Je.layout_symbol["text-transform"]),"text-offset":new ue(Je.layout_symbol["text-offset"]),"text-allow-overlap":new Q(Je.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Q(Je.layout_symbol["text-ignore-placement"]),"text-optional":new Q(Je.layout_symbol["text-optional"])});var T1={paint:new _e({"icon-opacity":new ue(Je.paint_symbol["icon-opacity"]),"icon-color":new ue(Je.paint_symbol["icon-color"]),"icon-halo-color":new ue(Je.paint_symbol["icon-halo-color"]),"icon-halo-width":new ue(Je.paint_symbol["icon-halo-width"]),"icon-halo-blur":new ue(Je.paint_symbol["icon-halo-blur"]),"icon-translate":new Q(Je.paint_symbol["icon-translate"]),"icon-translate-anchor":new Q(Je.paint_symbol["icon-translate-anchor"]),"text-opacity":new ue(Je.paint_symbol["text-opacity"]),"text-color":new ue(Je.paint_symbol["text-color"],{runtimeType:Co,getOverride:o=>o.textColor,hasOverride:o=>!!o.textColor}),"text-halo-color":new ue(Je.paint_symbol["text-halo-color"]),"text-halo-width":new ue(Je.paint_symbol["text-halo-width"]),"text-halo-blur":new ue(Je.paint_symbol["text-halo-blur"]),"text-translate":new Q(Je.paint_symbol["text-translate"]),"text-translate-anchor":new Q(Je.paint_symbol["text-translate-anchor"])}),layout:OF};class lI{constructor(t){this.type=t.property.overrides?t.property.overrides.runtimeType:sl,this.defaultValue=t}evaluate(t){if(t.formattedSection){let a=this.defaultValue.property.overrides;if(a&&a.hasOverride(t.formattedSection))return a.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default}eachChild(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Ot(lI,"FormatSectionOverride",{omit:["defaultValue"]});class vb extends Ms{constructor(t){super(t,T1)}recalculate(t,a){super.recalculate(t,a),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));let c=this.layout.get("text-writing-mode");if(c){let f=[];for(let g of c)f.indexOf(g)<0&&f.push(g);this.layout._values["text-writing-mode"]=f}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(t,a,c,f){let g=this.layout.get(t).evaluate(a,{},c,f),v=this._unevaluatedLayout._values[t];return v.isDataDriven()||Tl(v.value)||!g?g:function(C,I){return I.replace(/{([^{}]+)}/g,(A,F)=>F in C?String(C[F]):"")}(a.properties,g)}createBucket(t){return new lh(t)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(let t of T1.paint.overridableProperties){if(!vb.hasPaintOverride(this.layout,t))continue;let a=this.paint.get(t),c=new lI(a),f=new Ud(c,a.property.specification),g=null;g=a.value.kind==="constant"||a.value.kind==="source"?new $d("source",f):new La("composite",f,a.value.zoomStops,a.value._interpolationType),this.paint._values[t]=new he(a.property,g,a.parameters)}}_handleOverridablePaintPropertyUpdate(t,a,c){return!(!this.layout||a.isDataDriven()||c.isDataDriven())&&vb.hasPaintOverride(this.layout,t)}static hasPaintOverride(t,a){let c=t.get("text-field"),f=T1.paint.properties[a],g=!1,v=C=>{for(let I of C)if(f.overrides&&f.overrides.hasOverride(I))return void(g=!0)};if(c.value.kind==="constant"&&c.value.value instanceof qr)v(c.value.value.sections);else if(c.value.kind==="source"){let C=A=>{g||(A instanceof Oo&&qi(A.value)===su?v(A.value.sections):A instanceof ka?v(A.sections):A.eachChild(C))},I=c.value;I._styleExpression&&C(I._styleExpression.expression)}return g}getProgramConfiguration(t){return new Ll(this,t)}}var LF={paint:new _e({"background-color":new Q(Je.paint_background["background-color"]),"background-pattern":new Q(Je.paint_background["background-pattern"]),"background-opacity":new Q(Je.paint_background["background-opacity"])})},FF={paint:new _e({"raster-opacity":new Q(Je.paint_raster["raster-opacity"]),"raster-hue-rotate":new Q(Je.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Q(Je.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Q(Je.paint_raster["raster-brightness-max"]),"raster-saturation":new Q(Je.paint_raster["raster-saturation"]),"raster-contrast":new Q(Je.paint_raster["raster-contrast"]),"raster-resampling":new Q(Je.paint_raster["raster-resampling"]),"raster-fade-duration":new Q(Je.paint_raster["raster-fade-duration"])})};class NF extends Ms{constructor(t){super(t,{}),this.implementation=t}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}isLayerDraped(){return this.implementation.renderToTile!==void 0}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(t){this.implementation.onAdd&&this.implementation.onAdd(t,t.painter.context.gl)}onRemove(t){this.implementation.onRemove&&this.implementation.onRemove(t,t.painter.context.gl)}}var zF={paint:new _e({"sky-type":new Q(Je.paint_sky["sky-type"]),"sky-atmosphere-sun":new Q(Je.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new Q(Je.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new Q(Je.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new Q(Je.paint_sky["sky-gradient-radius"]),"sky-gradient":new ye(Je.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new Q(Je.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new Q(Je.paint_sky["sky-atmosphere-color"]),"sky-opacity":new Q(Je.paint_sky["sky-opacity"])})};function I1(o,t,a){let c=[0,0,1],f=xf([]);return nm(f,f,a?-Pn(o)+Math.PI:Pn(o)),tm(f,f,-Pn(t)),yy(c,c,f),or(c,c)}let BF={circle:class extends Ms{constructor(o){super(o,Rf)}createBucket(o){return new th(o)}queryRadius(o){let t=o;return Vu("circle-radius",this,t)+Vu("circle-stroke-width",this,t)+Uu(this.paint.get("circle-translate"))}queryIntersectsFeature(o,t,a,c,f,g,v,C){let I=Dy(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),g.angle,o.pixelToTileUnitsFactor),A=this.paint.get("circle-radius").evaluate(t,a)+this.paint.get("circle-stroke-width").evaluate(t,a);return Gv(o,c,g,v,C,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",I,A)}getProgramIds(){return["circle"]}getProgramConfiguration(o){return new Ll(this,o)}},heatmap:class extends Ms{createBucket(o){return new qv(o)}constructor(o){super(o,Xv),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(o){o==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Sy({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(o){return Vu("heatmap-radius",this,o)}queryIntersectsFeature(o,t,a,c,f,g,v,C){let I=this.paint.get("heatmap-radius").evaluate(t,a);return Gv(o,c,g,v,C,!0,!0,new It(0,0),I)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(o){return new Ll(this,o)}},hillshade:class extends Ms{constructor(o){super(o,Ay)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}},fill:class extends Ms{constructor(o){super(o,nb)}getProgramIds(){let o=this.paint.get("fill-pattern"),t=o&&o.constantOr(1),a=[t?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&a.push(t&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),a}getProgramConfiguration(o){return new Ll(this,o)}recalculate(o,t){super.recalculate(o,t);let a=this.paint._values["fill-outline-color"];a.value.kind==="constant"&&a.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(o){return new Nf(o)}queryRadius(){return Uu(this.paint.get("fill-translate"))}queryIntersectsFeature(o,t,a,c,f,g){return!o.queryGeometry.isAboveHorizon&&Pc(Hv(o.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),g.angle,o.pixelToTileUnitsFactor),c)}isTileClipped(){return!0}},"fill-extrusion":class extends Ms{constructor(o){super(o,X)}createBucket(o){return new y(o)}queryRadius(){return Uu(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(o){return new Ll(this,o)}queryIntersectsFeature(o,t,a,c,f,g,v,C,I){let A=Dy(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),g.angle,o.pixelToTileUnitsFactor),F=this.paint.get("fill-extrusion-height").evaluate(t,a),V=this.paint.get("fill-extrusion-base").evaluate(t,a),$=[0,0],W=C&&g.elevation,q=g.elevation?g.elevation.exaggeration():1,ee=o.tile.getBucket(this);if(W&&ee instanceof y){let xe=ee.centroidVertexArray,Te=I+1;Te<xe.length&&($[0]=xe.geta_centroid_pos0(Te),$[1]=xe.geta_centroid_pos1(Te))}if($[0]===0&&$[1]===1)return!1;g.projection.name==="globe"&&(c=N([c],[new It(0,0),new It(Wt,Wt)],o.tileID.canonical).map(xe=>xe.polygon).flat());let ae=W?C:null,[me,Ce]=function(xe,Te,De,qe,We,et,vt,Ke,ot,st,ft){return xe.projection.name==="globe"?function(wt,Qe,kt,Nt,Pt,mn,Et,qt,gn,oi,yn){let tn=[],Fi=[],xn=wt.projection.upVectorScale(yn,wt.center.lat,wt.worldSize).metersToTile,wn=[0,0,0,1],Ci=[0,0,0,1],ki=(Ei,Ji,fr,Er)=>{Ei[0]=Ji,Ei[1]=fr,Ei[2]=Er,Ei[3]=1},Ri=B();kt>0&&(kt+=Ri),Nt+=Ri;for(let Ei of Qe){let Ji=[],fr=[];for(let Er of Ei){let Di=Er.x+Pt.x,Or=Er.y+Pt.y,Dr=wt.projection.projectTilePoint(Di,Or,yn),ar=wt.projection.upVector(yn,Er.x,Er.y),li=kt,Mr=Nt;if(Et){let Pi=Le(Di,Or,kt,Nt,Et,qt,gn,oi);li+=Pi.base,Mr+=Pi.top}kt!==0?ki(wn,Dr.x+ar[0]*xn*li,Dr.y+ar[1]*xn*li,Dr.z+ar[2]*xn*li):ki(wn,Dr.x,Dr.y,Dr.z),ki(Ci,Dr.x+ar[0]*xn*Mr,Dr.y+ar[1]*xn*Mr,Dr.z+ar[2]*xn*Mr),sr(wn,wn,mn),sr(Ci,Ci,mn),Ji.push(new de(wn[0],wn[1],wn[2])),fr.push(new de(Ci[0],Ci[1],Ci[2]))}tn.push(Ji),Fi.push(fr)}return[tn,Fi]}(xe,Te,De,qe,We,et,vt,Ke,ot,st,ft):vt?function(wt,Qe,kt,Nt,Pt,mn,Et,qt,gn){let oi=[],yn=[],tn=[0,0,0,1];for(let Fi of wt){let xn=[],wn=[];for(let Ci of Fi){let ki=Ci.x+Nt.x,Ri=Ci.y+Nt.y,Ei=Le(ki,Ri,Qe,kt,mn,Et,qt,gn);tn[0]=ki,tn[1]=Ri,tn[2]=Ei.base,tn[3]=1,Fu(tn,tn,Pt),tn[3]=Math.max(tn[3],1e-5);let Ji=new de(tn[0]/tn[3],tn[1]/tn[3],tn[2]/tn[3]);tn[0]=ki,tn[1]=Ri,tn[2]=Ei.top,tn[3]=1,Fu(tn,tn,Pt),tn[3]=Math.max(tn[3],1e-5);let fr=new de(tn[0]/tn[3],tn[1]/tn[3],tn[2]/tn[3]);xn.push(Ji),wn.push(fr)}oi.push(xn),yn.push(wn)}return[oi,yn]}(Te,De,qe,We,et,vt,Ke,ot,st):function(wt,Qe,kt,Nt,Pt){let mn=[],Et=[],qt=Pt[8]*Qe,gn=Pt[9]*Qe,oi=Pt[10]*Qe,yn=Pt[11]*Qe,tn=Pt[8]*kt,Fi=Pt[9]*kt,xn=Pt[10]*kt,wn=Pt[11]*kt;for(let Ci of wt){let ki=[],Ri=[];for(let Ei of Ci){let Ji=Ei.x+Nt.x,fr=Ei.y+Nt.y,Er=Pt[0]*Ji+Pt[4]*fr+Pt[12],Di=Pt[1]*Ji+Pt[5]*fr+Pt[13],Or=Pt[2]*Ji+Pt[6]*fr+Pt[14],Dr=Pt[3]*Ji+Pt[7]*fr+Pt[15],ar=Er+qt,li=Di+gn,Mr=Or+oi,Pi=Math.max(Dr+yn,1e-5),Vo=Er+tn,Tr=Di+Fi,so=Or+xn,Kr=Math.max(Dr+wn,1e-5);ki.push(new de(ar/Pi,li/Pi,Mr/Pi)),Ri.push(new de(Vo/Kr,Tr/Kr,so/Kr))}mn.push(ki),Et.push(Ri)}return[mn,Et]}(Te,De,qe,We,et)}(g,c,V,F,A,v,ae,$,q,g.center.lat,o.tileID.canonical),ge=o.queryGeometry;return function(xe,Te,De){let qe=1/0;Pc(De,Te)&&(qe=Ue(De,Te[0]));for(let We=0;We<Te.length;We++){let et=Te[We],vt=xe[We];for(let Ke=0;Ke<et.length-1;Ke++){let ot=et[Ke],st=[ot,et[Ke+1],vt[Ke+1],vt[Ke],ot];Vv(De,st)&&(qe=Math.min(qe,Ue(De,st)))}}return qe!==1/0&&qe}(me,Ce,ge.isPointQuery()?ge.screenBounds:ge.screenGeometry)}},line:class extends Ms{constructor(o){super(o,Yt),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(o){if(o==="line-gradient"){let t=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=t._styleExpression&&t._styleExpression.expression instanceof Gh,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(o,t){super.recalculate(o,t),this.paint._values["line-floorwidth"]=zt.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,o)}createBucket(o){return new Lt(o)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getProgramConfiguration(o){return new Ll(this,o)}queryRadius(o){let t=o,a=Sn(Vu("line-width",this,t),Vu("line-gap-width",this,t)),c=Vu("line-offset",this,t);return a/2+Math.abs(c)+Uu(this.paint.get("line-translate"))}queryIntersectsFeature(o,t,a,c,f,g){if(o.queryGeometry.isAboveHorizon)return!1;let v=Hv(o.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),g.angle,o.pixelToTileUnitsFactor),C=o.pixelToTileUnitsFactor/2*Sn(this.paint.get("line-width").evaluate(t,a),this.paint.get("line-gap-width").evaluate(t,a)),I=this.paint.get("line-offset").evaluate(t,a);return I&&(c=function(A,F){let V=[],$=new It(0,0);for(let W=0;W<A.length;W++){let q=A[W],ee=[];for(let ae=0;ae<q.length;ae++){let me=q[ae],Ce=q[ae+1],ge=ae===0?$:me.sub(q[ae-1])._unit()._perp(),xe=ae===q.length-1?$:Ce.sub(me)._unit()._perp(),Te=ge._add(xe)._unit();Te._mult(1/(Te.x*xe.x+Te.y*xe.y)),ee.push(Te._mult(F)._add(me))}V.push(ee)}return V}(c,I*o.pixelToTileUnitsFactor)),function(A,F,V){for(let $=0;$<F.length;$++){let W=F[$];if(A.length>=3){for(let q=0;q<W.length;q++)if(ju(A,W[q]))return!0}if(Uv(A,W,V))return!0}return!1}(v,c,C)}isTileClipped(){return!0}},symbol:vb,background:class extends Ms{constructor(o){super(o,LF)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends Ms{constructor(o){super(o,FF)}getProgramIds(){return["raster"]}},sky:class extends Ms{constructor(o){super(o,zF),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(o){o==="sky-gradient"?this._updateColorRamp():o!=="sky-atmosphere-sun"&&o!=="sky-atmosphere-halo-color"&&o!=="sky-atmosphere-color"&&o!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=Sy({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(o){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){let t=o.style.light.properties.get("position");return this._lightPosition.azimuthal!==t.azimuthal||this._lightPosition.polar!==t.polar}return!1}getCenter(o,t){if(this.paint.get("sky-type")==="atmosphere"){let c=this.paint.get("sky-atmosphere-sun"),f=!c,g=o.style.light,v=g.properties.get("position");return f&&g.properties.get("anchor")==="viewport"&&vi("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),f?I1(v.azimuthal,90-v.polar,t):I1(c[0],90-c[1],t)}let a=this.paint.get("sky-gradient-center");return I1(a[0],90-a[1],t)}is3D(){return!1}isSky(){return!0}markSkyboxValid(o){this._skyboxInvalidated=!1,this._lightPosition=o.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){let o=this.paint.get("sky-type");return o==="atmosphere"?["skyboxCapture","skybox"]:o==="gradient"?["skyboxGradient"]:null}}};class Ky{constructor(t,a,c,f){this.context=t,this.format=c,this.texture=t.gl.createTexture(),this.update(a,f)}update(t,a,c){let{width:f,height:g}=t,{context:v}=this,{gl:C}=v,{HTMLImageElement:I,HTMLCanvasElement:A,HTMLVideoElement:F,ImageData:V,ImageBitmap:$}=E;if(C.bindTexture(C.TEXTURE_2D,this.texture),v.pixelStoreUnpackFlipY.set(!1),v.pixelStoreUnpack.set(1),v.pixelStoreUnpackPremultiplyAlpha.set(this.format===C.RGBA&&(!a||a.premultiply!==!1)),c||this.size&&this.size[0]===f&&this.size[1]===g){let{x:W,y:q}=c||{x:0,y:0};t instanceof I||t instanceof A||t instanceof F||t instanceof V||$&&t instanceof $?C.texSubImage2D(C.TEXTURE_2D,0,W,q,C.RGBA,C.UNSIGNED_BYTE,t):C.texSubImage2D(C.TEXTURE_2D,0,W,q,f,g,C.RGBA,C.UNSIGNED_BYTE,t.data)}else this.size=[f,g],t instanceof I||t instanceof A||t instanceof F||t instanceof V||$&&t instanceof $?C.texImage2D(C.TEXTURE_2D,0,this.format,this.format,C.UNSIGNED_BYTE,t):C.texImage2D(C.TEXTURE_2D,0,this.format,f,g,0,this.format,C.UNSIGNED_BYTE,t.data);this.useMipmap=!!(a&&a.useMipmap&&this.isSizePowerOfTwo()),this.useMipmap&&C.generateMipmap(C.TEXTURE_2D)}bind(t,a){let{context:c}=this,{gl:f}=c;f.bindTexture(f.TEXTURE_2D,this.texture),t!==this.filter&&(f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,t),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,this.useMipmap?t===f.NEAREST?f.NEAREST_MIPMAP_NEAREST:f.LINEAR_MIPMAP_NEAREST:t),this.filter=t),a!==this.wrap&&(f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,a),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,a),this.wrap=a)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){let{gl:t}=this.context;t.deleteTexture(this.texture),this.texture=null}}class jF{constructor(t){this._callback=t,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class VF{constructor(){this.tasks={},this.taskQueue=[],Ma(["process"],this),this.invoker=new jF(this.process),this.nextId=0}add(t,a){let c=this.nextId++,f=function({type:g,isSymbolTile:v,zoom:C}){return C=C||0,g==="message"?0:g!=="maybePrepare"||v?g!=="parseTile"||v?g==="parseTile"&&v?300-C:g==="maybePrepare"&&v?400-C:500:200-C:100-C}(a);if(f===0){ys();try{t()}finally{}return{cancel:()=>{}}}return this.tasks[c]={fn:t,metadata:a,priority:f,id:c},this.taskQueue.push(c),this.invoker.trigger(),{cancel:()=>{delete this.tasks[c]}}}process(){ys();try{if(this.taskQueue=this.taskQueue.filter(c=>!!this.tasks[c]),!this.taskQueue.length)return;let t=this.pick();if(t===null)return;let a=this.tasks[t];if(delete this.tasks[t],this.taskQueue.length&&this.invoker.trigger(),!a)return;a.fn()}finally{}}pick(){let t=null,a=1/0;for(let f=0;f<this.taskQueue.length;f++){let g=this.tasks[this.taskQueue[f]];g.priority<a&&(a=g.priority,t=f)}if(t===null)return null;let c=this.taskQueue[t];return this.taskQueue.splice(t,1),c}remove(){this.invoker.remove()}}class cI{constructor(t){this._stringToNumber={},this._numberToString=[];for(let a=0;a<t.length;a++){let c=t[a];this._stringToNumber[c]=a,this._numberToString[a]=c}}encode(t){return this._stringToNumber[t]}decode(t){return this._numberToString[t]}}let UF=["tile","layer","source","sourceLayer","state"];class uI{constructor(t,a,c,f,g){this.type="Feature",this._vectorTileFeature=t,this._z=a,this._x=c,this._y=f,this.properties=t.properties,this.id=g}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(t){this._geometry=t}toJSON(){let t={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};this.id!==void 0&&(t.id=this.id);for(let a of UF)this[a]!==void 0&&(t[a]=this[a]);return t}}let Ha=32,Lc=33,ch=new Uint16Array(8184);for(let o=0;o<2046;o++){let t=o+2,a=0,c=0,f=0,g=0,v=0,C=0;for(1&t?f=g=v=Ha:a=c=C=Ha;(t>>=1)>1;){let A=a+f>>1,F=c+g>>1;1&t?(f=a,g=c,a=v,c=C):(a=f,c=g,f=v,g=C),v=A,C=F}let I=4*o;ch[I+0]=a,ch[I+1]=c,ch[I+2]=f,ch[I+3]=g}let Fc=new Uint16Array(2178),uh=new Uint8Array(1089),bb=new Uint16Array(1089);function dI(o){return o===0?-.03125:o===32?.03125:0}var hI=Fe([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);let fI={type:2,extent:Wt,loadGeometry:()=>[[new It(0,0),new It(Wt+1,0),new It(Wt+1,Wt+1),new It(0,Wt+1),new It(0,0)]]};class S1{constructor(t,a,c,f,g){this.tileID=t,this.uid=tl(),this.uses=0,this.tileSize=a,this.tileZoom=c,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=g,this.expiredRequestCount=0,this.state="loading",f&&f.transform&&(this.projection=f.transform.projection)}registerFadeDuration(t){let a=t+this.timeAdded;a<vs.now()||this.fadeEndTime&&a<this.fadeEndTime||(this.fadeEndTime=a)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=Bf(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(t,a,c){if(this.unloadVectorData(),this.state="loaded",t){t.featureIndex&&(this.latestFeatureIndex=t.featureIndex,t.rawTileData?(this.latestRawTileData=t.rawTileData,this.latestFeatureIndex.rawTileData=t.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=t.collisionBoxArray,this.buckets=function(f,g){let v={};if(!g)return v;for(let C of f){let I=C.layerIds.map(A=>g.getLayer(A)).filter(Boolean);if(I.length!==0){C.layers=I,C.stateDependentLayerIds&&(C.stateDependentLayers=C.stateDependentLayerIds.map(A=>I.filter(F=>F.id===A)[0]));for(let A of I)v[A.id]=C}}return v}(t.buckets,a.style),this.hasSymbolBuckets=!1;for(let f in this.buckets){let g=this.buckets[f];if(g instanceof lh){if(this.hasSymbolBuckets=!0,!c)break;g.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(let f in this.buckets){let g=this.buckets[f];if(g instanceof lh&&g.hasRTLText){this.hasRTLText=!0,R.isLoading()||R.isLoaded()||D()!=="deferred"||k();break}}this.queryPadding=0;for(let f in this.buckets){let g=this.buckets[f];this.queryPadding=Math.max(this.queryPadding,a.style.getLayer(f).queryRadius(g))}t.imageAtlas&&(this.imageAtlas=t.imageAtlas),t.glyphAtlasImage&&(this.glyphAtlasImage=t.glyphAtlasImage),t.lineAtlas&&(this.lineAtlas=t.lineAtlas)}else this.collisionBoxArray=new fi}unloadVectorData(){if(this.hasData()){for(let t in this.buckets)this.buckets[t].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(t){return this.buckets[t.id]}upload(t){for(let c in this.buckets){let f=this.buckets[c];f.uploadPending()&&f.upload(t)}let a=t.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Ky(t,this.imageAtlas.image,a.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Ky(t,this.glyphAtlasImage,a.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new Ky(t,this.lineAtlas.image,a.ALPHA),this.lineAtlas.uploaded=!0)}prepare(t){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(t,this.imageAtlasTexture)}queryRenderedFeatures(t,a,c,f,g,v,C,I){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:f,pixelPosMatrix:C,transform:v,params:g,tileTransform:this.tileTransform},t,a,c):{}}querySourceFeatures(t,a){let c=this.latestFeatureIndex;if(!c||!c.rawTileData)return;let f=c.loadVTLayers(),g=a?a.sourceLayer:"",v=f._geojsonTileLayer||f[g];if(!v)return;let C=Sl(a&&a.filter),{z:I,x:A,y:F}=this.tileID.canonical,V={z:I,x:A,y:F};for(let $=0;$<v.length;$++){let W=v.feature($);if(C.needGeometry){let ae=As(W,!0);if(!C.filter(new z(this.tileID.overscaledZ),ae,this.tileID.canonical))continue}else if(!C.filter(new z(this.tileID.overscaledZ),W))continue;let q=c.getId(W,g),ee=new uI(W,I,A,F,q);ee.tile=V,t.push(ee)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(t){let a=this.expirationTime;if(t.cacheControl){let c=to(t.cacheControl);c["max-age"]&&(this.expirationTime=Date.now()+1e3*c["max-age"])}else t.expires&&(this.expirationTime=new Date(t.expires).getTime());if(this.expirationTime){let c=Date.now(),f=!1;if(this.expirationTime>c)f=!1;else if(a)if(this.expirationTime<a)f=!0;else{let g=this.expirationTime-a;g?this.expirationTime=c+Math.max(g,3e4):f=!0}else f=!0;f?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(t,a){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(t).length===0||!a)return;let c=this.latestFeatureIndex.loadVTLayers(),f=a.style.listImages();for(let g in this.buckets){if(!a.style.hasLayer(g))continue;let v=this.buckets[g],C=v.layers[0].sourceLayer||"_geojsonTileLayer",I=c[C],A=t[C];if(!I||!A||Object.keys(A).length===0)continue;if(v.update(A,I,f,this.imageAtlas&&this.imageAtlas.patternPositions||{}),v instanceof Lt||v instanceof Nf){let V=a.style._getSourceCache(v.layers[0].source);a._terrain&&a._terrain.enabled&&V&&v.programConfigurations.needsUpload&&a._terrain._clearRenderCacheForTile(V.id,this.tileID)}let F=a&&a.style&&a.style.getLayer(g);F&&(this.queryPadding=Math.max(this.queryPadding,F.queryRadius(v)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<vs.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(t){this.symbolFadeHoldUntil=vs.now()+t}setTexture(t,a){let c=a.context,f=c.gl;this.texture=this.texture||a.getTileTexture(t.width),this.texture?this.texture.update(t,{useMipmap:!0}):(this.texture=new Ky(c,t,f.RGBA,{useMipmap:!0}),this.texture.bind(f.LINEAR,f.CLAMP_TO_EDGE))}setDependencies(t,a){let c={};for(let f of a)c[f]=!0;this.dependencies[t]=c}hasDependency(t,a){for(let c of t){let f=this.dependencies[c];if(f){for(let g of a)if(f[g])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(t,a){if(!a||a.name==="mercator"||this._tileDebugBuffer)return;let c=pa(fI,this.tileID.canonical,this.tileTransform)[0],f=new mt,g=new To;for(let v=0;v<c.length;v++){let{x:C,y:I}=c[v];f.emplaceBack(C,I),g.emplaceBack(v)}g.emplaceBack(0),this._tileDebugIndexBuffer=t.createIndexBuffer(g),this._tileDebugBuffer=t.createVertexBuffer(f,Yd.members),this._tileDebugSegments=Xi.simpleSegment(0,0,f.length,g.length)}_makeTileBoundsBuffers(t,a){if(this._tileBoundsBuffer||!a||a.name==="mercator")return;let c=pa(fI,this.tileID.canonical,this.tileTransform)[0],f,g;if(this.isRaster){let v=function(C,I){let A=Bf(C,I),F=Math.pow(2,C.z);for(let ae=0;ae<Lc;ae++)for(let me=0;me<Lc;me++){let Ce=ls((C.x+(me+dI(me))/Ha)/F),ge=Xr((C.y+(ae+dI(ae))/Ha)/F),xe=I.project(Ce,ge),Te=ae*Lc+me;Fc[2*Te+0]=Math.round((xe.x*A.scale-A.x)*Wt),Fc[2*Te+1]=Math.round((xe.y*A.scale-A.y)*Wt)}uh.fill(0),bb.fill(0);for(let ae=2045;ae>=0;ae--){let me=4*ae,Ce=ch[me+0],ge=ch[me+1],xe=ch[me+2],Te=ch[me+3],De=Ce+xe>>1,qe=ge+Te>>1,We=De+qe-ge,et=qe+Ce-De,vt=ge*Lc+Ce,Ke=Te*Lc+xe,ot=qe*Lc+De,st=Math.hypot((Fc[2*vt+0]+Fc[2*Ke+0])/2-Fc[2*ot+0],(Fc[2*vt+1]+Fc[2*Ke+1])/2-Fc[2*ot+1])>=16;uh[ot]=uh[ot]||(st?1:0),ae<1022&&(uh[ot]=uh[ot]||uh[(ge+et>>1)*Lc+(Ce+We>>1)]||uh[(Te+et>>1)*Lc+(xe+We>>1)])}let V=new it,$=new Vt,W=0;function q(ae,me){let Ce=me*Lc+ae;return bb[Ce]===0&&(V.emplaceBack(Fc[2*Ce+0],Fc[2*Ce+1],ae*Wt/Ha,me*Wt/Ha),bb[Ce]=++W),bb[Ce]-1}function ee(ae,me,Ce,ge,xe,Te){let De=ae+Ce>>1,qe=me+ge>>1;if(Math.abs(ae-xe)+Math.abs(me-Te)>1&&uh[qe*Lc+De])ee(xe,Te,ae,me,De,qe),ee(Ce,ge,xe,Te,De,qe);else{let We=q(ae,me),et=q(Ce,ge),vt=q(xe,Te);$.emplaceBack(We,et,vt)}}return ee(0,0,Ha,Ha,Ha,0),ee(Ha,Ha,0,0,0,Ha),{vertices:V,indices:$}}(this.tileID.canonical,a);f=v.vertices,g=v.indices}else{f=new it,g=new Vt;for(let{x:C,y:I}of c)f.emplaceBack(C,I,0,0);let v=Fy(f.int16,void 0,4);for(let C=0;C<v.length;C+=3)g.emplaceBack(v[C],v[C+1],v[C+2])}this._tileBoundsBuffer=t.createVertexBuffer(f,hI.members),this._tileBoundsIndexBuffer=t.createIndexBuffer(g),this._tileBoundsSegments=Xi.simpleSegment(0,0,f.length,g.length)}_makeGlobeTileDebugBuffers(t,a){let c=a.projection;if(!c||c.name!=="globe"||a.freezeTileCoverage)return;let f=this.tileID.canonical,g=If(Ov(f,a)),v=Nu(a.zoom),C;v>0&&(C=Qp(new Float64Array(16),a.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(t,f,a,g,C,v),this._makeGlobeTileDebugTextBuffer(t,f,a,g,C,v)}_globePoint(t,a,c,f,g,v,C){let I=Tf(t,a,c);if(v){let A=1<<c.z,F=fa(f.center.lng),V=Va(f.center.lat),$=(c.x+.5)/A-F,W=0;$>.5?W=-1:$<-.5&&(W=1);let q=(t/Wt+c.x)/A+W,ee=(a/Wt+c.y)/A;q=(q-F)*f._pixelsPerMercatorPixel+F,ee=(ee-V)*f._pixelsPerMercatorPixel+V;let ae=[q*f.worldSize,ee*f.worldSize,0];sr(ae,ae,v),I=jl(I,ae,C)}return sr(I,I,g)}_makeGlobeTileDebugBorderBuffer(t,a,c,f,g,v){let C=new mt,I=new To,A=new He,F=($,W,q,ee,ae)=>{let me=(q-$)/(ae-1),Ce=(ee-W)/(ae-1),ge=C.length;for(let xe=0;xe<ae;xe++){let Te=$+xe*me,De=W+xe*Ce;C.emplaceBack(Te,De);let qe=this._globePoint(Te,De,a,c,f,g,v);A.emplaceBack(qe[0],qe[1],qe[2]),I.emplaceBack(ge+xe)}},V=Wt;F(0,0,V,0,16),F(V,0,V,V,16),F(V,V,0,V,16),F(0,V,0,0,16),this._tileDebugIndexBuffer=t.createIndexBuffer(I),this._tileDebugBuffer=t.createVertexBuffer(C,Yd.members),this._globeTileDebugBorderBuffer=t.createVertexBuffer(A,Rv.members),this._tileDebugSegments=Xi.simpleSegment(0,0,C.length,I.length)}_makeGlobeTileDebugTextBuffer(t,a,c,f,g,v){let C=Wt/4,I=new mt,A=new Vt,F=new He,V=25;A.reserve(32),I.reserve(V),F.reserve(V);let $=(W,q)=>V*W+q;for(let W=0;W<V;W++){let q=W*C;for(let ee=0;ee<V;ee++){let ae=ee*C;I.emplaceBack(ae,q);let me=this._globePoint(ae,q,a,c,f,g,v);F.emplaceBack(me[0],me[1],me[2])}}for(let W=0;W<4;W++)for(let q=0;q<4;q++){let ee=$(W,q),ae=$(W,q+1),me=$(W+1,q),Ce=$(W+1,q+1);A.emplaceBack(ee,ae,me),A.emplaceBack(me,ae,Ce)}this._tileDebugTextIndexBuffer=t.createIndexBuffer(A),this._tileDebugTextBuffer=t.createVertexBuffer(I,Yd.members),this._globeTileDebugTextBuffer=t.createVertexBuffer(F,Rv.members),this._tileDebugTextSegments=Xi.simpleSegment(0,0,V,32)}}class $F{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(t,a,c){let f=String(a);if(this.stateChanges[t]=this.stateChanges[t]||{},this.stateChanges[t][f]=this.stateChanges[t][f]||{},Bi(this.stateChanges[t][f],c),this.deletedStates[t]===null){this.deletedStates[t]={};for(let g in this.state[t])g!==f&&(this.deletedStates[t][g]=null)}else if(this.deletedStates[t]&&this.deletedStates[t][f]===null){this.deletedStates[t][f]={};for(let g in this.state[t][f])c[g]||(this.deletedStates[t][f][g]=null)}else for(let g in c)this.deletedStates[t]&&this.deletedStates[t][f]&&this.deletedStates[t][f][g]===null&&delete this.deletedStates[t][f][g]}removeFeatureState(t,a,c){if(this.deletedStates[t]===null)return;let f=String(a);if(this.deletedStates[t]=this.deletedStates[t]||{},c&&a!==void 0)this.deletedStates[t][f]!==null&&(this.deletedStates[t][f]=this.deletedStates[t][f]||{},this.deletedStates[t][f][c]=null);else if(a!==void 0)if(this.stateChanges[t]&&this.stateChanges[t][f])for(c in this.deletedStates[t][f]={},this.stateChanges[t][f])this.deletedStates[t][f][c]=null;else this.deletedStates[t][f]=null;else this.deletedStates[t]=null}getState(t,a){let c=String(a),f=Bi({},(this.state[t]||{})[c],(this.stateChanges[t]||{})[c]);if(this.deletedStates[t]===null)return{};if(this.deletedStates[t]){let g=this.deletedStates[t][a];if(g===null)return{};for(let v in g)delete f[v]}return f}initializeTileState(t,a){t.setFeatureState(this.state,a)}coalesceChanges(t,a){let c={};for(let f in this.stateChanges){this.state[f]=this.state[f]||{};let g={};for(let v in this.stateChanges[f])this.state[f][v]||(this.state[f][v]={}),Bi(this.state[f][v],this.stateChanges[f][v]),g[v]=this.state[f][v];c[f]=g}for(let f in this.deletedStates){this.state[f]=this.state[f]||{};let g={};if(this.deletedStates[f]===null)for(let v in this.state[f])g[v]={},this.state[f][v]={};else for(let v in this.deletedStates[f]){if(this.deletedStates[f][v]===null)this.state[f][v]={};else if(this.state[f][v])for(let C of Object.keys(this.deletedStates[f][v]))delete this.state[f][v][C];g[v]=this.state[f][v]}c[f]=c[f]||{},Bi(c[f],g)}if(this.stateChanges={},this.deletedStates={},Object.keys(c).length!==0)for(let f in t)t[f].setFeatureState(c,a)}}class pI{constructor(t){this.size=t,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(t,a){let c=this.toIdx(t,a);return{min:this.minimums[c],max:this.maximums[c]}}isLeaf(t,a){return this.leaves[this.toIdx(t,a)]}toIdx(t,a){return a*this.size+t}}function mI(o,t,a,c){let f=0,g=Number.MAX_VALUE;for(let v=0;v<3;v++)if(Math.abs(c[v])<1e-15){if(a[v]<o[v]||a[v]>t[v])return null}else{let C=1/c[v],I=(o[v]-a[v])*C,A=(t[v]-a[v])*C;if(I>A){let F=I;I=A,A=F}if(I>f&&(f=I),A<g&&(g=A),f>g)return null}return f}function gI(o,t,a,c,f,g,v,C,I,A,F){let V=c-o,$=f-t,W=g-a,q=v-o,ee=C-t,ae=I-a,me=F[1]*ae-F[2]*ee,Ce=F[2]*q-F[0]*ae,ge=F[0]*ee-F[1]*q,xe=V*me+$*Ce+W*ge;if(Math.abs(xe)<1e-15)return null;let Te=1/xe,De=A[0]-o,qe=A[1]-t,We=A[2]-a,et=(De*me+qe*Ce+We*ge)*Te;if(et<0||et>1)return null;let vt=qe*W-We*$,Ke=We*V-De*W,ot=De*$-qe*V,st=(F[0]*vt+F[1]*Ke+F[2]*ot)*Te;return st<0||et+st>1?null:(q*vt+ee*Ke+ae*ot)*Te}function yI(o,t,a){return(o-t)/(a-t)}function _I(o,t,a,c,f,g,v,C,I){let A=1<<a,F=g-c,V=v-f,$=(o+1)/A*F+c,W=(t+0)/A*V+f,q=(t+1)/A*V+f;C[0]=(o+0)/A*F+c,C[1]=W,I[0]=$,I[1]=q}class vI{constructor(t){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=t,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;let a=function(g){let v=Math.ceil(Math.log2(g.dim/8)),C=[],I=Math.ceil(Math.pow(2,v)),A=1/I,F=(W,q,ee,ae,me)=>{let Ce=ae?1:0,ge=(W+1)*ee-Ce,xe=q*ee,Te=(q+1)*ee-Ce;me[0]=W*ee,me[1]=xe,me[2]=ge,me[3]=Te},V=new pI(I),$=[];for(let W=0;W<I*I;W++){F(W%I,Math.floor(W/I),A,!1,$);let q=dh($[0],$[1],g),ee=dh($[2],$[1],g),ae=dh($[2],$[3],g),me=dh($[0],$[3],g);V.minimums.push(Math.min(q,ee,ae,me)),V.maximums.push(Math.max(q,ee,ae,me)),V.leaves.push(1)}for(C.push(V),I/=2;I>=1;I/=2){let W=C[C.length-1];V=new pI(I);for(let q=0;q<I*I;q++){F(q%I,Math.floor(q/I),2,!0,$);let ee=W.getElevation($[0],$[1]),ae=W.getElevation($[2],$[1]),me=W.getElevation($[2],$[3]),Ce=W.getElevation($[0],$[3]),ge=W.isLeaf($[0],$[1]),xe=W.isLeaf($[2],$[1]),Te=W.isLeaf($[2],$[3]),De=W.isLeaf($[0],$[3]),qe=Math.min(ee.min,ae.min,me.min,Ce.min),We=Math.max(ee.max,ae.max,me.max,Ce.max),et=ge&&xe&&Te&&De;V.maximums.push(We),V.minimums.push(qe),V.leaves.push(We-qe<=5&&et?1:0)}C.push(V)}return C}(this.dem),c=a.length-1,f=a[c];this._addNode(f.minimums[0],f.maximums[0],f.leaves[0]),this._construct(a,0,0,c,0)}raycastRoot(t,a,c,f,g,v,C=1){return mI([t,a,-100],[c,f,this.maximums[0]*C],g,v)}raycast(t,a,c,f,g,v,C=1){if(!this.nodeCount)return null;let I=this.raycastRoot(t,a,c,f,g,v,C);if(I==null)return null;let A=[],F=[],V=[],$=[],W=[{idx:0,t:I,nodex:0,nodey:0,depth:0}];for(;W.length>0;){let{idx:q,t:ee,nodex:ae,nodey:me,depth:Ce}=W.pop();if(this.leaves[q]){_I(ae,me,Ce,t,a,c,f,V,$);let xe=1<<Ce,Te=(ae+0)/xe,De=(ae+1)/xe,qe=(me+0)/xe,We=(me+1)/xe,et=dh(Te,qe,this.dem)*C,vt=dh(De,qe,this.dem)*C,Ke=dh(De,We,this.dem)*C,ot=dh(Te,We,this.dem)*C,st=gI(V[0],V[1],et,$[0],V[1],vt,$[0],$[1],Ke,g,v),ft=gI($[0],$[1],Ke,V[0],$[1],ot,V[0],V[1],et,g,v),wt=Math.min(st!==null?st:Number.MAX_VALUE,ft!==null?ft:Number.MAX_VALUE);if(wt!==Number.MAX_VALUE)return wt;{let Qe=Ac([],g,v,ee);if(bI(et,vt,ot,Ke,yI(Qe[0],V[0],$[0]),yI(Qe[1],V[1],$[1]))>=Qe[2])return ee}continue}let ge=0;for(let xe=0;xe<this._siblingOffset.length;xe++){_I((ae<<1)+this._siblingOffset[xe][0],(me<<1)+this._siblingOffset[xe][1],Ce+1,t,a,c,f,V,$),V[2]=-100,$[2]=this.maximums[this.childOffsets[q]+xe]*C;let Te=mI(V,$,g,v);if(Te!=null){let De=Te;A[xe]=De;let qe=!1;for(let We=0;We<ge&&!qe;We++)De>=A[F[We]]&&(F.splice(We,0,xe),qe=!0);qe||(F[ge]=xe),ge++}}for(let xe=0;xe<ge;xe++){let Te=F[xe];W.push({idx:this.childOffsets[q]+Te,t:A[Te],nodex:(ae<<1)+this._siblingOffset[Te][0],nodey:(me<<1)+this._siblingOffset[Te][1],depth:Ce+1})}}return null}_addNode(t,a,c){return this.minimums.push(t),this.maximums.push(a),this.leaves.push(c),this.childOffsets.push(0),this.nodeCount++}_construct(t,a,c,f,g){if(t[f].isLeaf(a,c)===1)return;this.childOffsets[g]||(this.childOffsets[g]=this.nodeCount);let v=f-1,C=t[v],I=0,A=0;for(let F=0;F<this._siblingOffset.length;F++){let V=2*a+this._siblingOffset[F][0],$=2*c+this._siblingOffset[F][1],W=C.getElevation(V,$),q=C.isLeaf(V,$),ee=this._addNode(W.min,W.max,q);q&&(I|=1<<F),A||(A=ee)}for(let F=0;F<this._siblingOffset.length;F++)I&1<<F||this._construct(t,2*a+this._siblingOffset[F][0],2*c+this._siblingOffset[F][1],v,A+F)}}function bI(o,t,a,c,f,g){return Fn(Fn(o,a,g),Fn(t,c,g),f)}function dh(o,t,a){let c=a.dim,f=Tn(o*c-.5,0,c-1),g=Tn(t*c-.5,0,c-1),v=Math.floor(f),C=Math.floor(g),I=Math.min(v+1,c-1),A=Math.min(C+1,c-1);return bI(a.get(v,C),a.get(I,C),a.get(v,A),a.get(I,A),f-v,g-C)}let xI={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function HF(o,t,a){return(256*o*256+256*t+a)/10-1e4}function GF(o,t,a){return 256*o+t+a/256-32768}class xb{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(t,a,c,f=!1,g=!1){if(this.uid=t,a.height!==a.width)throw new RangeError("DEM tiles must be square");if(c&&c!=="mapbox"&&c!=="terrarium")return vi(`"${c}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=a.height;let v=this.dim=a.height-2,C=new Uint32Array(a.data.buffer);if(this.pixels=new Uint8Array(a.data.buffer),this.encoding=c||"mapbox",this.borderReady=f,!f){for(let I=0;I<v;I++)C[this._idx(-1,I)]=C[this._idx(0,I)],C[this._idx(v,I)]=C[this._idx(v-1,I)],C[this._idx(I,-1)]=C[this._idx(I,0)],C[this._idx(I,v)]=C[this._idx(I,v-1)];C[this._idx(-1,-1)]=C[this._idx(0,0)],C[this._idx(v,-1)]=C[this._idx(v-1,0)],C[this._idx(-1,v)]=C[this._idx(0,v-1)],C[this._idx(v,v)]=C[this._idx(v-1,v-1)],g&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new vI(this)}get(t,a,c=!1){c&&(t=Tn(t,-1,this.dim),a=Tn(a,-1,this.dim));let f=4*this._idx(t,a);return(this.encoding==="terrarium"?GF:HF)(this.pixels[f],this.pixels[f+1],this.pixels[f+2])}static getUnpackVector(t){return xI[t]}get unpackVector(){return xI[this.encoding]}_idx(t,a){if(t<-1||t>=this.dim+1||a<-1||a>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(a+1)*this.stride+(t+1)}static pack(t,a){let c=[0,0,0,0],f=xb.getUnpackVector(a),g=Math.floor((t+f[3])/f[2]);return c[2]=g%256,g=Math.floor(g/256),c[1]=g%256,g=Math.floor(g/256),c[0]=g,c}getPixels(){return new oo({width:this.stride,height:this.stride},this.pixels)}backfillBorder(t,a,c){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");let f=a*this.dim,g=a*this.dim+this.dim,v=c*this.dim,C=c*this.dim+this.dim;switch(a){case-1:f=g-1;break;case 1:g=f+1}switch(c){case-1:v=C-1;break;case 1:C=v+1}let I=-a*this.dim,A=-c*this.dim;for(let F=v;F<C;F++)for(let V=f;V<g;V++){let $=4*this._idx(V,F),W=4*this._idx(V+I,F+A);this.pixels[$+0]=t.pixels[W+0],this.pixels[$+1]=t.pixels[W+1],this.pixels[$+2]=t.pixels[W+2],this.pixels[$+3]=t.pixels[W+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}Ot(xb,"DEMData"),Ot(vI,"DemMinMaxQuadTree",{omit:["dem"]});class WF{constructor(t,a){this.max=t,this.onRemove=a,this.reset()}reset(){for(let t in this.data)for(let a of this.data[t])a.timeout&&clearTimeout(a.timeout),this.onRemove(a.value);return this.data={},this.order=[],this}add(t,a,c){let f=t.wrapped().key;this.data[f]===void 0&&(this.data[f]=[]);let g={value:a,timeout:void 0};if(c!==void 0&&(g.timeout=setTimeout(()=>{this.remove(t,g)},c)),this.data[f].push(g),this.order.push(f),this.order.length>this.max){let v=this._getAndRemoveByKey(this.order[0]);v&&this.onRemove(v)}return this}has(t){return t.wrapped().key in this.data}getAndRemove(t){return this.has(t)?this._getAndRemoveByKey(t.wrapped().key):null}_getAndRemoveByKey(t){let a=this.data[t].shift();return a.timeout&&clearTimeout(a.timeout),this.data[t].length===0&&delete this.data[t],this.order.splice(this.order.indexOf(t),1),a.value}getByKey(t){let a=this.data[t];return a?a[0].value:null}get(t){return this.has(t)?this.data[t.wrapped().key][0].value:null}remove(t,a){if(!this.has(t))return this;let c=t.wrapped().key,f=a===void 0?0:this.data[c].indexOf(a),g=this.data[c][f];return this.data[c].splice(f,1),g.timeout&&clearTimeout(g.timeout),this.data[c].length===0&&delete this.data[c],this.onRemove(g.value),this.order.splice(this.order.indexOf(c),1),this}setMaxSize(t){for(this.max=t;this.order.length>this.max;){let a=this._getAndRemoveByKey(this.order[0]);a&&this.onRemove(a)}return this}filter(t){let a=[];for(let c in this.data)for(let f of this.data[c])t(f.value)||a.push(f);for(let c of a)this.remove(c.value.tileID,c)}}class Om{constructor(t,a,c){this.func=t,this.mask=a,this.range=c}}Om.ReadOnly=!1,Om.ReadWrite=!0,Om.disabled=new Om(519,Om.ReadOnly,[0,1]);let A1=7680;class k1{constructor(t,a,c,f,g,v){this.test=t,this.ref=a,this.mask=c,this.fail=f,this.depthFail=g,this.pass=v}}k1.disabled=new k1({func:519,mask:0},0,0,A1,A1,A1);class Nc{constructor(t,a,c){this.blendFunction=t,this.blendColor=a,this.mask=c}}Nc.Replace=[1,0],Nc.disabled=new Nc(Nc.Replace,ir.transparent,[!1,!1,!1,!1]),Nc.unblended=new Nc(Nc.Replace,ir.transparent,[!0,!0,!0,!0]),Nc.alphaBlended=new Nc([1,771],ir.transparent,[!0,!0,!0,!0]);let R1=1029,P1=2305;class $l{constructor(t,a,c){this.enable=t,this.mode=a,this.frontFace=c}}$l.disabled=new $l(!1,R1,P1),$l.backCCW=new $l(!0,R1,P1),$l.backCW=new $l(!0,R1,2304),$l.frontCW=new $l(!0,1028,2304),$l.frontCCW=new $l(!0,1028,P1);class jf extends sc{constructor(t,a,c){super(),this.id=t,this._onlySymbols=c,a.on("data",f=>{f.dataType==="source"&&f.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&f.dataType==="source"&&f.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),a.on("error",()=>{this._sourceErrored=!0}),this._source=a,this._tiles={},this._cache=new WF(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=a.minTileCacheSize,this._maxTileCacheSize=a.maxTileCacheSize,this._loadedParentTiles={},this._coveredTiles={},this._state=new $F,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(t){this.map=t,this._minTileCacheSize=this._minTileCacheSize===void 0&&t?t._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&t?t._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(let t in this._tiles){let a=this._tiles[t];if(a.state!=="loaded"&&a.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;let t=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,t&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(t,a){return t.isSymbolTile=this._onlySymbols,this._source.loadTile(t,a)}_unloadTile(t){if(this._source.unloadTile)return this._source.unloadTile(t,()=>{})}_abortTile(t){if(this._source.abortTile)return this._source.abortTile(t,()=>{})}serialize(){return this._source.serialize()}prepare(t){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(let a in this._tiles){let c=this._tiles[a];c.upload(t),c.prepare(this.map.style.imageManager)}}getIds(){return vo(this._tiles).map(t=>t.tileID).sort(wI).map(t=>t.key)}getRenderableIds(t){let a=[];for(let c in this._tiles)this._isIdRenderable(+c,t)&&a.push(this._tiles[c]);return t?a.sort((c,f)=>{let g=c.tileID,v=f.tileID,C=new It(g.canonical.x,g.canonical.y)._rotate(this.transform.angle),I=new It(v.canonical.x,v.canonical.y)._rotate(this.transform.angle);return g.overscaledZ-v.overscaledZ||I.y-C.y||I.x-C.x}).map(c=>c.tileID.key):a.map(c=>c.tileID).sort(wI).map(c=>c.key)}hasRenderableParent(t){let a=this.findLoadedParent(t,0);return!!a&&this._isIdRenderable(a.tileID.key)}_isIdRenderable(t,a){return this._tiles[t]&&this._tiles[t].hasData()&&!this._coveredTiles[t]&&(a||!this._tiles[t].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(let t in this._tiles)this._tiles[t].state!=="errored"&&this._reloadTile(+t,"reloading")}}_reloadTile(t,a){let c=this._tiles[t];c&&(c.state!=="loading"&&(c.state=a),this._loadTile(c,this._tileLoaded.bind(this,c,t,a)))}_tileLoaded(t,a,c,f){if(f)if(t.state="errored",f.status!==404)this._source.fire(new ta(f,{tile:t}));else if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){let g=this.map.painter.terrain;this.update(this.transform,g.getScaledDemTileSize(),!0),g.resetTileLookupCache(this.id)}else this.update(this.transform);else t.timeAdded=vs.now(),c==="expired"&&(t.refreshedUponExpiration=!0),this._setTileReloadTimer(a,t),this._source.type==="raster-dem"&&t.dem&&this._backfillDEM(t),this._state.initializeTileState(t,this.map?this.map.painter:null),this._source.fire(new ol("data",{dataType:"source",tile:t,coord:t.tileID,sourceCacheId:this.id}))}_backfillDEM(t){let a=this.getRenderableIds();for(let f=0;f<a.length;f++){let g=a[f];if(t.neighboringTiles&&t.neighboringTiles[g]){let v=this.getTileByID(g);c(t,v),c(v,t)}}function c(f,g){if(!f.dem||f.dem.borderReady)return;f.needsHillshadePrepare=!0,f.needsDEMTextureUpload=!0;let v=g.tileID.canonical.x-f.tileID.canonical.x,C=g.tileID.canonical.y-f.tileID.canonical.y,I=Math.pow(2,f.tileID.canonical.z),A=g.tileID.key;v===0&&C===0||Math.abs(C)>1||(Math.abs(v)>1&&(Math.abs(v+I)===1?v+=I:Math.abs(v-I)===1&&(v-=I)),g.dem&&f.dem&&(f.dem.backfillBorder(g.dem,v,C),f.neighboringTiles&&f.neighboringTiles[A]&&(f.neighboringTiles[A].backfilled=!0)))}}getTile(t){return this.getTileByID(t.key)}getTileByID(t){return this._tiles[t]}_retainLoadedChildren(t,a,c,f){for(let g in this._tiles){let v=this._tiles[g];if(f[g]||!v.hasData()||v.tileID.overscaledZ<=a||v.tileID.overscaledZ>c)continue;let C=v.tileID;for(;v&&v.tileID.overscaledZ>a+1;){let A=v.tileID.scaledTo(v.tileID.overscaledZ-1);v=this._tiles[A.key],v&&v.hasData()&&(C=A)}let I=C;for(;I.overscaledZ>a;)if(I=I.scaledTo(I.overscaledZ-1),t[I.key]){f[C.key]=C;break}}}findLoadedParent(t,a){if(t.key in this._loadedParentTiles){let c=this._loadedParentTiles[t.key];return c&&c.tileID.overscaledZ>=a?c:null}for(let c=t.overscaledZ-1;c>=a;c--){let f=t.scaledTo(c),g=this._getLoadedTile(f);if(g)return g}}_getLoadedTile(t){let a=this._tiles[t.key];return a&&a.hasData()?a:this._cache.getByKey(this._source.reparseOverscaled?t.wrapped().key:t.canonical.key)}updateCacheSize(t,a){a=a||this._source.tileSize;let c=Math.ceil(t.width/a)+1,f=Math.ceil(t.height/a)+1,g=Math.floor(c*f*5),v=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,g):g,C=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,v):v;this._cache.setMaxSize(C)}handleWrapJump(t){let a=Math.round((t-(this._prevLng===void 0?t:this._prevLng))/360);if(this._prevLng=t,a){let c={};for(let f in this._tiles){let g=this._tiles[f];g.tileID=g.tileID.unwrapTo(g.tileID.wrap+a),c[g.tileID.key]=g}this._tiles=c;for(let f in this._timers)clearTimeout(this._timers[f]),delete this._timers[f];for(let f in this._tiles)this._setTileReloadTimer(+f,this._tiles[f])}}update(t,a,c){if(this.transform=t,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!c)return;let f;this.updateCacheSize(t,a),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?f=t.getVisibleUnwrappedCoordinates(this._source.tileID).map(C=>new J(C.canonical.z,C.wrap,C.canonical.z,C.canonical.x,C.canonical.y)):(f=t.coveringTiles({tileSize:a||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!c,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(f=f.filter(C=>this._source.hasTile(C)))):f=[];let g=this._updateRetainedTiles(f);if(CI(this._source.type)&&f.length!==0){let C={},I={},A=Object.keys(g);for(let V of A){let $=g[V],W=this._tiles[V];if(!W||W.fadeEndTime&&W.fadeEndTime<=vs.now())continue;let q=this.findLoadedParent($,Math.max($.overscaledZ-jf.maxOverzooming,this._source.minzoom));q&&(this._addTile(q.tileID),C[q.tileID.key]=q.tileID),I[V]=$}let F=f[f.length-1].overscaledZ;for(let V in this._tiles){let $=this._tiles[V];if(g[V]||!$.hasData())continue;let W=$.tileID;for(;W.overscaledZ>F;){W=W.scaledTo(W.overscaledZ-1);let q=this._tiles[W.key];if(q&&q.hasData()&&I[W.key]){g[V]=$.tileID;break}}}for(let V in C)g[V]||(this._coveredTiles[V]=!0,g[V]=C[V])}for(let C in g)this._tiles[C].clearFadeHold();let v=function(C,I){let A=[];for(let F in C)F in I||A.push(F);return A}(this._tiles,g);for(let C of v){let I=this._tiles[C];I.hasSymbolBuckets&&!I.holdingForFade()?I.setHoldDuration(this.map._fadeDuration):I.hasSymbolBuckets&&!I.symbolFadeFinished()||this._removeTile(+C)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(let t in this._tiles)this._tiles[t].holdingForFade()&&this._removeTile(+t)}_updateRetainedTiles(t){let a={};if(t.length===0)return a;let c={},f=t.reduce((A,F)=>Math.min(A,F.overscaledZ),1/0),g=t[0].overscaledZ,v=Math.max(g-jf.maxOverzooming,this._source.minzoom),C=Math.max(g+jf.maxUnderzooming,this._source.minzoom),I={};for(let A of t){let F=this._addTile(A);a[A.key]=A,F.hasData()||f<this._source.maxzoom&&(I[A.key]=A)}this._retainLoadedChildren(I,f,C,a);for(let A of t){let F=this._tiles[A.key];if(F.hasData())continue;if(A.canonical.z>=this._source.maxzoom){let $=A.children(this._source.maxzoom)[0],W=this.getTile($);if(W&&W.hasData()){a[$.key]=$;continue}}else{let $=A.children(this._source.maxzoom);if(a[$[0].key]&&a[$[1].key]&&a[$[2].key]&&a[$[3].key])continue}let V=F.wasRequested();for(let $=A.overscaledZ-1;$>=v;--$){let W=A.scaledTo($);if(c[W.key]||(c[W.key]=!0,F=this.getTile(W),!F&&V&&(F=this._addTile(W)),F&&(a[W.key]=W,V=F.wasRequested(),F.hasData())))break}}return a}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(let t in this._tiles){let a=[],c,f=this._tiles[t].tileID;for(;f.overscaledZ>0;){if(f.key in this._loadedParentTiles){c=this._loadedParentTiles[f.key];break}a.push(f.key);let g=f.scaledTo(f.overscaledZ-1);if(c=this._getLoadedTile(g),c)break;f=g}for(let g of a)this._loadedParentTiles[g]=c}}_addTile(t){let a=this._tiles[t.key];if(a)return a;a=this._cache.getAndRemove(t),a&&(this._setTileReloadTimer(t.key,a),a.tileID=t,this._state.initializeTileState(a,this.map?this.map.painter:null),this._cacheTimers[t.key]&&(clearTimeout(this._cacheTimers[t.key]),delete this._cacheTimers[t.key],this._setTileReloadTimer(t.key,a)));let c=!!a;if(!c){let f=this.map?this.map.painter:null;a=new S1(t,this._source.tileSize*t.overscaleFactor(),this.transform.tileZoom,f,this._isRaster),this._loadTile(a,this._tileLoaded.bind(this,a,t.key,a.state))}return a?(a.uses++,this._tiles[t.key]=a,c||this._source.fire(new ol("dataloading",{tile:a,coord:a.tileID,dataType:"source"})),a):null}_setTileReloadTimer(t,a){t in this._timers&&(clearTimeout(this._timers[t]),delete this._timers[t]);let c=a.getExpiryTimeout();c&&(this._timers[t]=setTimeout(()=>{this._reloadTile(t,"expired"),delete this._timers[t]},c))}_removeTile(t){let a=this._tiles[t];a&&(a.uses--,delete this._tiles[t],this._timers[t]&&(clearTimeout(this._timers[t]),delete this._timers[t]),a.uses>0||(a.hasData()&&a.state!=="reloading"?this._cache.add(a.tileID,a,a.getExpiryTimeout()):(a.aborted=!0,this._abortTile(a),this._unloadTile(a))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(let t in this._tiles)this._removeTile(+t);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(t,a,c){let f=[],g=this.transform;if(!g)return f;let v=g.projection.name==="globe",C=fa(g.center.lng);for(let I in this._tiles){let A=this._tiles[I];if(c&&A.clearQueryDebugViz(),A.holdingForFade())continue;let F;if(v){let V=A.tileID.canonical;if(V.z===0){let $=[Math.abs(Tn(C,...Qy(V,-1))-C),Math.abs(Tn(C,...Qy(V,1))-C)];F=[0,2*$.indexOf(Math.min(...$))-1]}else{let $=[Math.abs(Tn(C,...Qy(V,-1))-C),Math.abs(Tn(C,...Qy(V,0))-C),Math.abs(Tn(C,...Qy(V,1))-C)];F=[$.indexOf(Math.min(...$))-1]}}else F=[0];for(let V of F){let $=t.containsTile(A,g,a,V);$&&f.push($)}}return f}getVisibleCoordinates(t){let a=this.getRenderableIds(t).map(c=>this._tiles[c].tileID);for(let c of a)c.projMatrix=this.transform.calculateProjMatrix(c.toUnwrapped());return a}hasTransition(){if(this._source.hasTransition())return!0;if(CI(this._source.type))for(let t in this._tiles){let a=this._tiles[t];if(a.fadeEndTime!==void 0&&a.fadeEndTime>=vs.now())return!0}return!1}setFeatureState(t,a,c){this._state.updateState(t=t||"_geojsonTileLayer",a,c)}removeFeatureState(t,a,c){this._state.removeFeatureState(t=t||"_geojsonTileLayer",a,c)}getFeatureState(t,a){return this._state.getState(t=t||"_geojsonTileLayer",a)}setDependencies(t,a,c){let f=this._tiles[t];f&&f.setDependencies(a,c)}reloadTilesForDependencies(t,a){for(let c in this._tiles)this._tiles[c].hasDependency(t,a)&&this._reloadTile(+c,"reloading");this._cache.filter(c=>!c.hasDependency(t,a))}_preloadTiles(t,a){if(!this._sourceLoaded){let C=()=>{this._sourceLoaded&&(this._source.off("data",C),this._preloadTiles(t,a))};return void this._source.on("data",C)}let c=new Map,f=Array.isArray(t)?t:[t],g=this.map.painter.terrain,v=this.usedForTerrain&&g?g.getScaledDemTileSize():this._source.tileSize;for(let C of f){let I=C.coveringTiles({tileSize:v,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(let A of I)c.set(A.key,A);this.usedForTerrain&&C.updateElevation(!1)}wr(Array.from(c.values()),(C,I)=>{let A=new S1(C,this._source.tileSize*C.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(A,F=>{this._source.type==="raster-dem"&&A.dem&&this._backfillDEM(A),I(F,A)})},a)}}function wI(o,t){let a=Math.abs(2*o.wrap)-+(o.wrap<0),c=Math.abs(2*t.wrap)-+(t.wrap<0);return o.overscaledZ-t.overscaledZ||c-a||t.canonical.y-o.canonical.y||t.canonical.x-o.canonical.x}function CI(o){return o==="raster"||o==="image"||o==="video"||o==="custom"}function Qy(o,t){let a=1<<o.z;return[o.x/a+t,(o.x+1)/a+t]}jf.maxOverzooming=10,jf.maxUnderzooming=3;class wb{constructor(t,a,c){this._demTile=t,this._dem=this._demTile.dem,this._scale=a,this._offset=c}static create(t,a,c){let f=c||t.findDEMTileFor(a);if(!f||!f.dem)return;let g=f.dem,v=f.tileID,C=1<<a.canonical.z-v.canonical.z;return new wb(f,f.tileSize/Wt/C,[(a.canonical.x/C-v.canonical.x)*g.dim,(a.canonical.y/C-v.canonical.y)*g.dim])}tileCoordToPixel(t,a){let c=a*this._scale+this._offset[1],f=Math.floor(t*this._scale+this._offset[0]),g=Math.floor(c);return new It(f,g)}getElevationAt(t,a,c,f){let g=t*this._scale+this._offset[0],v=a*this._scale+this._offset[1],C=Math.floor(g),I=Math.floor(v),A=this._dem;return f=!!f,c?Fn(Fn(A.get(C,I,f),A.get(C,I+1,f),v-I),Fn(A.get(C+1,I,f),A.get(C+1,I+1,f),v-I),g-C):A.get(C,I,f)}getElevationAtPixel(t,a,c){return this._dem.get(t,a,!!c)}getMeterToDEM(t){return(1<<this._demTile.tileID.canonical.z)*as(1,t)*this._dem.stride}}class EI{constructor(t,a){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new Al(Wt,16,0),this.featureIndexArray=new mi,this.promoteId=a}insert(t,a,c,f,g,v=0){let C=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(c,f,g,v);let I=this.grid;for(let A=0;A<a.length;A++){let F=a[A],V=[1/0,1/0,-1/0,-1/0];for(let $=0;$<F.length;$++){let W=F[$];V[0]=Math.min(V[0],W.x),V[1]=Math.min(V[1],W.y),V[2]=Math.max(V[2],W.x),V[3]=Math.max(V[3],W.y)}V[0]<Wt&&V[1]<Wt&&V[2]>=0&&V[3]>=0&&I.insert(C,V[0],V[1],V[2],V[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new Vy(new lb(this.rawTileData)).layers,this.sourceLayerCoder=new cI(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(let t in this.vtLayers)this.vtFeatures[t]=[]}return this.vtLayers}query(t,a,c,f){this.loadVTLayers();let g=t.params||{},v=Sl(g.filter),C=t.tileResult,I=t.transform,A=C.bufferedTilespaceBounds,F=this.grid.query(A.min.x,A.min.y,A.max.x,A.max.y,(q,ee,ae,me)=>ih(C.bufferedTilespaceGeometry,q,ee,ae,me));F.sort(qF);let V=null;I.elevation&&F.length>0&&(V=wb.create(I.elevation,this.tileID));let $={},W;for(let q=0;q<F.length;q++){let ee=F[q];if(ee===W)continue;W=ee;let ae=this.featureIndexArray.get(ee),me=null;this.loadMatchingFeature($,ae,v,g.layers,g.availableImages,a,c,f,(Ce,ge,xe,Te=0)=>(me||(me=pa(Ce,this.tileID.canonical,t.tileTransform)),ge.queryIntersectsFeature(C,Ce,xe,me,this.z,t.transform,t.pixelPosMatrix,V,Te)))}return $}loadMatchingFeature(t,a,c,f,g,v,C,I,A){let{featureIndex:F,bucketIndex:V,sourceLayerIndex:$,layoutVertexArrayOffset:W}=a,q=this.bucketLayerIDs[V];if(f&&!function(Ce,ge){for(let xe=0;xe<Ce.length;xe++)if(ge.indexOf(Ce[xe])>=0)return!0;return!1}(f,q))return;let ee=this.sourceLayerCoder.decode($),ae=this.vtLayers[ee].feature(F);if(c.needGeometry){let Ce=As(ae,!0);if(!c.filter(new z(this.tileID.overscaledZ),Ce,this.tileID.canonical))return}else if(!c.filter(new z(this.tileID.overscaledZ),ae))return;let me=this.getId(ae,ee);for(let Ce=0;Ce<q.length;Ce++){let ge=q[Ce];if(f&&f.indexOf(ge)<0)continue;let xe=v[ge];if(!xe)continue;let Te={};me!==void 0&&I&&(Te=I.getState(xe.sourceLayer||"_geojsonTileLayer",me));let De=Bi({},C[ge]);De.paint=DI(De.paint,xe.paint,ae,Te,g),De.layout=DI(De.layout,xe.layout,ae,Te,g);let qe=!A||A(ae,xe,Te,W);if(!qe)continue;let We=new uI(ae,this.z,this.x,this.y,me);We.layer=De;let et=t[ge];et===void 0&&(et=t[ge]=[]),et.push({featureIndex:F,feature:We,intersectionZ:qe})}}lookupSymbolFeatures(t,a,c,f,g,v,C,I){let A={};this.loadVTLayers();let F=Sl(g);for(let V of t)this.loadMatchingFeature(A,{bucketIndex:c,sourceLayerIndex:f,featureIndex:V,layoutVertexArrayOffset:0},F,v,C,I,a);return A}loadFeature(t){let{featureIndex:a,sourceLayerIndex:c}=t;this.loadVTLayers();let f=this.sourceLayerCoder.decode(c),g=this.vtFeatures[f];if(g[a])return g[a];let v=this.vtLayers[f].feature(a);return g[a]=v,v}hasLayer(t){for(let a of this.bucketLayerIDs)for(let c of a)if(t===c)return!0;return!1}getId(t,a){let c=t.id;if(this.promoteId){let f=typeof this.promoteId=="string"?this.promoteId:this.promoteId[a];f!=null&&(c=t.properties[f]),typeof c=="boolean"&&(c=Number(c))}return c}}function DI(o,t,a,c,f){return jn(o,(g,v)=>{let C=t instanceof pe?t.get(v):null;return C&&C.evaluate?C.evaluate(a,c,f):C})}function qF(o,t){return t-o}Ot(EI,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});class MI{constructor(t,a){this.width=t,this.height=a,this.nextRow=0,this.image=new Vl({width:t,height:a}),this.positions={},this.uploaded=!1}getDash(t,a){let c=this.getKey(t,a);return this.positions[c]}trim(){let t=this.width,a=this.height=Ys(this.nextRow);this.image.resize({width:t,height:a})}getKey(t,a){return t.join(",")+a}getDashRanges(t,a,c){let f=[],g=t.length%2==1?-t[t.length-1]*c:0,v=t[0]*c,C=!0;f.push({left:g,right:v,isDash:C,zeroLength:t[0]===0});let I=t[0];for(let A=1;A<t.length;A++){C=!C;let F=t[A];g=I*c,I+=F,v=I*c,f.push({left:g,right:v,isDash:C,zeroLength:F===0})}return f}addRoundDash(t,a,c){let f=a/2;for(let g=-c;g<=c;g++){let v=this.width*(this.nextRow+c+g),C=0,I=t[C];for(let A=0;A<this.width;A++){A/I.right>1&&(I=t[++C]);let F=Math.abs(A-I.left),V=Math.abs(A-I.right),$=Math.min(F,V),W,q=g/c*(f+1);if(I.isDash){let ee=f-Math.abs(q);W=Math.sqrt($*$+ee*ee)}else W=f-Math.sqrt($*$+q*q);this.image.data[v+A]=Math.max(0,Math.min(255,W+128))}}}addRegularDash(t,a){for(let I=t.length-1;I>=0;--I){let A=t[I],F=t[I+1];A.zeroLength?t.splice(I,1):F&&F.isDash===A.isDash&&(F.left=A.left,t.splice(I,1))}let c=t[0],f=t[t.length-1];c.isDash===f.isDash&&(c.left=f.left-this.width,f.right=c.right+this.width);let g=this.width*this.nextRow,v=0,C=t[v];for(let I=0;I<this.width;I++){I/C.right>1&&(C=t[++v]);let A=Math.abs(I-C.left),F=Math.abs(I-C.right),V=Math.min(A,F);this.image.data[g+I]=Math.max(0,Math.min(255,(C.isDash?V:-V)+a+128))}}addDash(t,a){let c=this.getKey(t,a);if(this.positions[c])return this.positions[c];let f=a==="round",g=f?7:0,v=2*g+1;if(this.nextRow+v>this.height)return vi("LineAtlas out of space"),null;t.length===0&&t.push(1);let C=0;for(let F=0;F<t.length;F++)t[F]<0&&(vi("Negative value is found in line dasharray, replacing values with 0"),t[F]=0),C+=t[F];if(C!==0){let F=this.width/C,V=this.getDashRanges(t,this.width,F);f?this.addRoundDash(V,F,g):this.addRegularDash(V,a==="square"?.5*F:0)}let I=this.nextRow+g;this.nextRow+=v;let A={tl:[I,g],br:[C,0]};return this.positions[c]=A,A}}Ot(MI,"LineAtlas");let TI=1*Ul;class II{constructor(t){let a={},c=[];for(let C in t){let I=t[C],A=a[C]={};for(let F in I.glyphs){let V=I.glyphs[+F];if(!V||V.bitmap.width===0||V.bitmap.height===0)continue;let $=V.metrics.localGlyph?TI:1,W={x:0,y:0,w:V.bitmap.width+2*$,h:V.bitmap.height+2*$};c.push(W),A[F]=W}}let{w:f,h:g}=y1(c),v=new Vl({width:f||1,height:g||1});for(let C in t){let I=t[C];for(let A in I.glyphs){let F=I.glyphs[+A];if(!F||F.bitmap.width===0||F.bitmap.height===0)continue;let V=a[C][A],$=F.metrics.localGlyph?TI:1;Vl.copy(F.bitmap,v,{x:0,y:0},{x:V.x+$,y:V.y+$},F.bitmap)}}this.image=v,this.positions=a}}Ot(II,"GlyphAtlas");class ZF{constructor(t){this.tileID=new J(t.tileID.overscaledZ,t.tileID.wrap,t.tileID.canonical.z,t.tileID.canonical.x,t.tileID.canonical.y),this.tileZoom=t.tileZoom,this.uid=t.uid,this.zoom=t.zoom,this.canonical=t.tileID.canonical,this.pixelRatio=t.pixelRatio,this.tileSize=t.tileSize,this.source=t.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=t.showCollisionBoxes,this.collectResourceTiming=!!t.collectResourceTiming,this.returnDependencies=!!t.returnDependencies,this.promoteId=t.promoteId,this.enableTerrain=!!t.enableTerrain,this.isSymbolTile=t.isSymbolTile,this.tileTransform=Bf(t.tileID.canonical,t.projection),this.projection=t.projection}parse(t,a,c,f,g){this.status="parsing",this.data=t,this.collisionBoxArray=new fi;let v=new cI(Object.keys(t.layers).sort()),C=new EI(this.tileID,this.promoteId);C.bucketLayerIDs=[];let I={},A=new MI(256,256),F={featureIndex:C,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:A,availableImages:c},V=a.familiesBySource[this.source];for(let Te in V){let De=t.layers[Te];if(!De)continue;let qe=!1,We=!1;for(let Ke of V[Te])Ke[0].type==="symbol"?qe=!0:We=!0;if(this.isSymbolTile===!0&&!qe||this.isSymbolTile===!1&&!We)continue;De.version===1&&vi(`Vector tile source "${this.source}" layer "${Te}" does not use vector tile spec v2 and therefore may have some rendering errors.`);let et=v.encode(Te),vt=[];for(let Ke=0;Ke<De.length;Ke++){let ot=De.feature(Ke),st=C.getId(ot,Te);vt.push({feature:ot,id:st,index:Ke,sourceLayerIndex:et})}for(let Ke of V[Te]){let ot=Ke[0];this.isSymbolTile!==void 0&&ot.type==="symbol"!==this.isSymbolTile||ot.minzoom&&this.zoom<Math.floor(ot.minzoom)||ot.maxzoom&&this.zoom>=ot.maxzoom||ot.visibility!=="none"&&(O1(Ke,this.zoom,c),(I[ot.id]=ot.createBucket({index:C.bucketLayerIDs.length,layers:Ke,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:et,sourceID:this.source,enableTerrain:this.enableTerrain,projection:this.projection.spec,availableImages:c})).populate(vt,F,this.tileID.canonical,this.tileTransform),C.bucketLayerIDs.push(Ke.map(st=>st.id)))}}let $,W,q,ee;A.trim();let ae={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},me=()=>{if($)return g($);if(W&&q&&ee){let Te=new II(W),De=new LT(q,ee);for(let qe in I){let We=I[qe];We instanceof lh?(O1(We.layers,this.zoom,c),bF(We,W,Te.positions,q,De.iconPositions,this.showCollisionBoxes,c,this.tileID.canonical,this.tileZoom,this.projection)):We.hasPattern&&(We instanceof Lt||We instanceof Nf||We instanceof y)&&(O1(We.layers,this.zoom,c),We.addFeatures(F,this.tileID.canonical,De.patternPositions,c,this.tileTransform))}this.status="done",g(null,{buckets:vo(I).filter(qe=>!qe.isEmpty()),featureIndex:C,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Te.image,lineAtlas:A,imageAtlas:De,glyphMap:this.returnDependencies?W:null,iconMap:this.returnDependencies?q:null,glyphPositions:this.returnDependencies?Te.positions:null})}},Ce=jn(F.glyphDependencies,Te=>Object.keys(Te).map(Number));Object.keys(Ce).length?f.send("getGlyphs",{uid:this.uid,stacks:Ce},(Te,De)=>{$||($=Te,W=De,me())},void 0,!1,ae):W={};let ge=Object.keys(F.iconDependencies);ge.length?f.send("getImages",{icons:ge,source:this.source,tileID:this.tileID,type:"icons"},(Te,De)=>{$||($=Te,q=De,me())},void 0,!1,ae):q={};let xe=Object.keys(F.patternDependencies);xe.length?f.send("getImages",{icons:xe,source:this.source,tileID:this.tileID,type:"patterns"},(Te,De)=>{$||($=Te,ee=De,me())},void 0,!1,ae):ee={},me()}}function O1(o,t,a){let c=new z(t);for(let f of o)f.recalculate(c,a)}class SI{constructor(t){this.entries={},this.scheduler=t}request(t,a,c,f){let g=this.entries[t]=this.entries[t]||{callbacks:[]};if(g.result){let[v,C]=g.result;return this.scheduler?this.scheduler.add(()=>{f(v,C)},a):f(v,C),()=>{}}return g.callbacks.push(f),g.cancel||(g.cancel=c((v,C)=>{g.result=[v,C];for(let I of g.callbacks)this.scheduler?this.scheduler.add(()=>{I(v,C)},a):I(v,C);setTimeout(()=>delete this.entries[t],3e3)})),()=>{g.result||(g.callbacks=g.callbacks.filter(v=>v!==f),g.callbacks.length||(g.cancel(),delete this.entries[t]))}}}function AI(o,t,a){let c=JSON.stringify(o.request);return o.data&&(this.deduped.entries[c]={result:[null,o.data]}),this.deduped.request(c,{type:"parseTile",isSymbolTile:o.isSymbolTile,zoom:o.tileZoom},f=>{let g=ea(o.request,(v,C,I,A)=>{v?f(v):C&&f(null,{vectorTile:a?void 0:new Vy(new lb(C)),rawData:C,cacheControl:I,expires:A})});return()=>{g.cancel(),f()}},t)}let kI=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class L1{static from(t){if(!(t instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");let[a,c]=new Uint8Array(t,0,2);if(a!==219)throw new Error("Data does not appear to be in a KDBush format.");let f=c>>4;if(f!==1)throw new Error(`Got v${f} data when expected v1.`);let g=kI[15&c];if(!g)throw new Error("Unrecognized array type.");let[v]=new Uint16Array(t,2,1),[C]=new Uint32Array(t,4,1);return new L1(C,v,g,t)}constructor(t,a=64,c=Float64Array,f){if(isNaN(t)||t<0)throw new Error(`Unpexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+a,2),65535),this.ArrayType=c,this.IndexArrayType=t<65536?Uint16Array:Uint32Array;let g=kI.indexOf(this.ArrayType),v=2*t*this.ArrayType.BYTES_PER_ELEMENT,C=t*this.IndexArrayType.BYTES_PER_ELEMENT,I=(8-C%8)%8;if(g<0)throw new Error(`Unexpected typed array class: ${c}.`);f&&f instanceof ArrayBuffer?(this.data=f,this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+C+I,2*t),this._pos=2*t,this._finished=!0):(this.data=new ArrayBuffer(8+v+C+I),this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+C+I,2*t),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+g]),new Uint16Array(this.data,2,1)[0]=a,new Uint32Array(this.data,4,1)[0]=t)}add(t,a){let c=this._pos>>1;return this.ids[c]=c,this.coords[this._pos++]=t,this.coords[this._pos++]=a,c}finish(){let t=this._pos>>1;if(t!==this.numItems)throw new Error(`Added ${t} items when expected ${this.numItems}.`);return F1(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(t,a,c,f){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");let{ids:g,coords:v,nodeSize:C}=this,I=[0,g.length-1,0],A=[];for(;I.length;){let F=I.pop()||0,V=I.pop()||0,$=I.pop()||0;if(V-$<=C){for(let ae=$;ae<=V;ae++){let me=v[2*ae],Ce=v[2*ae+1];me>=t&&me<=c&&Ce>=a&&Ce<=f&&A.push(g[ae])}continue}let W=$+V>>1,q=v[2*W],ee=v[2*W+1];q>=t&&q<=c&&ee>=a&&ee<=f&&A.push(g[W]),(F===0?t<=q:a<=ee)&&(I.push($),I.push(W-1),I.push(1-F)),(F===0?c>=q:f>=ee)&&(I.push(W+1),I.push(V),I.push(1-F))}return A}within(t,a,c){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");let{ids:f,coords:g,nodeSize:v}=this,C=[0,f.length-1,0],I=[],A=c*c;for(;C.length;){let F=C.pop()||0,V=C.pop()||0,$=C.pop()||0;if(V-$<=v){for(let ae=$;ae<=V;ae++)PI(g[2*ae],g[2*ae+1],t,a)<=A&&I.push(f[ae]);continue}let W=$+V>>1,q=g[2*W],ee=g[2*W+1];PI(q,ee,t,a)<=A&&I.push(f[W]),(F===0?t-c<=q:a-c<=ee)&&(C.push($),C.push(W-1),C.push(1-F)),(F===0?t+c>=q:a+c>=ee)&&(C.push(W+1),C.push(V),C.push(1-F))}return I}}function F1(o,t,a,c,f,g){if(f-c<=a)return;let v=c+f>>1;RI(o,t,v,c,f,g),F1(o,t,a,c,v-1,1-g),F1(o,t,a,v+1,f,1-g)}function RI(o,t,a,c,f,g){for(;f>c;){if(f-c>600){let A=f-c+1,F=a-c+1,V=Math.log(A),$=.5*Math.exp(2*V/3),W=.5*Math.sqrt(V*$*(A-$)/A)*(F-A/2<0?-1:1);RI(o,t,a,Math.max(c,Math.floor(a-F*$/A+W)),Math.min(f,Math.floor(a+(A-F)*$/A+W)),g)}let v=t[2*a+g],C=c,I=f;for(Jy(o,t,c,a),t[2*f+g]>v&&Jy(o,t,c,f);C<I;){for(Jy(o,t,C,I),C++,I--;t[2*C+g]<v;)C++;for(;t[2*I+g]>v;)I--}t[2*c+g]===v?Jy(o,t,c,I):(I++,Jy(o,t,I,f)),I<=a&&(c=I+1),a<=I&&(f=I-1)}}function Jy(o,t,a,c){N1(o,a,c),N1(t,2*a,2*c),N1(t,2*a+1,2*c+1)}function N1(o,t,a){let c=o[t];o[t]=o[a],o[a]=c}function PI(o,t,a,c){let f=o-a,g=t-c;return f*f+g*g}i.ARRAY_TYPE=Rr,i.AUTH_ERR_MSG=Ie,i.Aabb=po,i.Actor=class{constructor(o,t,a){this.target=o,this.parent=t,this.mapId=a,this.callbacks={},this.cancelCallbacks={},Ma(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=ys()?o:E,this.scheduler=new VF}send(o,t,a,c,f=!1,g){let v=Math.round(1e18*Math.random()).toString(36).substring(0,10);a&&(a.metadata=g,this.callbacks[v]=a);let C=tc(this.globalScope)?void 0:[];return this.target.postMessage({id:v,type:o,hasCallback:!!a,targetMapId:c,mustQueue:f,sourceMapId:this.mapId,data:za(t,C)},C),{cancel:()=>{a&&delete this.callbacks[v],this.target.postMessage({id:v,type:"<cancel>",targetMapId:c,sourceMapId:this.mapId})}}}receive(o){let t=o.data,a=t.id;if(a&&(!t.targetMapId||this.mapId===t.targetMapId))if(t.type==="<cancel>"){let c=this.cancelCallbacks[a];delete this.cancelCallbacks[a],c&&c.cancel()}else if(t.mustQueue||ys()){let c=this.callbacks[a];this.cancelCallbacks[a]=this.scheduler.add(()=>this.processTask(a,t),c&&c.metadata||{type:"message"})}else this.processTask(a,t)}processTask(o,t){if(t.type==="<response>"){let a=this.callbacks[o];delete this.callbacks[o],a&&(t.error?a(kl(t.error)):a(null,kl(t.data)))}else{let a=tc(this.globalScope)?void 0:[],c=t.hasCallback?(g,v)=>{delete this.cancelCallbacks[o],this.target.postMessage({id:o,type:"<response>",sourceMapId:this.mapId,error:g?za(g):null,data:za(v,a)},a)}:g=>{},f=kl(t.data);if(this.parent[t.type])this.parent[t.type](t.sourceMapId,f,c);else if(this.parent.getWorkerSource){let g=t.type.split(".");this.parent.getWorkerSource(t.sourceMapId,g[0],f.source)[g[1]](f,c)}else c(new Error(`Could not find function ${t.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}},i.CanonicalTileID=te,i.Color=ir,i.ColorMode=Nc,i.CullFaceMode=$l,i.DEMData=xb,i.DataConstantProperty=Q,i.DedupedRequest=SI,i.DepthMode=Om,i.EXTENT=Wt,i.Elevation=class{isDataAvailableAtPoint(o){let t=this._source();if(this.isUsingMockSource()||!t||o.y<0||o.y>1)return!1;let a=t.getSource().maxzoom,c=1<<a,f=Math.floor(o.x),g=Math.floor((o.x-f)*c),v=Math.floor(o.y*c),C=this.findDEMTileFor(new J(a,f,a,g,v));return!(!C||!C.dem)}getAtPointOrZero(o,t=0){return this.getAtPoint(o,t)||0}getAtPoint(o,t,a=!0){if(this.isUsingMockSource())return null;t==null&&(t=null);let c=this._source();if(!c||o.y<0||o.y>1)return t;let f=c.getSource().maxzoom,g=1<<f,v=Math.floor(o.x),C=o.x-v,I=new J(f,v,f,Math.floor(C*g),Math.floor(o.y*g)),A=this.findDEMTileFor(I);if(!A||!A.dem)return t;let F=A.dem,V=1<<A.tileID.canonical.z,$=(C*V-A.tileID.canonical.x)*F.dim,W=(o.y*V-A.tileID.canonical.y)*F.dim,q=Math.floor($),ee=Math.floor(W);return(a?this.exaggeration():1)*Fn(Fn(F.get(q,ee),F.get(q,ee+1),W-ee),Fn(F.get(q+1,ee),F.get(q+1,ee+1),W-ee),$-q)}getAtTileOffset(o,t,a){let c=1<<o.canonical.z;return this.getAtPointOrZero(new Jd(o.wrap+(o.canonical.x+t/Wt)/c,(o.canonical.y+a/Wt)/c))}getAtTileOffsetFunc(o,t,a,c){return f=>{let g=this.getAtTileOffset(o,f.x,f.y),v=c.upVector(o.canonical,f.x,f.y);return os(v,v,g*c.upVectorScale(o.canonical,t,a).metersToTile),v}}getForTilePoints(o,t,a,c){if(this.isUsingMockSource())return!1;let f=wb.create(this,o,c);return!!f&&(t.forEach(g=>{g[2]=this.exaggeration()*f.getElevationAt(g[0],g[1],a)}),!0)}getMinMaxForTile(o){if(this.isUsingMockSource())return null;let t=this.findDEMTileFor(o);if(!t||!t.dem)return null;let a=t.dem.tree,c=t.tileID,f=1<<o.canonical.z-c.canonical.z,g=o.canonical.x/f-c.canonical.x,v=o.canonical.y/f-c.canonical.y,C=0;for(let I=0;I<o.canonical.z-c.canonical.z&&!a.leaves[C];I++){g*=2,v*=2;let A=2*Math.floor(v)+Math.floor(g);C=a.childOffsets[C]+A,g%=1,v%=1}return{min:this.exaggeration()*a.minimums[C],max:this.exaggeration()*a.maximums[C]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(o,t,a){throw new Error("Pure virtual method called.")}pointCoordinate(o){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(o){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}},i.ErrorEvent=ta,i.EvaluationParameters=z,i.Event=ol,i.Evented=sc,i.FillExtrusionBucket=y,i.Frustum=by,i.FrustumCorners=vy,i.GLOBE_RADIUS=Is,i.GLOBE_SCALE_MATCH_LATITUDE=45,i.GLOBE_ZOOM_THRESHOLD_MAX=om,i.GLOBE_ZOOM_THRESHOLD_MIN=rm,i.GlobeSharedBuffers=class{constructor(o){this._createGrid(o),this._createPoles(o)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(let o of this._poleSegments)o.destroy();for(let o of this._gridSegments)o.withSkirts.destroy(),o.withoutSkirts.destroy();if(this._wireframeIndexBuffer){this._wireframeIndexBuffer.destroy();for(let o of this._wireframeSegments)o.destroy()}}_fillGridMeshWithLods(o,t){let a=new mt,c=new Vt,f=[],g=o+1+2,v=t[0]+1,C=t[0]+1+(1+t.length),I=(A,F,V)=>{let $=A===g-1?A-2:A===0?A:A-1;return $+=V?24575:0,[$,F]};for(let A=0;A<g;++A)a.emplaceBack(...I(A,0,!0));for(let A=0;A<v;++A)for(let F=0;F<g;++F)a.emplaceBack(...I(F,A,(F===0||F===g-1)&&!0));for(let A=0;A<t.length;++A){let F=t[A];for(let V=0;V<g;++V)a.emplaceBack(...I(V,F,!0))}for(let A=0;A<t.length;++A){let F=c.length,V=t[A]+1+2,$=new Vt;for(let ee=0;ee<V-1;ee++){let ae=ee===V-2,me=ae?g*(C-t.length+A-ee):g;for(let Ce=0;Ce<g-1;Ce++){let ge=ee*g+Ce;ee===0||ae||Ce===0||Ce===g-2?($.emplaceBack(ge+1,ge,ge+me),$.emplaceBack(ge+me,ge+me+1,ge+1)):(c.emplaceBack(ge+1,ge,ge+me),c.emplaceBack(ge+me,ge+me+1,ge+1))}}let W=Xi.simpleSegment(0,F,a.length,c.length-F);for(let ee=0;ee<$.uint16.length;ee+=3)c.emplaceBack($.uint16[ee],$.uint16[ee+1],$.uint16[ee+2]);let q=Xi.simpleSegment(0,F,a.length,c.length-F);f.push({withoutSkirts:W,withSkirts:q})}return{vertices:a,indices:c,segments:f}}_createGrid(o){let t=this._fillGridMeshWithLods(kc,Cf);this._gridSegments=t.segments,this._gridBuffer=o.createVertexBuffer(t.vertices,Yd.members),this._gridIndexBuffer=o.createIndexBuffer(t.indices,!0)}_createPoles(o){let t=new Vt;for(let f=0;f<=kc;f++)t.emplaceBack(0,f+1,f+2);this._poleIndexBuffer=o.createIndexBuffer(t,!0);let a=new hi,c=new hi;this._poleSegments=[];for(let f=0,g=0;f<rm;f++){let v=360/(1<<f);a.emplaceBack(0,-Is,0,.5,0),c.emplaceBack(0,-Is,0,.5,1);for(let C=0;C<=kc;C++){let I=C/kc,A=Fn(0,v,I),[F,V,$]=Kd($w,um,A,Is);a.emplaceBack(F,V,$,I,0),c.emplaceBack(F,V,$,I,1)}this._poleSegments.push(Xi.simpleSegment(g,0,66,64)),g+=66}this._poleNorthVertexBuffer=o.createVertexBuffer(a,_y,!1),this._poleSouthVertexBuffer=o.createVertexBuffer(c,_y,!1)}getGridBuffers(o,t){return[this._gridBuffer,this._gridIndexBuffer,t?this._gridSegments[o].withSkirts:this._gridSegments[o].withoutSkirts]}getPoleBuffers(o){return[this._poleNorthVertexBuffer,this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[o]]}getWirefameBuffers(o,t){if(!this._wireframeSegments){let a=new vr,c=kc,f=c+1+2,g=1;this._wireframeSegments=[];for(let v=0,C=0;v<Cf.length;v++){let I=Cf[v];for(let F=g;F<I+g;F++)for(let V=g;V<c+g;V++){let $=F*f+V;a.emplaceBack($,$+1),a.emplaceBack($,$+f),a.emplaceBack($,$+f+1)}let A=I*c*3;this._wireframeSegments.push(Xi.simpleSegment(0,C,(I+1)*f,A)),C+=A}this._wireframeIndexBuffer=o.createIndexBuffer(a)}return[this._gridBuffer,this._wireframeIndexBuffer,this._wireframeSegments[t]]}},i.GlyphManager=Sm,i.ImagePosition=_1,i.KDBush=L1,i.LivePerformanceUtils=Dp,i.LngLat=ai,i.LngLatBounds=Tc,i.LocalGlyphMode=x1,i.MAX_MERCATOR_LATITUDE=Yr,i.MercatorCoordinate=Jd,i.ONE_EM=An,i.OverscaledTileID=J,i.PerformanceMarkers=oc,i.Point=It,i.Properties=_e,i.RGBAImage=oo,i.Ray=im,i.RequestManager=class{constructor(o,t,a){this._transformRequestFn=o,this._customAccessToken=t,this._silenceAuthErrors=!!a,this._createSkuToken()}_createSkuToken(){let o=function(){let t="";for(let a=0;a<10;a++)t+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",Ut,t].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=o.token,this._skuTokenExpiresAt=o.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(o,t){return this._transformRequestFn&&this._transformRequestFn(o,t)||{url:o}}normalizeStyleURL(o,t){if(!Pe(o))return o;let a=Tt(o);return a.path=`/styles/v1${a.path}`,this._makeAPIURL(a,this._customAccessToken||t)}normalizeGlyphsURL(o,t){if(!Pe(o))return o;let a=Tt(o);return a.path=`/fonts/v1${a.path}`,this._makeAPIURL(a,this._customAccessToken||t)}normalizeSourceURL(o,t,a,c){if(!Pe(o))return o;let f=Tt(o);return f.path=`/v4/${f.authority}.json`,f.params.push("secure"),a&&f.params.push(`language=${a}`),c&&f.params.push(`worldview=${c}`),this._makeAPIURL(f,this._customAccessToken||t)}normalizeSpriteURL(o,t,a,c){let f=Tt(o);return Pe(o)?(f.path=`/styles/v1${f.path}/sprite${t}${a}`,this._makeAPIURL(f,this._customAccessToken||c)):(f.path+=`${t}${a}`,yt(f))}normalizeTileURL(o,t,a){if(this._isSkuTokenExpired()&&this._createSkuToken(),o&&!Pe(o))return o;let c=Tt(o);c.path=c.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${t||a&&c.authority!=="raster"&&a===512?"@2x":""}${oe.supported?".webp":"$1"}`),c.authority==="raster"?c.path=`/${Y.RASTER_URL_PREFIX}${c.path}`:(c.path=c.path.replace(/^.+\/v4\//,"/"),c.path=`/${Y.TILE_URL_VERSION}${c.path}`);let f=this._customAccessToken||function(g){for(let v of g){let C=v.match(/^access_token=(.*)$/);if(C)return C[1]}return null}(c.params)||Y.ACCESS_TOKEN;return Y.REQUIRE_ACCESS_TOKEN&&f&&this._skuToken&&c.params.push(`sku=${this._skuToken}`),this._makeAPIURL(c,f)}canonicalizeTileURL(o,t){let a=Tt(o);if(!a.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!a.path.match(/\.[\w]+$/))return o;let c="mapbox://";a.path.match(/^\/raster\/v1\//)?c+=`raster/${a.path.replace(`/${Y.RASTER_URL_PREFIX}/`,"")}`:c+=`tiles/${a.path.replace(`/${Y.TILE_URL_VERSION}/`,"")}`;let f=a.params;return t&&(f=f.filter(g=>!g.match(/^access_token=/))),f.length&&(c+=`?${f.join("&")}`),c}canonicalizeTileset(o,t){let a=!!t&&Pe(t),c=[];for(let f of o.tiles||[])$e(f)?c.push(this.canonicalizeTileURL(f,a)):c.push(f);return c}_makeAPIURL(o,t){let a="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",c=Tt(Y.API_URL);if(o.protocol=c.protocol,o.authority=c.authority,o.protocol==="http"){let f=o.params.indexOf("secure");f>=0&&o.params.splice(f,1)}if(c.path!=="/"&&(o.path=`${c.path}${o.path}`),!Y.REQUIRE_ACCESS_TOKEN)return yt(o);if(t=t||Y.ACCESS_TOKEN,!this._silenceAuthErrors){if(!t)throw new Error(`An API access token is required to use Mapbox GL. ${a}`);if(t[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${a}`)}return o.params=o.params.filter(f=>f.indexOf("access_token")===-1),o.params.push(`access_token=${t||""}`),yt(o)}},i.ResourceType=rl,i.SegmentVector=Xi,i.SourceCache=jf,i.StencilMode=k1,i.StructArrayLayout1ui2=To,i.StructArrayLayout2f1f2i16=Xt,i.StructArrayLayout2i4=mt,i.StructArrayLayout2ui4=vr,i.StructArrayLayout3f12=Mn,i.StructArrayLayout3ui6=Vt,i.StructArrayLayout4i8=it,i.StructArrayLayout5f20=hi,i.Texture=Ky,i.Tile=S1,i.Transitionable=K,i.Uniform1f=gf,i.Uniform1i=class extends Pl{constructor(o){super(o),this.current=0}set(o,t,a){this.fetchUniformLocation(o,t)&&this.current!==a&&(this.current=a,this.gl.uniform1i(this.location,a))}},i.Uniform2f=class extends Pl{constructor(o){super(o),this.current=[0,0]}set(o,t,a){this.fetchUniformLocation(o,t)&&(a[0]===this.current[0]&&a[1]===this.current[1]||(this.current=a,this.gl.uniform2f(this.location,a[0],a[1])))}},i.Uniform3f=class extends Pl{constructor(o){super(o),this.current=[0,0,0]}set(o,t,a){this.fetchUniformLocation(o,t)&&(a[0]===this.current[0]&&a[1]===this.current[1]&&a[2]===this.current[2]||(this.current=a,this.gl.uniform3f(this.location,a[0],a[1],a[2])))}},i.Uniform4f=Iv,i.UniformColor=uy,i.UniformMatrix2f=class extends Pl{constructor(o){super(o),this.current=Yp}set(o,t,a){if(this.fetchUniformLocation(o,t)){for(let c=0;c<4;c++)if(a[c]!==this.current[c]){this.current=a,this.gl.uniformMatrix2fv(this.location,!1,a);break}}}},i.UniformMatrix3f=class extends Pl{constructor(o){super(o),this.current=Rw}set(o,t,a){if(this.fetchUniformLocation(o,t)){for(let c=0;c<9;c++)if(a[c]!==this.current[c]){this.current=a,this.gl.uniformMatrix3fv(this.location,!1,a);break}}}},i.UniformMatrix4f=class extends Pl{constructor(o){super(o),this.current=kw}set(o,t,a){if(this.fetchUniformLocation(o,t)){if(a[12]!==this.current[12]||a[0]!==this.current[0])return this.current=a,void this.gl.uniformMatrix4fv(this.location,!1,a);for(let c=1;c<16;c++)if(a[c]!==this.current[c]){this.current=a,this.gl.uniformMatrix4fv(this.location,!1,a);break}}}},i.UnwrappedTileID=ne,i.ValidationError=Rt,i.VectorTileFeature=Gu,i.VectorTileWorkerSource=class extends sc{constructor(o,t,a,c,f){super(),this.actor=o,this.layerIndex=t,this.availableImages=a,this.loadVectorData=f||AI,this.loading={},this.loaded={},this.deduped=new SI(o.scheduler),this.isSpriteLoaded=c,this.scheduler=o.scheduler}loadTile(o,t){let a=o.uid,c=o&&o.request,f=c&&c.collectResourceTiming,g=this.loading[a]=new ZF(o);g.abort=this.loadVectorData(o,(v,C)=>{let I=!this.loading[a];if(delete this.loading[a],I||v||!C)return g.status="done",I||(this.loaded[a]=g),t(v);let A=C.rawData,F={};C.expires&&(F.expires=C.expires),C.cacheControl&&(F.cacheControl=C.cacheControl),g.vectorTile=C.vectorTile||new Vy(new lb(A));let V=()=>{g.parse(g.vectorTile,this.layerIndex,this.availableImages,this.actor,($,W)=>{if($||!W)return t($);let q={};if(f){let ee=iu(c);ee.length>0&&(q.resourceTiming=JSON.parse(JSON.stringify(ee)))}t(null,Bi({rawTileData:A.slice(0)},W,F,q))})};this.isSpriteLoaded?V():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(V,{type:"parseTile",isSymbolTile:o.isSymbolTile,zoom:o.tileZoom}):V()}),this.loaded=this.loaded||{},this.loaded[a]=g})}reloadTile(o,t){let a=this.loaded,c=o.uid,f=this;if(a&&a[c]){let g=a[c];g.showCollisionBoxes=o.showCollisionBoxes,g.enableTerrain=!!o.enableTerrain,g.projection=o.projection,g.tileTransform=Bf(o.tileID.canonical,o.projection);let v=(C,I)=>{let A=g.reloadCallback;A&&(delete g.reloadCallback,g.parse(g.vectorTile,f.layerIndex,this.availableImages,f.actor,A)),t(C,I)};g.status==="parsing"?g.reloadCallback=v:g.status==="done"&&(g.vectorTile?g.parse(g.vectorTile,this.layerIndex,this.availableImages,this.actor,v):v())}}abortTile(o,t){let a=o.uid,c=this.loading[a];c&&(c.abort&&c.abort(),delete this.loading[a]),t()}removeTile(o,t){let a=this.loaded,c=o.uid;a&&a[c]&&delete a[c],t()}},i.WritingMode=ma,i.ZoomDependentExpression=La,i.add=Nn,i.addDynamicAttributes=_b,i.adjoint=function(o,t){var a=t[0],c=t[1],f=t[2],g=t[3],v=t[4],C=t[5],I=t[6],A=t[7],F=t[8];return o[0]=v*F-C*A,o[1]=f*A-c*F,o[2]=c*C-f*v,o[3]=C*I-g*F,o[4]=a*F-f*I,o[5]=f*g-a*C,o[6]=g*A-v*I,o[7]=c*I-a*A,o[8]=a*v-c*g,o},i.asyncAll=wr,i.bezier=el,i.bindAll=Ma,i.boundsAttributes=hI,i.bufferConvexPolygon=function(o,t){let a=[];for(let c=0;c<o.length;c++){let f=gr(c-1,-1,o.length-1),g=gr(c+1,-1,o.length-1),v=o[c],C=o[g],I=o[f].sub(v).unit(),A=C.sub(v).unit(),F=A.angleWithSep(I.x,I.y),V=I.add(A).unit().mult(-1*t/Math.sin(F/2));a.push(v.add(V))}return a},i.cacheEntryPossiblyAdded=function(o){nu++,nu>gd&&(o.getActor().send("enforceCacheSizeLimit",Mi),nu=0)},i.calculateGlobeLabelMatrix=function(o,t){let{x:a,y:c}=o.point,f=Nv(a,c,o.worldSize/o._pixelsPerMercatorPixel,0,0);return Fl(f,f,lm(mo(t)))},i.calculateGlobeMatrix=function(o){let{x:t,y:a}=o.point,{lng:c,lat:f}=o._center;return Nv(t,a,o.worldSize,c,f)},i.calculateGlobeMercatorMatrix=function(o){let t=o.pixelsPerMeter,a=t/as(1,o.center.lat),c=ha(new Float64Array(16));return Lu(c,c,[o.point.x,o.point.y,0]),Ic(c,c,[a,a,t]),Float32Array.from(c)},i.circumferenceAtLatitude=Sf,i.clamp=Tn,i.clearTileCache=function(o){if(!ic())return;let t=E.caches.delete(nc);o&&t.catch(o).then(()=>o())},i.clipLine=ZT,i.clone=function(o){var t=new Rr(16);return t[0]=o[0],t[1]=o[1],t[2]=o[2],t[3]=o[3],t[4]=o[4],t[5]=o[5],t[6]=o[6],t[7]=o[7],t[8]=o[8],t[9]=o[9],t[10]=o[10],t[11]=o[11],t[12]=o[12],t[13]=o[13],t[14]=o[14],t[15]=o[15],t},i.clone$1=bo,i.collisionCircleLayout=ei,i.config=Y,i.conjugate=function(o,t){return o[0]=-t[0],o[1]=-t[1],o[2]=-t[2],o[3]=t[3],o},i.create=function(){var o=new Rr(16);return Rr!=Float32Array&&(o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[11]=0,o[12]=0,o[13]=0,o[14]=0),o[0]=1,o[5]=1,o[10]=1,o[15]=1,o},i.create$1=Zd,i.createExpression=Kt,i.createLayout=Fe,i.createStyleLayer=function(o){return o.type==="custom"?new NF(o):new BF[o.type](o)},i.cross=zr,i.degToRad=Pn,i.distance=function(o,t){return Math.hypot(t[0]-o[0],t[1]-o[1],t[2]-o[2])},i.div=function(o,t,a){return o[0]=t[0]/a[0],o[1]=t[1]/a[1],o[2]=t[2]/a[2],o},i.dot=Bo,i.earthRadius=zu,i.ease=eu,i.easeCubicInOut=Zs,i.ecefToLatLng=function([o,t,a]){let c=Math.hypot(o,t,a),f=Math.atan2(o,a),g=.5*Math.PI-Math.acos(-t/c);return new ai(tr(f),tr(g))},i.emitValidationErrors=$p,i.endsWith=nl,i.enforceCacheSizeLimit=function(o){Qs(),Po&&Po.then(t=>{t.keys().then(a=>{for(let c=0;c<a.length-o;c++)t.delete(a[c])})})},i.evaluateSizeForFeature=Pr,i.evaluateSizeForZoom=Qi,i.evaluateVariableOffset=JT,i.evented=x,i.exactEquals=function(o,t){return o[0]===t[0]&&o[1]===t[1]&&o[2]===t[2]&&o[3]===t[3]},i.exactEquals$1=function(o,t){return o[0]===t[0]&&o[1]===t[1]&&o[2]===t[2]},i.exported=vs,i.exported$1=oe,i.extend=Bi,i.extend$1=na,i.fillExtrusionHeightLift=B,i.filterObject=Zt,i.fromMat4=function(o,t){return o[0]=t[0],o[1]=t[1],o[2]=t[2],o[3]=t[4],o[4]=t[5],o[5]=t[6],o[6]=t[8],o[7]=t[9],o[8]=t[10],o},i.fromQuat=function(o,t){var a=t[0],c=t[1],f=t[2],g=t[3],v=a+a,C=c+c,I=f+f,A=a*v,F=c*v,V=c*C,$=f*v,W=f*C,q=f*I,ee=g*v,ae=g*C,me=g*I;return o[0]=1-V-q,o[1]=F+me,o[2]=$-ae,o[3]=0,o[4]=F-me,o[5]=1-A-q,o[6]=W+ee,o[7]=0,o[8]=$+ae,o[9]=W-ee,o[10]=1-A-V,o[11]=0,o[12]=0,o[13]=0,o[14]=0,o[15]=1,o},i.fromRotation=function(o,t){var a=Math.sin(t),c=Math.cos(t);return o[0]=c,o[1]=a,o[2]=0,o[3]=-a,o[4]=c,o[5]=0,o[6]=0,o[7]=0,o[8]=1,o},i.fromScaling=Nl,i.furthestTileCorner=function(o){let t=Math.round((o+45+360)%360/90)%4;return ec[t]},i.getAABBPointSquareDist=function(o,t,a){let c=0;for(let f=0;f<2;++f){let g=a?a[f]:0;o[f]>g&&(c+=(o[f]-g)*(o[f]-g)),t[f]<g&&(c+=(g-t[f])*(g-t[f]))}return c},i.getAnchorAlignment=b1,i.getAnchorJustification=C1,i.getBounds=function(o){let t=1/0,a=1/0,c=-1/0,f=-1/0;for(let g of o)t=Math.min(t,g.x),a=Math.min(a,g.y),c=Math.max(c,g.x),f=Math.max(f,g.y);return{min:new It(t,a),max:new It(c,f)}},i.getColumn=no,i.getDefaultExportFromCjs=Qt,i.getGridMatrix=function(o,t,a,c){let f=t.getNorth(),g=t.getSouth(),v=t.getWest(),C=t.getEast(),I=1<<o.z,A=C-v,F=f-g,V=A/kc,$=-F/Cf[a],W=[0,V,0,$,0,0,f,v,0];if(o.z>0){let q=180/c;fy(W,W,[q/A+1,0,0,0,q/F+1,0,-.5*q/V,.5*q/$,1])}return W[2]=I,W[5]=o.x,W[8]=o.y,W},i.getImage=ve,i.getJSON=function(o,t){return Sr(Bi(o,{type:"json"}),t)},i.getLatitudinalLod=function(o){let t=Yr-5;o=Tn(o,-t,t)/t*90;let a=Math.pow(Math.abs(Math.sin(Pn(o))),3);return Math.round(a*(Cf.length-1))},i.getMapSessionAPI=Ar,i.getPerformanceMeasurement=iu,i.getProjection=aI,i.getRTLTextPluginStatus=D,i.getReferrer=Js,i.getTilePoint=function(o,{x:t,y:a},c=0){return new It(((t-c)*o.scale-o.x)*Wt,(a*o.scale-o.y)*Wt)},i.getTileVec3=function(o,t,a=0){return Sc(((t.x-a)*o.scale-o.x)*Wt,(t.y*o.scale-o.y)*Wt,dm(t.z,t.y))},i.getVideo=function(o,t){let a=E.document.createElement("video");a.muted=!0,a.onloadstart=function(){t(null,a)};for(let c=0;c<o.length;c++){let f=E.document.createElement("source");yd(o[c])||(a.crossOrigin="Anonymous"),f.src=o[c],a.appendChild(f)}return{cancel:()=>{}}},i.globeCenterToScreenPoint=function(o){let t=[0,0,0],a=ha(new Float64Array(16));return Fl(a,o.pixelMatrix,o.globeMatrix),sr(t,t,a),new It(t[0],t[1])},i.globeDenormalizeECEF=lm,i.globeECEFOrigin=function(o,t){let a=[0,0,0];return sr(a,a,If(mo(t.canonical))),sr(a,a,o),a},i.globeMetersToEcef=Df,i.globeNormalizeECEF=If,i.globePixelsToTileUnits=function(o,t){return Wt/(512*Math.pow(2,o))*am(mo(t))},i.globePoleMatrixForTile=function(o,t,a){let c=ha(new Float64Array(16)),f=(t/(1<<o)-.5)*Math.PI*2;return zo(c,a.globeMatrix,f),Float32Array.from(c)},i.globeTileBounds=mo,i.globeTiltAtLngLat=cm,i.globeToMercatorTransition=Nu,i.globeUseCustomAntiAliasing=function(o,t,a){let c=Nu(a.zoom),f=o.style.map._antialias,g=!!t.extStandardDerivatives,v=t.extStandardDerivativesForceOff||o.terrain&&o.terrain.exaggeration()>0;return c===0&&!f&&!v&&g},i.identity=ha,i.identity$1=xf,i.invert=Qp,i.isFullscreen=function(){return!!E.document.fullscreenElement||!!E.document.webkitFullscreenElement},i.isLngLatBehindGlobe=wy,i.isMapAuthenticated=function(o){return Gr.has(o)},i.isMapboxURL=Pe,i.isSafariWithAntialiasingBug=function(o){let t=o.navigator?o.navigator.userAgent:null;return!!tc(o)&&t&&(t.match("Version/15.4")||t.match("Version/15.5")||t.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},i.latFromMercatorY=Xr,i.latLngToECEF=Qd,i.len=Bw,i.length=Ts,i.length$1=function(o){return Math.hypot(o[0],o[1],o[2],o[3])},i.lngFromMercatorX=ls,i.loadVectorTile=AI,i.makeRequest=Sr,i.mapValue=function(o,t,a,c,f){return Tn((o-t)/(a-t)*(f-c)+c,c,f)},i.mercatorScale=Bv,i.mercatorXfromLng=fa,i.mercatorYfromLat=Va,i.mercatorZfromAltitude=as,i.mul=Nw,i.mul$1=zw,i.multiply=Fl,i.multiply$1=fy,i.multiply$2=em,i.nextPowerOfTwo=Ys,i.normalize=or,i.normalize$1=jw,i.normalize$2=Av,i.number=Fn,i.ortho=function(o,t,a,c,f,g,v){var C=1/(t-a),I=1/(c-f),A=1/(g-v);return o[0]=-2*C,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=-2*I,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=2*A,o[11]=0,o[12]=(t+a)*C,o[13]=(f+c)*I,o[14]=(v+g)*A,o[15]=1,o},i.pbf=Wu,i.perspective=function(o,t,a,c,f){var g,v=1/Math.tan(t/2);return o[0]=v/a,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=v,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[11]=-1,o[12]=0,o[13]=0,o[15]=0,f!=null&&f!==1/0?(o[10]=(f+c)*(g=1/(c-f)),o[14]=2*f*c*g):(o[10]=-1,o[14]=-2*c),o},i.pick=function(o,t){let a={};for(let c=0;c<t.length;c++){let f=t[c];f in o&&(a[f]=o[f])}return a},i.plugin=R,i.pointGeometry=lt,i.polesInViewport=function(o){let t=ha(new Float64Array(16));Fl(t,o.pixelMatrix,o.globeMatrix);let a=[0,Ss,0],c=[0,ss,0];return sr(a,a,t),sr(c,c,t),[a[0]>0&&a[0]<=o.width&&a[1]>0&&a[1]<=o.height&&!wy(o,new ai(o.center.lat,90)),c[0]>0&&c[0]<=o.width&&c[1]>0&&c[1]<=o.height&&!wy(o,new ai(o.center.lat,-90))]},i.polygonContainsPoint=ju,i.polygonIntersectsBox=ih,i.polygonIntersectsPolygon=Vv,i.polygonizeBounds=function(o,t,a=0,c=!0){let f=new It(a,a),g=o.sub(f),v=t.add(f),C=[g,new It(v.x,g.y),v,new It(g.x,v.y)];return c&&C.push(g.clone()),C},i.posAttributes=Yd,i.postMapLoadEvent=nr,i.postPerformanceEvent=yr,i.postTurnstileEvent=On,i.potpack=y1,i.prevPowerOfTwo=function(o){return o<=1?1:Math.pow(2,Math.floor(Math.log(o)/Math.LN2))},i.radToDeg=tr,i.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],i.registerForPluginStateChange=function(o){return o({pluginStatus:m,pluginURL:l}),x.on("pluginStateChange",o),o},i.removeAuthState=function(o){Gr.delete(o)},i.renderColorRamp=Sy,i.resample=Af,i.rotateX=vf,i.rotateX$1=tm,i.rotateY=zo,i.rotateY$1=nm,i.rotateZ=function(o,t,a){var c=Math.sin(a),f=Math.cos(a),g=t[0],v=t[1],C=t[2],I=t[3],A=t[4],F=t[5],V=t[6],$=t[7];return t!==o&&(o[8]=t[8],o[9]=t[9],o[10]=t[10],o[11]=t[11],o[12]=t[12],o[13]=t[13],o[14]=t[14],o[15]=t[15]),o[0]=g*f+A*c,o[1]=v*f+F*c,o[2]=C*f+V*c,o[3]=I*f+$*c,o[4]=A*f-g*c,o[5]=F*f-v*c,o[6]=V*f-C*c,o[7]=$*f-I*c,o},i.rotateZ$1=function(o,t,a){a*=.5;var c=t[0],f=t[1],g=t[2],v=t[3],C=Math.sin(a),I=Math.cos(a);return o[0]=c*I+f*C,o[1]=f*I-c*C,o[2]=g*I+v*C,o[3]=v*I-g*C,o},i.scale=Ic,i.scale$1=zl,i.scale$2=os,i.scaleAndAdd=Ac,i.set=function(o,t,a,c){return o[0]=t,o[1]=a,o[2]=c,o},i.setCacheLimits=function(o,t){Mi=o,gd=t},i.setColumn=function(o,t,a){o[4*t+0]=a[0],o[4*t+1]=a[1],o[4*t+2]=a[2],o[4*t+3]=a[3]},i.setRTLTextPlugin=function(o,t,a=!1){if(m===ku||m===hf||m===ff)throw new Error("setRTLTextPlugin cannot be called multiple times.");l=vs.resolveURL(o),m=ku,Dc=t,_(),a||k()},i.smoothstep=Yo,i.spec=Je,i.squaredLength=function(o){var t=o[0],a=o[1],c=o[2];return t*t+a*a+c*c},i.storeAuthState=function(o,t){t?Gr.add(o):Gr.delete(o)},i.sub=jo,i.subtract=gy,i.symbolSize=So,i.tileAABB=function(o,t,a,c,f,g,v,C,I){if(I.name==="globe")return Uw(o,t,new te(a,c,f));let A=Bf({z:a,x:c,y:f},I);return new po([(g+A.x/A.scale)*t,t*(A.y/A.scale),v],[(g+A.x2/A.scale)*t,t*(A.y2/A.scale),C])},i.tileCornersToBounds=sm,i.tileTransform=Bf,i.transformMat3=function(o,t,a){var c=t[0],f=t[1],g=t[2];return o[0]=c*a[0]+f*a[3]+g*a[6],o[1]=c*a[1]+f*a[4]+g*a[7],o[2]=c*a[2]+f*a[5]+g*a[8],o},i.transformMat4=sr,i.transformMat4$1=Fu,i.transformQuat=yy,i.transitionTileAABBinECEF=Ov,i.translate=Lu,i.transpose=function(o,t){if(o===t){var a=t[1],c=t[2],f=t[5];o[1]=t[3],o[2]=t[6],o[3]=a,o[5]=t[7],o[6]=c,o[7]=f}else o[0]=t[0],o[1]=t[3],o[2]=t[6],o[3]=t[1],o[4]=t[4],o[5]=t[7],o[6]=t[2],o[7]=t[5],o[8]=t[8];return o},i.triggerPluginCompletionEvent=h,i.uniqueId=tl,i.updateGlobeVertexNormal=function(o,t,a,c,f){let g=5*t+2;o.float32[g+0]=a,o.float32[g+1]=c,o.float32[g+2]=f},i.validateCustomStyleLayer=function(o){let t=[],a=o.id;return a===void 0&&t.push({message:`layers.${a}: missing required property "id"`}),o.render===void 0&&t.push({message:`layers.${a}: missing required method "render"`}),o.renderingMode&&o.renderingMode!=="2d"&&o.renderingMode!=="3d"&&t.push({message:`layers.${a}: property "renderingMode" must be either "2d" or "3d"`}),t},i.validateFilter=o=>No(wc(o)),i.validateFog=o=>No(jp(o)),i.validateLayer=o=>No(sf(o)),i.validateLight=o=>No(af(o)),i.validateSource=o=>No(Au(o)),i.validateStyle=Vp,i.validateTerrain=o=>No(lf(o)),i.values=vo,i.vectorTile=oh,i.version=L,i.warnOnce=vi,i.window=E,i.wrap=gr}),s(["./shared"],function(i){"use strict";function E(be){if(typeof be=="number"||typeof be=="boolean"||typeof be=="string"||be==null)return JSON.stringify(be);if(Array.isArray(be)){let re="[";for(let ve of be)re+=`${E(ve)},`;return`${re}]`}let ie="{";for(let re of Object.keys(be).sort())ie+=`${re}:${E(be[re])},`;return`${ie}}`}function L(be){let ie="";for(let re of i.refProperties)ie+=`/${E(be[re])}`;return ie}class j{constructor(ie){this.keyCache={},ie&&this.replace(ie)}replace(ie){this._layerConfigs={},this._layers={},this.update(ie,[])}update(ie,re){for(let Ie of ie)this._layerConfigs[Ie.id]=Ie,(this._layers[Ie.id]=i.createStyleLayer(Ie)).compileFilter(),this.keyCache[Ie.id]&&delete this.keyCache[Ie.id];for(let Ie of re)delete this.keyCache[Ie],delete this._layerConfigs[Ie],delete this._layers[Ie];this.familiesBySource={};let ve=function(Ie,Pe){let $e={};for(let Oe=0;Oe<Ie.length;Oe++){let Xe=Pe&&Pe[Ie[Oe].id]||L(Ie[Oe]);Pe&&(Pe[Ie[Oe].id]=Xe);let Ct=$e[Xe];Ct||(Ct=$e[Xe]=[]),Ct.push(Ie[Oe])}let Ve=[];for(let Oe in $e)Ve.push($e[Oe]);return Ve}(i.values(this._layerConfigs),this.keyCache);for(let Ie of ve){let Pe=Ie.map(Tt=>this._layers[Tt.id]),$e=Pe[0];if($e.visibility==="none")continue;let Ve=$e.source||"",Oe=this.familiesBySource[Ve];Oe||(Oe=this.familiesBySource[Ve]={});let Xe=$e.sourceLayer||"_geojsonTileLayer",Ct=Oe[Xe];Ct||(Ct=Oe[Xe]=[]),Ct.push(Pe)}}}class Y{loadTile(ie,re){let{uid:ve,encoding:Ie,rawImageData:Pe,padding:$e,buildQuadTree:Ve}=ie,Oe=i.window.ImageBitmap&&Pe instanceof i.window.ImageBitmap?this.getImageData(Pe,$e):Pe;re(null,new i.DEMData(ve,Oe,Ie,$e<1,Ve))}getImageData(ie,re){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(ie.width,ie.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=ie.width,this.offscreenCanvas.height=ie.height,this.offscreenCanvasContext.drawImage(ie,0,0,ie.width,ie.height);let ve=this.offscreenCanvasContext.getImageData(-re,-re,ie.width+2*re,ie.height+2*re);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),ve}}function oe(be,ie){if(be.length!==0){Ee(be[0],ie);for(var re=1;re<be.length;re++)Ee(be[re],!ie)}}function Ee(be,ie){for(var re=0,ve=0,Ie=0,Pe=be.length,$e=Pe-1;Ie<Pe;$e=Ie++){var Ve=(be[Ie][0]-be[$e][0])*(be[$e][1]+be[Ie][1]),Oe=re+Ve;ve+=Math.abs(re)>=Math.abs(Ve)?re-Oe+Ve:Ve-Oe+re,re=Oe}re+ve>=0!=!!ie&&be.reverse()}var Ye=i.getDefaultExportFromCjs(function be(ie,re){var ve,Ie=ie&&ie.type;if(Ie==="FeatureCollection")for(ve=0;ve<ie.features.length;ve++)be(ie.features[ve],re);else if(Ie==="GeometryCollection")for(ve=0;ve<ie.geometries.length;ve++)be(ie.geometries[ve],re);else if(Ie==="Feature")be(ie.geometry,re);else if(Ie==="Polygon")oe(ie.coordinates,re);else if(Ie==="MultiPolygon")for(ve=0;ve<ie.coordinates.length;ve++)oe(ie.coordinates[ve],re);return ie});let Ne=i.VectorTileFeature.prototype.toGeoJSON;var ct={exports:{}},bt=i.pointGeometry,Ut=i.vectorTile.VectorTileFeature,Qt=_i;function _i(be,ie){this.options=ie||{},this.features=be,this.length=be.length}function Gn(be,ie){this.id=typeof be.id=="number"?be.id:void 0,this.type=be.type,this.rawGeometry=be.type===1?[be.geometry]:be.geometry,this.properties=be.tags,this.extent=ie||4096}_i.prototype.feature=function(be){return new Gn(this.features[be],this.options.extent)},Gn.prototype.loadGeometry=function(){var be=this.rawGeometry;this.geometry=[];for(var ie=0;ie<be.length;ie++){for(var re=be[ie],ve=[],Ie=0;Ie<re.length;Ie++)ve.push(new bt(re[Ie][0],re[Ie][1]));this.geometry.push(ve)}return this.geometry},Gn.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var be=this.geometry,ie=1/0,re=-1/0,ve=1/0,Ie=-1/0,Pe=0;Pe<be.length;Pe++)for(var $e=be[Pe],Ve=0;Ve<$e.length;Ve++){var Oe=$e[Ve];ie=Math.min(ie,Oe.x),re=Math.max(re,Oe.x),ve=Math.min(ve,Oe.y),Ie=Math.max(Ie,Oe.y)}return[ie,ve,re,Ie]},Gn.prototype.toGeoJSON=Ut.prototype.toGeoJSON;var Ro=i.pbf,lt=Qt;function _o(be){var ie=new Ro;return function(re,ve){for(var Ie in re.layers)ve.writeMessage(3,It,re.layers[Ie])}(be,ie),ie.finish()}function It(be,ie){var re;ie.writeVarintField(15,be.version||1),ie.writeStringField(1,be.name||""),ie.writeVarintField(5,be.extent||4096);var ve={keys:[],values:[],keycache:{},valuecache:{}};for(re=0;re<be.length;re++)ve.feature=be.feature(re),ie.writeMessage(2,qs,ve);var Ie=ve.keys;for(re=0;re<Ie.length;re++)ie.writeStringField(3,Ie[re]);var Pe=ve.values;for(re=0;re<Pe.length;re++)ie.writeMessage(4,Zs,Pe[re])}function qs(be,ie){var re=be.feature;re.id!==void 0&&ie.writeVarintField(1,re.id),ie.writeMessage(2,Ja,be),ie.writeVarintField(3,re.type),ie.writeMessage(4,ec,re)}function Ja(be,ie){var re=be.feature,ve=be.keys,Ie=be.values,Pe=be.keycache,$e=be.valuecache;for(var Ve in re.properties){var Oe=re.properties[Ve],Xe=Pe[Ve];if(Oe!==null){Xe===void 0&&(ve.push(Ve),Pe[Ve]=Xe=ve.length-1),ie.writeVarint(Xe);var Ct=typeof Oe;Ct!=="string"&&Ct!=="boolean"&&Ct!=="number"&&(Oe=JSON.stringify(Oe));var Tt=Ct+":"+Oe,yt=$e[Tt];yt===void 0&&(Ie.push(Oe),$e[Tt]=yt=Ie.length-1),ie.writeVarint(yt)}}}function Pn(be,ie){return(ie<<3)+(7&be)}function tr(be){return be<<1^be>>31}function ec(be,ie){for(var re=be.loadGeometry(),ve=be.type,Ie=0,Pe=0,$e=re.length,Ve=0;Ve<$e;Ve++){var Oe=re[Ve],Xe=1;ve===1&&(Xe=Oe.length),ie.writeVarint(Pn(1,Xe));for(var Ct=ve===3?Oe.length-1:Oe.length,Tt=0;Tt<Ct;Tt++){Tt===1&&ve!==1&&ie.writeVarint(Pn(2,Ct-1));var yt=Oe[Tt].x-Ie,cn=Oe[Tt].y-Pe;ie.writeVarint(tr(yt)),ie.writeVarint(tr(cn)),Ie+=yt,Pe+=cn}ve===3&&ie.writeVarint(Pn(7,1))}}function Zs(be,ie){var re=typeof be;re==="string"?ie.writeStringField(1,be):re==="boolean"?ie.writeBooleanField(7,be):re==="number"&&(be%1!=0?ie.writeDoubleField(3,be):be<0?ie.writeSVarintField(6,be):ie.writeVarintField(5,be))}ct.exports=_o,ct.exports.fromVectorTileJs=_o,ct.exports.fromGeojsonVt=function(be,ie){ie=ie||{};var re={};for(var ve in be)re[ve]=new lt(be[ve].features,ie),re[ve].name=ve,re[ve].version=ie.version,re[ve].extent=ie.extent;return _o({layers:re})},ct.exports.GeoJSONWrapper=lt;var el=i.getDefaultExportFromCjs(ct.exports);let eu={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:be=>be},Tn=Math.fround||(Yo=new Float32Array(1),be=>(Yo[0]=+be,Yo[0]));var Yo;let gr=3,wr=5,vo=6;class Bi{constructor(ie){this.options=Object.assign(Object.create(eu),ie),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(ie){let{log:re,minZoom:ve,maxZoom:Ie}=this.options;re&&console.time("total time");let Pe=`prepare ${ie.length} points`;re&&console.time(Pe),this.points=ie;let $e=[];for(let Oe=0;Oe<ie.length;Oe++){let Xe=ie[Oe];if(!Xe.geometry)continue;let[Ct,Tt]=Xe.geometry.coordinates,yt=Tn(Xs(Ct)),cn=Tn(Ys(Tt));$e.push(yt,cn,1/0,Oe,-1,1),this.options.reduce&&$e.push(0)}let Ve=this.trees[Ie+1]=this._createTree($e);re&&console.timeEnd(Pe);for(let Oe=Ie;Oe>=ve;Oe--){let Xe=+Date.now();Ve=this.trees[Oe]=this._createTree(this._cluster(Ve,Oe)),re&&console.log("z%d: %d clusters in %dms",Oe,Ve.numItems,+Date.now()-Xe)}return re&&console.timeEnd("total time"),this}getClusters(ie,re){let ve=((ie[0]+180)%360+360)%360-180,Ie=Math.max(-90,Math.min(90,ie[1])),Pe=ie[2]===180?180:((ie[2]+180)%360+360)%360-180,$e=Math.max(-90,Math.min(90,ie[3]));if(ie[2]-ie[0]>=360)ve=-180,Pe=180;else if(ve>Pe){let Tt=this.getClusters([ve,Ie,180,$e],re),yt=this.getClusters([-180,Ie,Pe,$e],re);return Tt.concat(yt)}let Ve=this.trees[this._limitZoom(re)],Oe=Ve.range(Xs(ve),Ys($e),Xs(Pe),Ys(Ie)),Xe=Ve.data,Ct=[];for(let Tt of Oe){let yt=this.stride*Tt;Ct.push(Xe[yt+wr]>1?ms(Xe,yt,this.clusterProps):this.points[Xe[yt+gr]])}return Ct}getChildren(ie){let re=this._getOriginId(ie),ve=this._getOriginZoom(ie),Ie="No cluster with the specified id.",Pe=this.trees[ve];if(!Pe)throw new Error(Ie);let $e=Pe.data;if(re*this.stride>=$e.length)throw new Error(Ie);let Ve=this.options.radius/(this.options.extent*Math.pow(2,ve-1)),Oe=Pe.within($e[re*this.stride],$e[re*this.stride+1],Ve),Xe=[];for(let Ct of Oe){let Tt=Ct*this.stride;$e[Tt+4]===ie&&Xe.push($e[Tt+wr]>1?ms($e,Tt,this.clusterProps):this.points[$e[Tt+gr]])}if(Xe.length===0)throw new Error(Ie);return Xe}getLeaves(ie,re,ve){let Ie=[];return this._appendLeaves(Ie,ie,re=re||10,ve=ve||0,0),Ie}getTile(ie,re,ve){let Ie=this.trees[this._limitZoom(ie)],Pe=Math.pow(2,ie),{extent:$e,radius:Ve}=this.options,Oe=Ve/$e,Xe=(ve-Oe)/Pe,Ct=(ve+1+Oe)/Pe,Tt={features:[]};return this._addTileFeatures(Ie.range((re-Oe)/Pe,Xe,(re+1+Oe)/Pe,Ct),Ie.data,re,ve,Pe,Tt),re===0&&this._addTileFeatures(Ie.range(1-Oe/Pe,Xe,1,Ct),Ie.data,Pe,ve,Pe,Tt),re===Pe-1&&this._addTileFeatures(Ie.range(0,Xe,Oe/Pe,Ct),Ie.data,-1,ve,Pe,Tt),Tt.features.length?Tt:null}getClusterExpansionZoom(ie){let re=this._getOriginZoom(ie)-1;for(;re<=this.options.maxZoom;){let ve=this.getChildren(ie);if(re++,ve.length!==1)break;ie=ve[0].properties.cluster_id}return re}_appendLeaves(ie,re,ve,Ie,Pe){let $e=this.getChildren(re);for(let Ve of $e){let Oe=Ve.properties;if(Oe&&Oe.cluster?Pe+Oe.point_count<=Ie?Pe+=Oe.point_count:Pe=this._appendLeaves(ie,Oe.cluster_id,ve,Ie,Pe):Pe<Ie?Pe++:ie.push(Ve),ie.length===ve)break}return Pe}_createTree(ie){let re=new i.KDBush(ie.length/this.stride|0,this.options.nodeSize,Float32Array);for(let ve=0;ve<ie.length;ve+=this.stride)re.add(ie[ve],ie[ve+1]);return re.finish(),re.data=ie,re}_addTileFeatures(ie,re,ve,Ie,Pe,$e){for(let Ve of ie){let Oe=Ve*this.stride,Xe=re[Oe+wr]>1,Ct,Tt,yt;if(Xe)Ct=tl(re,Oe,this.clusterProps),Tt=re[Oe],yt=re[Oe+1];else{let dn=this.points[re[Oe+gr]];Ct=dn.properties;let[vn,On]=dn.geometry.coordinates;Tt=Xs(vn),yt=Ys(On)}let cn={type:1,geometry:[[Math.round(this.options.extent*(Tt*Pe-ve)),Math.round(this.options.extent*(yt*Pe-Ie))]],tags:Ct},In;In=Xe||this.options.generateId?re[Oe+gr]:this.points[re[Oe+gr]].id,In!==void 0&&(cn.id=In),$e.features.push(cn)}}_limitZoom(ie){return Math.max(this.options.minZoom,Math.min(Math.floor(+ie),this.options.maxZoom+1))}_cluster(ie,re){let{radius:ve,extent:Ie,reduce:Pe,minPoints:$e}=this.options,Ve=ve/(Ie*Math.pow(2,re)),Oe=ie.data,Xe=[],Ct=this.stride;for(let Tt=0;Tt<Oe.length;Tt+=Ct){if(Oe[Tt+2]<=re)continue;Oe[Tt+2]=re;let yt=Oe[Tt],cn=Oe[Tt+1],In=ie.within(Oe[Tt],Oe[Tt+1],Ve),dn=Oe[Tt+wr],vn=dn;for(let On of In){let Ln=On*Ct;Oe[Ln+2]>re&&(vn+=Oe[Ln+wr])}if(vn>dn&&vn>=$e){let On,Ln=yt*dn,nr=cn*dn,Hr=-1,yr=((Tt/Ct|0)<<5)+(re+1)+this.points.length;for(let _s of In){let Ar=_s*Ct;if(Oe[Ar+2]<=re)continue;Oe[Ar+2]=re;let Gr=Oe[Ar+wr];Ln+=Oe[Ar]*Gr,nr+=Oe[Ar+1]*Gr,Oe[Ar+4]=yr,Pe&&(On||(On=this._map(Oe,Tt,!0),Hr=this.clusterProps.length,this.clusterProps.push(On)),Pe(On,this._map(Oe,Ar)))}Oe[Tt+4]=yr,Xe.push(Ln/vn,nr/vn,1/0,yr,-1,vn),Pe&&Xe.push(Hr)}else{for(let On=0;On<Ct;On++)Xe.push(Oe[Tt+On]);if(vn>1)for(let On of In){let Ln=On*Ct;if(!(Oe[Ln+2]<=re)){Oe[Ln+2]=re;for(let nr=0;nr<Ct;nr++)Xe.push(Oe[Ln+nr])}}}}return Xe}_getOriginId(ie){return ie-this.points.length>>5}_getOriginZoom(ie){return(ie-this.points.length)%32}_map(ie,re,ve){if(ie[re+wr]>1){let $e=this.clusterProps[ie[re+vo]];return ve?Object.assign({},$e):$e}let Ie=this.points[ie[re+gr]].properties,Pe=this.options.map(Ie);return ve&&Pe===Ie?Object.assign({},Pe):Pe}}function ms(be,ie,re){return{type:"Feature",id:be[ie+gr],properties:tl(be,ie,re),geometry:{type:"Point",coordinates:[(ve=be[ie],360*(ve-.5)),gs(be[ie+1])]}};var ve}function tl(be,ie,re){let ve=be[ie+wr],Ie=ve>=1e4?`${Math.round(ve/1e3)}k`:ve>=1e3?Math.round(ve/100)/10+"k":ve,Pe=be[ie+vo],$e=Pe===-1?{}:Object.assign({},re[Pe]);return Object.assign($e,{cluster:!0,cluster_id:be[ie+gr],point_count:ve,point_count_abbreviated:Ie})}function Xs(be){return be/360+.5}function Ys(be){let ie=Math.sin(be*Math.PI/180),re=.5-.25*Math.log((1+ie)/(1-ie))/Math.PI;return re<0?0:re>1?1:re}function gs(be){let ie=(180-360*be)*Math.PI/180;return 360*Math.atan(Math.exp(ie))/Math.PI-90}function Ma(be,ie,re,ve){for(var Ie,Pe=ve,$e=re-ie>>1,Ve=re-ie,Oe=be[ie],Xe=be[ie+1],Ct=be[re],Tt=be[re+1],yt=ie+3;yt<re;yt+=3){var cn=nl(be[yt],be[yt+1],Oe,Xe,Ct,Tt);if(cn>Pe)Ie=yt,Pe=cn;else if(cn===Pe){var In=Math.abs(yt-$e);In<Ve&&(Ie=yt,Ve=In)}}Pe>ve&&(Ie-ie>3&&Ma(be,ie,Ie,ve),be[Ie+2]=Pe,re-Ie>3&&Ma(be,Ie,re,ve))}function nl(be,ie,re,ve,Ie,Pe){var $e=Ie-re,Ve=Pe-ve;if($e!==0||Ve!==0){var Oe=((be-re)*$e+(ie-ve)*Ve)/($e*$e+Ve*Ve);Oe>1?(re=Ie,ve=Pe):Oe>0&&(re+=$e*Oe,ve+=Ve*Oe)}return($e=be-re)*$e+(Ve=ie-ve)*Ve}function jn(be,ie,re,ve){var Ie={id:be===void 0?null:be,type:ie,geometry:re,tags:ve,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(Pe){var $e=Pe.geometry,Ve=Pe.type;if(Ve==="Point"||Ve==="MultiPoint"||Ve==="LineString")Zt(Pe,$e);else if(Ve==="Polygon"||Ve==="MultiLineString")for(var Oe=0;Oe<$e.length;Oe++)Zt(Pe,$e[Oe]);else if(Ve==="MultiPolygon")for(Oe=0;Oe<$e.length;Oe++)for(var Xe=0;Xe<$e[Oe].length;Xe++)Zt(Pe,$e[Oe][Xe])}(Ie),Ie}function Zt(be,ie){for(var re=0;re<ie.length;re+=3)be.minX=Math.min(be.minX,ie[re]),be.minY=Math.min(be.minY,ie[re+1]),be.maxX=Math.max(be.maxX,ie[re]),be.maxY=Math.max(be.maxY,ie[re+1])}function bo(be,ie,re,ve){if(ie.geometry){var Ie=ie.geometry.coordinates,Pe=ie.geometry.type,$e=Math.pow(re.tolerance/((1<<re.maxZoom)*re.extent),2),Ve=[],Oe=ie.id;if(re.promoteId?Oe=ie.properties[re.promoteId]:re.generateId&&(Oe=ve||0),Pe==="Point")Ta(Ie,Ve);else if(Pe==="MultiPoint")for(var Xe=0;Xe<Ie.length;Xe++)Ta(Ie[Xe],Ve);else if(Pe==="LineString")vi(Ie,Ve,$e,!1);else if(Pe==="MultiLineString"){if(re.lineMetrics){for(Xe=0;Xe<Ie.length;Xe++)vi(Ie[Xe],Ve=[],$e,!1),be.push(jn(Oe,"LineString",Ve,ie.properties));return}xo(Ie,Ve,$e,!1)}else if(Pe==="Polygon")xo(Ie,Ve,$e,!0);else{if(Pe!=="MultiPolygon"){if(Pe==="GeometryCollection"){for(Xe=0;Xe<ie.geometry.geometries.length;Xe++)bo(be,{id:Oe,geometry:ie.geometry.geometries[Xe],properties:ie.properties},re,ve);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Xe=0;Xe<Ie.length;Xe++){var Ct=[];xo(Ie[Xe],Ct,$e,!0),Ve.push(Ct)}}be.push(jn(Oe,Pe,Ve,ie.properties))}}function Ta(be,ie){ie.push(il(be[0])),ie.push(ys(be[1])),ie.push(0)}function vi(be,ie,re,ve){for(var Ie,Pe,$e=0,Ve=0;Ve<be.length;Ve++){var Oe=il(be[Ve][0]),Xe=ys(be[Ve][1]);ie.push(Oe),ie.push(Xe),ie.push(0),Ve>0&&($e+=ve?(Ie*Xe-Oe*Pe)/2:Math.sqrt(Math.pow(Oe-Ie,2)+Math.pow(Xe-Pe,2))),Ie=Oe,Pe=Xe}var Ct=ie.length-3;ie[2]=1,Ma(ie,0,Ct,re),ie[Ct+2]=1,ie.size=Math.abs($e),ie.start=0,ie.end=ie.size}function xo(be,ie,re,ve){for(var Ie=0;Ie<be.length;Ie++){var Pe=[];vi(be[Ie],Pe,re,ve),ie.push(Pe)}}function il(be){return be/360+.5}function ys(be){var ie=Math.sin(be*Math.PI/180),re=.5-.25*Math.log((1+ie)/(1-ie))/Math.PI;return re<0?0:re>1?1:re}function to(be,ie,re,ve,Ie,Pe,$e,Ve){if(ve/=ie,Pe>=(re/=ie)&&$e<ve)return be;if($e<re||Pe>=ve)return null;for(var Oe=[],Xe=0;Xe<be.length;Xe++){var Ct=be[Xe],Tt=Ct.geometry,yt=Ct.type,cn=Ie===0?Ct.minX:Ct.minY,In=Ie===0?Ct.maxX:Ct.maxY;if(cn>=re&&In<ve)Oe.push(Ct);else if(!(In<re||cn>=ve)){var dn=[];if(yt==="Point"||yt==="MultiPoint")Ks(Tt,dn,re,ve,Ie);else if(yt==="LineString")tc(Tt,dn,re,ve,Ie,!1,Ve.lineMetrics);else if(yt==="MultiLineString")no(Tt,dn,re,ve,Ie,!1);else if(yt==="Polygon")no(Tt,dn,re,ve,Ie,!0);else if(yt==="MultiPolygon")for(var vn=0;vn<Tt.length;vn++){var On=[];no(Tt[vn],On,re,ve,Ie,!0),On.length&&dn.push(On)}if(dn.length){if(Ve.lineMetrics&&yt==="LineString"){for(vn=0;vn<dn.length;vn++)Oe.push(jn(Ct.id,yt,dn[vn],Ct.tags));continue}yt!=="LineString"&&yt!=="MultiLineString"||(dn.length===1?(yt="LineString",dn=dn[0]):yt="MultiLineString"),yt!=="Point"&&yt!=="MultiPoint"||(yt=dn.length===3?"Point":"MultiPoint"),Oe.push(jn(Ct.id,yt,dn,Ct.tags))}}}return Oe.length?Oe:null}function Ks(be,ie,re,ve,Ie){for(var Pe=0;Pe<be.length;Pe+=3){var $e=be[Pe+Ie];$e>=re&&$e<=ve&&(ie.push(be[Pe]),ie.push(be[Pe+1]),ie.push(be[Pe+2]))}}function tc(be,ie,re,ve,Ie,Pe,$e){for(var Ve,Oe,Xe=tu(be),Ct=Ie===0?Mi:gd,Tt=be.start,yt=0;yt<be.length-3;yt+=3){var cn=be[yt],In=be[yt+1],dn=be[yt+2],vn=be[yt+3],On=be[yt+4],Ln=Ie===0?cn:In,nr=Ie===0?vn:On,Hr=!1;$e&&(Ve=Math.sqrt(Math.pow(cn-vn,2)+Math.pow(In-On,2))),Ln<re?nr>re&&(Oe=Ct(Xe,cn,In,vn,On,re),$e&&(Xe.start=Tt+Ve*Oe)):Ln>ve?nr<ve&&(Oe=Ct(Xe,cn,In,vn,On,ve),$e&&(Xe.start=Tt+Ve*Oe)):nc(Xe,cn,In,dn),nr<re&&Ln>=re&&(Oe=Ct(Xe,cn,In,vn,On,re),Hr=!0),nr>ve&&Ln<=ve&&(Oe=Ct(Xe,cn,In,vn,On,ve),Hr=!0),!Pe&&Hr&&($e&&(Xe.end=Tt+Ve*Oe),ie.push(Xe),Xe=tu(be)),$e&&(Tt+=Ve)}var yr=be.length-3;cn=be[yr],In=be[yr+1],dn=be[yr+2],(Ln=Ie===0?cn:In)>=re&&Ln<=ve&&nc(Xe,cn,In,dn),yr=Xe.length-3,Pe&&yr>=3&&(Xe[yr]!==Xe[0]||Xe[yr+1]!==Xe[1])&&nc(Xe,Xe[0],Xe[1],Xe[2]),Xe.length&&ie.push(Xe)}function tu(be){var ie=[];return ie.size=be.size,ie.start=be.start,ie.end=be.end,ie}function no(be,ie,re,ve,Ie,Pe){for(var $e=0;$e<be.length;$e++)tc(be[$e],ie,re,ve,Ie,Pe,!1)}function nc(be,ie,re,ve){be.push(ie),be.push(re),be.push(ve)}function Mi(be,ie,re,ve,Ie,Pe){var $e=(Pe-ie)/(ve-ie);return be.push(Pe),be.push(re+(Ie-re)*$e),be.push(1),$e}function gd(be,ie,re,ve,Ie,Pe){var $e=(Pe-re)/(Ie-re);return be.push(ie+(ve-ie)*$e),be.push(Pe),be.push(1),$e}function Po(be,ie){for(var re=[],ve=0;ve<be.length;ve++){var Ie,Pe=be[ve],$e=Pe.type;if($e==="Point"||$e==="MultiPoint"||$e==="LineString")Ie=Ia(Pe.geometry,ie);else if($e==="MultiLineString"||$e==="Polygon"){Ie=[];for(var Ve=0;Ve<Pe.geometry.length;Ve++)Ie.push(Ia(Pe.geometry[Ve],ie))}else if($e==="MultiPolygon")for(Ie=[],Ve=0;Ve<Pe.geometry.length;Ve++){for(var Oe=[],Xe=0;Xe<Pe.geometry[Ve].length;Xe++)Oe.push(Ia(Pe.geometry[Ve][Xe],ie));Ie.push(Oe)}re.push(jn(Pe.id,$e,Ie,Pe.tags))}return re}function Ia(be,ie){var re=[];re.size=be.size,be.start!==void 0&&(re.start=be.start,re.end=be.end);for(var ve=0;ve<be.length;ve+=3)re.push(be[ve]+ie,be[ve+1],be[ve+2]);return re}function ic(be,ie){if(be.transformed)return be;var re,ve,Ie,Pe=1<<be.z,$e=be.x,Ve=be.y;for(re=0;re<be.features.length;re++){var Oe=be.features[re],Xe=Oe.geometry,Ct=Oe.type;if(Oe.geometry=[],Ct===1)for(ve=0;ve<Xe.length;ve+=2)Oe.geometry.push(Qs(Xe[ve],Xe[ve+1],ie,Pe,$e,Ve));else for(ve=0;ve<Xe.length;ve++){var Tt=[];for(Ie=0;Ie<Xe[ve].length;Ie+=2)Tt.push(Qs(Xe[ve][Ie],Xe[ve][Ie+1],ie,Pe,$e,Ve));Oe.geometry.push(Tt)}}return be.transformed=!0,be}function Qs(be,ie,re,ve,Ie,Pe){return[Math.round(re*(be*ve-Ie)),Math.round(re*(ie*ve-Pe))]}function rc(be,ie,re,ve,Ie){for(var Pe=ie===Ie.maxZoom?0:Ie.tolerance/((1<<ie)*Ie.extent),$e={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:re,y:ve,z:ie,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Ve=0;Ve<be.length;Ve++){$e.numFeatures++,nu($e,be[Ve],Pe,Ie);var Oe=be[Ve].minX,Xe=be[Ve].minY,Ct=be[Ve].maxX,Tt=be[Ve].maxY;Oe<$e.minX&&($e.minX=Oe),Xe<$e.minY&&($e.minY=Xe),Ct>$e.maxX&&($e.maxX=Ct),Tt>$e.maxY&&($e.maxY=Tt)}return $e}function nu(be,ie,re,ve){var Ie=ie.geometry,Pe=ie.type,$e=[];if(Pe==="Point"||Pe==="MultiPoint")for(var Ve=0;Ve<Ie.length;Ve+=3)$e.push(Ie[Ve]),$e.push(Ie[Ve+1]),be.numPoints++,be.numSimplified++;else if(Pe==="LineString")rl($e,Ie,be,re,!1,!1);else if(Pe==="MultiLineString"||Pe==="Polygon")for(Ve=0;Ve<Ie.length;Ve++)rl($e,Ie[Ve],be,re,Pe==="Polygon",Ve===0);else if(Pe==="MultiPolygon")for(var Oe=0;Oe<Ie.length;Oe++){var Xe=Ie[Oe];for(Ve=0;Ve<Xe.length;Ve++)rl($e,Xe[Ve],be,re,!0,Ve===0)}if($e.length){var Ct=ie.tags||null;if(Pe==="LineString"&&ve.lineMetrics){for(var Tt in Ct={},ie.tags)Ct[Tt]=ie.tags[Tt];Ct.mapbox_clip_start=Ie.start/Ie.size,Ct.mapbox_clip_end=Ie.end/Ie.size}var yt={geometry:$e,type:Pe==="Polygon"||Pe==="MultiPolygon"?3:Pe==="LineString"||Pe==="MultiLineString"?2:1,tags:Ct};ie.id!==null&&(yt.id=ie.id),be.features.push(yt)}}function rl(be,ie,re,ve,Ie,Pe){var $e=ve*ve;if(ve>0&&ie.size<(Ie?$e:ve))re.numPoints+=ie.length/3;else{for(var Ve=[],Oe=0;Oe<ie.length;Oe+=3)(ve===0||ie[Oe+2]>$e)&&(re.numSimplified++,Ve.push(ie[Oe]),Ve.push(ie[Oe+1])),re.numPoints++;Ie&&function(Xe,Ct){for(var Tt=0,yt=0,cn=Xe.length,In=cn-2;yt<cn;In=yt,yt+=2)Tt+=(Xe[yt]-Xe[In])*(Xe[yt+1]+Xe[In+1]);if(Tt>0===Ct)for(yt=0,cn=Xe.length;yt<cn/2;yt+=2){var dn=Xe[yt],vn=Xe[yt+1];Xe[yt]=Xe[cn-2-yt],Xe[yt+1]=Xe[cn-1-yt],Xe[cn-2-yt]=dn,Xe[cn-1-yt]=vn}}(Ve,Pe),be.push(Ve)}}function wo(be,ie){var re=(ie=this.options=function(Ie,Pe){for(var $e in Pe)Ie[$e]=Pe[$e];return Ie}(Object.create(this.options),ie)).debug;if(re&&console.time("preprocess data"),ie.maxZoom<0||ie.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(ie.promoteId&&ie.generateId)throw new Error("promoteId and generateId cannot be used together.");var ve=function(Ie,Pe){var $e=[];if(Ie.type==="FeatureCollection")for(var Ve=0;Ve<Ie.features.length;Ve++)bo($e,Ie.features[Ve],Pe,Ve);else bo($e,Ie.type==="Feature"?Ie:{geometry:Ie},Pe);return $e}(be,ie);this.tiles={},this.tileCoords=[],re&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",ie.indexMaxZoom,ie.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),ve=function(Ie,Pe){var $e=Pe.buffer/Pe.extent,Ve=Ie,Oe=to(Ie,1,-1-$e,$e,0,-1,2,Pe),Xe=to(Ie,1,1-$e,2+$e,0,-1,2,Pe);return(Oe||Xe)&&(Ve=to(Ie,1,-$e,1+$e,0,-1,2,Pe)||[],Oe&&(Ve=Po(Oe,1).concat(Ve)),Xe&&(Ve=Ve.concat(Po(Xe,-1)))),Ve}(ve,ie),ve.length&&this.splitTile(ve,0,0,0),re&&(ve.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Js(be,ie,re){return 32*((1<<be)*re+ie)+be}function Sr(be,ie){let re=be.tileID.canonical;if(!this._geoJSONIndex)return ie(null,null);let ve=this._geoJSONIndex.getTile(re.z,re.x,re.y);if(!ve)return ie(null,null);let Ie=new class{constructor($e){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=i.EXTENT,this.length=$e.length,this._features=$e}feature($e){return new class{constructor(Ve){this._feature=Ve,this.extent=i.EXTENT,this.type=Ve.type,this.properties=Ve.tags,"id"in Ve&&!isNaN(Ve.id)&&(this.id=parseInt(Ve.id,10))}loadGeometry(){if(this._feature.type===1){let Ve=[];for(let Oe of this._feature.geometry)Ve.push([new i.Point(Oe[0],Oe[1])]);return Ve}{let Ve=[];for(let Oe of this._feature.geometry){let Xe=[];for(let Ct of Oe)Xe.push(new i.Point(Ct[0],Ct[1]));Ve.push(Xe)}return Ve}}toGeoJSON(Ve,Oe,Xe){return Ne.call(this,Ve,Oe,Xe)}}(this._features[$e])}}(ve.features),Pe=el(Ie);Pe.byteOffset===0&&Pe.byteLength===Pe.buffer.byteLength||(Pe=new Uint8Array(Pe)),ie(null,{vectorTile:Ie,rawData:Pe.buffer})}wo.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},wo.prototype.splitTile=function(be,ie,re,ve,Ie,Pe,$e){for(var Ve=[be,ie,re,ve],Oe=this.options,Xe=Oe.debug;Ve.length;){ve=Ve.pop(),re=Ve.pop(),ie=Ve.pop(),be=Ve.pop();var Ct=1<<ie,Tt=Js(ie,re,ve),yt=this.tiles[Tt];if(!yt&&(Xe>1&&console.time("creation"),yt=this.tiles[Tt]=rc(be,ie,re,ve,Oe),this.tileCoords.push({z:ie,x:re,y:ve}),Xe)){Xe>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",ie,re,ve,yt.numFeatures,yt.numPoints,yt.numSimplified),console.timeEnd("creation"));var cn="z"+ie;this.stats[cn]=(this.stats[cn]||0)+1,this.total++}if(yt.source=be,Ie){if(ie===Oe.maxZoom||ie===Ie)continue;var In=1<<Ie-ie;if(re!==Math.floor(Pe/In)||ve!==Math.floor($e/In))continue}else if(ie===Oe.indexMaxZoom||yt.numPoints<=Oe.indexMaxPoints)continue;if(yt.source=null,be.length!==0){Xe>1&&console.time("clipping");var dn,vn,On,Ln,nr,Hr,yr=.5*Oe.buffer/Oe.extent,_s=.5-yr,Ar=.5+yr,Gr=1+yr;dn=vn=On=Ln=null,nr=to(be,Ct,re-yr,re+Ar,0,yt.minX,yt.maxX,Oe),Hr=to(be,Ct,re+_s,re+Gr,0,yt.minX,yt.maxX,Oe),be=null,nr&&(dn=to(nr,Ct,ve-yr,ve+Ar,1,yt.minY,yt.maxY,Oe),vn=to(nr,Ct,ve+_s,ve+Gr,1,yt.minY,yt.maxY,Oe),nr=null),Hr&&(On=to(Hr,Ct,ve-yr,ve+Ar,1,yt.minY,yt.maxY,Oe),Ln=to(Hr,Ct,ve+_s,ve+Gr,1,yt.minY,yt.maxY,Oe),Hr=null),Xe>1&&console.timeEnd("clipping"),Ve.push(dn||[],ie+1,2*re,2*ve),Ve.push(vn||[],ie+1,2*re,2*ve+1),Ve.push(On||[],ie+1,2*re+1,2*ve),Ve.push(Ln||[],ie+1,2*re+1,2*ve+1)}}},wo.prototype.getTile=function(be,ie,re){var ve=this.options,Ie=ve.extent,Pe=ve.debug;if(be<0||be>24)return null;var $e=1<<be,Ve=Js(be,ie=(ie%$e+$e)%$e,re);if(this.tiles[Ve])return ic(this.tiles[Ve],Ie);Pe>1&&console.log("drilling down to z%d-%d-%d",be,ie,re);for(var Oe,Xe=be,Ct=ie,Tt=re;!Oe&&Xe>0;)Xe--,Ct=Math.floor(Ct/2),Tt=Math.floor(Tt/2),Oe=this.tiles[Js(Xe,Ct,Tt)];return Oe&&Oe.source?(Pe>1&&console.log("found parent tile z%d-%d-%d",Xe,Ct,Tt),Pe>1&&console.time("drilling down"),this.splitTile(Oe.source,Xe,Ct,Tt,be,ie,re),Pe>1&&console.timeEnd("drilling down"),this.tiles[Ve]?ic(this.tiles[Ve],Ie):null):null};class ea extends i.VectorTileWorkerSource{constructor(ie,re,ve,Ie,Pe){super(ie,re,ve,Ie,Sr),Pe&&(this.loadGeoJSON=Pe)}loadData(ie,re){let ve=ie&&ie.request,Ie=ve&&ve.collectResourceTiming;this.loadGeoJSON(ie,(Pe,$e)=>{if(Pe||!$e)return re(Pe);if(typeof $e!="object")return re(new Error(`Input data given to '${ie.source}' is not a valid GeoJSON object.`));{Ye($e,!0);try{if(ie.filter){let Oe=i.createExpression(ie.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Oe.result==="error")throw new Error(Oe.value.map(Ct=>`${Ct.key}: ${Ct.message}`).join(", "));$e={type:"FeatureCollection",features:$e.features.filter(Ct=>Oe.value.evaluate({zoom:0},Ct))}}this._geoJSONIndex=ie.cluster?new Bi(function({superclusterOptions:Oe,clusterProperties:Xe}){if(!Xe||!Oe)return Oe;let Ct={},Tt={},yt={accumulated:null,zoom:0},cn={properties:null},In=Object.keys(Xe);for(let dn of In){let[vn,On]=Xe[dn],Ln=i.createExpression(On),nr=i.createExpression(typeof vn=="string"?[vn,["accumulated"],["get",dn]]:vn);Ct[dn]=Ln.value,Tt[dn]=nr.value}return Oe.map=dn=>{cn.properties=dn;let vn={};for(let On of In)vn[On]=Ct[On].evaluate(yt,cn);return vn},Oe.reduce=(dn,vn)=>{cn.properties=vn;for(let On of In)yt.accumulated=dn[On],dn[On]=Tt[On].evaluate(yt,cn)},Oe}(ie)).load($e.features):function(Oe,Xe){return new wo(Oe,Xe)}($e,ie.geojsonVtOptions)}catch(Oe){return re(Oe)}this.loaded={};let Ve={};if(Ie){let Oe=i.getPerformanceMeasurement(ve);Oe&&(Ve.resourceTiming={},Ve.resourceTiming[ie.source]=JSON.parse(JSON.stringify(Oe)))}re(null,Ve)}})}reloadTile(ie,re){let ve=this.loaded;return ve&&ve[ie.uid]?super.reloadTile(ie,re):this.loadTile(ie,re)}loadGeoJSON(ie,re){if(ie.request)i.getJSON(ie.request,re);else{if(typeof ie.data!="string")return re(new Error(`Input data given to '${ie.source}' is not a valid GeoJSON object.`));try{return re(null,JSON.parse(ie.data))}catch{return re(new Error(`Input data given to '${ie.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(ie,re){try{re(null,this._geoJSONIndex.getClusterExpansionZoom(ie.clusterId))}catch(ve){re(ve)}}getClusterChildren(ie,re){try{re(null,this._geoJSONIndex.getChildren(ie.clusterId))}catch(ve){re(ve)}}getClusterLeaves(ie,re){try{re(null,this._geoJSONIndex.getLeaves(ie.clusterId,ie.limit,ie.offset))}catch(ve){re(ve)}}}class yd{constructor(ie){this.self=ie,this.actor=new i.Actor(ie,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=i.getProjection({name:"mercator"}),this.workerSourceTypes={vector:i.VectorTileWorkerSource,geojson:ea},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(re,ve)=>{if(this.workerSourceTypes[re])throw new Error(`Worker source with name "${re}" already registered.`);this.workerSourceTypes[re]=ve},this.self.registerRTLTextPlugin=re=>{if(i.plugin.isParsed())throw new Error("RTL text plugin already registered.");i.plugin.applyArabicShaping=re.applyArabicShaping,i.plugin.processBidirectionalText=re.processBidirectionalText,i.plugin.processStyledBidirectionalText=re.processStyledBidirectionalText}}clearCaches(ie,re,ve){delete this.layerIndexes[ie],delete this.availableImages[ie],delete this.workerSources[ie],delete this.demWorkerSources[ie],ve()}checkIfReady(ie,re,ve){ve()}setReferrer(ie,re){this.referrer=re}spriteLoaded(ie,re){this.isSpriteLoaded[ie]=re;for(let ve in this.workerSources[ie]){let Ie=this.workerSources[ie][ve];for(let Pe in Ie)Ie[Pe]instanceof i.VectorTileWorkerSource&&(Ie[Pe].isSpriteLoaded=re,Ie[Pe].fire(new i.Event("isSpriteLoaded")))}}setImages(ie,re,ve){this.availableImages[ie]=re;for(let Ie in this.workerSources[ie]){let Pe=this.workerSources[ie][Ie];for(let $e in Pe)Pe[$e].availableImages=re}ve()}enableTerrain(ie,re,ve){this.terrain=re,ve()}setProjection(ie,re){this.projections[ie]=i.getProjection(re)}setLayers(ie,re,ve){this.getLayerIndex(ie).replace(re),ve()}updateLayers(ie,re,ve){this.getLayerIndex(ie).update(re.layers,re.removedIds),ve()}loadTile(ie,re,ve){let Ie=this.enableTerrain?i.extend({enableTerrain:this.terrain},re):re;Ie.projection=this.projections[ie]||this.defaultProjection,this.getWorkerSource(ie,re.type,re.source).loadTile(Ie,ve)}loadDEMTile(ie,re,ve){let Ie=this.enableTerrain?i.extend({buildQuadTree:this.terrain},re):re;this.getDEMWorkerSource(ie,re.source).loadTile(Ie,ve)}reloadTile(ie,re,ve){let Ie=this.enableTerrain?i.extend({enableTerrain:this.terrain},re):re;Ie.projection=this.projections[ie]||this.defaultProjection,this.getWorkerSource(ie,re.type,re.source).reloadTile(Ie,ve)}abortTile(ie,re,ve){this.getWorkerSource(ie,re.type,re.source).abortTile(re,ve)}removeTile(ie,re,ve){this.getWorkerSource(ie,re.type,re.source).removeTile(re,ve)}removeSource(ie,re,ve){if(!this.workerSources[ie]||!this.workerSources[ie][re.type]||!this.workerSources[ie][re.type][re.source])return;let Ie=this.workerSources[ie][re.type][re.source];delete this.workerSources[ie][re.type][re.source],Ie.removeSource!==void 0?Ie.removeSource(re,ve):ve()}loadWorkerSource(ie,re,ve){try{this.self.importScripts(re.url),ve()}catch(Ie){ve(Ie.toString())}}syncRTLPluginState(ie,re,ve){try{i.plugin.setState(re);let Ie=i.plugin.getPluginURL();if(i.plugin.isLoaded()&&!i.plugin.isParsed()&&Ie!=null){this.self.importScripts(Ie);let Pe=i.plugin.isParsed();ve(Pe?void 0:new Error(`RTL Text Plugin failed to import scripts from ${Ie}`),Pe)}}catch(Ie){ve(Ie.toString())}}getAvailableImages(ie){let re=this.availableImages[ie];return re||(re=[]),re}getLayerIndex(ie){let re=this.layerIndexes[ie];return re||(re=this.layerIndexes[ie]=new j),re}getWorkerSource(ie,re,ve){if(this.workerSources[ie]||(this.workerSources[ie]={}),this.workerSources[ie][re]||(this.workerSources[ie][re]={}),!this.workerSources[ie][re][ve]){let Ie={send:(Pe,$e,Ve,Oe,Xe,Ct)=>{this.actor.send(Pe,$e,Ve,ie,Xe,Ct)},scheduler:this.actor.scheduler};this.workerSources[ie][re][ve]=new this.workerSourceTypes[re](Ie,this.getLayerIndex(ie),this.getAvailableImages(ie),this.isSpriteLoaded[ie])}return this.workerSources[ie][re][ve]}getDEMWorkerSource(ie,re){return this.demWorkerSources[ie]||(this.demWorkerSources[ie]={}),this.demWorkerSources[ie][re]||(this.demWorkerSources[ie][re]=new Y),this.demWorkerSources[ie][re]}enforceCacheSizeLimit(ie,re){i.enforceCacheSizeLimit(re)}getWorkerPerformanceMetrics(ie,re,ve){ve(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new yd(self)),yd}),s(["./shared"],function(i){"use strict";function E(m,l){if(Array.isArray(m)){if(!Array.isArray(l)||m.length!==l.length)return!1;for(let h=0;h<m.length;h++)if(!E(m[h],l[h]))return!1;return!0}if(typeof m=="object"&&m!==null&&l!==null){if(typeof l!="object"||Object.keys(m).length!==Object.keys(l).length)return!1;for(let h in m)if(!E(m[h],l[h]))return!1;return!0}return m===l}var L=j;function j(m){return!function(l){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var _,x,D=new Blob([""],{type:"text/javascript"}),k=URL.createObjectURL(D);try{x=new Worker(k),_=!0}catch{_=!1}return x&&x.terminate(),URL.revokeObjectURL(k),_}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var _=document.createElement("canvas");_.width=_.height=1;var x=_.getContext("2d");if(!x)return!1;var D=x.getImageData(0,0,1,1);return D&&D.width===_.width}()?(Y[h=l&&l.failIfMajorPerformanceCaveat]===void 0&&(Y[h]=function(_){var x,D=function(k){var R=document.createElement("canvas"),z=Object.create(j.webGLContextAttributes);return z.failIfMajorPerformanceCaveat=k,R.getContext("webgl",z)||R.getContext("experimental-webgl",z)}(_);if(!D)return!1;try{x=D.createShader(D.VERTEX_SHADER)}catch{return!1}return!(!x||D.isContextLost())&&(D.shaderSource(x,"void main() {}"),D.compileShader(x),D.getShaderParameter(x,D.COMPILE_STATUS)===!0)}(h)),Y[h]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var h}(m)}var Y={};function oe(m,l,h){let _=i.window.document.createElement(m);return l!==void 0&&(_.className=l),h&&h.appendChild(_),_}function Ee(m,l,h){let _=i.window.document.createElementNS("http://www.w3.org/2000/svg",m);for(let x of Object.keys(l))_.setAttributeNS(null,x,l[x]);return h&&h.appendChild(_),_}j.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};let Ye=i.window.document&&i.window.document.documentElement.style,Ne=Ye&&Ye.userSelect!==void 0?"userSelect":"WebkitUserSelect",ct;function bt(){Ye&&Ne&&(ct=Ye[Ne],Ye[Ne]="none")}function Ut(){Ye&&Ne&&(Ye[Ne]=ct)}function Qt(m){m.preventDefault(),m.stopPropagation(),i.window.removeEventListener("click",Qt,!0)}function _i(){i.window.addEventListener("click",Qt,!0),i.window.setTimeout(()=>{i.window.removeEventListener("click",Qt,!0)},0)}function Gn(m,l){let h=m.getBoundingClientRect();return _o(m,h,l)}function Ro(m,l){let h=m.getBoundingClientRect(),_=[];for(let x=0;x<l.length;x++)_.push(_o(m,h,l[x]));return _}function lt(m){return i.window.InstallTrigger!==void 0&&m.button===2&&m.ctrlKey&&i.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:m.button}function _o(m,l,h){let _=m.offsetWidth===l.width?1:m.offsetWidth/l.width;return new i.Point((h.clientX-l.left)*_,(h.clientY-l.top)*_)}function It(m,l){var h=l[0],_=l[1],x=l[2],D=l[3],k=h*D-x*_;return k?(m[0]=D*(k=1/k),m[1]=-_*k,m[2]=-x*k,m[3]=h*k,m):null}function qs(m){let{userImage:l}=m;return!!(l&&l.render&&l.render())&&(m.data.replace(new Uint8Array(l.data.buffer)),!0)}class Ja extends i.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new i.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(l){if(this.loaded!==l&&(this.loaded=l,l)){for(let{ids:h,callback:_}of this.requestors)this._notify(h,_);this.requestors=[]}}hasImage(l){return!!this.getImage(l)}getImage(l){return this.images[l]}addImage(l,h){this._validate(l,h)&&(this.images[l]=h)}_validate(l,h){let _=!0;return this._validateStretch(h.stretchX,h.data&&h.data.width)||(this.fire(new i.ErrorEvent(new Error(`Image "${l}" has invalid "stretchX" value`))),_=!1),this._validateStretch(h.stretchY,h.data&&h.data.height)||(this.fire(new i.ErrorEvent(new Error(`Image "${l}" has invalid "stretchY" value`))),_=!1),this._validateContent(h.content,h)||(this.fire(new i.ErrorEvent(new Error(`Image "${l}" has invalid "content" value`))),_=!1),_}_validateStretch(l,h){if(!l)return!0;let _=0;for(let x of l){if(x[0]<_||x[1]<x[0]||h<x[1])return!1;_=x[1]}return!0}_validateContent(l,h){return!(l&&(l.length!==4||l[0]<0||h.data.width<l[0]||l[1]<0||h.data.height<l[1]||l[2]<0||h.data.width<l[2]||l[3]<0||h.data.height<l[3]||l[2]<l[0]||l[3]<l[1]))}updateImage(l,h){h.version=this.images[l].version+1,this.images[l]=h,this.updatedImages[l]=!0}removeImage(l){let h=this.images[l];delete this.images[l],delete this.patterns[l],h.userImage&&h.userImage.onRemove&&h.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(l,h){let _=!0;if(!this.isLoaded())for(let x of l)this.images[x]||(_=!1);this.isLoaded()||_?this._notify(l,h):this.requestors.push({ids:l,callback:h})}_notify(l,h){let _={};for(let x of l){this.images[x]||this.fire(new i.Event("styleimagemissing",{id:x}));let D=this.images[x];D?_[x]={data:D.data.clone(),pixelRatio:D.pixelRatio,sdf:D.sdf,version:D.version,stretchX:D.stretchX,stretchY:D.stretchY,content:D.content,hasRenderCallback:!!(D.userImage&&D.userImage.render)}:i.warnOnce(`Image "${x}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}h(null,_)}getPixelSize(){let{width:l,height:h}=this.atlasImage;return{width:l,height:h}}getPattern(l){let h=this.patterns[l],_=this.getImage(l);if(!_)return null;if(h&&h.position.version===_.version)return h.position;if(h)h.position.version=_.version;else{let x={w:_.data.width+2,h:_.data.height+2,x:0,y:0},D=new i.ImagePosition(x,_);this.patterns[l]={bin:x,position:D}}return this._updatePatternAtlas(),this.patterns[l].position}bind(l){let h=l.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new i.Texture(l,this.atlasImage,h.RGBA),this.atlasTexture&&this.atlasTexture.bind(h.LINEAR,h.CLAMP_TO_EDGE)}_updatePatternAtlas(){let l=[];for(let D in this.patterns)l.push(this.patterns[D].bin);let{w:h,h:_}=i.potpack(l),x=this.atlasImage;x.resize({width:h||1,height:_||1});for(let D in this.patterns){let{bin:k}=this.patterns[D],R=k.x+1,z=k.y+1,G=this.images[D].data,H=G.width,K=G.height;i.RGBAImage.copy(G,x,{x:0,y:0},{x:R,y:z},{width:H,height:K}),i.RGBAImage.copy(G,x,{x:0,y:K-1},{x:R,y:z-1},{width:H,height:1}),i.RGBAImage.copy(G,x,{x:0,y:0},{x:R,y:z+K},{width:H,height:1}),i.RGBAImage.copy(G,x,{x:H-1,y:0},{x:R-1,y:z},{width:1,height:K}),i.RGBAImage.copy(G,x,{x:0,y:0},{x:R+H,y:z},{width:1,height:K})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(l){for(let h of l){if(this.callbackDispatchedThisFrame[h])continue;this.callbackDispatchedThisFrame[h]=!0;let _=this.images[h];qs(_)&&this.updateImage(h,_)}}}let Pn=new i.Properties({anchor:new i.DataConstantProperty(i.spec.light.anchor),position:new class{constructor(){this.specification=i.spec.light.position}possiblyEvaluate(m,l){return function([h,_,x]){let D=i.degToRad(_+90),k=i.degToRad(x);return{x:h*Math.cos(D)*Math.sin(k),y:h*Math.sin(D)*Math.sin(k),z:h*Math.cos(k),azimuthal:_,polar:x}}(m.expression.evaluate(l))}interpolate(m,l,h){return{x:i.number(m.x,l.x,h),y:i.number(m.y,l.y,h),z:i.number(m.z,l.z,h),azimuthal:i.number(m.azimuthal,l.azimuthal,h),polar:i.number(m.polar,l.polar,h)}}},color:new i.DataConstantProperty(i.spec.light.color),intensity:new i.DataConstantProperty(i.spec.light.intensity)});class tr extends i.Evented{constructor(l){super(),this._transitionable=new i.Transitionable(Pn),this.setLight(l),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(l,h={}){if(!this._validate(i.validateLight,l,h))for(let _ in l){let x=l[_];i.endsWith(_,"-transition")?this._transitionable.setTransition(_.slice(0,-11),x):this._transitionable.setValue(_,x)}}updateTransitions(l){this._transitioning=this._transitionable.transitioned(l,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(l){this.properties=this._transitioning.possiblyEvaluate(l)}_validate(l,h,_){return(!_||_.validate!==!1)&&i.emitValidationErrors(this,l.call(i.validateStyle,i.extend({value:h,style:{glyphs:!0,sprite:!0},styleSpec:i.spec})))}}let ec=new i.Properties({source:new i.DataConstantProperty(i.spec.terrain.source),exaggeration:new i.DataConstantProperty(i.spec.terrain.exaggeration)}),Zs=class extends i.Evented{constructor(m,l){super(),this._transitionable=new i.Transitionable(ec),this.set(m),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=l}get(){return this._transitionable.serialize()}set(m){for(let l in m){let h=m[l];i.endsWith(l,"-transition")?this._transitionable.setTransition(l.slice(0,-11),h):this._transitionable.setValue(l,h)}}updateTransitions(m){this._transitioning=this._transitionable.transitioned(m,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(m){this.properties=this._transitioning.possiblyEvaluate(m)}};function el(m,l,h,_){let x=i.smoothstep(45,65,h),[D,k]=eu(m,_),R=i.length(l),z=1-Math.min(1,Math.exp((R-D)/(k-D)*-6));return z*=z*z,z=Math.min(1,1.00747*z),z*x*m.alpha}function eu(m,l){let h=.5/Math.tan(.5*l);return[m.range[0]+h,m.range[1]+h]}let Tn=new i.Properties({range:new i.DataConstantProperty(i.spec.fog.range),color:new i.DataConstantProperty(i.spec.fog.color),"high-color":new i.DataConstantProperty(i.spec.fog["high-color"]),"space-color":new i.DataConstantProperty(i.spec.fog["space-color"]),"horizon-blend":new i.DataConstantProperty(i.spec.fog["horizon-blend"]),"star-intensity":new i.DataConstantProperty(i.spec.fog["star-intensity"])});class Yo extends i.Evented{constructor(l,h){super(),this._transitionable=new i.Transitionable(Tn),this.set(l),this._transitioning=this._transitionable.untransitioned(),this._transform=h}get state(){let l=this._transform,h=l.projection.name==="globe",_=i.globeToMercatorTransition(l.zoom),x=this.properties.get("range"),D=[.5,3];return{range:h?[i.number(D[0],x[0],_),i.number(D[1],x[1],_)]:x,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(l,h={}){if(!this._validate(i.validateFog,l,h)){for(let _ of Object.keys(i.spec.fog))l&&l[_]===void 0&&(l[_]=i.spec.fog[_].default);for(let _ in l){let x=l[_];i.endsWith(_,"-transition")?this._transitionable.setTransition(_.slice(0,-11),x):this._transitionable.setValue(_,x)}}}getOpacity(l){if(!this._transform.projection.supportsFog)return 0;let h=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:i.smoothstep(45,65,l))*h.a}getOpacityAtLatLng(l,h){return this._transform.projection.supportsFog?function(_,x,D){let k=i.MercatorCoordinate.fromLngLat(x),R=D.elevation?D.elevation.getAtPointOrZero(k):0,z=[k.x,k.y,R];return i.transformMat4(z,z,D.mercatorFogMatrix),el(_,z,D.pitch,D._fov)}(this.state,l,h):0}getFovAdjustedRange(l){return this._transform.projection.supportsFog?eu(this.state,l):[0,1]}updateTransitions(l){this._transitioning=this._transitionable.transitioned(l,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(l){this.properties=this._transitioning.possiblyEvaluate(l)}_validate(l,h,_){return(!_||_.validate!==!1)&&i.emitValidationErrors(this,l.call(i.validateStyle,i.extend({value:h,style:{glyphs:!0,sprite:!0},styleSpec:i.spec})))}}class gr{constructor(l,h){this.workerPool=l,this.actors=[],this.currentActor=0,this.id=i.uniqueId();let _=this.workerPool.acquire(this.id);for(let x=0;x<_.length;x++){let D=new gr.Actor(_[x],h,this.id);D.name=`Worker ${x}`,this.actors.push(D)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(l,h,_){i.asyncAll(this.actors,(x,D)=>{x.send(l,h,D)},_=_||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(l=>{l.remove()}),this.actors=[],this.workerPool.release(this.id)}}function wr(m,l,h){return l*(i.EXTENT/(m.tileSize*Math.pow(2,h-m.tileID.overscaledZ)))}gr.Actor=i.Actor;class vo{constructor(l,h,_,x){this.screenBounds=l,this.cameraPoint=h,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=_,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,x)}static createFromScreenPoints(l,h){let _,x;if(l instanceof i.Point||typeof l[0]=="number"){let D=i.Point.convert(l);_=[D],x=h.isPointAboveHorizon(D)}else{let D=i.Point.convert(l[0]),k=i.Point.convert(l[1]);_=[D,k],x=i.polygonizeBounds(D,k).every(R=>h.isPointAboveHorizon(R))}return new vo(_,h.getCameraPoint(),x,h)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(l){return i.polygonizeBounds(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],l)}bufferedCameraGeometry(l){let h=this.screenBounds[0],_=this.screenBounds.length===1?this.screenBounds[0].add(new i.Point(1,1)):this.screenBounds[1],x=i.polygonizeBounds(h,_,0,!1);return this.cameraPoint.y>_.y&&(this.cameraPoint.x>h.x&&this.cameraPoint.x<_.x?x.splice(3,0,this.cameraPoint):this.cameraPoint.x>=_.x?x[2]=this.cameraPoint:this.cameraPoint.x<=h.x&&(x[3]=this.cameraPoint)),i.bufferConvexPolygon(x,l)}bufferedCameraGeometryGlobe(l){let h=this.screenBounds[0],_=this.screenBounds.length===1?this.screenBounds[0].add(new i.Point(1,1)):this.screenBounds[1],x=i.polygonizeBounds(h,_,l),D=this.cameraPoint.clone();switch(3*((D.y>h.y)+(D.y>_.y))+((D.x>h.x)+(D.x>_.x))){case 0:x[0]=D,x[4]=D.clone();break;case 1:x.splice(1,0,D);break;case 2:x[1]=D;break;case 3:x.splice(4,0,D);break;case 5:x.splice(2,0,D);break;case 6:x[3]=D;break;case 7:x.splice(3,0,D);break;case 8:x[2]=D}return x}containsTile(l,h,_,x=0){let D=l.queryPadding/h._pixelsPerMercatorPixel+1,k=_?this._bufferedCameraMercator(D,h):this._bufferedScreenMercator(D,h),R=l.tileID.wrap+(k.unwrapped?x:0),z=k.polygon.map(pe=>i.getTilePoint(l.tileTransform,pe,R));if(!i.polygonIntersectsBox(z,0,0,i.EXTENT,i.EXTENT))return;R=l.tileID.wrap+(this.screenGeometryMercator.unwrapped?x:0);let G=this.screenGeometryMercator.polygon.map(pe=>i.getTileVec3(l.tileTransform,pe,R)),H=G.map(pe=>new i.Point(pe[0],pe[1])),K=h.getFreeCameraOptions().position||new i.MercatorCoordinate(0,0,0),se=i.getTileVec3(l.tileTransform,K,R),le=G.map(pe=>{let Q=i.sub(pe,pe,se);return i.normalize(Q,Q),new i.Ray(se,Q)}),fe=wr(l,1,h.zoom)*h._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:H,tilespaceRays:le,bufferedTilespaceGeometry:z,bufferedTilespaceBounds:(he=i.getBounds(z),he.min.x=i.clamp(he.min.x,0,i.EXTENT),he.min.y=i.clamp(he.min.y,0,i.EXTENT),he.max.x=i.clamp(he.max.x,0,i.EXTENT),he.max.y=i.clamp(he.max.y,0,i.EXTENT),he),tile:l,tileID:l.tileID,pixelToTileUnitsFactor:fe};var he}_bufferedScreenMercator(l,h){let _=tl(l);if(this._screenRaycastCache[_])return this._screenRaycastCache[_];{let x;return x=h.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(l),h):{polygon:this.bufferedScreenGeometry(l).map(D=>h.pointCoordinate3D(D)),unwrapped:!0},this._screenRaycastCache[_]=x,x}}_bufferedCameraMercator(l,h){let _=tl(l);if(this._cameraRaycastCache[_])return this._cameraRaycastCache[_];{let x;return x=h.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(l),h):{polygon:this.bufferedCameraGeometry(l).map(D=>h.pointCoordinate3D(D)),unwrapped:!0},this._cameraRaycastCache[_]=x,x}}_projectAndResample(l,h){let _=function(D,k){let R=i.multiply([],k.pixelMatrix,k.globeMatrix),z=[0,-i.GLOBE_RADIUS,0,1],G=[0,i.GLOBE_RADIUS,0,1],H=[0,0,0,1];i.transformMat4$1(z,z,R),i.transformMat4$1(G,G,R),i.transformMat4$1(H,H,R);let K=new i.Point(z[0]/z[3],z[1]/z[3]),se=new i.Point(G[0]/G[3],G[1]/G[3]),le=i.polygonContainsPoint(D,K)&&z[3]<H[3],fe=i.polygonContainsPoint(D,se)&&G[3]<H[3];if(!le&&!fe)return null;let he=function(Me,Be,Fe){for(let je=1;je<Me.length;je++){let mt=ms(Be.pointCoordinate3D(Me[je-1]).x),He=ms(Be.pointCoordinate3D(Me[je]).x);if(Fe<0){if(mt<He)return{idx:je,t:-mt/(He-1-mt)}}else if(He<mt)return{idx:je,t:(1-mt)/(He+1-mt)}}return null}(D,k,le?-1:1);if(!he)return null;let{idx:pe,t:Q}=he,ue=pe>1?Bi(D.slice(0,pe),k):[],ye=pe<D.length?Bi(D.slice(pe),k):[];ue=ue.map(Me=>new i.Point(ms(Me.x),Me.y)),ye=ye.map(Me=>new i.Point(ms(Me.x),Me.y));let _e=[...ue];_e.length===0&&_e.push(ye[ye.length-1]);let Ae=i.number(_e[_e.length-1].y,(ye.length===0?ue[0]:ye[0]).y,Q),Re;return Re=le?[new i.Point(0,Ae),new i.Point(0,0),new i.Point(1,0),new i.Point(1,Ae)]:[new i.Point(1,Ae),new i.Point(1,1),new i.Point(0,1),new i.Point(0,Ae)],_e.push(...Re),ye.length===0?_e.push(ue[0]):_e.push(...ye),{polygon:_e.map(Me=>new i.MercatorCoordinate(Me.x,Me.y)),unwrapped:!1}}(l,h);if(_)return _;let x=function(D,k){let R=!1,z=-1/0,G=0;for(let K=0;K<D.length-1;K++)D[K].x>z&&(z=D[K].x,G=K);for(let K=0;K<D.length-1;K++){let se=(G+K)%(D.length-1),le=D[se],fe=D[se+1];Math.abs(le.x-fe.x)>.5&&(le.x<fe.x?(le.x+=1,se===0&&(D[D.length-1].x+=1)):(fe.x+=1,se+1===D.length-1&&(D[0].x+=1)),R=!0)}let H=i.mercatorXfromLng(k.center.lng);return R&&H<Math.abs(H-1)&&D.forEach(K=>{K.x-=1}),{polygon:D,unwrapped:R}}(Bi(l,h).map(D=>new i.Point(ms(D.x),D.y)),h);return{polygon:x.polygon.map(D=>new i.MercatorCoordinate(D.x,D.y)),unwrapped:x.unwrapped}}}function Bi(m,l){return i.resample(m,h=>{let _=l.pointCoordinate3D(h);h.x=_.x,h.y=_.y},1/256)}function ms(m){return m<0?1+m%1:m%1}function tl(m){return 100*m|0}function Xs(m,l,h,_,x){let D=function(k,R){if(k)return x(k);if(R){m.url&&R.tiles&&m.tiles&&delete m.tiles;let z=i.pick(i.extend(R,m),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);R.vector_layers&&(z.vectorLayers=R.vector_layers,z.vectorLayerIds=z.vectorLayers.map(G=>G.id)),z.tiles=l.canonicalizeTileset(z,m.url),x(null,z)}};return m.url?i.getJSON(l.transformRequest(l.normalizeSourceURL(m.url,null,h,_),i.ResourceType.Source),D):i.exported.frame(()=>D(null,m))}class Ys{constructor(l,h,_){this.bounds=i.LngLatBounds.convert(this.validateBounds(l)),this.minzoom=h||0,this.maxzoom=_||24}validateBounds(l){return Array.isArray(l)&&l.length===4?[Math.max(-180,l[0]),Math.max(-90,l[1]),Math.min(180,l[2]),Math.min(90,l[3])]:[-180,-90,180,90]}contains(l){let h=Math.pow(2,l.z),_=Math.floor(i.mercatorXfromLng(this.bounds.getWest())*h),x=Math.floor(i.mercatorYfromLat(this.bounds.getNorth())*h),D=Math.ceil(i.mercatorXfromLng(this.bounds.getEast())*h),k=Math.ceil(i.mercatorYfromLat(this.bounds.getSouth())*h);return l.x>=_&&l.x<D&&l.y>=x&&l.y<k}}class gs{constructor(l,h,_){this.context=l;let x=l.gl;this.buffer=x.createBuffer(),this.dynamicDraw=!!_,this.context.unbindVAO(),l.bindElementBuffer.set(this.buffer),x.bufferData(x.ELEMENT_ARRAY_BUFFER,h.arrayBuffer,this.dynamicDraw?x.DYNAMIC_DRAW:x.STATIC_DRAW),this.dynamicDraw||h.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(l){let h=this.context.gl;this.context.unbindVAO(),this.bind(),h.bufferSubData(h.ELEMENT_ARRAY_BUFFER,0,l.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}let Ma={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class nl{constructor(l,h,_,x){this.length=h.length,this.attributes=_,this.itemSize=h.bytesPerElement,this.dynamicDraw=x,this.context=l;let D=l.gl;this.buffer=D.createBuffer(),l.bindVertexBuffer.set(this.buffer),D.bufferData(D.ARRAY_BUFFER,h.arrayBuffer,this.dynamicDraw?D.DYNAMIC_DRAW:D.STATIC_DRAW),this.dynamicDraw||h.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(l){let h=this.context.gl;this.bind(),h.bufferSubData(h.ARRAY_BUFFER,0,l.arrayBuffer)}enableAttributes(l,h){for(let _=0;_<this.attributes.length;_++){let x=h.attributes[this.attributes[_].name];x!==void 0&&l.enableVertexAttribArray(x)}}setVertexAttribPointers(l,h,_){for(let x=0;x<this.attributes.length;x++){let D=this.attributes[x],k=h.attributes[D.name];k!==void 0&&l.vertexAttribPointer(k,D.components,l[Ma[D.type]],!1,this.itemSize,D.offset+this.itemSize*(_||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class jn{constructor(l){this.gl=l.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(l){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Zt extends jn{getDefault(){return i.Color.transparent}set(l){let h=this.current;(l.r!==h.r||l.g!==h.g||l.b!==h.b||l.a!==h.a||this.dirty)&&(this.gl.clearColor(l.r,l.g,l.b,l.a),this.current=l,this.dirty=!1)}}class bo extends jn{getDefault(){return 1}set(l){(l!==this.current||this.dirty)&&(this.gl.clearDepth(l),this.current=l,this.dirty=!1)}}class Ta extends jn{getDefault(){return 0}set(l){(l!==this.current||this.dirty)&&(this.gl.clearStencil(l),this.current=l,this.dirty=!1)}}class vi extends jn{getDefault(){return[!0,!0,!0,!0]}set(l){let h=this.current;(l[0]!==h[0]||l[1]!==h[1]||l[2]!==h[2]||l[3]!==h[3]||this.dirty)&&(this.gl.colorMask(l[0],l[1],l[2],l[3]),this.current=l,this.dirty=!1)}}class xo extends jn{getDefault(){return!0}set(l){(l!==this.current||this.dirty)&&(this.gl.depthMask(l),this.current=l,this.dirty=!1)}}class il extends jn{getDefault(){return 255}set(l){(l!==this.current||this.dirty)&&(this.gl.stencilMask(l),this.current=l,this.dirty=!1)}}class ys extends jn{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(l){let h=this.current;(l.func!==h.func||l.ref!==h.ref||l.mask!==h.mask||this.dirty)&&(this.gl.stencilFunc(l.func,l.ref,l.mask),this.current=l,this.dirty=!1)}}class to extends jn{getDefault(){let l=this.gl;return[l.KEEP,l.KEEP,l.KEEP]}set(l){let h=this.current;(l[0]!==h[0]||l[1]!==h[1]||l[2]!==h[2]||this.dirty)&&(this.gl.stencilOp(l[0],l[1],l[2]),this.current=l,this.dirty=!1)}}class Ks extends jn{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;let h=this.gl;l?h.enable(h.STENCIL_TEST):h.disable(h.STENCIL_TEST),this.current=l,this.dirty=!1}}class tc extends jn{getDefault(){return[0,1]}set(l){let h=this.current;(l[0]!==h[0]||l[1]!==h[1]||this.dirty)&&(this.gl.depthRange(l[0],l[1]),this.current=l,this.dirty=!1)}}class tu extends jn{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;let h=this.gl;l?h.enable(h.DEPTH_TEST):h.disable(h.DEPTH_TEST),this.current=l,this.dirty=!1}}class no extends jn{getDefault(){return this.gl.LESS}set(l){(l!==this.current||this.dirty)&&(this.gl.depthFunc(l),this.current=l,this.dirty=!1)}}class nc extends jn{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;let h=this.gl;l?h.enable(h.BLEND):h.disable(h.BLEND),this.current=l,this.dirty=!1}}class Mi extends jn{getDefault(){let l=this.gl;return[l.ONE,l.ZERO]}set(l){let h=this.current;(l[0]!==h[0]||l[1]!==h[1]||this.dirty)&&(this.gl.blendFunc(l[0],l[1]),this.current=l,this.dirty=!1)}}class gd extends jn{getDefault(){return i.Color.transparent}set(l){let h=this.current;(l.r!==h.r||l.g!==h.g||l.b!==h.b||l.a!==h.a||this.dirty)&&(this.gl.blendColor(l.r,l.g,l.b,l.a),this.current=l,this.dirty=!1)}}class Po extends jn{getDefault(){return this.gl.FUNC_ADD}set(l){(l!==this.current||this.dirty)&&(this.gl.blendEquation(l),this.current=l,this.dirty=!1)}}class Ia extends jn{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;let h=this.gl;l?h.enable(h.CULL_FACE):h.disable(h.CULL_FACE),this.current=l,this.dirty=!1}}class ic extends jn{getDefault(){return this.gl.BACK}set(l){(l!==this.current||this.dirty)&&(this.gl.cullFace(l),this.current=l,this.dirty=!1)}}class Qs extends jn{getDefault(){return this.gl.CCW}set(l){(l!==this.current||this.dirty)&&(this.gl.frontFace(l),this.current=l,this.dirty=!1)}}let rc,nu=class extends jn{getDefault(){return null}set(m){(m!==this.current||this.dirty)&&(this.gl.useProgram(m),this.current=m,this.dirty=!1)}};class rl extends jn{getDefault(){return this.gl.TEXTURE0}set(l){(l!==this.current||this.dirty)&&(this.gl.activeTexture(l),this.current=l,this.dirty=!1)}}class wo extends jn{getDefault(){let l=this.gl;return[0,0,l.drawingBufferWidth,l.drawingBufferHeight]}set(l){let h=this.current;(l[0]!==h[0]||l[1]!==h[1]||l[2]!==h[2]||l[3]!==h[3]||this.dirty)&&(this.gl.viewport(l[0],l[1],l[2],l[3]),this.current=l,this.dirty=!1)}}class Js extends jn{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;let h=this.gl;h.bindFramebuffer(h.FRAMEBUFFER,l),this.current=l,this.dirty=!1}}class Sr extends jn{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;let h=this.gl;h.bindRenderbuffer(h.RENDERBUFFER,l),this.current=l,this.dirty=!1}}class ea extends jn{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;let h=this.gl;h.bindTexture(h.TEXTURE_2D,l),this.current=l,this.dirty=!1}}class yd extends jn{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;let h=this.gl;h.bindBuffer(h.ARRAY_BUFFER,l),this.current=l,this.dirty=!1}}class be extends jn{getDefault(){return null}set(l){let h=this.gl;h.bindBuffer(h.ELEMENT_ARRAY_BUFFER,l),this.current=l,this.dirty=!1}}class ie extends jn{constructor(l){super(l),this.vao=l.extVertexArrayObject}getDefault(){return null}set(l){this.vao&&(l!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(l),this.current=l,this.dirty=!1)}}class re extends jn{getDefault(){return 4}set(l){if(l===this.current&&!this.dirty)return;let h=this.gl;h.pixelStorei(h.UNPACK_ALIGNMENT,l),this.current=l,this.dirty=!1}}class ve extends jn{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;let h=this.gl;h.pixelStorei(h.UNPACK_PREMULTIPLY_ALPHA_WEBGL,l),this.current=l,this.dirty=!1}}class Ie extends jn{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;let h=this.gl;h.pixelStorei(h.UNPACK_FLIP_Y_WEBGL,l),this.current=l,this.dirty=!1}}class Pe extends jn{constructor(l,h){super(l),this.context=l,this.parent=h}getDefault(){return null}}class $e extends Pe{setDirty(){this.dirty=!0}set(l){if(l===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);let h=this.gl;h.framebufferTexture2D(h.FRAMEBUFFER,h.COLOR_ATTACHMENT0,h.TEXTURE_2D,l,0),this.current=l,this.dirty=!1}}class Ve extends Pe{attachment(){return this.gl.DEPTH_ATTACHMENT}set(l){if(l===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);let h=this.gl;h.framebufferRenderbuffer(h.FRAMEBUFFER,this.attachment(),h.RENDERBUFFER,l),this.current=l,this.dirty=!1}}class Oe extends Ve{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class Xe{constructor(l,h,_,x){this.context=l,this.width=h,this.height=_;let D=this.framebuffer=l.gl.createFramebuffer();this.colorAttachment=new $e(l,D),x&&(this.depthAttachment=new Ve(l,D))}destroy(){let l=this.context.gl,h=this.colorAttachment.get();if(h&&l.deleteTexture(h),this.depthAttachment){let _=this.depthAttachment.get();_&&l.deleteRenderbuffer(_)}l.deleteFramebuffer(this.framebuffer)}}class Ct{constructor(l,h=!1){if(this.gl=l,this.isWebGL2=h,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),h){let _=l;this.extVertexArrayObject={createVertexArrayOES:_.createVertexArray.bind(l),deleteVertexArrayOES:_.deleteVertexArray.bind(l),bindVertexArrayOES:_.bindVertexArray.bind(l)}}this.clearColor=new Zt(this),this.clearDepth=new bo(this),this.clearStencil=new Ta(this),this.colorMask=new vi(this),this.depthMask=new xo(this),this.stencilMask=new il(this),this.stencilFunc=new ys(this),this.stencilOp=new to(this),this.stencilTest=new Ks(this),this.depthRange=new tc(this),this.depthTest=new tu(this),this.depthFunc=new no(this),this.blend=new nc(this),this.blendFunc=new Mi(this),this.blendColor=new gd(this),this.blendEquation=new Po(this),this.cullFace=new Ia(this),this.cullFaceSide=new ic(this),this.frontFace=new Qs(this),this.program=new nu(this),this.activeTexture=new rl(this),this.viewport=new wo(this),this.bindFramebuffer=new Js(this),this.bindRenderbuffer=new Sr(this),this.bindTexture=new ea(this),this.bindVertexBuffer=new yd(this),this.bindElementBuffer=new be(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new ie(this),this.pixelStoreUnpack=new re(this),this.pixelStoreUnpackPremultiplyAlpha=new ve(this),this.pixelStoreUnpackFlipY=new Ie(this),this.extTextureFilterAnisotropic=l.getExtension("EXT_texture_filter_anisotropic")||l.getExtension("MOZ_EXT_texture_filter_anisotropic")||l.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=l.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extStandardDerivativesForceOff=!1,this.extDebugRendererInfo=l.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=l.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=l.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),h||(this.extTextureHalfFloat=l.getExtension("OES_texture_half_float")),(h||this.extTextureHalfFloat&&l.getExtension("OES_texture_half_float_linear"))&&(this.extRenderToTextureHalfFloat=l.getExtension("EXT_color_buffer_half_float")),this.extStandardDerivatives=h||l.getExtension("OES_standard_derivatives"),this.extTimerQuery=l.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=l.getParameter(l.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(l,h){return new gs(this,l,h)}createVertexBuffer(l,h,_){return new nl(this,l,h,_)}createRenderbuffer(l,h,_){let x=this.gl,D=x.createRenderbuffer();return this.bindRenderbuffer.set(D),x.renderbufferStorage(x.RENDERBUFFER,l,h,_),this.bindRenderbuffer.set(null),D}createFramebuffer(l,h,_){return new Xe(this,l,h,_)}clear({color:l,depth:h,stencil:_}){let x=this.gl,D=0;l&&(D|=x.COLOR_BUFFER_BIT,this.clearColor.set(l),this.colorMask.set([!0,!0,!0,!0])),h!==void 0&&(D|=x.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(h),this.depthMask.set(!0)),_!==void 0&&(D|=x.STENCIL_BUFFER_BIT,this.clearStencil.set(_),this.stencilMask.set(255)),x.clear(D)}setCullFace(l){l.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(l.mode),this.frontFace.set(l.frontFace))}setDepthMode(l){l.func!==this.gl.ALWAYS||l.mask?(this.depthTest.set(!0),this.depthFunc.set(l.func),this.depthMask.set(l.mask),this.depthRange.set(l.range)):this.depthTest.set(!1)}setStencilMode(l){l.test.func!==this.gl.ALWAYS||l.mask?(this.stencilTest.set(!0),this.stencilMask.set(l.mask),this.stencilOp.set([l.fail,l.depthFail,l.pass]),this.stencilFunc.set({func:l.test.func,ref:l.ref,mask:l.test.mask})):this.stencilTest.set(!1)}setColorMode(l){E(l.blendFunction,i.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(l.blendFunction),this.blendColor.set(l.blendColor)),this.colorMask.set(l.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class Tt extends i.Evented{constructor(l,h,_,x){if(super(),this.id=l,this.dispatcher=_,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,i.extend(this,i.pick(h,["url","scheme","tileSize","promoteId"])),this._options=i.extend({type:"vector"},h),this._collectResourceTiming=h.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(x),this._tileWorkers={},this._deduped=new i.DedupedRequest}load(l){this._loaded=!1,this.fire(new i.Event("dataloading",{dataType:"source"}));let h=Array.isArray(this.map._language)?this.map._language.join():this.map._language,_=this.map._worldview;this._tileJSONRequest=Xs(this._options,this.map._requestManager,h,_,(x,D)=>{this._tileJSONRequest=null,this._loaded=!0,x?(h&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${h}`),_&&_.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${_}`),this.fire(new i.ErrorEvent(x))):D&&(i.extend(this,D),D.bounds&&(this.tileBounds=new Ys(D.bounds,this.minzoom,this.maxzoom)),i.postTurnstileEvent(D.tiles,this.map._requestManager._customAccessToken),this.fire(new i.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new i.Event("data",{dataType:"source",sourceDataType:"content"}))),l&&l(x)})}loaded(){return this._loaded}hasTile(l){return!this.tileBounds||this.tileBounds.contains(l.canonical)}onAdd(l){this.map=l,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(l){return this._options.tiles=l,this.reload(),this}setUrl(l){return this.url=l,this._options.url=l,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return i.extend({},this._options)}loadTile(l,h){let _=this.map._requestManager.normalizeTileURL(l.tileID.canonical.url(this.tiles,this.scheme)),x={request:this.map._requestManager.transformRequest(_,i.ResourceType.Tile),data:void 0,uid:l.uid,tileID:l.tileID,tileZoom:l.tileZoom,zoom:l.tileID.overscaledZ,tileSize:this.tileSize*l.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:i.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:l.isSymbolTile};if(x.request.collectResourceTiming=this._collectResourceTiming,l.actor&&l.state!=="expired")l.state==="loading"?l.reloadCallback=h:l.request=l.actor.send("reloadTile",x,D.bind(this));else if(l.actor=this._tileWorkers[_]=this._tileWorkers[_]||this.dispatcher.getActor(),this.dispatcher.ready)l.request=l.actor.send("loadTile",x,D.bind(this),void 0,!0);else{let k=i.loadVectorTile.call({deduped:this._deduped},x,(R,z)=>{R||!z?D.call(this,R):(x.data={cacheControl:z.cacheControl,expires:z.expires,rawData:z.rawData.slice(0)},l.actor&&l.actor.send("loadTile",x,D.bind(this),void 0,!0))},!0);l.request={cancel:k}}function D(k,R){return delete l.request,l.aborted?h(null):k&&k.status!==404?h(k):(R&&R.resourceTiming&&(l.resourceTiming=R.resourceTiming),this.map._refreshExpiredTiles&&R&&l.setExpiryData(R),l.loadVectorData(R,this.map.painter),i.cacheEntryPossiblyAdded(this.dispatcher),h(null),void(l.reloadCallback&&(this.loadTile(l,l.reloadCallback),l.reloadCallback=null)))}}abortTile(l){l.request&&(l.request.cancel(),delete l.request),l.actor&&l.actor.send("abortTile",{uid:l.uid,type:this.type,source:this.id})}unloadTile(l){l.unloadVectorData(),l.actor&&l.actor.send("removeTile",{uid:l.uid,type:this.type,source:this.id})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class yt extends i.Evented{constructor(l,h,_,x){super(),this.id=l,this.dispatcher=_,this.setEventedParent(x),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=i.extend({type:"raster"},h),i.extend(this,i.pick(h,["url","scheme","tileSize"]))}load(l){this._loaded=!1,this.fire(new i.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Xs(this._options,this.map._requestManager,null,null,(h,_)=>{this._tileJSONRequest=null,this._loaded=!0,h?this.fire(new i.ErrorEvent(h)):_&&(i.extend(this,_),_.bounds&&(this.tileBounds=new Ys(_.bounds,this.minzoom,this.maxzoom)),i.postTurnstileEvent(_.tiles),this.fire(new i.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new i.Event("data",{dataType:"source",sourceDataType:"content"}))),l&&l(h)})}loaded(){return this._loaded}onAdd(l){this.map=l,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(l){return this._options.tiles=l,this.reload(),this}setUrl(l){return this.url=l,this._options.url=l,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return i.extend({},this._options)}hasTile(l){return!this.tileBounds||this.tileBounds.contains(l.canonical)}loadTile(l,h){let _=i.exported.devicePixelRatio>=2,x=this.map._requestManager.normalizeTileURL(l.tileID.canonical.url(this.tiles,this.scheme),_,this.tileSize);l.request=i.getImage(this.map._requestManager.transformRequest(x,i.ResourceType.Tile),(D,k,R,z)=>(delete l.request,l.aborted?(l.state="unloaded",h(null)):D?(l.state="errored",h(D)):k?(this.map._refreshExpiredTiles&&l.setExpiryData({cacheControl:R,expires:z}),l.setTexture(k,this.map.painter),l.state="loaded",i.cacheEntryPossiblyAdded(this.dispatcher),void h(null)):h(null)))}static loadTileData(l,h,_){l.setTexture(h,_)}static unloadTileData(l,h){l.texture&&h.saveTileTexture(l.texture)}abortTile(l,h){l.request&&(l.request.cancel(),delete l.request),h()}unloadTile(l,h){l.texture&&this.map.painter.saveTileTexture(l.texture),h()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}function cn(m,l,h,_,x,D,k,R){let z=[m,h,x,l,_,D,1,1,1],G=[k,R,1],H=i.adjoint([],z),[K,se,le]=i.transformMat3(G,G,i.transpose(H,H));return i.multiply$1(z,[K,0,0,0,se,0,0,0,le],z)}class In extends i.Evented{constructor(l,h,_,x){super(),this.id=l,this.dispatcher=_,this.coordinates=h.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(x),this.options=h,this._dirty=!1}load(l,h){this._loaded=h||!1,this.fire(new i.Event("dataloading",{dataType:"source"})),this.url=this.options.url,this._imageRequest=i.getImage(this.map._requestManager.transformRequest(this.url,i.ResourceType.Image),(_,x)=>{if(this._imageRequest=null,this._loaded=!0,_)this.fire(new i.ErrorEvent(_));else if(x){let{HTMLImageElement:D}=i.window;this.image=x instanceof D?i.exported.getImageData(x):x,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,l&&(this.coordinates=l),this._finishLoading()}})}loaded(){return this._loaded}updateImage(l){return this.image&&l.url?(this._imageRequest&&l.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=l.url,this.load(l.coordinates,this._loaded),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new i.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(l){this.map=l,this.load()}onRemove(){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),this.texture&&this.texture.destroy()}setCoordinates(l){this.coordinates=l,this._boundsArray=void 0;let h=l.map(i.MercatorCoordinate.fromLngLat);return this.tileID=function(_){let x=1/0,D=1/0,k=-1/0,R=-1/0;for(let K of _)x=Math.min(x,K.x),D=Math.min(D,K.y),k=Math.max(k,K.x),R=Math.max(R,K.y);let z=Math.max(k-x,R-D),G=Math.max(0,Math.floor(-Math.log(z)/Math.LN2)),H=Math.pow(2,G);return new i.CanonicalTileID(G,Math.floor((x+k)/2*H),Math.floor((D+R)/2*H))}(h),this.minzoom=this.maxzoom=this.tileID.z,this.fire(new i.Event("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0}_prepareData(l){for(let z in this.tiles){let G=this.tiles[z];G.state!=="loaded"&&(G.state="loaded",G.texture=this.texture)}if(this._boundsArray)return;let h=i.tileTransform(this.tileID,this.map.transform.projection),[_,x,D,k]=this.coordinates.map(z=>{let G=h.projection.project(z[0],z[1]);return i.getTilePoint(h,G)._round()});this.perspectiveTransform=function(z,G,H,K,se,le,fe,he,pe,Q){let ue=cn(0,0,z,0,0,G,z,G),ye=cn(H,K,se,le,fe,he,pe,Q);return i.multiply$1(ye,i.adjoint(ue,ue),ye),[ye[6]/ye[8]*z/i.EXTENT,ye[7]/ye[8]*G/i.EXTENT]}(this.width,this.height,_.x,_.y,x.x,x.y,k.x,k.y,D.x,D.y);let R=this._boundsArray=new i.StructArrayLayout4i8;R.emplaceBack(_.x,_.y,0,0),R.emplaceBack(x.x,x.y,i.EXTENT,0),R.emplaceBack(k.x,k.y,0,i.EXTENT),R.emplaceBack(D.x,D.y,i.EXTENT,i.EXTENT),this.boundsBuffer&&this.boundsBuffer.destroy(),this.boundsBuffer=l.createVertexBuffer(R,i.boundsAttributes.members),this.boundsSegments=i.SegmentVector.simpleSegment(0,0,4,2)}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;let l=this.map.painter.context,h=l.gl;this._dirty&&(this.texture?this.texture.update(this.image):(this.texture=new i.Texture(l,this.image,h.RGBA),this.texture.bind(h.LINEAR,h.CLAMP_TO_EDGE)),this._dirty=!1),this._prepareData(l)}loadTile(l,h){this.tileID&&this.tileID.equals(l.tileID.canonical)?(this.tiles[String(l.tileID.wrap)]=l,l.buckets={},h(null)):(l.state="errored",h(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}let dn={vector:Tt,raster:yt,"raster-dem":class extends yt{constructor(m,l,h,_){super(m,l,h,_),this.type="raster-dem",this.maxzoom=22,this._options=i.extend({type:"raster-dem"},l),this.encoding=l.encoding||"mapbox"}loadTile(m,l){let h=this.map._requestManager.normalizeTileURL(m.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function _(x,D){x&&(m.state="errored",l(x)),D&&(m.dem=D,m.dem.onDeserialize(),m.needsHillshadePrepare=!0,m.needsDEMTextureUpload=!0,m.state="loaded",l(null))}m.request=i.getImage(this.map._requestManager.transformRequest(h,i.ResourceType.Tile),function(x,D,k,R){if(delete m.request,m.aborted)m.state="unloaded",l(null);else if(x)m.state="errored",l(x);else if(D){this.map._refreshExpiredTiles&&m.setExpiryData({cacheControl:k,expires:R});let z=i.window.ImageBitmap&&D instanceof i.window.ImageBitmap&&(rc==null&&(rc=i.window.OffscreenCanvas&&new i.window.OffscreenCanvas(1,1).getContext("2d")&&typeof i.window.createImageBitmap=="function"),rc),G=1-(D.width-i.prevPowerOfTwo(D.width))/2;G<1||m.neighboringTiles||(m.neighboringTiles=this._getNeighboringTiles(m.tileID));let H=z?D:i.exported.getImageData(D,G),K={uid:m.uid,coord:m.tileID,source:this.id,rawImageData:H,encoding:this.encoding,padding:G};m.actor&&m.state!=="expired"||(m.actor=this.dispatcher.getActor(),m.actor.send("loadDEMTile",K,_.bind(this),void 0,!0))}}.bind(this))}_getNeighboringTiles(m){let l=m.canonical,h=Math.pow(2,l.z),_=(l.x-1+h)%h,x=l.x===0?m.wrap-1:m.wrap,D=(l.x+1+h)%h,k=l.x+1===h?m.wrap+1:m.wrap,R={};return R[new i.OverscaledTileID(m.overscaledZ,x,l.z,_,l.y).key]={backfilled:!1},R[new i.OverscaledTileID(m.overscaledZ,k,l.z,D,l.y).key]={backfilled:!1},l.y>0&&(R[new i.OverscaledTileID(m.overscaledZ,x,l.z,_,l.y-1).key]={backfilled:!1},R[new i.OverscaledTileID(m.overscaledZ,m.wrap,l.z,l.x,l.y-1).key]={backfilled:!1},R[new i.OverscaledTileID(m.overscaledZ,k,l.z,D,l.y-1).key]={backfilled:!1}),l.y+1<h&&(R[new i.OverscaledTileID(m.overscaledZ,x,l.z,_,l.y+1).key]={backfilled:!1},R[new i.OverscaledTileID(m.overscaledZ,m.wrap,l.z,l.x,l.y+1).key]={backfilled:!1},R[new i.OverscaledTileID(m.overscaledZ,k,l.z,D,l.y+1).key]={backfilled:!1}),R}unloadTile(m){m.demTexture&&this.map.painter.saveTileTexture(m.demTexture),m.fbo&&(m.fbo.destroy(),delete m.fbo),m.dem&&delete m.dem,delete m.neighboringTiles,m.state="unloaded"}},geojson:class extends i.Evented{constructor(m,l,h,_){super(),this.id=m,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=h.getActor(),this.setEventedParent(_),this._data=l.data,this._options=i.extend({},l),this._collectResourceTiming=l.collectResourceTiming,l.maxzoom!==void 0&&(this.maxzoom=l.maxzoom),l.type&&(this.type=l.type),l.attribution&&(this.attribution=l.attribution),this.promoteId=l.promoteId;let x=i.EXTENT/this.tileSize;this.workerOptions=i.extend({source:this.id,cluster:l.cluster||!1,geojsonVtOptions:{buffer:(l.buffer!==void 0?l.buffer:128)*x,tolerance:(l.tolerance!==void 0?l.tolerance:.375)*x,extent:i.EXTENT,maxZoom:this.maxzoom,lineMetrics:l.lineMetrics||!1,generateId:l.generateId||!1},superclusterOptions:{maxZoom:l.clusterMaxZoom!==void 0?l.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,l.clusterMinPoints||2),extent:i.EXTENT,radius:(l.clusterRadius!==void 0?l.clusterRadius:50)*x,log:!1,generateId:l.generateId||!1},clusterProperties:l.clusterProperties,filter:l.filter},l.workerOptions)}onAdd(m){this.map=m,this.setData(this._data)}setData(m){return this._data=m,this._updateWorkerData(),this}getClusterExpansionZoom(m,l){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:m,source:this.id},l),this}getClusterChildren(m,l){return this.actor.send("geojson.getClusterChildren",{clusterId:m,source:this.id},l),this}getClusterLeaves(m,l,h,_){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:m,limit:l,offset:h},_),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new i.Event("dataloading",{dataType:"source"})),this._loaded=!1;let m=i.extend({},this.workerOptions),l=this._data;typeof l=="string"?(m.request=this.map._requestManager.transformRequest(i.exported.resolveURL(l),i.ResourceType.Source),m.request.collectResourceTiming=this._collectResourceTiming):m.data=JSON.stringify(l),this._pendingLoad=this.actor.send(`${this.type}.loadData`,m,(h,_)=>{if(this._loaded=!0,this._pendingLoad=null,h)this.fire(new i.ErrorEvent(h));else{let x={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&_&&_.resourceTiming&&_.resourceTiming[this.id]&&(x.resourceTiming=_.resourceTiming[this.id]),this.fire(new i.Event("data",x)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(m,l){let h=m.actor?"reloadTile":"loadTile";m.actor=this.actor,m.request=this.actor.send(h,{type:this.type,uid:m.uid,tileID:m.tileID,tileZoom:m.tileZoom,zoom:m.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:i.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(_,x)=>(delete m.request,m.unloadVectorData(),m.aborted?l(null):_?l(_):(m.loadVectorData(x,this.map.painter,h==="reloadTile"),l(null))),void 0,h==="loadTile")}abortTile(m){m.request&&(m.request.cancel(),delete m.request),m.aborted=!0}unloadTile(m){m.unloadVectorData(),this.actor.send("removeTile",{uid:m.uid,type:this.type,source:this.id})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return i.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends In{constructor(m,l,h,_){super(m,l,h,_),this.roundZoom=!0,this.type="video",this.options=l}load(){this._loaded=!1;let m=this.options;this.urls=[];for(let l of m.urls)this.urls.push(this.map._requestManager.transformRequest(l,i.ResourceType.Source).url);i.getVideo(this.urls,(l,h)=>{this._loaded=!0,l?this.fire(new i.ErrorEvent(l)):h&&(this.video=h,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(m){if(this.video){let l=this.video.seekable;m<l.start(0)||m>l.end(0)?this.fire(new i.ErrorEvent(new i.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${l.start(0)} and ${l.end(0)}-second mark.`))):this.video.currentTime=m}}getVideo(){return this.video}onAdd(m){this.map||(this.map=m,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;let m=this.map.painter.context,l=m.gl;this.texture?this.video.paused||(this.texture.bind(l.LINEAR,l.CLAMP_TO_EDGE),l.texSubImage2D(l.TEXTURE_2D,0,0,0,l.RGBA,l.UNSIGNED_BYTE,this.video)):(this.texture=new i.Texture(m,this.video,l.RGBA),this.texture.bind(l.LINEAR,l.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(m)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:In,canvas:class extends In{constructor(m,l,h,_){super(m,l,h,_),l.coordinates?Array.isArray(l.coordinates)&&l.coordinates.length===4&&!l.coordinates.some(x=>!Array.isArray(x)||x.length!==2||x.some(D=>typeof D!="number"))||this.fire(new i.ErrorEvent(new i.ValidationError(`sources.${m}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new i.ErrorEvent(new i.ValidationError(`sources.${m}`,null,'missing required property "coordinates"'))),l.animate&&typeof l.animate!="boolean"&&this.fire(new i.ErrorEvent(new i.ValidationError(`sources.${m}`,null,'optional "animate" property must be a boolean value'))),l.canvas?typeof l.canvas=="string"||l.canvas instanceof i.window.HTMLCanvasElement||this.fire(new i.ErrorEvent(new i.ValidationError(`sources.${m}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new i.ErrorEvent(new i.ValidationError(`sources.${m}`,null,'missing required property "canvas"'))),this.options=l,this.animate=l.animate===void 0||l.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof i.window.HTMLCanvasElement?this.options.canvas:i.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new i.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(m){this.map=m,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let m=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,m=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,m=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;let l=this.map.painter.context;this.texture?(m||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new i.Texture(l,this.canvas,l.gl.RGBA,{premultiply:!0}),this._prepareData(l)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(let m of[this.canvas.width,this.canvas.height])if(isNaN(m)||m<=0)return!0;return!1}},custom:class extends i.Evented{constructor(m,l,h,_){super(),this.id=m,this.type="custom",this._dataType="raster",this._dispatcher=h,this._implementation=l,this.setEventedParent(_),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new i.ErrorEvent(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new i.ErrorEvent(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new Ys(this._implementation.bounds,this.minzoom,this.maxzoom)),l.update=this._update.bind(this),l.clearTiles=this._clearTiles.bind(this),l.coveringTiles=this._coveringTiles.bind(this),i.extend(this,i.pick(l,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return i.pick(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new i.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new i.Event("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(m){this._map=m,this._loaded=!1,this.fire(new i.Event("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(m),this.load()}onRemove(m){this._implementation.onRemove&&this._implementation.onRemove(m)}hasTile(m){if(this._implementation.hasTile){let{x:l,y:h,z:_}=m.canonical;return this._implementation.hasTile({x:l,y:h,z:_})}return!this.tileBounds||this.tileBounds.contains(m.canonical)}loadTile(m,l){let{x:h,y:_,z:x}=m.tileID.canonical,D=new i.window.AbortController;m.request=Promise.resolve(this._implementation.loadTile({x:h,y:_,z:x},{signal:D.signal})).then(function(k){return delete m.request,m.aborted?(m.state="unloaded",l(null)):k===void 0?(m.state="errored",l(null)):k===null?(this.loadTileData(m,{width:this.tileSize,height:this.tileSize,data:null}),m.state="loaded",l(null)):function(R){return R instanceof i.window.ImageData||R instanceof i.window.HTMLCanvasElement||R instanceof i.window.ImageBitmap||R instanceof i.window.HTMLImageElement}(k)?(this.loadTileData(m,k),m.state="loaded",void l(null)):(m.state="errored",l(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}.bind(this)).catch(k=>{k.code!==20&&(m.state="errored",l(k))}),m.request.cancel=()=>D.abort()}loadTileData(m,l){yt.loadTileData(m,l,this._map.painter)}unloadTileData(m){yt.unloadTileData(m,this._map.painter)}unloadTile(m,l){if(this.unloadTileData(m),this._implementation.unloadTile){let{x:h,y:_,z:x}=m.tileID.canonical;this._implementation.unloadTile({x:h,y:_,z:x})}l()}abortTile(m,l){m.request&&m.request.cancel&&(m.request.cancel(),delete m.request),l()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(m=>({x:m.canonical.x,y:m.canonical.y,z:m.canonical.z}))}_clearTiles(){this._map.style._clearSource(this.id)}_update(){this.fire(new i.Event("data",{dataType:"source",sourceDataType:"content"}))}}},vn=function(m,l,h,_){let x=new dn[l.type](m,l,h,_);if(x.id!==m)throw new Error(`Expected Source id to be ${m} instead of ${x.id}`);return i.bindAll(["load","abort","unload","serialize","prepare"],x),x};function On(m,l){let h=i.identity([]);return i.scale(h,h,[.5*m.width,.5*-m.height,1]),i.translate(h,h,[1,-1,0]),i.multiply(h,h,m.calculateProjMatrix(l.toUnwrapped())),Float32Array.from(h)}function Ln(m,l,h,_,x,D,k,R=!1){let z=m.tilesIn(_,k,R);z.sort(Hr);let G=[];for(let K of z)G.push({wrappedTileID:K.tile.tileID.wrapped().key,queryResults:K.tile.queryRenderedFeatures(l,h,m._state,K,x,D,On(m.transform,K.tile.tileID),R)});let H=function(K){let se={},le={};for(let fe of K){let he=fe.queryResults,pe=fe.wrappedTileID,Q=le[pe]=le[pe]||{};for(let ue in he){let ye=he[ue],_e=Q[ue]=Q[ue]||{},Ae=se[ue]=se[ue]||[];for(let Re of ye)_e[Re.featureIndex]||(_e[Re.featureIndex]=!0,Ae.push(Re))}}return se}(G);for(let K in H)H[K].forEach(se=>{let le=se.feature,fe=le.layer;fe&&fe.type!=="background"&&fe.type!=="sky"&&(le.source=fe.source,fe["source-layer"]&&(le.sourceLayer=fe["source-layer"]),le.state=le.id!==void 0?m.getFeatureState(fe["source-layer"],le.id):{})});return H}function nr(m,l){let h=m.getRenderableIds().map(D=>m.getTileByID(D)),_=[],x={};for(let D=0;D<h.length;D++){let k=h[D],R=k.tileID.canonical.key;x[R]||(x[R]=!0,k.querySourceFeatures(_,l))}return _}function Hr(m,l){let h=m.tileID,_=l.tileID;return h.overscaledZ-_.overscaledZ||h.canonical.y-_.canonical.y||h.wrap-_.wrap||h.canonical.x-_.canonical.x}function yr(){return Dc.workerClass!=null?new Dc.workerClass:new i.window.Worker(Dc.workerUrl)}let _s="mapboxgl_preloaded_worker_pool";class Ar{constructor(){this.active={}}acquire(l){if(!this.workers)for(this.workers=[];this.workers.length<Ar.workerCount;)this.workers.push(new yr);return this.active[l]=!0,this.workers.slice()}release(l){delete this.active[l],this.numActive()===0&&(this.workers.forEach(h=>{h.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[_s]}numActive(){return Object.keys(this.active).length}}let Gr;function oc(){return Gr||(Gr=new Ar),Gr}function Dp(m,l){let h={};for(let _ in m)_!=="ref"&&(h[_]=m[_]);return i.refProperties.forEach(_=>{_ in l&&(h[_]=l[_])}),h}function Lh(m){m=m.slice();let l=Object.create(null);for(let h=0;h<m.length;h++)l[m[h].id]=m[h];for(let h=0;h<m.length;h++)"ref"in m[h]&&(m[h]=Dp(m[h],l[m[h].ref]));return m}Ar.workerCount=2;let ri={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setProjection:"setProjection"};function iu(m,l,h){h.push({command:ri.addSource,args:[m,l[m]]})}function Sa(m,l,h){l.push({command:ri.removeSource,args:[m]}),h[m]=!0}function Fh(m,l,h,_){Sa(m,h,_),iu(m,l,h)}function bi(m,l,h){let _;for(_ in m[h])if(m[h].hasOwnProperty(_)&&_!=="data"&&!E(m[h][_],l[h][_]))return!1;for(_ in l[h])if(l[h].hasOwnProperty(_)&&_!=="data"&&!E(m[h][_],l[h][_]))return!1;return!0}function Ko(m,l,h,_,x,D){let k;for(k in l=l||{},m=m||{})m.hasOwnProperty(k)&&(E(m[k],l[k])||h.push({command:D,args:[_,k,l[k],x]}));for(k in l)l.hasOwnProperty(k)&&!m.hasOwnProperty(k)&&(E(m[k],l[k])||h.push({command:D,args:[_,k,l[k],x]}))}function vs(m){return m.id}function Nh(m,l){return m[l.id]=l,m}class zh{constructor(l,h){this.reset(l,h)}reset(l,h){this.points=l||[],this._distances=[0];for(let _=1;_<this.points.length;_++)this._distances[_]=this._distances[_-1]+this.points[_].dist(this.points[_-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(h||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(l){if(this.points.length===1)return this.points[0];l=i.clamp(l,0,1);let h=1,_=this._distances[h],x=l*this.paddedLength+this.padding;for(;_<x&&h<this._distances.length;)_=this._distances[++h];let D=h-1,k=this._distances[D],R=_-k,z=R>0?(x-k)/R:0;return this.points[D].mult(1-z).add(this.points[h].mult(z))}}class ol{constructor(l,h,_){let x=this.boxCells=[],D=this.circleCells=[];this.xCellCount=Math.ceil(l/_),this.yCellCount=Math.ceil(h/_);for(let k=0;k<this.xCellCount*this.yCellCount;k++)x.push([]),D.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=l,this.height=h,this.xScale=this.xCellCount/l,this.yScale=this.yCellCount/h,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(l,h,_,x,D){this._forEachCell(h,_,x,D,this._insertBoxCell,this.boxUid++),this.boxKeys.push(l),this.bboxes.push(h),this.bboxes.push(_),this.bboxes.push(x),this.bboxes.push(D)}insertCircle(l,h,_,x){this._forEachCell(h-x,_-x,h+x,_+x,this._insertCircleCell,this.circleUid++),this.circleKeys.push(l),this.circles.push(h),this.circles.push(_),this.circles.push(x)}_insertBoxCell(l,h,_,x,D,k){this.boxCells[D].push(k)}_insertCircleCell(l,h,_,x,D,k){this.circleCells[D].push(k)}_query(l,h,_,x,D,k){if(_<0||l>this.width||x<0||h>this.height)return!D&&[];let R=[];if(l<=0&&h<=0&&this.width<=_&&this.height<=x){if(D)return!0;for(let z=0;z<this.boxKeys.length;z++)R.push({key:this.boxKeys[z],x1:this.bboxes[4*z],y1:this.bboxes[4*z+1],x2:this.bboxes[4*z+2],y2:this.bboxes[4*z+3]});for(let z=0;z<this.circleKeys.length;z++){let G=this.circles[3*z],H=this.circles[3*z+1],K=this.circles[3*z+2];R.push({key:this.circleKeys[z],x1:G-K,y1:H-K,x2:G+K,y2:H+K})}return k?R.filter(k):R}return this._forEachCell(l,h,_,x,this._queryCell,R,{hitTest:D,seenUids:{box:{},circle:{}}},k),D?R.length>0:R}_queryCircle(l,h,_,x,D){let k=l-_,R=l+_,z=h-_,G=h+_;if(R<0||k>this.width||G<0||z>this.height)return!x&&[];let H=[];return this._forEachCell(k,z,R,G,this._queryCellCircle,H,{hitTest:x,circle:{x:l,y:h,radius:_},seenUids:{box:{},circle:{}}},D),x?H.length>0:H}query(l,h,_,x,D){return this._query(l,h,_,x,!1,D)}hitTest(l,h,_,x,D){return this._query(l,h,_,x,!0,D)}hitTestCircle(l,h,_,x){return this._queryCircle(l,h,_,!0,x)}_queryCell(l,h,_,x,D,k,R,z){let G=R.seenUids,H=this.boxCells[D];if(H!==null){let se=this.bboxes;for(let le of H)if(!G.box[le]){G.box[le]=!0;let fe=4*le;if(l<=se[fe+2]&&h<=se[fe+3]&&_>=se[fe+0]&&x>=se[fe+1]&&(!z||z(this.boxKeys[le]))){if(R.hitTest)return k.push(!0),!0;k.push({key:this.boxKeys[le],x1:se[fe],y1:se[fe+1],x2:se[fe+2],y2:se[fe+3]})}}}let K=this.circleCells[D];if(K!==null){let se=this.circles;for(let le of K)if(!G.circle[le]){G.circle[le]=!0;let fe=3*le;if(this._circleAndRectCollide(se[fe],se[fe+1],se[fe+2],l,h,_,x)&&(!z||z(this.circleKeys[le]))){if(R.hitTest)return k.push(!0),!0;{let he=se[fe],pe=se[fe+1],Q=se[fe+2];k.push({key:this.circleKeys[le],x1:he-Q,y1:pe-Q,x2:he+Q,y2:pe+Q})}}}}}_queryCellCircle(l,h,_,x,D,k,R,z){let G=R.circle,H=R.seenUids,K=this.boxCells[D];if(K!==null){let le=this.bboxes;for(let fe of K)if(!H.box[fe]){H.box[fe]=!0;let he=4*fe;if(this._circleAndRectCollide(G.x,G.y,G.radius,le[he+0],le[he+1],le[he+2],le[he+3])&&(!z||z(this.boxKeys[fe])))return k.push(!0),!0}}let se=this.circleCells[D];if(se!==null){let le=this.circles;for(let fe of se)if(!H.circle[fe]){H.circle[fe]=!0;let he=3*fe;if(this._circlesCollide(le[he],le[he+1],le[he+2],G.x,G.y,G.radius)&&(!z||z(this.circleKeys[fe])))return k.push(!0),!0}}}_forEachCell(l,h,_,x,D,k,R,z){let G=this._convertToXCellCoord(l),H=this._convertToYCellCoord(h),K=this._convertToXCellCoord(_),se=this._convertToYCellCoord(x);for(let le=G;le<=K;le++)for(let fe=H;fe<=se;fe++)if(D.call(this,l,h,_,x,this.xCellCount*fe+le,k,R,z))return}_convertToXCellCoord(l){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(l*this.xScale)))}_convertToYCellCoord(l){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(l*this.yScale)))}_circlesCollide(l,h,_,x,D,k){let R=x-l,z=D-h,G=_+k;return G*G>R*R+z*z}_circleAndRectCollide(l,h,_,x,D,k,R){let z=(k-x)/2,G=Math.abs(l-(x+z));if(G>z+_)return!1;let H=(R-D)/2,K=Math.abs(h-(D+H));if(K>H+_)return!1;if(G<=z||K<=H)return!0;let se=G-z,le=K-H;return se*se+le*le<=_*_}}let ta={unknown:0,flipRequired:1,flipNotRequired:2},sc=Math.tan(85*Math.PI/180);function Je(m,l,h,_,x,D,k){let R=i.create();if(h)if(D.name==="globe"){let z=i.calculateGlobeLabelMatrix(x,l);i.multiply(R,R,z)}else{let z=It([],k);R[0]=z[0],R[1]=z[1],R[4]=z[2],R[5]=z[3],_||i.rotateZ(R,R,x.angle)}else i.multiply(R,x.labelPlaneMatrix,m);return R}function na(m,l,h,_,x,D,k){let R=Je(m,l,h,_,x,D,k);return D.name==="globe"&&h||(R[2]=R[6]=R[10]=R[14]=0),R}function ur(m,l,h,_,x,D,k){if(h){if(D.name==="globe"){let R=Je(m,l,h,_,x,D,k);return i.invert(R,R),i.multiply(R,m,R),R}{let R=i.clone(m),z=i.identity([]);return z[0]=k[0],z[1]=k[1],z[4]=k[2],z[5]=k[3],i.multiply(R,R,z),_||i.rotateZ(R,R,-x.angle),R}}return x.glCoordMatrix}function kr(m,l,h,_){let x=[m,l,h,1];h?i.transformMat4$1(x,x,_):Dn(x,x,_);let D=x[3];return x[0]/=D,x[1]/=D,x[2]/=D,x}function ru(m,l){return Math.min(.5+m/l*.5,1.5)}function Qo(m,l){let h=m[0]/m[3],_=m[1]/m[3];return h>=-l[0]&&h<=l[0]&&_>=-l[1]&&_<=l[1]}function _d(m,l,h,_,x,D,k,R,z,G){let H=h.transform,K=_?m.textSizeData:m.iconSizeData,se=i.evaluateSizeForZoom(K,h.transform.zoom),le=H.projection.name==="globe",fe=[256/h.width*2+1,256/h.height*2+1],he=_?m.text.dynamicLayoutVertexArray:m.icon.dynamicLayoutVertexArray;he.clear();let pe=null;le&&(pe=_?m.text.globeExtVertexArray:m.icon.globeExtVertexArray);let Q=m.lineVertexArray,ue=_?m.text.placedSymbolArray:m.icon.placedSymbolArray,ye=h.transform.width/h.transform.height,_e,Ae=!1;for(let Re=0;Re<ue.length;Re++){let Me=ue.get(Re),{numGlyphs:Be,writingMode:Fe}=Me;if(Fe!==i.WritingMode.vertical||Ae||_e===i.WritingMode.horizontal||(Ae=!0),_e=Fe,(Me.hidden||Fe===i.WritingMode.vertical)&&!Ae){Jo(Be,he);continue}Ae=!1;let je=new i.Point(Me.tileAnchorX,Me.tileAnchorY),{x:mt,y:He,z:it}=H.projection.projectTilePoint(je.x,je.y,G.canonical);if(z){let[sn,Ft,Xt]=z(je);mt+=sn,He+=Ft,it+=Xt}let Ze=[mt,He,it,1];if(i.transformMat4$1(Ze,Ze,l),!Qo(Ze,fe)){Jo(Be,he);continue}let ht=ru(h.transform.cameraToCenterDistance,Ze[3]),Ge=i.evaluateSizeForFeature(K,se,Me),tt=k?Ge/ht:Ge*ht,gt=kr(mt,He,it,x);if(gt[3]<=0){Jo(Be,he);continue}let at={},_t=k?null:z,$t=Mt(Me,tt,!1,R,l,x,D,m.glyphOffsetArray,Q,he,pe,gt,je,at,ye,_t,H.projection,G,k);Ae=$t.useVertical,_t&&$t.needsFlipping&&(at={}),($t.notEnoughRoom||Ae||$t.needsFlipping&&Mt(Me,tt,!0,R,l,x,D,m.glyphOffsetArray,Q,he,pe,gt,je,at,ye,_t,H.projection,G,k).notEnoughRoom)&&Jo(Be,he)}_?(m.text.dynamicLayoutVertexBuffer.updateData(he),pe&&m.text.globeExtVertexBuffer.updateData(pe)):(m.icon.dynamicLayoutVertexBuffer.updateData(he),pe&&m.icon.globeExtVertexBuffer.updateData(pe))}function ou(m,l,h,_,x,D,k,R,z,G,H,K,se,le,fe,he){let{lineStartIndex:pe,glyphStartIndex:Q,segment:ue}=R,ye=Q+R.numGlyphs,_e=pe+R.lineLength,Ae=l.getoffsetX(Q),Re=l.getoffsetX(ye-1),Me=Co(m*Ae,h,_,x,D,k,ue,pe,_e,z,G,H,K,se,!0,le,fe,he);if(!Me)return null;let Be=Co(m*Re,h,_,x,D,k,ue,pe,_e,z,G,H,K,se,!0,le,fe,he);return Be?{first:Me,last:Be}:null}function sl(m,l,h,_){return m===i.WritingMode.horizontal&&Math.abs(_)>Math.abs(h)?{useVertical:!0}:m===i.WritingMode.vertical?_>0?{needsFlipping:!0}:null:l!==ta.unknown&&function(x,D){return x===0||Math.abs(D/x)>sc}(h,_)?l===ta.flipRequired?{needsFlipping:!0}:null:h<0?{needsFlipping:!0}:null}function Mt(m,l,h,_,x,D,k,R,z,G,H,K,se,le,fe,he,pe,Q,ue){let ye=l/24,_e=m.lineOffsetX*ye,Ae=m.lineOffsetY*ye,{lineStartIndex:Re,glyphStartIndex:Me,numGlyphs:Be,segment:Fe,writingMode:je,flipState:mt}=m,He=Re+m.lineLength,it=Ze=>{if(H){let[gt,at,_t]=Ze.up,$t=G.length;i.updateGlobeVertexNormal(H,$t+0,gt,at,_t),i.updateGlobeVertexNormal(H,$t+1,gt,at,_t),i.updateGlobeVertexNormal(H,$t+2,gt,at,_t),i.updateGlobeVertexNormal(H,$t+3,gt,at,_t)}let[ht,Ge,tt]=Ze.point;i.addDynamicAttributes(G,ht,Ge,tt,Ze.angle)};if(Be>1){let Ze=ou(ye,R,_e,Ae,h,K,se,m,z,D,le,he,!1,pe,Q,ue);if(!Ze)return{notEnoughRoom:!0};if(_&&!h){let[ht,Ge,tt]=Ze.first.point,[gt,at,_t]=Ze.last.point;[ht,Ge]=kr(ht,Ge,tt,k),[gt,at]=kr(gt,at,_t,k);let $t=sl(je,mt,(gt-ht)*fe,at-Ge);if(m.flipState=$t&&$t.needsFlipping?ta.flipRequired:ta.flipNotRequired,$t)return $t}it(Ze.first);for(let ht=Me+1;ht<Me+Be-1;ht++){let Ge=Co(ye*R.getoffsetX(ht),_e,Ae,h,K,se,Fe,Re,He,z,D,le,he,!1,!1,pe,Q,ue);if(!Ge)return G.length-=4*(ht-Me),{notEnoughRoom:!0};it(Ge)}it(Ze.last)}else{if(_&&!h){let ht=kr(se.x,se.y,0,x),Ge=Re+Fe+1,tt=new i.Point(z.getx(Ge),z.gety(Ge)),gt=kr(tt.x,tt.y,0,x),at=gt[3]>0?gt:kn(se,tt,ht,1,x,void 0,pe,Q.canonical),_t=sl(je,mt,(at[0]-ht[0])*fe,at[1]-ht[1]);if(m.flipState=_t&&_t.needsFlipping?ta.flipRequired:ta.flipNotRequired,_t)return _t}let Ze=Co(ye*R.getoffsetX(Me),_e,Ae,h,K,se,Fe,Re,He,z,D,le,he,!1,!1,pe,Q,ue);if(!Ze)return{notEnoughRoom:!0};it(Ze)}return{}}function En(m,l,h,_,x){let{x:D,y:k,z:R}=_.projectTilePoint(m.x,m.y,l);if(!x)return kr(D,k,R,h);let[z,G,H]=x(m);return kr(D+z,k+G,R+H,h)}function kn(m,l,h,_,x,D,k,R){let z=En(m.sub(l)._unit()._add(m),R,x,k,D);return i.sub(z,h,z),i.normalize(z,z),i.scaleAndAdd(z,h,z,_)}function Co(m,l,h,_,x,D,k,R,z,G,H,K,se,le,fe,he,pe,Q){let ue=_?m-l:m+l,ye=ue>0?1:-1,_e=0;_&&(ye*=-1,_e=Math.PI),ye<0&&(_e+=Math.PI);let Ae=R+k+(ye>0?0:1)|0,Re=x,Me=x,Be=0,Fe=0,je=Math.abs(ue),mt=[],He=[],it=D,Ze=it,ht=()=>kn(Ze,it,Me,je-Be+1,H,se,he,pe.canonical);for(;Be+Fe<=je;){if(Ae+=ye,Ae<R||Ae>=z)return null;if(Me=Re,Ze=it,mt.push(Me),le&&He.push(Ze),it=new i.Point(G.getx(Ae),G.gety(Ae)),Re=K[Ae],!Re){let Xt=En(it,pe.canonical,H,he,se);Re=Xt[3]>0?K[Ae]=Xt:ht()}Be+=Fe,Fe=i.distance(Me,Re)}fe&&se&&(K[Ae]&&(Re=ht(),Fe=i.distance(Me,Re)),K[Ae]=Re);let Ge=(je-Be)/Fe,tt=it.sub(Ze)._mult(Ge)._add(Ze),gt=i.sub([],Re,Me),at=i.scaleAndAdd([],Me,gt,Ge),_t=[0,0,1],$t=gt[0],sn=gt[1];if(Q&&(_t=he.upVector(pe.canonical,tt.x,tt.y),_t[0]!==0||_t[1]!==0||_t[2]!==1)){let Xt=[_t[2],0,-_t[0]],Gt=i.cross([],_t,Xt);i.normalize(Xt,Xt),i.normalize(Gt,Gt),$t=i.dot(gt,Xt),sn=i.dot(gt,Gt)}if(h){let Xt=i.cross([],_t,gt);i.normalize(Xt,Xt),i.scaleAndAdd(at,at,Xt,h*ye)}let Ft=_e+Math.atan2(sn,$t);return mt.push(at),le&&He.push(tt),{point:at,angle:Ft,path:mt,tilePath:He,up:_t}}function Jo(m,l){let h=l.length,_=h+4*m;l.resize(_),l.float32.fill(-1/0,4*h,4*_)}function Dn(m,l,h){let _=l[0],x=l[1];return m[0]=h[0]*_+h[4]*x+h[12],m[1]=h[1]*_+h[5]*x+h[13],m[3]=h[3]*_+h[7]*x+h[15],m}let Wr=100;class su{constructor(l,h,_=new ol(l.width+200,l.height+200,25),x=new ol(l.width+200,l.height+200,25)){this.transform=l,this.grid=_,this.ignoredGrid=x,this.pitchfactor=Math.cos(l._pitch)*l.cameraToCenterDistance,this.screenRightBoundary=l.width+Wr,this.screenBottomBoundary=l.height+Wr,this.gridRightBoundary=l.width+200,this.gridBottomBoundary=l.height+200,this.fogState=h}placeCollisionBox(l,h,_,x,D,k,R,z){let G=_.projectedAnchorX,H=_.projectedAnchorY,K=_.projectedAnchorZ,se=_.elevation,le=_.tileID,fe=l.getProjection();if(se&&le){let[Re,Me,Be]=fe.upVector(le.canonical,_.tileAnchorX,_.tileAnchorY),Fe=fe.upVectorScale(le.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;G+=Re*se*Fe,H+=Me*se*Fe,K+=Be*se*Fe}let he=this.projectAndGetPerspectiveRatio(R,G,H,K,_.tileID,fe.name==="globe"||!!se||this.transform.pitch>0,fe),pe=k*he.perspectiveRatio,Q=(_.x1*h+x.x-_.padding)*pe+he.point.x,ue=(_.y1*h+x.y-_.padding)*pe+he.point.y,ye=(_.x2*h+x.x+_.padding)*pe+he.point.x,_e=(_.y2*h+x.y+_.padding)*pe+he.point.y,Ae=he.perspectiveRatio<=.55||he.occluded;return!this.isInsideGrid(Q,ue,ye,_e)||!D&&this.grid.hitTest(Q,ue,ye,_e,z)||Ae?{box:[],offscreen:!1,occluded:he.occluded}:{box:[Q,ue,ye,_e],offscreen:this.isOffscreen(Q,ue,ye,_e),occluded:!1}}placeCollisionCircles(l,h,_,x,D,k,R,z,G,H,K,se,le,fe,he){let pe=[],Q=this.transform.elevation,ue=l.getProjection(),ye=Q?Q.getAtTileOffsetFunc(he,this.transform.center.lat,this.transform.worldSize,ue):null,_e=new i.Point(_.tileAnchorX,_.tileAnchorY),{x:Ae,y:Re,z:Me}=ue.projectTilePoint(_e.x,_e.y,he.canonical);if(ye){let[tt,gt,at]=ye(_e);Ae+=tt,Re+=gt,Me+=at}let Be=ue.name==="globe",Fe=this.projectAndGetPerspectiveRatio(R,Ae,Re,Me,he,Be||!!Q||this.transform.pitch>0,ue),{perspectiveRatio:je}=Fe,mt=(K?k/je:k*je)/i.ONE_EM,He=kr(Ae,Re,Me,z),it=Fe.signedDistanceFromCamera>0?ou(mt,D,_.lineOffsetX*mt,_.lineOffsetY*mt,!1,He,_e,_,x,z,{},Q&&!K?ye:null,K&&!!Q,ue,he,K):null,Ze=!1,ht=!1,Ge=!0;if(it&&!Fe.occluded){let tt=.5*le*je+fe,gt=new i.Point(-100,-100),at=new i.Point(this.screenRightBoundary,this.screenBottomBoundary),_t=new zh,{first:$t,last:sn}=it,Ft=$t.path.length,Xt=[];for(let Vt=Ft-1;Vt>=1;Vt--)Xt.push($t.path[Vt]);for(let Vt=1;Vt<sn.path.length;Vt++)Xt.push(sn.path[Vt]);let Gt=2.5*tt;G&&(Xt=Xt.map(([Vt,Qn,ui],di)=>(ye&&!Be&&(ui=ye(di<Ft-1?$t.tilePath[Ft-1-di]:sn.tilePath[di-Ft+2])[2]),kr(Vt,Qn,ui,G))),Xt.some(Vt=>Vt[3]<=0)&&(Xt=[]));let Mn=[];if(Xt.length>0){let Vt=1/0,Qn=-1/0,ui=1/0,di=-1/0;for(let hi of Xt)Vt=Math.min(Vt,hi[0]),ui=Math.min(ui,hi[1]),Qn=Math.max(Qn,hi[0]),di=Math.max(di,hi[1]);Qn>=gt.x&&Vt<=at.x&&di>=gt.y&&ui<=at.y&&(Mn=[Xt.map(hi=>new i.Point(hi[0],hi[1]))],(Vt<gt.x||Qn>at.x||ui<gt.y||di>at.y)&&(Mn=i.clipLine(Mn,gt.x,gt.y,at.x,at.y)))}for(let Vt of Mn){_t.reset(Vt,.25*tt);let Qn=0;Qn=_t.length<=.5*tt?1:Math.ceil(_t.paddedLength/Gt)+1;for(let ui=0;ui<Qn;ui++){let di=ui/Math.max(Qn-1,1),hi=_t.lerp(di),dr=hi.x+Wr,vr=hi.y+Wr;pe.push(dr,vr,tt,0);let To=dr-tt,is=vr-tt,Si=dr+tt,fi=vr+tt;if(Ge=Ge&&this.isOffscreen(To,is,Si,fi),ht=ht||this.isInsideGrid(To,is,Si,fi),!h&&this.grid.hitTestCircle(dr,vr,tt,se)&&(Ze=!0,!H))return{circles:[],offscreen:!1,collisionDetected:Ze,occluded:!1}}}}return{circles:!H&&Ze||!ht?[]:pe,offscreen:Ge,collisionDetected:Ze,occluded:Fe.occluded}}queryRenderedSymbols(l){if(l.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};let h=[],_=1/0,x=1/0,D=-1/0,k=-1/0;for(let H of l){let K=new i.Point(H.x+Wr,H.y+Wr);_=Math.min(_,K.x),x=Math.min(x,K.y),D=Math.max(D,K.x),k=Math.max(k,K.y),h.push(K)}let R=this.grid.query(_,x,D,k).concat(this.ignoredGrid.query(_,x,D,k)),z={},G={};for(let H of R){let K=H.key;if(z[K.bucketInstanceId]===void 0&&(z[K.bucketInstanceId]={}),z[K.bucketInstanceId][K.featureIndex])continue;let se=[new i.Point(H.x1,H.y1),new i.Point(H.x2,H.y1),new i.Point(H.x2,H.y2),new i.Point(H.x1,H.y2)];i.polygonIntersectsPolygon(h,se)&&(z[K.bucketInstanceId][K.featureIndex]=!0,G[K.bucketInstanceId]===void 0&&(G[K.bucketInstanceId]=[]),G[K.bucketInstanceId].push(K.featureIndex))}return G}insertCollisionBox(l,h,_,x,D){(h?this.ignoredGrid:this.grid).insert({bucketInstanceId:_,featureIndex:x,collisionGroupID:D},l[0],l[1],l[2],l[3])}insertCollisionCircles(l,h,_,x,D){let k=h?this.ignoredGrid:this.grid,R={bucketInstanceId:_,featureIndex:x,collisionGroupID:D};for(let z=0;z<l.length;z+=4)k.insertCircle(R,l[z],l[z+1],l[z+2])}projectAndGetPerspectiveRatio(l,h,_,x,D,k,R){let z=[h,_,x,1],G=!1;x||this.transform.pitch>0?(i.transformMat4$1(z,z,l),this.fogState&&D&&R.name!=="globe"&&(G=function(se,le,fe,he,pe,Q){let ue=Q.calculateFogTileMatrix(pe),ye=[le,fe,he];return i.transformMat4(ye,ye,ue),el(se,ye,Q.pitch,Q._fov)}(this.fogState,h,_,x,D.toUnwrapped(),this.transform)>.9)):Dn(z,z,l);let H=z[3];return{point:new i.Point((z[0]/H+1)/2*this.transform.width+Wr,(-z[1]/H+1)/2*this.transform.height+Wr),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(R)/H*.5,1.5),signedDistanceFromCamera:H,occluded:k&&z[2]>H||G}}isOffscreen(l,h,_,x){return _<Wr||l>=this.screenRightBoundary||x<Wr||h>this.screenBottomBoundary}isInsideGrid(l,h,_,x){return _>=0&&l<this.gridRightBoundary&&x>=0&&h<this.gridBottomBoundary}getViewportMatrix(){let l=i.identity([]);return i.translate(l,l,[-100,-100,0]),l}}function al(m,l,h){let _=l.createTileMatrix(m,m.worldSize,h.toUnwrapped());return i.multiply(new Float32Array(16),m.projMatrix,_)}function Eo(m,l,h){if(l.projection.name===h.projection.name)return m.projMatrix;let _=h.clone();return _.setProjection(l.projection),al(_,l.getProjection(),m)}function Ti(m,l,h){return l.name===h.projection.name?m.projMatrix:al(h,l,m)}class ll{constructor(l,h,_,x){this.opacity=l?Math.max(0,Math.min(1,l.opacity+(l.placed?h:-h))):x&&_?1:0,this.placed=_}isHidden(){return this.opacity===0&&!this.placed}}class ia{constructor(l,h,_,x,D,k=!1){this.text=new ll(l?l.text:null,h,_,D),this.icon=new ll(l?l.icon:null,h,x,D),this.clipped=k}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Aa{constructor(l,h,_,x=!1){this.text=l,this.icon=h,this.skipFade=_,this.clipped=x}}class au{constructor(){this.invProjMatrix=i.create(),this.viewportMatrix=i.create(),this.circles=[]}}class Bh{constructor(l,h,_,x,D){this.bucketInstanceId=l,this.featureIndex=h,this.sourceLayerIndex=_,this.bucketIndex=x,this.tileID=D}}class Mp{constructor(l){this.crossSourceCollisions=l,this.maxGroupID=0,this.collisionGroups={}}get(l){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[l]){let h=++this.maxGroupID;this.collisionGroups[l]={ID:h,predicate:_=>_.collisionGroupID===h}}return this.collisionGroups[l]}}function cl(m,l,h,_,x){let{horizontalAlign:D,verticalAlign:k}=i.getAnchorAlignment(m),R=-(D-.5)*l,z=-(k-.5)*h,G=i.evaluateVariableOffset(m,_);return new i.Point(R+G[0]*x,z+G[1]*x)}function lu(m,l,h,_,x){let D=new i.Point(m,l);return h&&D._rotate(_?x:-x),D}class ul{constructor(l,h,_,x,D){this.transform=l.clone(),this.projection=l.projection.name,this.collisionIndex=new su(this.transform,D),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=h,this.retainedQueryData={},this.collisionGroups=new Mp(_),this.collisionCircleArrays={},this.prevPlacement=x,x&&(x.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(l,h,_,x){let D=_.getBucket(h),k=_.latestFeatureIndex;if(!D||!k||h.id!==D.layerIds[0])return;let R=D.layers[0].layout,z=_.collisionBoxArray,G=Math.pow(2,this.transform.zoom-_.tileID.overscaledZ),H=_.tileSize/i.EXTENT,K=_.tileID.toUnwrapped();this.transform.setProjection(D.projection);let se=(le=_.tileID,fe=D.getProjection(),he=this.transform,fe.name===this.projection?he.calculateProjMatrix(le.toUnwrapped()):al(he,fe,le));var le,fe,he;let pe=R.get("text-pitch-alignment")==="map",Q=R.get("text-rotation-alignment")==="map";h.compileFilter();let ue=h.dynamicFilter(),ye=h.dynamicFilterNeedsFeature(),_e=this.transform.calculatePixelsToTileUnitsMatrix(_),Ae=na(se,_.tileID.canonical,pe,Q,this.transform,D.getProjection(),_e),Re=null;if(pe){let Fe=ur(se,_.tileID.canonical,pe,Q,this.transform,D.getProjection(),_e);Re=i.multiply([],this.transform.labelPlaneMatrix,Fe)}let Me=null;ue&&_.latestFeatureIndex&&(Me={unwrappedTileID:K,dynamicFilter:ue,dynamicFilterNeedsFeature:ye,featureIndex:_.latestFeatureIndex}),this.retainedQueryData[D.bucketInstanceId]=new Bh(D.bucketInstanceId,k,D.sourceLayerIndex,D.index,_.tileID);let Be={bucket:D,layout:R,posMatrix:se,textLabelPlaneMatrix:Ae,labelToScreenMatrix:Re,clippingData:Me,scale:G,textPixelRatio:H,holdingForFade:_.holdingForFade(),collisionBoxArray:z,partiallyEvaluatedTextSize:i.evaluateSizeForZoom(D.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:i.evaluateSizeForZoom(D.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(D.sourceID)};if(x)for(let Fe of D.sortKeyRanges){let{sortKey:je,symbolInstanceStart:mt,symbolInstanceEnd:He}=Fe;l.push({sortKey:je,symbolInstanceStart:mt,symbolInstanceEnd:He,parameters:Be})}else l.push({symbolInstanceStart:0,symbolInstanceEnd:D.symbolInstances.length,parameters:Be})}attemptAnchorPlacement(l,h,_,x,D,k,R,z,G,H,K,se,le,fe,he,pe,Q,ue){let{textOffset0:ye,textOffset1:_e,crossTileID:Ae}=se,Re=[ye,_e],Me=cl(l,_,x,Re,D),Be=this.collisionIndex.placeCollisionBox(fe,D,h,lu(Me.x,Me.y,k,R,this.transform.angle),K,z,G,H.predicate);if(pe){let Fe=fe.getSymbolInstanceIconSize(ue,this.transform.zoom,se.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(fe,Fe,pe,lu(Me.x,Me.y,k,R,this.transform.angle),K,z,G,H.predicate).box.length===0)return}if(Be.box.length>0){let Fe;return this.prevPlacement&&this.prevPlacement.variableOffsets[Ae]&&this.prevPlacement.placements[Ae]&&this.prevPlacement.placements[Ae].text&&(Fe=this.prevPlacement.variableOffsets[Ae].anchor),this.variableOffsets[Ae]={textOffset:Re,width:_,height:x,anchor:l,textScale:D,prevAnchor:Fe},this.markUsedJustification(fe,l,se,he),fe.allowVerticalPlacement&&(this.markUsedOrientation(fe,he,se),this.placedOrientations[Ae]=he),{shift:Me,placedGlyphBoxes:Be}}}placeLayerBucketPart(l,h,_,x){let{bucket:D,layout:k,posMatrix:R,textLabelPlaneMatrix:z,labelToScreenMatrix:G,clippingData:H,textPixelRatio:K,holdingForFade:se,collisionBoxArray:le,partiallyEvaluatedTextSize:fe,partiallyEvaluatedIconSize:he,collisionGroup:pe}=l.parameters,Q=k.get("text-optional"),ue=k.get("icon-optional"),ye=k.get("text-allow-overlap"),_e=k.get("icon-allow-overlap"),Ae=k.get("text-rotation-alignment")==="map",Re=k.get("text-pitch-alignment")==="map",Me=k.get("icon-text-fit")!=="none",Be=k.get("symbol-z-order")==="viewport-y";this.transform.setProjection(D.projection);let Fe=ye&&(_e||!D.hasIconData()||ue),je=_e&&(ye||!D.hasTextData()||Q);!D.collisionArrays&&le&&D.deserializeCollisionBoxes(le),_&&x&&D.updateCollisionDebugBuffers(this.transform.zoom,le);let mt=(He,it,Ze)=>{let{crossTileID:ht,numVerticalGlyphVertices:Ge}=He;if(H){let Si={zoom:this.transform.zoom,pitch:this.transform.pitch},fi=null;if(H.dynamicFilterNeedsFeature){let rn=this.retainedQueryData[D.bucketInstanceId];fi=H.featureIndex.loadFeature({featureIndex:He.featureIndex,bucketIndex:rn.bucketIndex,sourceLayerIndex:rn.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,H.dynamicFilter)(Si,fi,this.retainedQueryData[D.bucketInstanceId].tileID.canonical,new i.Point(He.tileAnchorX,He.tileAnchorY),this.transform.calculateDistanceTileData(H.unwrappedTileID)))return this.placements[ht]=new Aa(!1,!1,!1,!0),void h.add(ht)}if(h.has(ht))return;if(se)return void(this.placements[ht]=new Aa(!1,!1,!1));let tt=!1,gt=!1,at=!0,_t=!1,$t=!1,sn=null,Ft={box:null,offscreen:null,occluded:null},Xt={box:null,offscreen:null,occluded:null},Gt=null,Mn=null,Vt=null,Qn=0,ui=0,di=0;Ze.textFeatureIndex?Qn=Ze.textFeatureIndex:He.useRuntimeCollisionCircles&&(Qn=He.featureIndex),Ze.verticalTextFeatureIndex&&(ui=Ze.verticalTextFeatureIndex);let hi=Si=>{Si.tileID=this.retainedQueryData[D.bucketInstanceId].tileID;let fi=this.transform.elevation;(fi||Si.elevation)&&(Si.elevation=fi?fi.getAtTileOffset(Si.tileID,Si.tileAnchorX,Si.tileAnchorY):0)},dr=Ze.textBox;if(dr){hi(dr);let Si=rn=>{let hr=i.WritingMode.horizontal;if(D.allowVerticalPlacement&&!rn&&this.prevPlacement){let ro=this.prevPlacement.placedOrientations[ht];ro&&(this.placedOrientations[ht]=ro,hr=ro,this.markUsedOrientation(D,hr,He))}return hr},fi=(rn,hr)=>{if(D.allowVerticalPlacement&&Ge>0&&Ze.verticalTextBox){for(let ro of D.writingModes)if(ro===i.WritingMode.vertical?(Ft=hr(),Xt=Ft):Ft=rn(),Ft&&Ft.box&&Ft.box.length)break}else Ft=rn()};if(k.get("text-variable-anchor")){let rn=k.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[ht]){let xi=this.prevPlacement.variableOffsets[ht];rn.indexOf(xi.anchor)>0&&(rn=rn.filter(Nr=>Nr!==xi.anchor),rn.unshift(xi.anchor))}let hr=(xi,Nr,la)=>{let Rl=D.getSymbolInstanceTextSize(fe,He,this.transform.zoom,it),mi=(xi.x2-xi.x1)*Rl+2*xi.padding,ca=(xi.y2-xi.y1)*Rl+2*xi.padding,ua=Me&&!_e?Nr:null;ua&&hi(ua);let Ba={box:[],offscreen:!1,occluded:!1},Ru=ye?2*rn.length:rn.length;for(let rr=0;rr<Ru;++rr){let pf=this.attemptAnchorPlacement(rn[rr%rn.length],xi,mi,ca,Rl,Ae,Re,K,R,pe,rr>=rn.length,He,it,D,la,ua,fe,he);if(pf&&(Ba=pf.placedGlyphBoxes,Ba&&Ba.box&&Ba.box.length)){tt=!0,sn=pf.shift;break}}return Ba};fi(()=>hr(dr,Ze.iconBox,i.WritingMode.horizontal),()=>{let xi=Ze.verticalTextBox;return xi&&hi(xi),D.allowVerticalPlacement&&!(Ft&&Ft.box&&Ft.box.length)&&Ge>0&&xi?hr(xi,Ze.verticalIconBox,i.WritingMode.vertical):{box:null,offscreen:null,occluded:null}}),Ft&&(tt=Ft.box,at=Ft.offscreen,_t=Ft.occluded);let ro=Si(!(!Ft||!Ft.box));if(!tt&&this.prevPlacement){let xi=this.prevPlacement.variableOffsets[ht];xi&&(this.variableOffsets[ht]=xi,this.markUsedJustification(D,xi.anchor,He,ro))}}else{let rn=(hr,ro)=>{let xi=D.getSymbolInstanceTextSize(fe,He,this.transform.zoom,it),Nr=this.collisionIndex.placeCollisionBox(D,xi,hr,new i.Point(0,0),ye,K,R,pe.predicate);return Nr&&Nr.box&&Nr.box.length&&(this.markUsedOrientation(D,ro,He),this.placedOrientations[ht]=ro),Nr};fi(()=>rn(dr,i.WritingMode.horizontal),()=>{let hr=Ze.verticalTextBox;return D.allowVerticalPlacement&&Ge>0&&hr?(hi(hr),rn(hr,i.WritingMode.vertical)):{box:null,offscreen:null,occluded:null}}),Si(!!(Ft&&Ft.box&&Ft.box.length))}}if(Gt=Ft,tt=Gt&&Gt.box&&Gt.box.length>0,at=Gt&&Gt.offscreen,_t=Gt&&Gt.occluded,He.useRuntimeCollisionCircles){let Si=D.text.placedSymbolArray.get(He.centerJustifiedTextSymbolIndex>=0?He.centerJustifiedTextSymbolIndex:He.verticalPlacedTextSymbolIndex),fi=i.evaluateSizeForFeature(D.textSizeData,fe,Si),rn=k.get("text-padding");Mn=this.collisionIndex.placeCollisionCircles(D,ye,Si,D.lineVertexArray,D.glyphOffsetArray,fi,R,z,G,_,Re,pe.predicate,He.collisionCircleDiameter*fi/i.ONE_EM,rn,this.retainedQueryData[D.bucketInstanceId].tileID),tt=ye||Mn.circles.length>0&&!Mn.collisionDetected,at=at&&Mn.offscreen,_t=Mn.occluded}if(Ze.iconFeatureIndex&&(di=Ze.iconFeatureIndex),Ze.iconBox){let Si=fi=>{hi(fi);let rn=Me&&sn?lu(sn.x,sn.y,Ae,Re,this.transform.angle):new i.Point(0,0),hr=D.getSymbolInstanceIconSize(he,this.transform.zoom,He.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(D,hr,fi,rn,_e,K,R,pe.predicate)};Xt&&Xt.box&&Xt.box.length&&Ze.verticalIconBox?(Vt=Si(Ze.verticalIconBox),gt=Vt.box.length>0):(Vt=Si(Ze.iconBox),gt=Vt.box.length>0),at=at&&Vt.offscreen,$t=Vt.occluded}let vr=Q||He.numHorizontalGlyphVertices===0&&Ge===0,To=ue||He.numIconVertices===0;if(vr||To?To?vr||(gt=gt&&tt):tt=gt&&tt:gt=tt=gt&&tt,tt&&Gt&&Gt.box&&this.collisionIndex.insertCollisionBox(Gt.box,k.get("text-ignore-placement"),D.bucketInstanceId,Xt&&Xt.box&&ui?ui:Qn,pe.ID),gt&&Vt&&this.collisionIndex.insertCollisionBox(Vt.box,k.get("icon-ignore-placement"),D.bucketInstanceId,di,pe.ID),Mn&&(tt&&this.collisionIndex.insertCollisionCircles(Mn.circles,k.get("text-ignore-placement"),D.bucketInstanceId,Qn,pe.ID),_)){let Si=D.bucketInstanceId,fi=this.collisionCircleArrays[Si];fi===void 0&&(fi=this.collisionCircleArrays[Si]=new au);for(let rn=0;rn<Mn.circles.length;rn+=4)fi.circles.push(Mn.circles[rn+0]),fi.circles.push(Mn.circles[rn+1]),fi.circles.push(Mn.circles[rn+2]),fi.circles.push(Mn.collisionDetected?1:0)}let is=D.projection.name!=="globe";Fe=Fe&&(is||!_t),je=je&&(is||!$t),this.placements[ht]=new Aa(tt||Fe,gt||je,at||D.justReloaded),h.add(ht)};if(Be){let He=D.getSortedSymbolIndexes(this.transform.angle);for(let it=He.length-1;it>=0;--it){let Ze=He[it];mt(D.symbolInstances.get(Ze),Ze,D.collisionArrays[Ze])}}else for(let He=l.symbolInstanceStart;He<l.symbolInstanceEnd;He++)mt(D.symbolInstances.get(He),He,D.collisionArrays[He]);if(_&&D.bucketInstanceId in this.collisionCircleArrays){let He=this.collisionCircleArrays[D.bucketInstanceId];i.invert(He.invProjMatrix,R),He.viewportMatrix=this.collisionIndex.getViewportMatrix()}D.justReloaded=!1}markUsedJustification(l,h,_,x){let{leftJustifiedTextSymbolIndex:D,centerJustifiedTextSymbolIndex:k,rightJustifiedTextSymbolIndex:R,verticalPlacedTextSymbolIndex:z,crossTileID:G}=_,H=i.getAnchorJustification(h),K=x===i.WritingMode.vertical?z:H==="left"?D:H==="center"?k:H==="right"?R:-1;D>=0&&(l.text.placedSymbolArray.get(D).crossTileID=K>=0&&D!==K?0:G),k>=0&&(l.text.placedSymbolArray.get(k).crossTileID=K>=0&&k!==K?0:G),R>=0&&(l.text.placedSymbolArray.get(R).crossTileID=K>=0&&R!==K?0:G),z>=0&&(l.text.placedSymbolArray.get(z).crossTileID=K>=0&&z!==K?0:G)}markUsedOrientation(l,h,_){let x=h===i.WritingMode.horizontal||h===i.WritingMode.horizontalOnly?h:0,D=h===i.WritingMode.vertical?h:0,{leftJustifiedTextSymbolIndex:k,centerJustifiedTextSymbolIndex:R,rightJustifiedTextSymbolIndex:z,verticalPlacedTextSymbolIndex:G}=_,H=l.text.placedSymbolArray;k>=0&&(H.get(k).placedOrientation=x),R>=0&&(H.get(R).placedOrientation=x),z>=0&&(H.get(z).placedOrientation=x),G>=0&&(H.get(G).placedOrientation=D)}commit(l){this.commitTime=l,this.zoomAtLastRecencyCheck=this.transform.zoom;let h=this.prevPlacement,_=!1;this.prevZoomAdjustment=h?h.zoomAdjustment(this.transform.zoom):0;let x=h?h.symbolFadeChange(l):1,D=h?h.opacities:{},k=h?h.variableOffsets:{},R=h?h.placedOrientations:{};for(let z in this.placements){let G=this.placements[z],H=D[z];H?(this.opacities[z]=new ia(H,x,G.text,G.icon,null,G.clipped),_=_||G.text!==H.text.placed||G.icon!==H.icon.placed):(this.opacities[z]=new ia(null,x,G.text,G.icon,G.skipFade,G.clipped),_=_||G.text||G.icon)}for(let z in D){let G=D[z];if(!this.opacities[z]){let H=new ia(G,x,!1,!1);H.isHidden()||(this.opacities[z]=H,_=_||G.text.placed||G.icon.placed)}}for(let z in k)this.variableOffsets[z]||!this.opacities[z]||this.opacities[z].isHidden()||(this.variableOffsets[z]=k[z]);for(let z in R)this.placedOrientations[z]||!this.opacities[z]||this.opacities[z].isHidden()||(this.placedOrientations[z]=R[z]);_?this.lastPlacementChangeTime=l:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=h?h.lastPlacementChangeTime:l)}updateLayerOpacities(l,h){let _=new Set;for(let x of h){let D=x.getBucket(l);D&&x.latestFeatureIndex&&l.id===D.layerIds[0]&&this.updateBucketOpacities(D,_,x.collisionBoxArray)}}updateBucketOpacities(l,h,_){l.hasTextData()&&l.text.opacityVertexArray.clear(),l.hasIconData()&&l.icon.opacityVertexArray.clear(),l.hasIconCollisionBoxData()&&l.iconCollisionBox.collisionVertexArray.clear(),l.hasTextCollisionBoxData()&&l.textCollisionBox.collisionVertexArray.clear();let x=l.layers[0].layout,D=!!l.layers[0].dynamicFilter(),k=new ia(null,0,!1,!1,!0),R=x.get("text-allow-overlap"),z=x.get("icon-allow-overlap"),G=x.get("text-variable-anchor"),H=x.get("text-rotation-alignment")==="map",K=x.get("text-pitch-alignment")==="map",se=x.get("icon-text-fit")!=="none",le=new ia(null,0,R&&(z||!l.hasIconData()||x.get("icon-optional")),z&&(R||!l.hasTextData()||x.get("text-optional")),!0);!l.collisionArrays&&_&&(l.hasIconCollisionBoxData()||l.hasTextCollisionBoxData())&&l.deserializeCollisionBoxes(_);let fe=(pe,Q,ue)=>{for(let ye=0;ye<Q/4;ye++)pe.opacityVertexArray.emplaceBack(ue)},he=0;for(let pe=0;pe<l.symbolInstances.length;pe++){let Q=l.symbolInstances.get(pe),{numHorizontalGlyphVertices:ue,numVerticalGlyphVertices:ye,crossTileID:_e,numIconVertices:Ae}=Q,Re=h.has(_e),Me=this.opacities[_e];Re?Me=k:Me||(Me=le,this.opacities[_e]=Me),h.add(_e);let Be=ue>0||ye>0,Fe=Ae>0,je=this.placedOrientations[_e],mt=je===i.WritingMode.vertical,He=je===i.WritingMode.horizontal||je===i.WritingMode.horizontalOnly;if(!Be&&!Fe||Me.isHidden()||he++,Be){let it=uu(Me.text);fe(l.text,ue,mt?qi:it),fe(l.text,ye,He?qi:it);let Ze=Me.text.isHidden(),{leftJustifiedTextSymbolIndex:ht,centerJustifiedTextSymbolIndex:Ge,rightJustifiedTextSymbolIndex:tt,verticalPlacedTextSymbolIndex:gt}=Q,at=l.text.placedSymbolArray,_t=Ze||mt?1:0;ht>=0&&(at.get(ht).hidden=_t),Ge>=0&&(at.get(Ge).hidden=_t),tt>=0&&(at.get(tt).hidden=_t),gt>=0&&(at.get(gt).hidden=Ze||He?1:0);let $t=this.variableOffsets[_e];$t&&this.markUsedJustification(l,$t.anchor,Q,je);let sn=this.placedOrientations[_e];sn&&(this.markUsedJustification(l,"left",Q,sn),this.markUsedOrientation(l,sn,Q))}if(Fe){let it=uu(Me.icon),{placedIconSymbolIndex:Ze,verticalPlacedIconSymbolIndex:ht}=Q,Ge=l.icon.placedSymbolArray,tt=Me.icon.isHidden()?1:0;Ze>=0&&(fe(l.icon,Ae,mt?qi:it),Ge.get(Ze).hidden=tt),ht>=0&&(fe(l.icon,Q.numVerticalIconVertices,He?qi:it),Ge.get(ht).hidden=tt)}if(l.hasIconCollisionBoxData()||l.hasTextCollisionBoxData()){let it=l.collisionArrays[pe];if(it){let Ze=new i.Point(0,0),ht=!0;if(it.textBox||it.verticalTextBox){if(G){let tt=this.variableOffsets[_e];tt?(Ze=cl(tt.anchor,tt.width,tt.height,tt.textOffset,tt.textScale),H&&Ze._rotate(K?this.transform.angle:-this.transform.angle)):ht=!1}D&&(ht=!Me.clipped),it.textBox&&dl(l.textCollisionBox.collisionVertexArray,Me.text.placed,!ht||mt,Ze.x,Ze.y),it.verticalTextBox&&dl(l.textCollisionBox.collisionVertexArray,Me.text.placed,!ht||He,Ze.x,Ze.y)}let Ge=ht&&!!(!He&&it.verticalIconBox);it.iconBox&&dl(l.iconCollisionBox.collisionVertexArray,Me.icon.placed,Ge,se?Ze.x:0,se?Ze.y:0),it.verticalIconBox&&dl(l.iconCollisionBox.collisionVertexArray,Me.icon.placed,!Ge,se?Ze.x:0,se?Ze.y:0)}}}if(l.fullyClipped=he===0,l.sortFeatures(this.transform.angle),this.retainedQueryData[l.bucketInstanceId]&&(this.retainedQueryData[l.bucketInstanceId].featureSortOrder=l.featureSortOrder),l.hasTextData()&&l.text.opacityVertexBuffer&&l.text.opacityVertexBuffer.updateData(l.text.opacityVertexArray),l.hasIconData()&&l.icon.opacityVertexBuffer&&l.icon.opacityVertexBuffer.updateData(l.icon.opacityVertexArray),l.hasIconCollisionBoxData()&&l.iconCollisionBox.collisionVertexBuffer&&l.iconCollisionBox.collisionVertexBuffer.updateData(l.iconCollisionBox.collisionVertexArray),l.hasTextCollisionBoxData()&&l.textCollisionBox.collisionVertexBuffer&&l.textCollisionBox.collisionVertexBuffer.updateData(l.textCollisionBox.collisionVertexArray),l.bucketInstanceId in this.collisionCircleArrays){let pe=this.collisionCircleArrays[l.bucketInstanceId];l.placementInvProjMatrix=pe.invProjMatrix,l.placementViewportMatrix=pe.viewportMatrix,l.collisionCircleArray=pe.circles,delete this.collisionCircleArrays[l.bucketInstanceId]}}symbolFadeChange(l){return this.fadeDuration===0?1:(l-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(l){return Math.max(0,(this.transform.zoom-l)/1.5)}hasTransitions(l){return this.stale||l-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(l,h){let _=this.zoomAtLastRecencyCheck===h?1-this.zoomAdjustment(h):1;return this.zoomAtLastRecencyCheck=h,this.commitTime+this.fadeDuration*_>l}setStale(){this.stale=!0}}function dl(m,l,h,_,x){m.emplaceBack(l?1:0,h?1:0,_||0,x||0),m.emplaceBack(l?1:0,h?1:0,_||0,x||0),m.emplaceBack(l?1:0,h?1:0,_||0,x||0),m.emplaceBack(l?1:0,h?1:0,_||0,x||0)}let Wi=Math.pow(2,25),ir=Math.pow(2,24),hl=Math.pow(2,17),cu=Math.pow(2,16),qr=Math.pow(2,9),Do=Math.pow(2,8),jh=Math.pow(2,1);function uu(m){if(m.opacity===0&&!m.placed)return 0;if(m.opacity===1&&m.placed)return 4294967295;let l=m.placed?1:0,h=Math.floor(127*m.opacity);return h*Wi+l*ir+h*hl+l*cu+h*qr+l*Do+h*jh+l}let qi=0;class ac{constructor(l){this._sortAcrossTiles=l.layout.get("symbol-z-order")!=="viewport-y"&&l.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(l,h,_,x,D){let k=this._bucketParts;for(;this._currentTileIndex<l.length;)if(h.getBucketParts(k,x,l[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,D())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,k.sort((R,z)=>R.sortKey-z.sortKey));this._currentPartIndex<k.length;){let R=k[this._currentPartIndex];if(h.placeLayerBucketPart(R,this._seenCrossTileIDs,_,R.symbolInstanceStart===0),this._currentPartIndex++,D())return!0}return!1}}class du{constructor(l,h,_,x,D,k,R,z){this.placement=new ul(l,D,k,R,z),this._currentPlacementIndex=h.length-1,this._forceFullPlacement=_,this._showCollisionBoxes=x,this._done=!1}isDone(){return this._done}continuePlacement(l,h,_){let x=i.exported.now(),D=()=>{let k=i.exported.now()-x;return!this._forceFullPlacement&&k>2};for(;this._currentPlacementIndex>=0;){let k=h[l[this._currentPlacementIndex]],R=this.placement.collisionIndex.transform.zoom;if(k.type==="symbol"&&(!k.minzoom||k.minzoom<=R)&&(!k.maxzoom||k.maxzoom>R)){if(this._inProgressLayer||(this._inProgressLayer=new ac(k)),this._inProgressLayer.continuePlacement(_[k.source],this.placement,this._showCollisionBoxes,k,D))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(l){return this.placement.commit(l),this.placement}}let Oo=512/i.EXTENT/2;class Ii{constructor(l,h,_){this.tileID=l,this.bucketInstanceId=_,this.index=new i.KDBush(h.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];let x=l.canonical.x*i.EXTENT,D=l.canonical.y*i.EXTENT;for(let k=0;k<h.length;k++){let{key:R,crossTileID:z,tileAnchorX:G,tileAnchorY:H}=h.get(k),K=Math.floor((x+G)*Oo),se=Math.floor((D+H)*Oo);this.index.add(K,se),this.keys.push(R),this.crossTileIDs.push(z)}this.index.finish()}findMatches(l,h,_){let x=this.tileID.canonical.z<h.canonical.z?1:Math.pow(2,this.tileID.canonical.z-h.canonical.z),D=Oo/Math.pow(2,h.canonical.z-this.tileID.canonical.z),k=h.canonical.x*i.EXTENT,R=h.canonical.y*i.EXTENT;for(let z=0;z<l.length;z++){let G=l.get(z);if(G.crossTileID)continue;let{key:H,tileAnchorX:K,tileAnchorY:se}=G,le=Math.floor((k+K)*D),fe=Math.floor((R+se)*D),he=this.index.range(le-x,fe-x,le+x,fe+x);for(let pe of he){let Q=this.crossTileIDs[pe];if(this.keys[pe]===H&&!_.has(Q)){_.add(Q),G.crossTileID=Q;break}}}}}class lc{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Vh{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(l){let h=Math.round((l-this.lng)/360);if(h!==0)for(let _ in this.indexes){let x=this.indexes[_],D={};for(let k in x){let R=x[k];R.tileID=R.tileID.unwrapTo(R.tileID.wrap+h),D[R.tileID.key]=R}this.indexes[_]=D}this.lng=l}addBucket(l,h,_){if(this.indexes[l.overscaledZ]&&this.indexes[l.overscaledZ][l.key]){if(this.indexes[l.overscaledZ][l.key].bucketInstanceId===h.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(l.overscaledZ,this.indexes[l.overscaledZ][l.key])}for(let D=0;D<h.symbolInstances.length;D++)h.symbolInstances.get(D).crossTileID=0;this.usedCrossTileIDs[l.overscaledZ]||(this.usedCrossTileIDs[l.overscaledZ]=new Set);let x=this.usedCrossTileIDs[l.overscaledZ];for(let D in this.indexes){let k=this.indexes[D];if(Number(D)>l.overscaledZ)for(let R in k){let z=k[R];z.tileID.isChildOf(l)&&z.findMatches(h.symbolInstances,l,x)}else{let R=k[l.scaledTo(Number(D)).key];R&&R.findMatches(h.symbolInstances,l,x)}}for(let D=0;D<h.symbolInstances.length;D++){let k=h.symbolInstances.get(D);k.crossTileID||(k.crossTileID=_.generate(),x.add(k.crossTileID))}return this.indexes[l.overscaledZ]===void 0&&(this.indexes[l.overscaledZ]={}),this.indexes[l.overscaledZ][l.key]=new Ii(l,h.symbolInstances,h.bucketInstanceId),!0}removeBucketCrossTileIDs(l,h){for(let _ of h.crossTileIDs)this.usedCrossTileIDs[l].delete(_)}removeStaleBuckets(l){let h=!1;for(let _ in this.indexes){let x=this.indexes[_];for(let D in x)l[x[D].bucketInstanceId]||(this.removeBucketCrossTileIDs(_,x[D]),delete x[D],h=!0)}return h}}class ra{constructor(){this.layerIndexes={},this.crossTileIDs=new lc,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(l,h,_,x){let D=this.layerIndexes[l.id];D===void 0&&(D=this.layerIndexes[l.id]=new Vh);let k=!1,R={};x.name!=="globe"&&D.handleWrapJump(_);for(let z of h){let G=z.getBucket(l);G&&l.id===G.layerIds[0]&&(G.bucketInstanceId||(G.bucketInstanceId=++this.maxBucketInstanceId),D.addBucket(z.tileID,G,this.crossTileIDs)&&(k=!0),R[G.bucketInstanceId]=!0)}return D.removeStaleBuckets(R)&&(k=!0),k}pruneUnusedLayers(l){let h={};l.forEach(_=>{h[_]=!0});for(let _ in this.layerIndexes)h[_]||delete this.layerIndexes[_]}}let ka=(m,l)=>i.emitValidationErrors(m,l&&l.filter(h=>h.identifier!=="source.canvas")),hu=i.pick(ri,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection"]),Cr=i.pick(ri,["setCenter","setZoom","setBearing","setPitch"]),Lo={version:8,layers:[],sources:{}},fl={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class bs extends i.Evented{constructor(l,h={}){super(),this.map=l,this.dispatcher=new gr(oc(),this),this.imageManager=new Ja,this.imageManager.setEventedParent(this),this.glyphManager=new i.GlyphManager(l._requestManager,h.localFontFamily?i.LocalGlyphMode.all:h.localIdeographFontFamily?i.LocalGlyphMode.ideographs:i.LocalGlyphMode.none,h.localFontFamily||h.localIdeographFontFamily),this.crossTileSymbolIndex=new ra,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",i.getReferrer());let _=this;this._rtlTextPluginCallback=bs.registerForPluginStateChange(x=>{_.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:x.pluginStatus,pluginURL:x.pluginURL},(D,k)=>{if(i.triggerPluginCompletionEvent(D),k&&k.every(R=>R))for(let R in _._sourceCaches){let z=_._sourceCaches[R],G=z.getSource().type;G!=="vector"&&G!=="geojson"||z.reload()}})}),this.on("data",x=>{if(x.dataType!=="source"||x.sourceDataType!=="metadata")return;let D=this.getSource(x.sourceId);if(D&&D.vectorLayerIds)for(let k in this._layers){let R=this._layers[k];R.source===D.id&&this._validateLayer(R)}})}loadURL(l,h={}){this.fire(new i.Event("dataloading",{dataType:"style"}));let _=typeof h.validate=="boolean"?h.validate:!i.isMapboxURL(l);l=this.map._requestManager.normalizeStyleURL(l,h.accessToken);let x=this.map._requestManager.transformRequest(l,i.ResourceType.Style);this._request=i.getJSON(x,(D,k)=>{this._request=null,D?this.fire(new i.ErrorEvent(D)):k&&this._load(k,_)})}loadJSON(l,h={}){this.fire(new i.Event("dataloading",{dataType:"style"})),this._request=i.exported.frame(()=>{this._request=null,this._load(l,h.validate!==!1)})}loadEmpty(){this.fire(new i.Event("dataloading",{dataType:"style"})),this._load(Lo,!1)}_updateLayerCount(l,h){let _=h?1:-1;l.is3D()&&(this._num3DLayers+=_),l.type==="circle"&&(this._numCircleLayers+=_),l.type==="symbol"&&(this._numSymbolLayers+=_)}_load(l,h){if(h&&ka(this,i.validateStyle(l)))return;this._loaded=!0,this.stylesheet=i.clone$1(l),this._updateMapProjection();for(let x in l.sources)this.addSource(x,l.sources[x],{validate:!1});this._changed=!1,l.sprite?this._loadSprite(l.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(l.glyphs);let _=Lh(this.stylesheet.layers);this._order=_.map(x=>x.id),this._layers={},this._serializedLayers={};for(let x of _){let D=i.createStyleLayer(x);D.setEventedParent(this,{layer:{id:D.id}}),this._layers[D.id]=D,this._serializedLayers[D.id]=D.serialize(),this._updateLayerCount(D,!0)}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new tr(this.stylesheet.light),this.stylesheet.terrain&&!this.terrainSetForDrapingOnly()&&this._createTerrain(this.stylesheet.terrain,1),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new i.Event("data",{dataType:"style"})),this.fire(new i.Event("style.load"))}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}setProjection(l){l?this.stylesheet.projection=l:delete this.stylesheet.projection,this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null))}_updateMapProjection(){this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.stylesheet.projection)}_loadSprite(l){this._spriteRequest=function(h,_,x){let D,k,R,z=i.exported.devicePixelRatio>1?"@2x":"",G=i.getJSON(_.transformRequest(_.normalizeSpriteURL(h,z,".json"),i.ResourceType.SpriteJSON),(se,le)=>{G=null,R||(R=se,D=le,K())}),H=i.getImage(_.transformRequest(_.normalizeSpriteURL(h,z,".png"),i.ResourceType.SpriteImage),(se,le)=>{H=null,R||(R=se,k=le,K())});function K(){if(R)x(R);else if(D&&k){let se=i.exported.getImageData(k),le={};for(let fe in D){let{width:he,height:pe,x:Q,y:ue,sdf:ye,pixelRatio:_e,stretchX:Ae,stretchY:Re,content:Me}=D[fe],Be=new i.RGBAImage({width:he,height:pe});i.RGBAImage.copy(se,Be,{x:Q,y:ue},{x:0,y:0},{width:he,height:pe}),le[fe]={data:Be,pixelRatio:_e,sdf:ye,stretchX:Ae,stretchY:Re,content:Me}}x(null,le)}}return{cancel(){G&&(G.cancel(),G=null),H&&(H.cancel(),H=null)}}}(l,this.map._requestManager,(h,_)=>{if(this._spriteRequest=null,h)this.fire(new i.ErrorEvent(h));else if(_)for(let x in _)this.imageManager.addImage(x,_[x]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.dispatcher.broadcast("spriteLoaded",!0),this.fire(new i.Event("data",{dataType:"style"}))})}_validateLayer(l){let h=this.getSource(l.source);if(!h)return;let _=l.sourceLayer;_&&(h.type==="geojson"||h.vectorLayerIds&&h.vectorLayerIds.indexOf(_)===-1)&&this.fire(new i.ErrorEvent(new Error(`Source layer "${_}" does not exist on source "${h.id}" as specified by style layer "${l.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(let l in this._sourceCaches)if(!this._sourceCaches[l].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(l){let h=[];for(let _ of l){let x=this._layers[_];x.type!=="custom"&&h.push(x.serialize())}return h}hasTransitions(){if(this.light&&this.light.hasTransition()||this.fog&&this.fog.hasTransition())return!0;for(let l in this._sourceCaches)if(this._sourceCaches[l].hasTransition())return!0;for(let l in this._layers)if(this._layers[l].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(l){return!!this.terrain&&(typeof l.isLayerDraped=="function"?l.isLayerDraped():fl[l.type])}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(l){if(!this._loaded)return;let h=this._changed;if(this._changed){let x=Object.keys(this._updatedLayers),D=Object.keys(this._removedLayers);(x.length||D.length)&&this._updateWorkerLayers(x,D);for(let k in this._updatedSources){let R=this._updatedSources[k];R==="reload"?this._reloadSource(k):R==="clear"&&this._clearSource(k)}this._updateTilesForChangedImages();for(let k in this._updatedPaintProps)this._layers[k].updateTransitions(l);this.light.updateTransitions(l),this.fog&&this.fog.updateTransitions(l),this._resetUpdates()}let _={};for(let x in this._sourceCaches){let D=this._sourceCaches[x];_[x]=D.used,D.used=!1}for(let x of this._order){let D=this._layers[x];if(D.recalculate(l,this._availableImages),!D.isHidden(l.zoom)){let R=this._getLayerSourceCache(D);R&&(R.used=!0)}let k=this.map.painter;if(k){let R=D.getProgramIds();if(!R)continue;let z=D.getProgramConfiguration(l.zoom);for(let G of R)k.useProgram(G,z)}}for(let x in _){let D=this._sourceCaches[x];_[x]!==D.used&&D.getSource().fire(new i.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:D.getSource().id}))}this.light.recalculate(l),this.terrain&&this.terrain.recalculate(l),this.fog&&this.fog.recalculate(l),this.z=l.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),h&&this.fire(new i.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){let l=Object.keys(this._changedImages);if(l.length){for(let h in this._sourceCaches)this._sourceCaches[h].reloadTilesForDependencies(["icons","patterns"],l);this._changedImages={}}}_updateWorkerLayers(l,h){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(l),removedIds:h})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(l){if(this._checkLoaded(),ka(this,i.validateStyle(l)))return!1;(l=i.clone$1(l)).layers=Lh(l.layers);let h=function(x,D){if(!x)return[{command:ri.setStyle,args:[D]}];let k=[];try{if(!E(x.version,D.version))return[{command:ri.setStyle,args:[D]}];E(x.center,D.center)||k.push({command:ri.setCenter,args:[D.center]}),E(x.zoom,D.zoom)||k.push({command:ri.setZoom,args:[D.zoom]}),E(x.bearing,D.bearing)||k.push({command:ri.setBearing,args:[D.bearing]}),E(x.pitch,D.pitch)||k.push({command:ri.setPitch,args:[D.pitch]}),E(x.sprite,D.sprite)||k.push({command:ri.setSprite,args:[D.sprite]}),E(x.glyphs,D.glyphs)||k.push({command:ri.setGlyphs,args:[D.glyphs]}),E(x.transition,D.transition)||k.push({command:ri.setTransition,args:[D.transition]}),E(x.light,D.light)||k.push({command:ri.setLight,args:[D.light]}),E(x.fog,D.fog)||k.push({command:ri.setFog,args:[D.fog]}),E(x.projection,D.projection)||k.push({command:ri.setProjection,args:[D.projection]});let R={},z=[];(function(K,se,le,fe){let he;for(he in se=se||{},K=K||{})K.hasOwnProperty(he)&&(se.hasOwnProperty(he)||Sa(he,le,fe));for(he in se){if(!se.hasOwnProperty(he))continue;let pe=se[he];K.hasOwnProperty(he)?E(K[he],pe)||(K[he].type==="geojson"&&pe.type==="geojson"&&bi(K,se,he)?le.push({command:ri.setGeoJSONSourceData,args:[he,pe.data]}):Fh(he,se,le,fe)):iu(he,se,le)}})(x.sources,D.sources,z,R);let G=[];x.layers&&x.layers.forEach(K=>{K.source&&R[K.source]?k.push({command:ri.removeLayer,args:[K.id]}):G.push(K)});let H=x.terrain;H&&R[H.source]&&(k.push({command:ri.setTerrain,args:[void 0]}),H=void 0),k=k.concat(z),E(H,D.terrain)||k.push({command:ri.setTerrain,args:[D.terrain]}),function(K,se,le){se=se||[];let fe=(K=K||[]).map(vs),he=se.map(vs),pe=K.reduce(Nh,{}),Q=se.reduce(Nh,{}),ue=fe.slice(),ye=Object.create(null),_e,Ae,Re,Me,Be,Fe,je;for(_e=0,Ae=0;_e<fe.length;_e++)Re=fe[_e],Q.hasOwnProperty(Re)?Ae++:(le.push({command:ri.removeLayer,args:[Re]}),ue.splice(ue.indexOf(Re,Ae),1));for(_e=0,Ae=0;_e<he.length;_e++)Re=he[he.length-1-_e],ue[ue.length-1-_e]!==Re&&(pe.hasOwnProperty(Re)?(le.push({command:ri.removeLayer,args:[Re]}),ue.splice(ue.lastIndexOf(Re,ue.length-Ae),1)):Ae++,Fe=ue[ue.length-_e],le.push({command:ri.addLayer,args:[Q[Re],Fe]}),ue.splice(ue.length-_e,0,Re),ye[Re]=!0);for(_e=0;_e<he.length;_e++)if(Re=he[_e],Me=pe[Re],Be=Q[Re],!ye[Re]&&!E(Me,Be))if(E(Me.source,Be.source)&&E(Me["source-layer"],Be["source-layer"])&&E(Me.type,Be.type)){for(je in Ko(Me.layout,Be.layout,le,Re,null,ri.setLayoutProperty),Ko(Me.paint,Be.paint,le,Re,null,ri.setPaintProperty),E(Me.filter,Be.filter)||le.push({command:ri.setFilter,args:[Re,Be.filter]}),E(Me.minzoom,Be.minzoom)&&E(Me.maxzoom,Be.maxzoom)||le.push({command:ri.setLayerZoomRange,args:[Re,Be.minzoom,Be.maxzoom]}),Me)Me.hasOwnProperty(je)&&je!=="layout"&&je!=="paint"&&je!=="filter"&&je!=="metadata"&&je!=="minzoom"&&je!=="maxzoom"&&(je.indexOf("paint.")===0?Ko(Me[je],Be[je],le,Re,je.slice(6),ri.setPaintProperty):E(Me[je],Be[je])||le.push({command:ri.setLayerProperty,args:[Re,je,Be[je]]}));for(je in Be)Be.hasOwnProperty(je)&&!Me.hasOwnProperty(je)&&je!=="layout"&&je!=="paint"&&je!=="filter"&&je!=="metadata"&&je!=="minzoom"&&je!=="maxzoom"&&(je.indexOf("paint.")===0?Ko(Me[je],Be[je],le,Re,je.slice(6),ri.setPaintProperty):E(Me[je],Be[je])||le.push({command:ri.setLayerProperty,args:[Re,je,Be[je]]}))}else le.push({command:ri.removeLayer,args:[Re]}),Fe=ue[ue.lastIndexOf(Re)+1],le.push({command:ri.addLayer,args:[Be,Fe]})}(G,D.layers,k)}catch(R){console.warn("Unable to compute style diff:",R),k=[{command:ri.setStyle,args:[D]}]}return k}(this.serialize(),l).filter(x=>!(x.command in Cr));if(h.length===0)return!1;let _=h.filter(x=>!(x.command in hu));if(_.length>0)throw new Error(`Unimplemented: ${_.map(x=>x.command).join(", ")}.`);return h.forEach(x=>{x.command!=="setTransition"&&x.command!=="setProjection"&&this[x.command].apply(this,x.args)}),this.stylesheet=l,this._updateMapProjection(),!0}addImage(l,h){return this.getImage(l)?this.fire(new i.ErrorEvent(new Error("An image with this name already exists."))):(this.imageManager.addImage(l,h),this._afterImageUpdated(l),this)}updateImage(l,h){this.imageManager.updateImage(l,h)}getImage(l){return this.imageManager.getImage(l)}removeImage(l){return this.getImage(l)?(this.imageManager.removeImage(l),this._afterImageUpdated(l),this):this.fire(new i.ErrorEvent(new Error("No image with this name exists.")))}_afterImageUpdated(l){this._availableImages=this.imageManager.listImages(),this._changedImages[l]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new i.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addSource(l,h,_={}){if(this._checkLoaded(),this.getSource(l)!==void 0)throw new Error("There is already a source with this ID");if(!h.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(h).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(h.type)>=0&&this._validate(i.validateSource,`sources.${l}`,h,null,_))return;this.map&&this.map._collectResourceTiming&&(h.collectResourceTiming=!0);let x=vn(l,h,this.dispatcher,this);x.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(l),source:x.serialize(),sourceId:l}));let D=k=>{let R=(k?"symbol:":"other:")+l,z=this._sourceCaches[R]=new i.SourceCache(R,x,k);(k?this._symbolSourceCaches:this._otherSourceCaches)[l]=z,z.style=this,z.onAdd(this.map)};D(!1),h.type!=="vector"&&h.type!=="geojson"||D(!0),x.onAdd&&x.onAdd(this.map),this._changed=!0}removeSource(l){this._checkLoaded();let h=this.getSource(l);if(!h)throw new Error("There is no source with this ID");for(let x in this._layers)if(this._layers[x].source===l)return this.fire(new i.ErrorEvent(new Error(`Source "${l}" cannot be removed while layer "${x}" is using it.`)));if(this.terrain&&this.terrain.get().source===l)return this.fire(new i.ErrorEvent(new Error(`Source "${l}" cannot be removed while terrain is using it.`)));let _=this._getSourceCaches(l);for(let x of _)delete this._sourceCaches[x.id],delete this._updatedSources[x.id],x.fire(new i.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:x.getSource().id})),x.setEventedParent(null),x.clearTiles();return delete this._otherSourceCaches[l],delete this._symbolSourceCaches[l],h.setEventedParent(null),h.onRemove&&h.onRemove(this.map),this._changed=!0,this}setGeoJSONSourceData(l,h){this._checkLoaded(),this.getSource(l).setData(h),this._changed=!0}getSource(l){let h=this._getSourceCache(l);return h&&h.getSource()}_getSources(){let l=[];for(let h in this._otherSourceCaches){let _=this._getSourceCache(h);_&&l.push(_.getSource())}return l}addLayer(l,h,_={}){this._checkLoaded();let x=l.id;if(this.getLayer(x))return void this.fire(new i.ErrorEvent(new Error(`Layer with id "${x}" already exists on this map`)));let D;if(l.type==="custom"){if(ka(this,i.validateCustomStyleLayer(l)))return;D=i.createStyleLayer(l)}else{if(typeof l.source=="object"&&(this.addSource(x,l.source),l=i.clone$1(l),l=i.extend(l,{source:x})),this._validate(i.validateLayer,`layers.${x}`,l,{arrayIndex:-1},_))return;D=i.createStyleLayer(l),this._validateLayer(D),D.setEventedParent(this,{layer:{id:x}}),this._serializedLayers[D.id]=D.serialize(),this._updateLayerCount(D,!0)}let k=h?this._order.indexOf(h):this._order.length;if(h&&k===-1)return void this.fire(new i.ErrorEvent(new Error(`Layer with id "${h}" does not exist on this map.`)));this._order.splice(k,0,x),this._layerOrderChanged=!0,this._layers[x]=D;let R=this._getLayerSourceCache(D);if(this._removedLayers[x]&&D.source&&R&&D.type!=="custom"){let z=this._removedLayers[x];delete this._removedLayers[x],z.type!==D.type?this._updatedSources[D.source]="clear":(this._updatedSources[D.source]="reload",R.pause())}this._updateLayer(D),D.onAdd&&D.onAdd(this.map),this._updateDrapeFirstLayers()}moveLayer(l,h){if(this._checkLoaded(),this._changed=!0,!this._layers[l])return void this.fire(new i.ErrorEvent(new Error(`The layer '${l}' does not exist in the map's style and cannot be moved.`)));if(l===h)return;let _=this._order.indexOf(l);this._order.splice(_,1);let x=h?this._order.indexOf(h):this._order.length;h&&x===-1?this.fire(new i.ErrorEvent(new Error(`Layer with id "${h}" does not exist on this map.`))):(this._order.splice(x,0,l),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}removeLayer(l){this._checkLoaded();let h=this._layers[l];if(!h)return void this.fire(new i.ErrorEvent(new Error(`The layer '${l}' does not exist in the map's style and cannot be removed.`)));h.setEventedParent(null),this._updateLayerCount(h,!1);let _=this._order.indexOf(l);this._order.splice(_,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[l]=h,delete this._layers[l],delete this._serializedLayers[l],delete this._updatedLayers[l],delete this._updatedPaintProps[l],h.onRemove&&h.onRemove(this.map),this._updateDrapeFirstLayers()}getLayer(l){return this._layers[l]}hasLayer(l){return l in this._layers}hasLayerType(l){for(let h in this._layers)if(this._layers[h].type===l)return!0;return!1}setLayerZoomRange(l,h,_){this._checkLoaded();let x=this.getLayer(l);x?x.minzoom===h&&x.maxzoom===_||(h!=null&&(x.minzoom=h),_!=null&&(x.maxzoom=_),this._updateLayer(x)):this.fire(new i.ErrorEvent(new Error(`The layer '${l}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(l,h,_={}){this._checkLoaded();let x=this.getLayer(l);if(x){if(!E(x.filter,h))return h==null?(x.filter=void 0,void this._updateLayer(x)):void(this._validate(i.validateFilter,`layers.${x.id}.filter`,h,{layerType:x.type},_)||(x.filter=i.clone$1(h),this._updateLayer(x)))}else this.fire(new i.ErrorEvent(new Error(`The layer '${l}' does not exist in the map's style and cannot be filtered.`)))}getFilter(l){let h=this.getLayer(l);return h&&i.clone$1(h.filter)}setLayoutProperty(l,h,_,x={}){this._checkLoaded();let D=this.getLayer(l);D?E(D.getLayoutProperty(h),_)||(D.setLayoutProperty(h,_,x),this._updateLayer(D)):this.fire(new i.ErrorEvent(new Error(`The layer '${l}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(l,h){let _=this.getLayer(l);if(_)return _.getLayoutProperty(h);this.fire(new i.ErrorEvent(new Error(`The layer '${l}' does not exist in the map's style.`)))}setPaintProperty(l,h,_,x={}){this._checkLoaded();let D=this.getLayer(l);D?E(D.getPaintProperty(h),_)||(D.setPaintProperty(h,_,x)&&this._updateLayer(D),this._changed=!0,this._updatedPaintProps[l]=!0):this.fire(new i.ErrorEvent(new Error(`The layer '${l}' does not exist in the map's style and cannot be styled.`)))}getPaintProperty(l,h){let _=this.getLayer(l);return _&&_.getPaintProperty(h)}setFeatureState(l,h){this._checkLoaded();let _=l.source,x=l.sourceLayer,D=this.getSource(_);if(!D)return void this.fire(new i.ErrorEvent(new Error(`The source '${_}' does not exist in the map's style.`)));let k=D.type;if(k==="geojson"&&x)return void this.fire(new i.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(k==="vector"&&!x)return void this.fire(new i.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));l.id===void 0&&this.fire(new i.ErrorEvent(new Error("The feature id parameter must be provided.")));let R=this._getSourceCaches(_);for(let z of R)z.setFeatureState(x,l.id,h)}removeFeatureState(l,h){this._checkLoaded();let _=l.source,x=this.getSource(_);if(!x)return void this.fire(new i.ErrorEvent(new Error(`The source '${_}' does not exist in the map's style.`)));let D=x.type,k=D==="vector"?l.sourceLayer:void 0;if(D==="vector"&&!k)return void this.fire(new i.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));if(h&&typeof l.id!="string"&&typeof l.id!="number")return void this.fire(new i.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));let R=this._getSourceCaches(_);for(let z of R)z.removeFeatureState(k,l.id,h)}getFeatureState(l){this._checkLoaded();let h=l.source,_=l.sourceLayer,x=this.getSource(h);if(x){if(x.type!=="vector"||_)return l.id===void 0&&this.fire(new i.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(h)[0].getFeatureState(_,l.id);this.fire(new i.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new i.ErrorEvent(new Error(`The source '${h}' does not exist in the map's style.`)))}getTransition(){return i.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){let l={};for(let h in this._sourceCaches){let _=this._sourceCaches[h].getSource();l[_.id]||(l[_.id]=_.serialize())}return i.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.getTerrain()||void 0,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:l,layers:this._serializeLayers(this._order)},h=>h!==void 0)}_updateLayer(l){this._updatedLayers[l.id]=!0;let h=this._getLayerSourceCache(l);l.source&&!this._updatedSources[l.source]&&h&&h.getSource().type!=="raster"&&(this._updatedSources[l.source]="reload",h.pause()),this._changed=!0,l.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(l){let h=k=>this._layers[k].type==="fill-extrusion",_={},x=[];for(let k=this._order.length-1;k>=0;k--){let R=this._order[k];if(h(R)){_[R]=k;for(let z of l){let G=z[R];if(G)for(let H of G)x.push(H)}}}x.sort((k,R)=>R.intersectionZ-k.intersectionZ);let D=[];for(let k=this._order.length-1;k>=0;k--){let R=this._order[k];if(h(R))for(let z=x.length-1;z>=0;z--){let G=x[z].feature;if(_[G.layer.id]<k)break;D.push(G),x.pop()}else for(let z of l){let G=z[R];if(G)for(let H of G)D.push(H.feature)}}return D}queryRenderedFeatures(l,h,_){h&&h.filter&&this._validate(i.validateFilter,"queryRenderedFeatures.filter",h.filter,null,h);let x={};if(h&&h.layers){if(!Array.isArray(h.layers))return this.fire(new i.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(let z of h.layers){let G=this._layers[z];if(!G)return this.fire(new i.ErrorEvent(new Error(`The layer '${z}' does not exist in the map's style and cannot be queried for features.`))),[];x[G.source]=!0}}let D=[];h.availableImages=this._availableImages;let k=h&&h.layers?h.layers.some(z=>{let G=this.getLayer(z);return G&&G.is3D()}):this.has3DLayers(),R=vo.createFromScreenPoints(l,_);for(let z in this._sourceCaches){let G=this._sourceCaches[z].getSource().id;h.layers&&!x[G]||D.push(Ln(this._sourceCaches[z],this._layers,this._serializedLayers,R,h,_,k,!!this.map._showQueryGeometry))}return this.placement&&D.push(function(z,G,H,K,se,le,fe){let he={},pe=le.queryRenderedSymbols(K),Q=[];for(let ue of Object.keys(pe).map(Number))Q.push(fe[ue]);Q.sort(Hr);for(let ue of Q){let ye=ue.featureIndex.lookupSymbolFeatures(pe[ue.bucketInstanceId],G,ue.bucketIndex,ue.sourceLayerIndex,se.filter,se.layers,se.availableImages,z);for(let _e in ye){let Ae=he[_e]=he[_e]||[],Re=ye[_e];Re.sort((Me,Be)=>{let Fe=ue.featureSortOrder;if(Fe){let je=Fe.indexOf(Me.featureIndex);return Fe.indexOf(Be.featureIndex)-je}return Be.featureIndex-Me.featureIndex});for(let Me of Re)Ae.push(Me)}}for(let ue in he)he[ue].forEach(ye=>{let _e=ye.feature,Ae=H(z[ue]);if(!Ae)return;let Re=Ae.getFeatureState(_e.layer["source-layer"],_e.id);_e.source=_e.layer.source,_e.layer["source-layer"]&&(_e.sourceLayer=_e.layer["source-layer"]),_e.state=Re});return he}(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),R.screenGeometry,h,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(D)}querySourceFeatures(l,h){h&&h.filter&&this._validate(i.validateFilter,"querySourceFeatures.filter",h.filter,null,h);let _=this._getSourceCaches(l),x=[];for(let D of _)x=x.concat(nr(D,h));return x}addSourceType(l,h,_){return bs.getSourceType(l)?_(new Error(`A source type called "${l}" already exists.`)):(bs.setSourceType(l,h),h.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:l,url:h.workerSourceURL},_):_(null,null))}getLight(){return this.light.getLight()}setLight(l,h={}){this._checkLoaded();let _=this.light.getLight(),x=!1;for(let k in l)if(!E(l[k],_[k])){x=!0;break}if(!x)return;let D=this._setTransitionParameters({duration:300,delay:0});this.light.setLight(l,h),this.light.updateTransitions(D)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(l,h=1){if(this._checkLoaded(),!l)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);let _=l;if(h===1){if(typeof _.source=="object"){let x="terrain-dem-src";this.addSource(x,_.source),_=i.clone$1(_),_=i.extend(_,{source:x})}if(this._validate(i.validateTerrain,"terrain",_))return}if(!this.terrain||this.terrain&&h!==this.terrain.drapeRenderMode){if(!_)return;this._createTerrain(_,h)}else{let x=this.terrain,D=x.get();for(let k of Object.keys(i.spec.terrain))!_.hasOwnProperty(k)&&i.spec.terrain[k].default&&(_[k]=i.spec.terrain[k].default);for(let k in _)if(!E(_[k],D[k])){x.set(_),this.stylesheet.terrain=_;let R=this._setTransitionParameters({duration:0});x.updateTransitions(R);break}}this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(l){let h=this.fog=new Yo(l,this.map.transform);this.stylesheet.fog=l;let _=this._setTransitionParameters({duration:0});h.updateTransitions(_)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(let l of this.map._markers)l._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(l){if(this._checkLoaded(),!l)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){let h=this.fog,_=h.get();Object.keys(l).length===0&&h.set(l);for(let x in l)if(!E(l[x],_[x])){h.set(l),this.stylesheet.fog=l;let D=this._setTransitionParameters({duration:0});h.updateTransitions(D);break}}else this._createFog(l);this._markersNeedUpdate=!0}_setTransitionParameters(l){return{now:i.exported.now(),transition:i.extend(l,this.stylesheet.transition)}}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;let l=this._order.filter(_=>this.isLayerDraped(this._layers[_])),h=this._order.filter(_=>!this.isLayerDraped(this._layers[_]));this._drapedFirstOrder=[],this._drapedFirstOrder.push(...l),this._drapedFirstOrder.push(...h)}_createTerrain(l,h){let _=this.terrain=new Zs(l,h);this.stylesheet.terrain=l,this.dispatcher.broadcast("enableTerrain",!this.terrainSetForDrapingOnly()),this._force3DLayerUpdate();let x=this._setTransitionParameters({duration:0});_.updateTransitions(x)}_force3DLayerUpdate(){for(let l in this._layers){let h=this._layers[l];h.type==="fill-extrusion"&&this._updateLayer(h)}}_forceSymbolLayerUpdate(){for(let l in this._layers){let h=this._layers[l];h.type==="symbol"&&this._updateLayer(h)}}_validate(l,h,_,x,D={}){return(!D||D.validate!==!1)&&ka(this,l.call(i.validateStyle,i.extend({key:h,style:this.serialize(),value:_,styleSpec:i.spec},x)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),i.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(let l in this._layers)this._layers[l].setEventedParent(null);for(let l in this._sourceCaches)this._sourceCaches[l].clearTiles(),this._sourceCaches[l].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(l){let h=this._getSourceCaches(l);for(let _ of h)_.clearTiles()}_reloadSource(l){let h=this._getSourceCaches(l);for(let _ of h)_.resume(),_.reload()}_reloadSources(){for(let l of this._getSources())l.reload&&l.reload()}_updateSources(l){for(let h in this._sourceCaches)this._sourceCaches[h].update(l)}_generateCollisionBoxes(){for(let l in this._sourceCaches){let h=this._sourceCaches[l];h.resume(),h.reload()}}_updatePlacement(l,h,_,x,D=!1){let k=!1,R=!1,z={};for(let G of this._order){let H=this._layers[G];if(H.type!=="symbol")continue;if(!z[H.source]){let se=this._getLayerSourceCache(H);if(!se)continue;z[H.source]=se.getRenderableIds(!0).map(le=>se.getTileByID(le)).sort((le,fe)=>fe.tileID.overscaledZ-le.tileID.overscaledZ||(le.tileID.isLessThan(fe.tileID)?-1:1))}let K=this.crossTileSymbolIndex.addLayer(H,z[H.source],l.center.lng,l.projection);k=k||K}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),D=D||this._layerOrderChanged||_===0,this._layerOrderChanged&&this.fire(new i.Event("neworder")),(D||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(i.exported.now(),l.zoom))&&(this.pauseablePlacement=new du(l,this._order,D,h,_,x,this.placement,this.fog&&l.projection.supportsFog?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,z),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(i.exported.now()),R=!0),k&&this.pauseablePlacement.placement.setStale()),R||k)for(let G of this._order){let H=this._layers[G];H.type==="symbol"&&this.placement.updateLayerOpacities(H,z[H.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(i.exported.now())}_releaseSymbolFadeTiles(){for(let l in this._sourceCaches)this._sourceCaches[l].releaseSymbolFadeTiles()}getImages(l,h,_){this.imageManager.getImages(h.icons,_),this._updateTilesForChangedImages();let x=D=>{D&&D.setDependencies(h.tileID.key,h.type,h.icons)};x(this._otherSourceCaches[h.source]),x(this._symbolSourceCaches[h.source])}getGlyphs(l,h,_){this.glyphManager.getGlyphs(h.stacks,_)}getResource(l,h,_){return i.makeRequest(h,_)}_getSourceCache(l){return this._otherSourceCaches[l]}_getLayerSourceCache(l){return l.type==="symbol"?this._symbolSourceCaches[l.source]:this._otherSourceCaches[l.source]}_getSourceCaches(l){let h=[];return this._otherSourceCaches[l]&&h.push(this._otherSourceCaches[l]),this._symbolSourceCaches[l]&&h.push(this._symbolSourceCaches[l]),h}_isSourceCacheLoaded(l){let h=this._getSourceCaches(l);return h.length===0?(this.fire(new i.ErrorEvent(new Error(`There is no source with ID '${l}'`))),!1):h.every(_=>_.loaded())}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}bs.getSourceType=function(m){return dn[m]},bs.setSourceType=function(m,l){dn[m]=l},bs.registerForPluginStateChange=i.registerForPluginStateChange;var vd=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#define EXTENT 8192.0
#define HALF_PI PI/2.0
#define QUARTER_PI PI/4.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0`,es="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",oa=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)
{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}
#ifdef TERRAIN
#ifdef TERRAIN_DEM_FLOAT_FORMAT
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;
#else
uniform sampler2D u_dem;uniform sampler2D u_dem_prev;
#endif
uniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));
#ifdef TERRAIN_DEM_NEAREST_FILTER
return u_exaggeration*tl;
#endif
float tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(
unpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))
);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
float tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;
#else
vec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);
#endif
return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }
#endif`,Ra=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,xs=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump float u_fog_temporal_offset;varying vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`;let ws={},pl={},fu=[];ml(vd,fu),ml(oa,fu),ml(Ra,fu),ml(xs,fu),ws=Kn("",oa),pl=Kn(xs,Ra);let cc=Kn(`
#if __VERSION__ >=300
#define varying in
#define gl_FragColor glFragColor
#define texture2D texture
#define textureCube texture
out vec4 glFragColor;
#endif
highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}`,`
#if __VERSION__ >=300
#define attribute in
#define varying out
#define texture2D texture
#endif
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered.`),pu=vd,bd=`
#ifdef GL_ES
precision mediump float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`;var mu={background:Kn(`uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
varying vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform vec4 u_color;varying vec4 v_color;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting(u_color);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:Kn(`uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos;void main() {vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:Kn(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
gl_FragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:Kn("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Kn(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {gl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:Kn(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:Kn("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:Kn("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}",`attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:Kn("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}",`attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;
#endif
varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),fill:Kn(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutline:Kn(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:Kn(`uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;varying vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;varying vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:Kn(`uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:Kn(`varying vec4 v_color;
#ifdef RENDER_SHADOWS
varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef ZERO_ROOF_RADIUS
varying vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
varying highp vec3 v_normal;
#endif
void main() {
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
vec3 normal=v_normal;
#endif
float z;vec4 color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);color=mix(v_color,v_roof_color,z);
#else
color=v_color;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);color.rgb=color.rgb*shade;
#endif
#ifdef RENDER_SHADOWS
#ifdef ZERO_ROOF_RADIUS
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#endif
color.xyz=shadowed_color_normal(color.xyz,normalize(normal),v_pos_light_view_0,v_pos_light_view_1,v_depth);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec4 v_color;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;
#endif
#ifdef ZERO_ROOF_RADIUS
varying vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
varying highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
v_normal=normal;
#endif
base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele;vec3 pos;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);
#ifdef RENDER_SHADOWS
v_pos_light_view_0=u_light_matrix_0*vec4(pos,1);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1);v_depth=gl_Position.w;
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}v_color=vec4(0.0,0.0,0.0,1.0);
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting(color,NdotL);
#else
v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));
#endif
v_color*=u_opacity;
#ifdef ZERO_ROOF_RADIUS
v_roof_color=vec4(0.0,0.0,0.0,1.0);
#ifdef LIGHTING_3D_MODE
v_roof_color=apply_lighting(color,calculate_NdotL(vec3(0.0,0.0,1.0)));
#else
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));
#endif
v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionPattern:Kn(`uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
varying float v_NdotL;
#endif
varying vec2 v_pos;varying vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,v_NdotL)*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec2 v_pos;varying vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
varying float v_NdotL;
#endif
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_NdotL=NdotL;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif 
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),hillshadePrepare:Kn(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
return texture2D(u_image,coord).a/4.0;
#else
vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;
#endif
}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Kn(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
gl_FragColor=apply_lighting(gl_FragColor);
#endif
#ifdef FOG
gl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:Kn(`uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;varying vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
uniform float u_border_width;uniform vec4 u_border_color;float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture2D(u_dash_image,v_tex).a;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture2D(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
float trimmed=1.0;
#ifdef RENDER_LINE_TRIM_OFFSET
highp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);trimmed=0.0;}}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef RENDER_LINE_ALPHA_DISCARD
if (alpha < u_alpha_discard_threshold) {discard;}
#endif
#ifdef RENDER_LINE_BORDER
float edgeBlur=(u_border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);
#ifdef RENDER_LINE_BORDER_AUTO
float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}
#else
out_color.rgb=mix(u_border_color.rgb*u_border_color.a*trimmed,out_color.rgb,smoothAlpha);
#endif
}
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define EXTRUDE_SCALE 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
attribute highp vec4 a_packed;
#endif
#ifdef RENDER_LINE_DASH
attribute float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;varying vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);
#else
v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),linePattern:Kn(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;vec2 pattern_size=vec2(display_size.x/u_tile_units_to_pixels,display_size.y);float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x=mod(v_linesofar/pattern_size.x*aspect,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));vec4 color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
color=apply_lighting(color);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),raster:Kn(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply(out_color,v_fog_pos));
#endif
gl_FragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {float w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,0,w);v_pos0=a_texture_pos/8192.0;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),symbolIcon:Kn(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;}`),symbolSDF:Kn(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float gamma_scale=gl_Position.w;float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade);}`),symbolTextAndIcon:Kn(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade,is_sdf);}`),terrainRaster:Kn(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#endif
void main() {vec4 color=texture2D(u_image0,v_pos0);
#ifdef RENDER_SHADOWS
color.xyz=shadowed_color(color.xyz,v_pos_light_view_0,v_pos_light_view_1,v_depth);
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#endif
const float wireframeOffset=0.00015;void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;
#ifdef TERRAIN_WIREFRAME
elevation+=wireframeOffset;
#endif
v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);v_depth=gl_Position.w;
#endif
}`),terrainDepth:Kn(`#ifdef GL_ES
precision highp float;
#endif
varying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}`,"uniform mat4 u_matrix;attribute vec2 a_pos;varying float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:Kn(`
varying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,es),skyboxGradient:Kn(`varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,es),skyboxCapture:Kn(`
varying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;
#ifdef GL_ES
precision highp float;
#endif
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}`,"attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:Kn(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture2D(u_image0,v_pos0);color=vec4(raster.rgb*antialias,raster.a*antialias);
#else
color=texture2D(u_image0,v_pos0);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;
#ifdef GLOBE_POLES
attribute vec3 a_globe_pos;attribute vec2 a_uv;
#else
attribute vec2 a_pos;
#endif
varying vec2 v_pos0;const float wireframeOffset=1e3;float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(QUARTER_PI+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;
#ifdef GLOBE_POLES
vec3 up_vector=globe_derived_up_vector;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);
#ifdef TERRAIN_WIREFRAME
height+=wireframeOffset;
#endif
globe_pos+=up_vector*height;
#ifndef GLOBE_POLES
globe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;
#endif
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:Kn(`uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec3 u_start_color;uniform vec4 u_color;uniform vec4 u_space_color;uniform vec4 u_high_color;uniform float u_star_intensity;uniform float u_star_size;uniform float u_star_density;uniform float u_horizon_angle;uniform mat4 u_rotation_matrix;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;highp float random(highp vec3 p) {p=fract(p*vec3(23.2342,97.1231,91.2342));p+=dot(p.zxy,p.yxz+123.1234);return fract(p.x*p.y);}float stars(vec3 p,float scale,vec2 offset) {vec2 uv_scale=(u_viewport/u_star_size)*scale;vec3 position=vec3(p.xy*uv_scale+offset*u_viewport,p.z);vec3 q=fract(position)-0.5;vec3 id=floor(position);float random_visibility=step(random(id),u_star_density);float circle=smoothstep(0.5+u_star_intensity,0.5,length(q));return circle*random_visibility;}void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {discard;return;}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(dot(dir,horizon_dir)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;float closest_point_to_center=length(closest_point-u_globe_pos);float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c =mix(color_stop_2,c2,t);float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);vec2 uv=gl_FragCoord.xy/u_viewport-0.5;float aspect_ratio=u_viewport.x/u_viewport.y;vec4 uv_dir=vec4(normalize(vec3(uv.x*aspect_ratio,uv.y,1.0)),1.0);uv_dir=u_rotation_matrix*uv_dir;vec3 n=abs(uv_dir.xyz);vec2 uv_remap=(n.x > n.y && n.x > n.z) ? uv_dir.yz/uv_dir.x:
(n.y > n.x && n.y > n.z) ? uv_dir.zx/uv_dir.y:
uv_dir.xy/uv_dir.z;uv_remap.x/=aspect_ratio;vec3 D=vec3(uv_remap,1.0);highp float star_field=0.0;if (u_star_intensity > 0.0) {star_field+=stars(D,1.2,vec2(0.0,0.0));star_field+=stars(D,1.0,vec2(1.0,0.0));star_field+=stars(D,0.8,vec2(0.0,1.0));star_field+=stars(D,0.6,vec2(1.0,1.0));star_field*=(1.0-pow(t,0.25+(1.0-u_high_color.a)*0.75));c+=star_field*alpha_2;}c=dither(c,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=vec4(c,a);}`,`attribute vec3 a_pos;attribute vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`)};function ml(m,l){let h=m.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let _ of h)if(_=_.trim(),_[0]==="#"&&_.includes("if")&&!_.includes("endif")){_=_.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();let x=_.split(" ");for(let D of x)l.includes(D)||l.push(D)}}function Kn(m,l){let h=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,_=l.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),x={},D=[...fu];return ml(m,D),ml(l,D),{fragmentSource:m=m.replace(h,(k,R,z,G,H)=>(x[H]=!0,R==="define"?`
#ifndef HAS_UNIFORM_u_${H}
varying ${z} ${G} ${H};
#else
uniform ${z} ${G} u_${H};
#endif
`:`
#ifdef HAS_UNIFORM_u_${H}
    ${z} ${G} ${H} = u_${H};
#endif
`)),vertexSource:l=l.replace(h,(k,R,z,G,H)=>{let K=G==="float"?"vec2":"vec4",se=H.match(/color/)?"color":K;return x[H]?R==="define"?`
#ifndef HAS_UNIFORM_u_${H}
uniform lowp float u_${H}_t;
attribute ${z} ${K} a_${H};
varying ${z} ${G} ${H};
#else
uniform ${z} ${G} u_${H};
#endif
`:se==="vec4"?`
#ifndef HAS_UNIFORM_u_${H}
    ${H} = a_${H};
#else
    ${z} ${G} ${H} = u_${H};
#endif
`:`
#ifndef HAS_UNIFORM_u_${H}
    ${H} = unpack_mix_${se}(a_${H}, u_${H}_t);
#else
    ${z} ${G} ${H} = u_${H};
#endif
`:R==="define"?`
#ifndef HAS_UNIFORM_u_${H}
uniform lowp float u_${H}_t;
attribute ${z} ${K} a_${H};
#else
uniform ${z} ${G} u_${H};
#endif
`:se==="vec4"?`
#ifndef HAS_UNIFORM_u_${H}
    ${z} ${G} ${H} = a_${H};
#else
    ${z} ${G} ${H} = u_${H};
#endif
`:`
#ifndef HAS_UNIFORM_u_${H}
    ${z} ${G} ${H} = unpack_mix_${se}(a_${H}, u_${H}_t);
#else
    ${z} ${G} ${H} = u_${H};
#endif
`}),staticAttributes:_,usedDefines:D}}class Qg{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(l,h,_,x,D,k,R){this.context=l;let z=this.boundPaintVertexBuffers.length!==x.length;for(let H=0;!z&&H<x.length;H++)this.boundPaintVertexBuffers[H]!==x[H]&&(z=!0);let G=this.boundDynamicVertexBuffers.length!==R.length;for(let H=0;!G&&H<R.length;H++)this.boundDynamicVertexBuffers[H]!==R[H]&&(G=!0);if(!l.extVertexArrayObject||!this.vao||this.boundProgram!==h||this.boundLayoutVertexBuffer!==_||z||G||this.boundIndexBuffer!==D||this.boundVertexOffset!==k)this.freshBind(h,_,x,D,k,R);else{l.bindVertexArrayOES.set(this.vao);for(let H of R)H&&H.bind();D&&D.dynamicDraw&&D.bind()}}freshBind(l,h,_,x,D,k){let R,z=l.numAttributes,G=this.context,H=G.gl;if(G.extVertexArrayObject)this.vao&&this.destroy(),this.vao=G.extVertexArrayObject.createVertexArrayOES(),G.bindVertexArrayOES.set(this.vao),R=0,this.boundProgram=l,this.boundLayoutVertexBuffer=h,this.boundPaintVertexBuffers=_,this.boundIndexBuffer=x,this.boundVertexOffset=D,this.boundDynamicVertexBuffers=k;else{R=G.currentNumAttributes||0;for(let K=z;K<R;K++)H.disableVertexAttribArray(K)}h.enableAttributes(H,l),h.bind(),h.setVertexAttribPointers(H,l,D);for(let K of _)K.enableAttributes(H,l),K.bind(),K.setVertexAttribPointers(H,l,D);for(let K of k)K&&(K.enableAttributes(H,l),K.bind(),K.setVertexAttribPointers(H,l,D));x&&x.bind(),G.currentNumAttributes=z}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function xd(m,l){let h=Math.pow(2,l.canonical.z),_=l.canonical.y;return[new i.MercatorCoordinate(0,_/h).toLngLat().lat,new i.MercatorCoordinate(0,(_+1)/h).toLngLat().lat]}function wd(m,l,h,_,x,D,k){let R=m.context,z=R.gl,G=h.fbo;if(!G)return;m.prepareDrawTile();let H=m.useProgram("hillshade");R.activeTexture.set(z.TEXTURE0),z.bindTexture(z.TEXTURE_2D,G.colorAttachment.get());let K=((he,pe,Q,ue)=>{let ye=Q.paint.get("hillshade-shadow-color"),_e=Q.paint.get("hillshade-highlight-color"),Ae=Q.paint.get("hillshade-accent-color"),Re=Q.paint.get("hillshade-illumination-direction")*(Math.PI/180);Q.paint.get("hillshade-illumination-anchor")==="viewport"&&(Re-=he.transform.angle);let Me=!he.options.moving;return{u_matrix:ue||he.transform.calculateProjMatrix(pe.tileID.toUnwrapped(),Me),u_image:0,u_latrange:xd(0,pe.tileID),u_light:[Q.paint.get("hillshade-exaggeration"),Re],u_shadow:ye,u_highlight:_e,u_accent:Ae}})(m,h,_,m.terrain?l.projMatrix:null);m.prepareDrawProgram(R,H,l.toUnwrapped());let{tileBoundsBuffer:se,tileBoundsIndexBuffer:le,tileBoundsSegments:fe}=m.getTileBoundsBuffers(h);H.draw(R,z.TRIANGLES,x,D,k,i.CullFaceMode.disabled,K,_.id,se,le,fe)}function Uh(m,l,h){if(!l.needsDEMTextureUpload)return;let _=m.context,x=_.gl;_.pixelStoreUnpackPremultiplyAlpha.set(!1),l.demTexture=l.demTexture||m.getTileTexture(h.stride);let D=h.getPixels();l.demTexture?l.demTexture.update(D,{premultiply:!1}):l.demTexture=new i.Texture(_,D,x.RGBA,{premultiply:!1}),l.needsDEMTextureUpload=!1}function Tp(m,l,h,_,x,D){let k=m.context,R=k.gl;if(!l.dem)return;let z=l.dem;if(k.activeTexture.set(R.TEXTURE1),Uh(m,l,z),!l.demTexture)return;l.demTexture.bind(R.NEAREST,R.CLAMP_TO_EDGE);let G=z.dim;k.activeTexture.set(R.TEXTURE0);let H=l.fbo;if(!H){let fe=new i.Texture(k,{width:G,height:G,data:null},R.RGBA);fe.bind(R.LINEAR,R.CLAMP_TO_EDGE),H=l.fbo=k.createFramebuffer(G,G,!0),H.colorAttachment.set(fe.texture)}k.bindFramebuffer.set(H.framebuffer),k.viewport.set([0,0,G,G]);let{tileBoundsBuffer:K,tileBoundsIndexBuffer:se,tileBoundsSegments:le}=m.getMercatorTileBoundsBuffers();m.useProgram("hillshadePrepare").draw(k,R.TRIANGLES,_,x,D,i.CullFaceMode.disabled,((fe,he)=>{let pe=he.stride,Q=i.create();return i.ortho(Q,0,i.EXTENT,-i.EXTENT,0,0,1),i.translate(Q,Q,[0,-i.EXTENT,0]),{u_matrix:Q,u_image:1,u_dimension:[pe,pe],u_zoom:fe.overscaledZ,u_unpack:he.unpackVector}})(l.tileID,z),h.id,K,se,le),l.needsHillshadePrepare=!1}let $h=m=>({u_matrix:new i.UniformMatrix4f(m),u_image0:new i.Uniform1i(m),u_skirt_height:new i.Uniform1f(m)}),uc=(m,l)=>({u_matrix:m,u_image0:0,u_skirt_height:l}),Cd=(m,l,h,_,x,D,k,R,z,G,H,K,se,le,fe)=>({u_proj_matrix:Float32Array.from(m),u_globe_matrix:l,u_normalize_matrix:Float32Array.from(_),u_merc_matrix:h,u_zoom_transition:x,u_merc_center:D,u_image0:0,u_frustum_tl:k,u_frustum_tr:R,u_frustum_br:z,u_frustum_bl:G,u_globe_pos:H,u_globe_radius:K,u_viewport:se,u_grid_matrix:fe?Float32Array.from(fe):new Float32Array(9),u_skirt_height:le});function Pa(m,l){return m!=null&&l!=null&&!(!m.hasData()||!l.hasData())&&m.demTexture!=null&&l.demTexture!=null&&m.tileID.key!==l.tileID.key}let sa=new class{constructor(){this.operations={}}newMorphing(m,l,h,_,x){if(m in this.operations){let D=this.operations[m];D.to.tileID.key!==h.tileID.key&&(D.queued=h)}else this.operations[m]={startTime:_,phase:0,duration:x,from:l,to:h,queued:null}}getMorphValuesForProxy(m){if(!(m in this.operations))return null;let l=this.operations[m];return{from:l.from,to:l.to,phase:l.phase}}update(m){for(let l in this.operations){let h=this.operations[l];for(h.phase=(m-h.startTime)/h.duration;h.phase>=1||!this._validOp(h);)if(!this._nextOp(h,m)){delete this.operations[l];break}}}_nextOp(m,l){return!!m.queued&&(m.from=m.to,m.to=m.queued,m.queued=null,m.phase=0,m.startTime=l,!0)}_validOp(m){return m.from.hasData()&&m.to.hasData()}},gl={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function Ed(m){return 6*Math.pow(1.5,22-m)}function Hh(m,l){let h=1<<m.z;return!l&&(m.x===0||m.x===h-1)||m.y===0||m.y===h-1}let Cs=m=>({u_matrix:m});function Dd(m,l,h,_,x){if(x>0){let D=i.exported.now(),k=(D-m.timeAdded)/x,R=l?(D-l.timeAdded)/x:-1,z=h.getSource(),G=_.coveringZoomLevel({tileSize:z.tileSize,roundZoom:z.roundZoom}),H=!l||Math.abs(l.tileID.overscaledZ-G)>Math.abs(m.tileID.overscaledZ-G),K=H&&m.refreshedUponExpiration?1:i.clamp(H?k:1-R,0,1);return m.refreshedUponExpiration&&k>=1&&(m.refreshedUponExpiration=!1),l?{opacity:1,mix:1-K}:{opacity:K,mix:0}}return{opacity:1,mix:0}}class Md extends i.SourceCache{constructor(l){let h={type:"raster-dem",maxzoom:l.transform.maxZoom},_=new gr(oc(),null),x=vn("mock-dem",h,_,l.style);super("mock-dem",x,!1),x.setEventedParent(this),this._sourceLoaded=!0}_loadTile(l,h){l.state="loaded",h(null)}}class Td extends i.SourceCache{constructor(l){let h=vn("proxy",{type:"geojson",maxzoom:l.transform.maxZoom},new gr(oc(),null),l.style);super("proxy",h,!1),h.setEventedParent(this),this.map=this.getSource().map=l,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(l,h,_){if(l.freezeTileCoverage)return;this.transform=l;let x=l.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((D,k)=>{if(D[k.key]="",!this._tiles[k.key]){let R=new i.Tile(k,this._source.tileSize*k.overscaleFactor(),l.tileZoom);R.state="loaded",this._tiles[k.key]=R}return D},{});for(let D in this._tiles)D in x||(this.freeFBO(D),this._tiles[D].unloadVectorData(),delete this._tiles[D])}freeFBO(l){let h=this.proxyCachedFBO[l];if(h!==void 0){let _=Object.values(h);this.renderCachePool.push(..._),delete this.proxyCachedFBO[l]}}deallocRenderCache(){this.renderCache.forEach(l=>l.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class Id extends i.OverscaledTileID{constructor(l,h,_){super(l.overscaledZ,l.wrap,l.canonical.z,l.canonical.x,l.canonical.y),this.proxyTileKey=h,this.projMatrix=_}}class Gh extends i.Elevation{constructor(l,h){super(),this.painter=l,this.terrainTileForTile={},this.prevTerrainTileForTile={};let[_,x,D]=function(z){let G=new i.StructArrayLayout2i4,H=new i.StructArrayLayout3ui6,K=131;G.reserve(17161),H.reserve(33800);let se=i.EXTENT/128,le=i.EXTENT+se/2,fe=le+se;for(let pe=-se;pe<fe;pe+=se)for(let Q=-se;Q<fe;Q+=se){let ue=Q<0||Q>le||pe<0||pe>le?24575:0,ye=i.clamp(Math.round(Q),0,i.EXTENT),_e=i.clamp(Math.round(pe),0,i.EXTENT);G.emplaceBack(ye+ue,_e)}let he=(pe,Q)=>{let ue=Q*K+pe;H.emplaceBack(ue+1,ue,ue+K),H.emplaceBack(ue+K,ue+K+1,ue+1)};for(let pe=1;pe<129;pe++)for(let Q=1;Q<129;Q++)he(Q,pe);return[0,129].forEach(pe=>{for(let Q=0;Q<130;Q++)he(Q,pe),he(pe,Q)}),[G,H,32768]}(),k=l.context;this.gridBuffer=k.createVertexBuffer(_,i.posAttributes.members),this.gridIndexBuffer=k.createIndexBuffer(x),this.gridSegments=i.SegmentVector.simpleSegment(0,0,_.length,x.length),this.gridNoSkirtSegments=i.SegmentVector.simpleSegment(0,0,_.length,D),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new Td(h.map),this.orthoMatrix=i.create(),i.ortho(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,i.EXTENT,0,i.EXTENT,0,1);let R=k.gl;this._overlapStencilMode=new i.StencilMode({func:R.GEQUAL,mask:255},0,255,R.KEEP,R.KEEP,R.REPLACE),this._previousZoom=l.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=h,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new Md(h.map)}set style(l){l.on("data",this._onStyleDataEvent.bind(this)),l.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=l,this._checkRenderCacheEfficiency(),this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(l,h,_){if(l&&l.terrain){this._style!==l&&(this.style=l),this.enabled=!0;let x=l.terrain.properties;this.sourceCache=l.terrain.drapeRenderMode===0?this._mockSourceCache:l._getSourceCache(x.get("source")),this._exaggeration=x.get("exaggeration");let D=()=>{this.sourceCache.used&&i.warnOnce(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);let k=this.getScaledDemTileSize();this.sourceCache.update(h,k,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,D(),this._initializing=!0),D(),h.updateElevation(!0,_),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(h),this._emptyDEMTextureDirty=!0}else this._disable()}resetTileLookupCache(l){this._findCoveringTileCache[l]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_checkRenderCacheEfficiency(){let l=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||l.efficiency!==100&&i.warnOnce(`Terrain render cache efficiency is not optimal (${l.efficiency}%) and performance
                may be affected negatively, consider placing all background, fill and line layers before layer
                with id '${l.firstUndrapedLayer}' or create a map using optimizeForTerrain: true option.`)}_onStyleDataEvent(l){l.coord&&l.dataType==="source"?this._clearRenderCacheForTile(l.sourceCacheId,l.coord):l.dataType==="style"&&(this._invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(let l in this._style._sourceCaches)this._style._sourceCaches[l].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(l=>l.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0)}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){let l=2*this.proxySourceCache.getSource().tileSize;return[l,l]}set useVertexMorphing(l){this._useVertexMorphing=l}updateTileBinding(l){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;let h=this.proxySourceCache,_=this.painter.transform;this._initializing&&(this._initializing=_._centerAltitude===0&&this.getAtPointOrZero(i.MercatorCoordinate.fromLngLat(_.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);let x=this.proxyCoords=h.getIds().map(z=>{let G=h.getTileByID(z).tileID;return G.projMatrix=_.calculateProjMatrix(G.toUnwrapped()),G});(function(z,G){let H=G.transform.pointCoordinate(G.transform.getCameraPoint()),K=new i.Point(H.x,H.y);z.sort((se,le)=>{if(le.overscaledZ-se.overscaledZ)return le.overscaledZ-se.overscaledZ;let fe=new i.Point(se.canonical.x+(1<<se.canonical.z)*se.wrap,se.canonical.y),he=new i.Point(le.canonical.x+(1<<le.canonical.z)*le.wrap,le.canonical.y),pe=K.mult(1<<se.canonical.z);return pe.x-=.5,pe.y-=.5,pe.distSqr(fe)-pe.distSqr(he)})})(x,this.painter),this._previousZoom=_.zoom;let D=this.proxyToSource||{};this.proxyToSource={},x.forEach(z=>{this.proxyToSource[z.key]={}}),this.terrainTileForTile={};let k=this._style._sourceCaches;for(let z in k){let G=k[z];if(!G.used||(G!==this.sourceCache&&this.resetTileLookupCache(G.id),this._setupProxiedCoordsForOrtho(G,l[z],D),G.usedForTerrain))continue;let H=l[z];G.getSource().reparseOverscaled&&this._assignTerrainTiles(H)}this.proxiedCoords[h.id]=x.map(z=>new Id(z,z.key,this.orthoMatrix)),this._assignTerrainTiles(x),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(D),this.renderingToTexture=!1,this._updateTimestamp=i.exported.now();let R={};this._visibleDemTiles=[];for(let z of this.proxyCoords){let G=this.terrainTileForTile[z.key];if(!G)continue;let H=G.tileID.key;H in R||(this._visibleDemTiles.push(G),R[H]=H)}}_assignTerrainTiles(l){this._initializing||l.forEach(h=>{if(this.terrainTileForTile[h.key])return;let _=this._findTileCoveringTileID(h,this.sourceCache);_&&(this.terrainTileForTile[h.key]=_)})}_prepareDEMTextures(){let l=this.painter.context,h=l.gl;for(let _ in this.terrainTileForTile){let x=this.terrainTileForTile[_],D=x.dem;!D||x.demTexture&&!x.needsDEMTextureUpload||(l.activeTexture.set(h.TEXTURE1),Uh(this.painter,x,D))}}_prepareDemTileUniforms(l,h,_,x){if(!h||h.demTexture==null)return!1;let D=l.tileID.canonical,k=Math.pow(2,h.tileID.canonical.z-D.z),R=x||"";return _[`u_dem_tl${R}`]=[D.x*k%1,D.y*k%1],_[`u_dem_scale${R}`]=k,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){let l=this.painter.context,h=l.gl;if(!this._emptyDepthBufferTexture){let _=new i.RGBAImage({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new i.Texture(l,_,h.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let l=0,h=this._visibleDemTiles.reduce((_,x)=>{if(!x.dem)return _;let D=x.dem.tree.minimums[0];return D>0&&l++,_+D},0);return l?h/l:0}_updateEmptyDEMTexture(){let l=this.painter.context,h=l.gl;l.activeTexture.set(h.TEXTURE2);let _=this._getLoadedAreaMinimum(),x=new i.RGBAImage({width:1,height:1},new Uint8Array(i.DEMData.pack(_,this.sourceCache.getSource().encoding)));this._emptyDEMTextureDirty=!1;let D=this._emptyDEMTexture;return D?D.update(x,{premultiply:!1}):D=this._emptyDEMTexture=new i.Texture(l,x,h.RGBA,{premultiply:!1}),D}setupElevationDraw(l,h,_){let x=this.painter.context,D=x.gl,k=(R=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:i.DEMData.getUnpackVector(R),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0});var R;k.u_dem_size=this.sourceCache.getSource().tileSize,k.u_exaggeration=this.exaggeration();let z=null,G=null,H=1;if(_&&_.morphing&&this._useVertexMorphing){let K=_.morphing.srcDemTile,se=_.morphing.dstDemTile;H=_.morphing.phase,K&&se&&(this._prepareDemTileUniforms(l,K,k,"_prev")&&(G=K),this._prepareDemTileUniforms(l,se,k)&&(z=se))}if(G&&z?(x.activeTexture.set(D.TEXTURE2),z.demTexture.bind(D.NEAREST,D.CLAMP_TO_EDGE,D.NEAREST),x.activeTexture.set(D.TEXTURE4),G.demTexture.bind(D.NEAREST,D.CLAMP_TO_EDGE,D.NEAREST),k.u_dem_lerp=H):(z=this.terrainTileForTile[l.tileID.key],x.activeTexture.set(D.TEXTURE2),(this._prepareDemTileUniforms(l,z,k)?z.demTexture:this.emptyDEMTexture).bind(D.NEAREST,D.CLAMP_TO_EDGE)),x.activeTexture.set(D.TEXTURE3),_&&_.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(D.NEAREST,D.CLAMP_TO_EDGE),this._depthFBO&&(k.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(D.NEAREST,D.CLAMP_TO_EDGE),k.u_depth_size_inv=[1,1]),_&&_.useMeterToDem&&z){let K=(1<<z.tileID.canonical.z)*i.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;k.u_meter_to_dem=K}if(_&&_.labelPlaneMatrixInv&&(k.u_label_plane_matrix_inv=_.labelPlaneMatrixInv),h.setTerrainUniformValues(x,k),this.painter.transform.projection.name==="globe"){let K=this.globeUniformValues(this.painter.transform,l.tileID.canonical,_&&_.useDenormalizedUpVectorScale);h.setGlobeUniformValues(x,K)}}globeUniformValues(l,h,_){let x=l.projection;return{u_tile_tl_up:x.upVector(h,0,0),u_tile_tr_up:x.upVector(h,i.EXTENT,0),u_tile_br_up:x.upVector(h,i.EXTENT,i.EXTENT),u_tile_bl_up:x.upVector(h,0,i.EXTENT),u_tile_up_scale:_?i.globeMetersToEcef(1):x.upVectorScale(h,l.center.lat,l.worldSize).metersToTile}}renderToBackBuffer(l){let h=this.painter,_=this.painter.context;l.length!==0&&(_.bindFramebuffer.set(null),_.viewport.set([0,0,h.width,h.height]),h.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(x,D,k,R,z){if(x.transform.projection.name==="globe")(function(G,H,K,se,le){let fe=G.context,he=fe.gl,pe,Q,ue=G.options.showTerrainWireframe?2:0,ye=G.transform,_e=i.globeUseCustomAntiAliasing(G,fe,ye),Ae=(ht,Ge)=>{if(Q===ht)return;let tt=[gl[ht],"PROJECTION_GLOBE_VIEW"];_e&&tt.push("CUSTOM_ANTIALIASING"),Ge&&tt.push(gl[ue]),pe=G.useProgram("globeRaster",null,tt),Q=ht},Re=G.colorModeForRenderPass(),Me=new i.DepthMode(he.LEQUAL,i.DepthMode.ReadWrite,G.depthRangeFor3D);sa.update(le);let Be=i.calculateGlobeMercatorMatrix(ye),Fe=[i.mercatorXfromLng(ye.center.lng),i.mercatorYfromLat(ye.center.lat)],je=ue?[!1,!0]:[!1],mt=G.globeSharedBuffers,He=[ye.width*i.exported.devicePixelRatio,ye.height*i.exported.devicePixelRatio],it=Float32Array.from(ye.globeMatrix),Ze={useDenormalizedUpVectorScale:!0};if(je.forEach(ht=>{let Ge=G.transform,tt=Ed(Ge.zoom)*H.exaggeration();Q=-1;let gt=ht?he.LINES:he.TRIANGLES;for(let at of se){let _t=K.getTile(at),$t=i.StencilMode.disabled,sn=H.prevTerrainTileForTile[at.key],Ft=H.terrainTileForTile[at.key];Pa(sn,Ft)&&sa.newMorphing(at.key,sn,Ft,le,250),fe.activeTexture.set(he.TEXTURE0),_t.texture.bind(he.LINEAR,he.CLAMP_TO_EDGE);let Xt=sa.getMorphValuesForProxy(at.key),Gt=Xt?1:0;Xt&&i.extend$1(Ze,{morphing:{srcDemTile:Xt.from,dstDemTile:Xt.to,phase:i.easeCubicInOut(Xt.phase)}});let Mn=i.tileCornersToBounds(at.canonical),Vt=i.getLatitudinalLod(Mn.getCenter().lat),Qn=i.getGridMatrix(at.canonical,Mn,Vt,Ge.worldSize/Ge._pixelsPerMercatorPixel),ui=i.globeNormalizeECEF(i.globeTileBounds(at.canonical)),di=Cd(Ge.projMatrix,it,Be,ui,i.globeToMercatorTransition(Ge.zoom),Fe,Ge.frustumCorners.TL,Ge.frustumCorners.TR,Ge.frustumCorners.BR,Ge.frustumCorners.BL,Ge.globeCenterInViewSpace,Ge.globeRadius,He,tt,Qn);if(Ae(Gt,ht),H.setupElevationDraw(_t,pe,Ze),G.prepareDrawProgram(fe,pe,at.toUnwrapped()),mt){let[hi,dr,vr]=ht?mt.getWirefameBuffers(G.context,Vt):mt.getGridBuffers(Vt,tt!==0);pe.draw(fe,gt,Me,$t,Re,i.CullFaceMode.backCCW,di,"globe_raster",hi,dr,vr)}}}),mt){let ht=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];_e&&ht.push("CUSTOM_ANTIALIASING"),pe=G.useProgram("globeRaster",null,ht);for(let Ge of se){let{x:tt,y:gt,z:at}=Ge.canonical,_t=gt===0,$t=gt===(1<<at)-1,[sn,Ft,Xt,Gt]=mt.getPoleBuffers(at);if(Gt&&(_t||$t)){let Mn=K.getTile(Ge);fe.activeTexture.set(he.TEXTURE0),Mn.texture.bind(he.LINEAR,he.CLAMP_TO_EDGE);let Vt=i.globePoleMatrixForTile(at,tt,ye),Qn=i.globeNormalizeECEF(i.globeTileBounds(Ge.canonical)),ui=(di,hi)=>di.draw(fe,he.TRIANGLES,Me,i.StencilMode.disabled,Re,i.CullFaceMode.disabled,Cd(ye.projMatrix,Vt,Vt,Qn,0,Fe,ye.frustumCorners.TL,ye.frustumCorners.TR,ye.frustumCorners.BR,ye.frustumCorners.BL,ye.globeCenterInViewSpace,ye.globeRadius,He,0),"globe_pole_raster",hi,Xt,Gt);H.setupElevationDraw(Mn,pe,Ze),G.prepareDrawProgram(fe,pe,Ge.toUnwrapped()),_t&&ui(pe,sn),$t&&(Vt=i.scale(i.create(),Vt,[1,-1,1]),ui(pe,Ft))}}}})(x,D,k,R,z);else{let G=x.context,H=G.gl,K,se,le=x.options.showTerrainWireframe?2:0,fe=(ye,_e)=>{if(se===ye)return;let Ae=[gl[ye]];_e&&Ae.push(gl[le]),K=x.useProgram("terrainRaster",null,Ae),se=ye},he=x.colorModeForRenderPass(),pe=new i.DepthMode(H.LEQUAL,i.DepthMode.ReadWrite,x.depthRangeFor3D);sa.update(z);let Q=x.transform,ue=Ed(Q.zoom)*D.exaggeration();(le?[!1,!0]:[!1]).forEach(ye=>{se=-1;let _e=ye?H.LINES:H.TRIANGLES,[Ae,Re]=ye?D.getWirefameBuffer():[D.gridIndexBuffer,D.gridSegments];for(let Me of R){let Be=k.getTile(Me),Fe=i.StencilMode.disabled,je=D.prevTerrainTileForTile[Me.key],mt=D.terrainTileForTile[Me.key];Pa(je,mt)&&sa.newMorphing(Me.key,je,mt,z,250),G.activeTexture.set(H.TEXTURE0),Be.texture.bind(H.LINEAR,H.CLAMP_TO_EDGE,H.LINEAR_MIPMAP_NEAREST);let He=sa.getMorphValuesForProxy(Me.key),it=He?1:0,Ze;He&&(Ze={morphing:{srcDemTile:He.from,dstDemTile:He.to,phase:i.easeCubicInOut(He.phase)}});let ht=uc(Me.projMatrix,Hh(Me.canonical,Q.renderWorldCopies)?ue/10:ue);fe(it,ye),D.setupElevationDraw(Be,K,Ze),x.prepareDrawProgram(G,K,Me.toUnwrapped()),K.draw(G,_e,pe,Fe,he,i.CullFaceMode.backCCW,ht,"terrain_raster",D.gridBuffer,Ae,Re)}})}}(h,this,this.proxySourceCache,l,this._updateTimestamp),this.renderingToTexture=!0,h.gpuTimingDeferredRenderEnd(),l.splice(0,l.length))}renderBatch(l){if(this._drapedRenderBatches.length===0)return l+1;this.renderingToTexture=!0;let h=this.painter,_=this.painter.context,x=this.proxySourceCache,D=this.proxiedCoords[x.id],k=this._drapedRenderBatches.shift(),R=[],z=h.style.order,G=0;for(let H of D){let K=x.getTileByID(H.proxyTileKey),se=x.proxyCachedFBO[H.key]?x.proxyCachedFBO[H.key][l]:void 0,le=se!==void 0?x.renderCache[se]:this.pool[G++],fe=se!==void 0;if(K.texture=le.tex,fe&&!le.dirty){R.push(K.tileID);continue}let he;_.bindFramebuffer.set(le.fb.framebuffer),this.renderedToTile=!1,le.dirty&&(_.clear({color:i.Color.transparent,stencil:0}),le.dirty=!1);for(let pe=k.start;pe<=k.end;++pe){let Q=h.style._layers[z[pe]];if(Q.isHidden(h.transform.zoom))continue;let ue=h.style._getLayerSourceCache(Q),ye=ue?this.proxyToSource[H.key][ue.id]:[H];if(!ye)continue;let _e=ye;_.viewport.set([0,0,le.fb.width,le.fb.height]),he!==(ue?ue.id:null)&&(this._setupStencil(le,ye,Q,ue),he=ue?ue.id:null),h.renderLayer(h,ue,Q,_e)}this.renderedToTile?(le.dirty=!0,R.push(K.tileID)):fe||--G,G===5&&(G=0,this.renderToBackBuffer(R))}return this.renderToBackBuffer(R),this.renderingToTexture=!1,_.bindFramebuffer.set(null),_.viewport.set([0,0,h.width,h.height]),k.end+1}postRender(){}renderCacheEfficiency(l){let h=l.order.length;if(h===0)return{efficiency:100};let _,x=0,D=0,k=!1;for(let R=0;R<h;++R){let z=l._layers[l.order[R]];this._style.isLayerDraped(z)?(k&&++x,++D):k||(k=!0,_=z.id)}return D===0?{efficiency:100}:{efficiency:100*(1-x/D),firstUndrapedLayer:_}}getMinElevationBelowMSL(){let l=0;return this._visibleDemTiles.filter(h=>h.dem).forEach(h=>{l=Math.min(l,h.dem.tree.minimums[0])}),l===0?l:(l-30)*this._exaggeration}raycast(l,h,_){if(!this._visibleDemTiles)return null;let x=this._visibleDemTiles.filter(D=>D.dem).map(D=>{let k=D.tileID,R=1<<k.overscaledZ,{x:z,y:G}=k.canonical,H=z/R,K=(z+1)/R,se=G/R,le=(G+1)/R;return{minx:H,miny:se,maxx:K,maxy:le,t:D.dem.tree.raycastRoot(H,se,K,le,l,h,_),tile:D}});x.sort((D,k)=>(D.t!==null?D.t:Number.MAX_VALUE)-(k.t!==null?k.t:Number.MAX_VALUE));for(let D of x){if(D.t==null)return null;let k=D.tile.dem.tree.raycast(D.minx,D.miny,D.maxx,D.maxy,l,h,_);if(k!=null)return k}return null}_createFBO(){let l=this.painter.context,h=l.gl,_=this.drapeBufferSize;l.activeTexture.set(h.TEXTURE0);let x=new i.Texture(l,{width:_[0],height:_[1],data:null},h.RGBA);x.bind(h.LINEAR,h.CLAMP_TO_EDGE);let D=l.createFramebuffer(_[0],_[1],!1);return D.colorAttachment.set(x.texture),D.depthAttachment=new Oe(l,D.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=l.createRenderbuffer(l.gl.DEPTH_STENCIL,_[0],_[1]),this._stencilRef=0,D.depthAttachment.set(this._sharedDepthStencil),l.clear({stencil:0})):D.depthAttachment.set(this._sharedDepthStencil),l.extTextureFilterAnisotropic&&!l.extTextureFilterAnisotropicForceOff&&h.texParameterf(h.TEXTURE_2D,l.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,l.extTextureFilterAnisotropicMax),{fb:D,tex:x,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.light&&this._style.light.hasTransition())return!0;for(let l in this._style._sourceCaches)if(this._style._sourceCaches[l].hasTransition())return!0;return this._style.order.some(l=>{let h=this._style._layers[l],_=h.isHidden(this.painter.transform.zoom);return h.type==="custom"?!_&&h.shouldRedrape():!_&&h.hasTransition()})}_clearLineLayersFromRenderCache(){let l=!1;for(let _ of this._style._getSources())if(_ instanceof Tt){l=!0;break}if(!l)return;let h={};for(let _=0;_<this._style.order.length;++_){let x=this._style._layers[this._style.order[_]],D=this._style._getLayerSourceCache(x);if(D&&!h[D.id]&&!x.isHidden(this.painter.transform.zoom)&&x.type==="line"&&x.widthExpression()instanceof i.ZoomDependentExpression){h[D.id]=!0;for(let k of this.proxyCoords){let R=this.proxyToSource[k.key][D.id];if(R)for(let z of R)this._clearRenderCacheForTile(D.id,z)}}}}_clearRasterLayersFromRenderCache(){let l=!1;for(let _ in this._style._sourceCaches)if(this._style._sourceCaches[_]._source instanceof yt){l=!0;break}if(!l)return;let h={};for(let _=0;_<this._style.order.length;++_){let x=this._style._layers[this._style.order[_]],D=this._style._getLayerSourceCache(x);if(!D||h[D.id]||x.isHidden(this.painter.transform.zoom)||x.type!=="raster")continue;let k=x.paint.get("raster-fade-duration");for(let R of this.proxyCoords){let z=this.proxyToSource[R.key][D.id];if(z)for(let G of z){let H=Dd(D.getTile(G),D.findLoadedParent(G,0),D,this.painter.transform,k);(H.opacity!==1||H.mix!==0)&&this._clearRenderCacheForTile(D.id,G)}}}}_setupDrapedRenderBatches(){let l=this._style.order,h=l.length;if(h===0)return;let _=[],x,D=0,k=this._style._layers[l[D]];for(;!this._style.isLayerDraped(k)&&k.isHidden(this.painter.transform.zoom)&&++D<h;)k=this._style._layers[l[D]];for(;D<h;++D){let R=this._style._layers[l[D]];R.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(R)?x===void 0&&(x=D):x!==void 0&&(_.push({start:x,end:D-1}),x=void 0))}x!==void 0&&_.push({start:x,end:D-1}),this._drapedRenderBatches=_}_setupRenderCache(l){let h=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,h.renderCache.length>h.renderCachePool.length){let k=Object.values(h.proxyCachedFBO);h.proxyCachedFBO={};for(let R=0;R<k.length;++R){let z=Object.values(k[R]);h.renderCachePool.push(...z)}}return}this._clearRasterLayersFromRenderCache();let _=this.proxyCoords,x=this._tilesDirty;for(let k=_.length-1;k>=0;k--){let R=_[k];if(h.getTileByID(R.key),h.proxyCachedFBO[R.key]!==void 0){let z=l[R.key],G=this.proxyToSource[R.key],H=0;for(let K in G){let se=G[K],le=z[K];if(!le||le.length!==se.length||se.some((fe,he)=>fe!==le[he]||x[K]&&x[K].hasOwnProperty(fe.key))){H=-1;break}++H}for(let K in h.proxyCachedFBO[R.key])h.renderCache[h.proxyCachedFBO[R.key][K]].dirty=H<0||H!==Object.values(z).length}}let D=[...this._drapedRenderBatches];D.sort((k,R)=>R.end-R.start-(k.end-k.start));for(let k of D)for(let R of _){if(h.proxyCachedFBO[R.key])continue;let z=h.renderCachePool.pop();z===void 0&&h.renderCache.length<50&&(z=h.renderCache.length,h.renderCache.push(this._createFBO())),z!==void 0&&(h.proxyCachedFBO[R.key]={},h.proxyCachedFBO[R.key][k.start]=z,h.renderCache[z].dirty=!0)}this._tilesDirty={}}_setupStencil(l,h,_,x){if(!x||!this._sourceTilesOverlap[x.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));let D=this.painter.context,k=D.gl;if(h.length<=1)return void(this._overlapStencilType=!1);let R;if(_.isTileClipped())R=h.length,this._overlapStencilMode.test={func:k.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(h[0].overscaledZ>h[h.length-1].overscaledZ))return void(this._overlapStencilType=!1);R=1,this._overlapStencilMode.test={func:k.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+R>255&&(D.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=R,this._overlapStencilMode.ref=this._stencilRef,_.isTileClipped()&&this._renderTileClippingMasks(h,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(l){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[l.key]),this._overlapStencilMode):i.StencilMode.disabled}_renderTileClippingMasks(l,h){let _=this.painter,x=this.painter.context,D=x.gl;_._tileClippingMaskIDs={},x.setColorMode(i.ColorMode.disabled),x.setDepthMode(i.DepthMode.disabled);let k=_.useProgram("clippingMask");for(let R of l){let z=_._tileClippingMaskIDs[R.key]=--h;k.draw(x,D.TRIANGLES,i.DepthMode.disabled,new i.StencilMode({func:D.ALWAYS,mask:0},z,255,D.KEEP,D.KEEP,D.REPLACE),i.ColorMode.disabled,i.CullFaceMode.disabled,Cs(R.projMatrix),"$clipping",_.tileExtentBuffer,_.quadTriangleIndexBuffer,_.tileExtentSegments)}}pointCoordinate(l){let h=this.painter.transform;if(l.x<0||l.x>h.width||l.y<0||l.y>h.height)return null;let _=[l.x,l.y,1,1];i.transformMat4$1(_,_,h.pixelMatrixInverse),i.scale$1(_,_,1/_[3]),_[0]/=h.worldSize,_[1]/=h.worldSize;let x=h._camera.position,D=i.mercatorZfromAltitude(1,h.center.lat),k=[x[0],x[1],x[2]/D,0],R=i.subtract([],_.slice(0,3),k);i.normalize(R,R);let z=this.raycast(k,R,this._exaggeration);return z!==null&&z?(i.scaleAndAdd(k,k,R,z),k[3]=k[2],k[2]*=D,k):null}drawDepth(){let l=this.painter,h=l.context,_=this.proxySourceCache,x=Math.ceil(l.width),D=Math.ceil(l.height);if(!this._depthFBO||this._depthFBO.width===x&&this._depthFBO.height===D||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){let k=h.gl,R=h.createFramebuffer(x,D,!0);h.activeTexture.set(k.TEXTURE0);let z=new i.Texture(h,{width:x,height:D,data:null},k.RGBA);z.bind(k.NEAREST,k.CLAMP_TO_EDGE),R.colorAttachment.set(z.texture);let G=h.createRenderbuffer(h.gl.DEPTH_COMPONENT16,x,D);R.depthAttachment.set(G),this._depthFBO=R,this._depthTexture=z}h.bindFramebuffer.set(this._depthFBO.framebuffer),h.viewport.set([0,0,x,D]),function(k,R,z,G){if(k.transform.projection.name==="globe")return;let H=k.context,K=H.gl;H.clear({depth:1});let se=k.useProgram("terrainDepth"),le=new i.DepthMode(K.LESS,i.DepthMode.ReadWrite,k.depthRangeFor3D);for(let fe of G){let he=z.getTile(fe),pe=uc(fe.projMatrix,0);R.setupElevationDraw(he,se),se.draw(H,K.TRIANGLES,le,i.StencilMode.disabled,i.ColorMode.unblended,i.CullFaceMode.backCCW,pe,"terrain_depth",R.gridBuffer,R.gridIndexBuffer,R.gridNoSkirtSegments)}}(l,this,_,this.proxyCoords)}_setupProxiedCoordsForOrtho(l,h,_){if(l.getSource()instanceof In)return this._setupProxiedCoordsForImageSource(l,h,_);this._findCoveringTileCache[l.id]=this._findCoveringTileCache[l.id]||{};let x=this.proxiedCoords[l.id]=[],D=this.proxyCoords;for(let R=0;R<D.length;R++){let z=D[R],G=this._findTileCoveringTileID(z,l);if(G){let H=this._createProxiedId(z,G,_[z.key]&&_[z.key][l.id]);x.push(H),this.proxyToSource[z.key][l.id]=[H]}}let k=!1;for(let R=0;R<h.length;R++){let z=l.getTile(h[R]);if(!z||!z.hasData())continue;let G=this._findTileCoveringTileID(z.tileID,this.proxySourceCache);if(G&&G.tileID.canonical.z!==z.tileID.canonical.z){let H=this.proxyToSource[G.tileID.key][l.id],K=this._createProxiedId(G.tileID,z,_[G.tileID.key]&&_[G.tileID.key][l.id]);H?H.splice(H.length-1,0,K):this.proxyToSource[G.tileID.key][l.id]=[K],x.push(K),k=!0}}this._sourceTilesOverlap[l.id]=k}_setupProxiedCoordsForImageSource(l,h,_){if(!l.getSource().loaded())return;let x=this.proxiedCoords[l.id]=[],D=this.proxyCoords,k=l.getSource(),R=new i.Point(k.tileID.x,k.tileID.y)._div(1<<k.tileID.z),z=k.coordinates.map(i.MercatorCoordinate.fromLngLat).reduce((H,K)=>(H.min.x=Math.min(H.min.x,K.x-R.x),H.min.y=Math.min(H.min.y,K.y-R.y),H.max.x=Math.max(H.max.x,K.x-R.x),H.max.y=Math.max(H.max.y,K.y-R.y),H),{min:new i.Point(Number.MAX_VALUE,Number.MAX_VALUE),max:new i.Point(-Number.MAX_VALUE,-Number.MAX_VALUE)}),G=(H,K)=>{let se=H.wrap+H.canonical.x/(1<<H.canonical.z),le=H.canonical.y/(1<<H.canonical.z),fe=i.EXTENT/(1<<H.canonical.z),he=K.wrap+K.canonical.x/(1<<K.canonical.z),pe=K.canonical.y/(1<<K.canonical.z);return se+fe<he+z.min.x||se>he+z.max.x||le+fe<pe+z.min.y||le>pe+z.max.y};for(let H=0;H<D.length;H++){let K=D[H];for(let se=0;se<h.length;se++){let le=l.getTile(h[se]);if(!le||!le.hasData()||G(K,le.tileID))continue;let fe=this._createProxiedId(K,le,_[K.key]&&_[K.key][l.id]),he=this.proxyToSource[K.key][l.id];he?he.push(fe):this.proxyToSource[K.key][l.id]=[fe],x.push(fe)}}}_createProxiedId(l,h,_){let x=this.orthoMatrix;if(_){let D=_.find(k=>k.key===h.tileID.key);if(D)return D}if(h.tileID.key!==l.key){let D=l.canonical.z-h.tileID.canonical.z,k,R,z;x=i.create();let G=h.tileID.wrap-l.wrap<<l.overscaledZ;D>0?(k=i.EXTENT>>D,R=k*((h.tileID.canonical.x<<D)-l.canonical.x+G),z=k*((h.tileID.canonical.y<<D)-l.canonical.y)):(k=i.EXTENT<<-D,R=i.EXTENT*(h.tileID.canonical.x-(l.canonical.x+G<<-D)),z=i.EXTENT*(h.tileID.canonical.y-(l.canonical.y<<-D))),i.ortho(x,0,k,0,k,0,1),i.translate(x,x,[R,z,0])}return new Id(h.tileID,l.key,x)}_findTileCoveringTileID(l,h){let _=h.getTile(l);if(_&&_.hasData())return _;let x=this._findCoveringTileCache[h.id],D=x[l.key];if(_=D?h.getTileByID(D):null,_&&_.hasData()||D===null)return _;let k=_?_.tileID:l,R=k.overscaledZ,z=h.getSource().minzoom,G=[];if(!D){let K=h.getSource().maxzoom;if(l.canonical.z>=K){let se=l.canonical.z-K;h.getSource().reparseOverscaled?(R=Math.max(l.canonical.z+2,h.transform.tileZoom),k=new i.OverscaledTileID(R,l.wrap,K,l.canonical.x>>se,l.canonical.y>>se)):se!==0&&(R=K,k=new i.OverscaledTileID(R,l.wrap,K,l.canonical.x>>se,l.canonical.y>>se))}k.key!==l.key&&(G.push(k.key),_=h.getTile(k))}let H=K=>{G.forEach(se=>{x[se]=K}),G.length=0};for(R-=1;R>=z&&(!_||!_.hasData());R--){_&&H(_.tileID.key);let K=k.calculateScaledKey(R);if(_=h.getTileByID(K),_&&_.hasData())break;let se=x[K];if(se===null)break;se===void 0?G.push(K):_=h.getTileByID(se)}return H(_?_.tileID.key:null),_&&_.hasData()?_:null}findDEMTileFor(l){return this.enabled?this._findTileCoveringTileID(l,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(l,h){let _=this._tilesDirty[l];_||(_=this._tilesDirty[l]={}),_[h.key]=!0}getWirefameBuffer(){if(!this.wireframeSegments){let l=function(h){let _=0,x=new i.StructArrayLayout2ui4,D=131;for(let k=1;k<129;k++){for(let R=1;R<129;R++)_=k*D+R,x.emplaceBack(_,_+1),x.emplaceBack(_,_+D),x.emplaceBack(_+1,_+D),k===128&&x.emplaceBack(_+D,_+D+1);x.emplaceBack(_+1,_+1+D)}return x}();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(l),this.wireframeSegments=i.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,l.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}class Fn{static cacheKey(l,h,_,x){let D=`${h}${x?x.cacheKey:""}`;for(let k of _)l.usedDefines.includes(k)&&(D+=`/${k}`);return D}constructor(l,h,_,x,D,k){let R=l.gl;this.program=R.createProgram();let z=function(Q){let ue=[];for(let ye=0;ye<Q.length;ye++){if(Q[ye]===null)continue;let _e=Q[ye].split(" ");ue.push(_e.pop())}return ue}(_.staticAttributes),G=x?x.getBinderAttributes():[],H=z.concat(G),K=x?x.defines():[];K=K.concat(k.map(Q=>`#define ${Q}`));let se=l.isWebGL2?`#version 300 es
`:"",le=se+K.concat(l.extStandardDerivatives&&se.length===0?`#extension GL_OES_standard_derivatives : enable
`.concat(bd):bd,bd,pu,cc.fragmentSource,pl.fragmentSource,_.fragmentSource).join(`
`),fe=se+K.concat(`
#ifdef GL_ES
precision highp float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`,pu,cc.vertexSource,pl.vertexSource,ws.vertexSource,_.vertexSource).join(`
`),he=R.createShader(R.FRAGMENT_SHADER);if(R.isContextLost())return void(this.failedToCreate=!0);R.shaderSource(he,le),R.compileShader(he),R.attachShader(this.program,he);let pe=R.createShader(R.VERTEX_SHADER);if(R.isContextLost())this.failedToCreate=!0;else{R.shaderSource(pe,fe),R.compileShader(pe),R.attachShader(this.program,pe),this.attributes={},this.numAttributes=H.length;for(let Q=0;Q<this.numAttributes;Q++)H[Q]&&(R.bindAttribLocation(this.program,Q,H[Q]),this.attributes[H[Q]]=Q);R.linkProgram(this.program),R.deleteShader(pe),R.deleteShader(he),this.fixedUniforms=D(l),this.binderUniforms=x?x.getUniforms(l):[],k.includes("TERRAIN")&&(this.terrainUniforms=(Q=>({u_dem:new i.Uniform1i(Q),u_dem_prev:new i.Uniform1i(Q),u_dem_unpack:new i.Uniform4f(Q),u_dem_tl:new i.Uniform2f(Q),u_dem_scale:new i.Uniform1f(Q),u_dem_tl_prev:new i.Uniform2f(Q),u_dem_scale_prev:new i.Uniform1f(Q),u_dem_size:new i.Uniform1f(Q),u_dem_lerp:new i.Uniform1f(Q),u_exaggeration:new i.Uniform1f(Q),u_depth:new i.Uniform1i(Q),u_depth_size_inv:new i.Uniform2f(Q),u_meter_to_dem:new i.Uniform1f(Q),u_label_plane_matrix_inv:new i.UniformMatrix4f(Q)}))(l)),k.includes("GLOBE")&&(this.globeUniforms=(Q=>({u_tile_tl_up:new i.Uniform3f(Q),u_tile_tr_up:new i.Uniform3f(Q),u_tile_br_up:new i.Uniform3f(Q),u_tile_bl_up:new i.Uniform3f(Q),u_tile_up_scale:new i.Uniform1f(Q)}))(l)),k.includes("FOG")&&(this.fogUniforms=(Q=>({u_fog_matrix:new i.UniformMatrix4f(Q),u_fog_range:new i.Uniform2f(Q),u_fog_color:new i.Uniform4f(Q),u_fog_horizon_blend:new i.Uniform1f(Q),u_fog_temporal_offset:new i.Uniform1f(Q),u_frustum_tl:new i.Uniform3f(Q),u_frustum_tr:new i.Uniform3f(Q),u_frustum_br:new i.Uniform3f(Q),u_frustum_bl:new i.Uniform3f(Q),u_globe_pos:new i.Uniform3f(Q),u_globe_radius:new i.Uniform1f(Q),u_globe_transition:new i.Uniform1f(Q),u_is_globe:new i.Uniform1i(Q),u_viewport:new i.Uniform2f(Q)}))(l))}}setTerrainUniformValues(l,h){if(!this.terrainUniforms)return;let _=this.terrainUniforms;if(!this.failedToCreate){l.program.set(this.program);for(let x in h)_[x]&&_[x].set(this.program,x,h[x])}}setGlobeUniformValues(l,h){if(!this.globeUniforms)return;let _=this.globeUniforms;if(!this.failedToCreate){l.program.set(this.program);for(let x in h)_[x]&&_[x].set(this.program,x,h[x])}}setFogUniformValues(l,h){if(!this.fogUniforms)return;let _=this.fogUniforms;if(!this.failedToCreate){l.program.set(this.program);for(let x in h)_[x].set(this.program,x,h[x])}}draw(l,h,_,x,D,k,R,z,G,H,K,se,le,fe,he){let pe=l.gl;if(this.failedToCreate)return;l.program.set(this.program),l.setDepthMode(_),l.setStencilMode(x),l.setColorMode(D),l.setCullFace(k);for(let ue of Object.keys(this.fixedUniforms))this.fixedUniforms[ue].set(this.program,ue,R[ue]);fe&&fe.setUniforms(this.program,l,this.binderUniforms,se,{zoom:le});let Q={[pe.LINES]:2,[pe.TRIANGLES]:3,[pe.LINE_STRIP]:1}[h];for(let ue of K.get()){let ye=ue.vaos||(ue.vaos={});(ye[z]||(ye[z]=new Qg)).bind(l,this,G,fe?fe.getPaintVertexBuffers():[],H,ue.vertexOffset,he||[]),pe.drawElements(h,ue.primitiveLength*Q,pe.UNSIGNED_SHORT,ue.primitiveOffset*Q*2)}}}function yl(m,l){let h=Math.pow(2,l.tileID.overscaledZ),_=l.tileSize*Math.pow(2,m.transform.tileZoom)/h,x=_*(l.tileID.canonical.x+l.tileID.wrap*h),D=_*l.tileID.canonical.y;return{u_image:0,u_texsize:l.imageAtlasTexture.size,u_tile_units_to_pixels:1/wr(l,1,m.transform.tileZoom),u_pixel_coord_upper:[x>>16,D>>16],u_pixel_coord_lower:[65535&x,65535&D]}}let gu=i.create(),dc=(m,l,h,_,x,D,k,R,z,G,H)=>{let K=l.style.light,se=K.properties.get("position"),le=[se.x,se.y,se.z],fe=i.create$1();K.properties.get("anchor")==="viewport"&&(i.fromRotation(fe,-l.transform.angle),i.transformMat3(le,le,fe));let he=K.properties.get("color"),pe=l.transform,Q={u_matrix:m,u_lightpos:le,u_lightintensity:K.properties.get("intensity"),u_lightcolor:[he.r,he.g,he.b],u_vertical_gradient:+h,u_opacity:_,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:gu,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:x,u_edge_radius:D};return pe.projection.name==="globe"&&(Q.u_tile_id=[k.canonical.x,k.canonical.y,1<<k.canonical.z],Q.u_zoom_transition=z,Q.u_inv_rot_matrix=H,Q.u_merc_center=G,Q.u_up_dir=pe.projection.upVector(new i.CanonicalTileID(0,0,0),G[0]*i.EXTENT,G[1]*i.EXTENT),Q.u_height_lift=R),Q},Ip=(m,l,h,_,x,D,k,R,z,G,H,K)=>{let se=dc(m,l,h,_,x,D,k,z,G,H,K),le={u_height_factor:-Math.pow(2,k.overscaledZ)/R.tileSize/8};return i.extend(se,yl(l,R),le)},Oa=m=>({u_matrix:m}),hc=(m,l,h)=>i.extend(Oa(m),yl(l,h)),_l=(m,l)=>({u_matrix:m,u_world:l}),Jg=(m,l,h,_)=>i.extend(hc(m,l,h),{u_world:_}),vl=i.create(),Wh=(m,l,h,_,x,D)=>{let k=m.transform,R=k.projection.name==="globe",z;if(D.paint.get("circle-pitch-alignment")==="map")if(R){let H=i.globePixelsToTileUnits(k.zoom,l.canonical)*k._pixelsPerMercatorPixel;z=Float32Array.from([H,0,0,H])}else z=k.calculatePixelsToTileUnitsMatrix(h);else z=new Float32Array([k.pixelsToGLUnits[0],0,0,k.pixelsToGLUnits[1]]);let G={u_camera_to_center_distance:k.cameraToCenterDistance,u_matrix:m.translatePosMatrix(l.projMatrix,h,D.paint.get("circle-translate"),D.paint.get("circle-translate-anchor")),u_device_pixel_ratio:i.exported.devicePixelRatio,u_extrude_scale:z,u_inv_rot_matrix:vl,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(R){G.u_inv_rot_matrix=_,G.u_merc_center=x,G.u_tile_id=[l.canonical.x,l.canonical.y,1<<l.canonical.z],G.u_zoom_transition=i.globeToMercatorTransition(k.zoom);let H=x[0]*i.EXTENT,K=x[1]*i.EXTENT;G.u_up_dir=k.projection.upVector(new i.CanonicalTileID(0,0,0),H,K)}return G},bl=m=>{let l=[];return m.paint.get("circle-pitch-alignment")==="map"&&l.push("PITCH_WITH_MAP"),m.paint.get("circle-pitch-scale")==="map"&&l.push("SCALE_WITH_MAP"),l},xl=(m,l,h,_)=>{let x=i.EXTENT/h.tileSize;return{u_matrix:m,u_camera_to_center_distance:l.getCameraToCenterDistance(_),u_extrude_scale:[l.pixelsToGLUnits[0]/x,l.pixelsToGLUnits[1]/x]}},Sd=(m,l,h=1)=>({u_matrix:m,u_color:l,u_overlay:0,u_overlay_scale:h}),Ad=i.create(),kd=(m,l,h,_,x,D,k)=>{let R=m.transform,z=R.projection.name==="globe",G=z?i.globePixelsToTileUnits(R.zoom,l.canonical)*R._pixelsPerMercatorPixel:wr(h,1,D),H={u_matrix:l.projMatrix,u_extrude_scale:G,u_intensity:k,u_inv_rot_matrix:Ad,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(z){H.u_inv_rot_matrix=_,H.u_merc_center=x,H.u_tile_id=[l.canonical.x,l.canonical.y,1<<l.canonical.z],H.u_zoom_transition=i.globeToMercatorTransition(R.zoom);let K=x[0]*i.EXTENT,se=x[1]*i.EXTENT;H.u_up_dir=R.projection.upVector(new i.CanonicalTileID(0,0,0),K,se)}return H},ey=(m,l,h,_,x,D,k)=>{let R=m.transform,z=R.calculatePixelsToTileUnitsMatrix(l);return{u_matrix:pc(m,l,h,_),u_pixels_to_tile_units:z,u_device_pixel_ratio:D,u_units_to_pixels:[1/R.pixelsToGLUnits[0],1/R.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:x,u_texsize:_u(h)?l.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:fc(l,m.transform),u_alpha_discard_threshold:0,u_trim_offset:k}},yu=(m,l,h,_,x)=>{let D=m.transform;return{u_matrix:pc(m,l,h,_),u_texsize:l.imageAtlasTexture.size,u_pixels_to_tile_units:D.calculatePixelsToTileUnitsMatrix(l),u_device_pixel_ratio:x,u_image:0,u_tile_units_to_pixels:fc(l,D),u_units_to_pixels:[1/D.pixelsToGLUnits[0],1/D.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}};function fc(m,l){return 1/wr(m,1,l.tileZoom)}function pc(m,l,h,_){return m.translatePosMatrix(_||l.tileID.projMatrix,l,h.paint.get("line-translate"),h.paint.get("line-translate-anchor"))}function _u(m){let l=m.paint.get("line-dasharray").value;return l.value||l.kind!=="constant"}let qh=(m,l,h,_,x,D)=>{return{u_matrix:m,u_tl_parent:l,u_scale_parent:h,u_fade_t:_.mix,u_opacity:_.opacity*x.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:x.paint.get("raster-brightness-min"),u_brightness_high:x.paint.get("raster-brightness-max"),u_saturation_factor:(R=x.paint.get("raster-saturation"),R>0?1-1/(1.001-R):-R),u_contrast_factor:(k=x.paint.get("raster-contrast"),k>0?1/(1-k):1+k),u_spin_weights:io(x.paint.get("raster-hue-rotate")),u_perspective_transform:D};var k,R};function io(m){m*=Math.PI/180;let l=Math.sin(m),h=Math.cos(m);return[(2*h+1)/3,(-Math.sqrt(3)*l-h+1)/3,(Math.sqrt(3)*l-h+1)/3]}let Rd=i.create(),Pd=(m,l,h,_,x,D,k,R,z,G,H,K,se,le,fe,he)=>{let pe=x.transform,Q={u_is_size_zoom_constant:+(m==="constant"||m==="source"),u_is_size_feature_constant:+(m==="constant"||m==="camera"),u_size_t:l?l.uSizeT:0,u_size:l?l.uSize:0,u_camera_to_center_distance:pe.cameraToCenterDistance,u_rotate_symbol:+h,u_aspect_ratio:pe.width/pe.height,u_fade_change:x.options.fadeDuration?x.symbolFadeChange:1,u_matrix:D,u_label_plane_matrix:k,u_coord_matrix:R,u_is_text:+z,u_pitch_with_map:+_,u_texsize:G,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Rd,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:Rd,u_up_vector:[0,-1,0]};return he.name==="globe"&&(Q.u_tile_id=[H.canonical.x,H.canonical.y,1<<H.canonical.z],Q.u_zoom_transition=K,Q.u_inv_rot_matrix=le,Q.u_merc_center=se,Q.u_camera_forward=pe._camera.forward(),Q.u_ecef_origin=i.globeECEFOrigin(pe.globeMatrix,H.toUnwrapped()),Q.u_tile_matrix=Float32Array.from(pe.globeMatrix),Q.u_up_vector=fe),Q},Od=(m,l,h,_,x,D,k,R,z,G,H,K,se,le,fe,he,pe)=>i.extend(Pd(m,l,h,_,x,D,k,R,z,G,K,se,le,fe,he,pe),{u_gamma_scale:_?x.transform.cameraToCenterDistance*Math.cos(x.terrain?0:x.transform._pitch):1,u_device_pixel_ratio:i.exported.devicePixelRatio,u_is_halo:+H}),Sp=(m,l,h,_,x,D,k,R,z,G,H,K,se,le,fe,he)=>i.extend(Od(m,l,h,_,x,D,k,R,!0,z,!0,H,K,se,le,fe,he),{u_texsize_icon:G,u_texture_icon:1}),Zh=(m,l,h)=>({u_matrix:m,u_opacity:l,u_color:h}),ty=(m,l,h,_,x)=>i.extend(function(D,k,R){let z=k.imageManager.getPattern(D.toString()),{width:G,height:H}=k.imageManager.getPixelSize(),K=Math.pow(2,R.tileID.overscaledZ),se=R.tileSize*Math.pow(2,k.transform.tileZoom)/K,le=se*(R.tileID.canonical.x+R.tileID.wrap*K),fe=se*R.tileID.canonical.y;return{u_image:0,u_pattern_tl:z.tl,u_pattern_br:z.br,u_texsize:[G,H],u_pattern_size:z.displaySize,u_tile_units_to_pixels:1/wr(R,1,k.transform.tileZoom),u_pixel_coord_upper:[le>>16,fe>>16],u_pixel_coord_lower:[65535&le,65535&fe]}}(_,h,x),{u_matrix:m,u_opacity:l}),Xh={fillExtrusion:m=>({u_matrix:new i.UniformMatrix4f(m),u_lightpos:new i.Uniform3f(m),u_lightintensity:new i.Uniform1f(m),u_lightcolor:new i.Uniform3f(m),u_vertical_gradient:new i.Uniform1f(m),u_opacity:new i.Uniform1f(m),u_edge_radius:new i.Uniform1f(m),u_ao:new i.Uniform2f(m),u_tile_id:new i.Uniform3f(m),u_zoom_transition:new i.Uniform1f(m),u_inv_rot_matrix:new i.UniformMatrix4f(m),u_merc_center:new i.Uniform2f(m),u_up_dir:new i.Uniform3f(m),u_height_lift:new i.Uniform1f(m)}),fillExtrusionPattern:m=>({u_matrix:new i.UniformMatrix4f(m),u_lightpos:new i.Uniform3f(m),u_lightintensity:new i.Uniform1f(m),u_lightcolor:new i.Uniform3f(m),u_vertical_gradient:new i.Uniform1f(m),u_height_factor:new i.Uniform1f(m),u_edge_radius:new i.Uniform1f(m),u_ao:new i.Uniform2f(m),u_tile_id:new i.Uniform3f(m),u_zoom_transition:new i.Uniform1f(m),u_inv_rot_matrix:new i.UniformMatrix4f(m),u_merc_center:new i.Uniform2f(m),u_up_dir:new i.Uniform3f(m),u_height_lift:new i.Uniform1f(m),u_image:new i.Uniform1i(m),u_texsize:new i.Uniform2f(m),u_pixel_coord_upper:new i.Uniform2f(m),u_pixel_coord_lower:new i.Uniform2f(m),u_tile_units_to_pixels:new i.Uniform1f(m),u_opacity:new i.Uniform1f(m)}),fill:m=>({u_matrix:new i.UniformMatrix4f(m)}),fillPattern:m=>({u_matrix:new i.UniformMatrix4f(m),u_image:new i.Uniform1i(m),u_texsize:new i.Uniform2f(m),u_pixel_coord_upper:new i.Uniform2f(m),u_pixel_coord_lower:new i.Uniform2f(m),u_tile_units_to_pixels:new i.Uniform1f(m)}),fillOutline:m=>({u_matrix:new i.UniformMatrix4f(m),u_world:new i.Uniform2f(m)}),fillOutlinePattern:m=>({u_matrix:new i.UniformMatrix4f(m),u_world:new i.Uniform2f(m),u_image:new i.Uniform1i(m),u_texsize:new i.Uniform2f(m),u_pixel_coord_upper:new i.Uniform2f(m),u_pixel_coord_lower:new i.Uniform2f(m),u_tile_units_to_pixels:new i.Uniform1f(m)}),circle:m=>({u_camera_to_center_distance:new i.Uniform1f(m),u_extrude_scale:new i.UniformMatrix2f(m),u_device_pixel_ratio:new i.Uniform1f(m),u_matrix:new i.UniformMatrix4f(m),u_inv_rot_matrix:new i.UniformMatrix4f(m),u_merc_center:new i.Uniform2f(m),u_tile_id:new i.Uniform3f(m),u_zoom_transition:new i.Uniform1f(m),u_up_dir:new i.Uniform3f(m)}),collisionBox:m=>({u_matrix:new i.UniformMatrix4f(m),u_camera_to_center_distance:new i.Uniform1f(m),u_extrude_scale:new i.Uniform2f(m)}),collisionCircle:m=>({u_matrix:new i.UniformMatrix4f(m),u_inv_matrix:new i.UniformMatrix4f(m),u_camera_to_center_distance:new i.Uniform1f(m),u_viewport_size:new i.Uniform2f(m)}),debug:m=>({u_color:new i.UniformColor(m),u_matrix:new i.UniformMatrix4f(m),u_overlay:new i.Uniform1i(m),u_overlay_scale:new i.Uniform1f(m)}),clippingMask:m=>({u_matrix:new i.UniformMatrix4f(m)}),heatmap:m=>({u_extrude_scale:new i.Uniform1f(m),u_intensity:new i.Uniform1f(m),u_matrix:new i.UniformMatrix4f(m),u_inv_rot_matrix:new i.UniformMatrix4f(m),u_merc_center:new i.Uniform2f(m),u_tile_id:new i.Uniform3f(m),u_zoom_transition:new i.Uniform1f(m),u_up_dir:new i.Uniform3f(m)}),heatmapTexture:m=>({u_image:new i.Uniform1i(m),u_color_ramp:new i.Uniform1i(m),u_opacity:new i.Uniform1f(m)}),hillshade:m=>({u_matrix:new i.UniformMatrix4f(m),u_image:new i.Uniform1i(m),u_latrange:new i.Uniform2f(m),u_light:new i.Uniform2f(m),u_shadow:new i.UniformColor(m),u_highlight:new i.UniformColor(m),u_accent:new i.UniformColor(m)}),hillshadePrepare:m=>({u_matrix:new i.UniformMatrix4f(m),u_image:new i.Uniform1i(m),u_dimension:new i.Uniform2f(m),u_zoom:new i.Uniform1f(m),u_unpack:new i.Uniform4f(m)}),line:m=>({u_matrix:new i.UniformMatrix4f(m),u_pixels_to_tile_units:new i.UniformMatrix2f(m),u_device_pixel_ratio:new i.Uniform1f(m),u_units_to_pixels:new i.Uniform2f(m),u_dash_image:new i.Uniform1i(m),u_gradient_image:new i.Uniform1i(m),u_image_height:new i.Uniform1f(m),u_texsize:new i.Uniform2f(m),u_tile_units_to_pixels:new i.Uniform1f(m),u_alpha_discard_threshold:new i.Uniform1f(m),u_trim_offset:new i.Uniform2f(m)}),linePattern:m=>({u_matrix:new i.UniformMatrix4f(m),u_texsize:new i.Uniform2f(m),u_pixels_to_tile_units:new i.UniformMatrix2f(m),u_device_pixel_ratio:new i.Uniform1f(m),u_image:new i.Uniform1i(m),u_units_to_pixels:new i.Uniform2f(m),u_tile_units_to_pixels:new i.Uniform1f(m),u_alpha_discard_threshold:new i.Uniform1f(m)}),raster:m=>({u_matrix:new i.UniformMatrix4f(m),u_tl_parent:new i.Uniform2f(m),u_scale_parent:new i.Uniform1f(m),u_fade_t:new i.Uniform1f(m),u_opacity:new i.Uniform1f(m),u_image0:new i.Uniform1i(m),u_image1:new i.Uniform1i(m),u_brightness_low:new i.Uniform1f(m),u_brightness_high:new i.Uniform1f(m),u_saturation_factor:new i.Uniform1f(m),u_contrast_factor:new i.Uniform1f(m),u_spin_weights:new i.Uniform3f(m),u_perspective_transform:new i.Uniform2f(m)}),symbolIcon:m=>({u_is_size_zoom_constant:new i.Uniform1i(m),u_is_size_feature_constant:new i.Uniform1i(m),u_size_t:new i.Uniform1f(m),u_size:new i.Uniform1f(m),u_camera_to_center_distance:new i.Uniform1f(m),u_rotate_symbol:new i.Uniform1i(m),u_aspect_ratio:new i.Uniform1f(m),u_fade_change:new i.Uniform1f(m),u_matrix:new i.UniformMatrix4f(m),u_label_plane_matrix:new i.UniformMatrix4f(m),u_coord_matrix:new i.UniformMatrix4f(m),u_is_text:new i.Uniform1i(m),u_pitch_with_map:new i.Uniform1i(m),u_texsize:new i.Uniform2f(m),u_tile_id:new i.Uniform3f(m),u_zoom_transition:new i.Uniform1f(m),u_inv_rot_matrix:new i.UniformMatrix4f(m),u_merc_center:new i.Uniform2f(m),u_camera_forward:new i.Uniform3f(m),u_tile_matrix:new i.UniformMatrix4f(m),u_up_vector:new i.Uniform3f(m),u_ecef_origin:new i.Uniform3f(m),u_texture:new i.Uniform1i(m)}),symbolSDF:m=>({u_is_size_zoom_constant:new i.Uniform1i(m),u_is_size_feature_constant:new i.Uniform1i(m),u_size_t:new i.Uniform1f(m),u_size:new i.Uniform1f(m),u_camera_to_center_distance:new i.Uniform1f(m),u_rotate_symbol:new i.Uniform1i(m),u_aspect_ratio:new i.Uniform1f(m),u_fade_change:new i.Uniform1f(m),u_matrix:new i.UniformMatrix4f(m),u_label_plane_matrix:new i.UniformMatrix4f(m),u_coord_matrix:new i.UniformMatrix4f(m),u_is_text:new i.Uniform1i(m),u_pitch_with_map:new i.Uniform1i(m),u_texsize:new i.Uniform2f(m),u_texture:new i.Uniform1i(m),u_gamma_scale:new i.Uniform1f(m),u_device_pixel_ratio:new i.Uniform1f(m),u_tile_id:new i.Uniform3f(m),u_zoom_transition:new i.Uniform1f(m),u_inv_rot_matrix:new i.UniformMatrix4f(m),u_merc_center:new i.Uniform2f(m),u_camera_forward:new i.Uniform3f(m),u_tile_matrix:new i.UniformMatrix4f(m),u_up_vector:new i.Uniform3f(m),u_ecef_origin:new i.Uniform3f(m),u_is_halo:new i.Uniform1i(m)}),symbolTextAndIcon:m=>({u_is_size_zoom_constant:new i.Uniform1i(m),u_is_size_feature_constant:new i.Uniform1i(m),u_size_t:new i.Uniform1f(m),u_size:new i.Uniform1f(m),u_camera_to_center_distance:new i.Uniform1f(m),u_rotate_symbol:new i.Uniform1i(m),u_aspect_ratio:new i.Uniform1f(m),u_fade_change:new i.Uniform1f(m),u_matrix:new i.UniformMatrix4f(m),u_label_plane_matrix:new i.UniformMatrix4f(m),u_coord_matrix:new i.UniformMatrix4f(m),u_is_text:new i.Uniform1i(m),u_pitch_with_map:new i.Uniform1i(m),u_texsize:new i.Uniform2f(m),u_texsize_icon:new i.Uniform2f(m),u_texture:new i.Uniform1i(m),u_texture_icon:new i.Uniform1i(m),u_gamma_scale:new i.Uniform1f(m),u_device_pixel_ratio:new i.Uniform1f(m),u_is_halo:new i.Uniform1i(m)}),background:m=>({u_matrix:new i.UniformMatrix4f(m),u_opacity:new i.Uniform1f(m),u_color:new i.UniformColor(m)}),backgroundPattern:m=>({u_matrix:new i.UniformMatrix4f(m),u_opacity:new i.Uniform1f(m),u_image:new i.Uniform1i(m),u_pattern_tl:new i.Uniform2f(m),u_pattern_br:new i.Uniform2f(m),u_texsize:new i.Uniform2f(m),u_pattern_size:new i.Uniform2f(m),u_pixel_coord_upper:new i.Uniform2f(m),u_pixel_coord_lower:new i.Uniform2f(m),u_tile_units_to_pixels:new i.Uniform1f(m)}),terrainRaster:$h,terrainDepth:$h,skybox:m=>({u_matrix:new i.UniformMatrix4f(m),u_sun_direction:new i.Uniform3f(m),u_cubemap:new i.Uniform1i(m),u_opacity:new i.Uniform1f(m),u_temporal_offset:new i.Uniform1f(m)}),skyboxGradient:m=>({u_matrix:new i.UniformMatrix4f(m),u_color_ramp:new i.Uniform1i(m),u_center_direction:new i.Uniform3f(m),u_radius:new i.Uniform1f(m),u_opacity:new i.Uniform1f(m),u_temporal_offset:new i.Uniform1f(m)}),skyboxCapture:m=>({u_matrix_3f:new i.UniformMatrix3f(m),u_sun_direction:new i.Uniform3f(m),u_sun_intensity:new i.Uniform1f(m),u_color_tint_r:new i.Uniform4f(m),u_color_tint_m:new i.Uniform4f(m),u_luminance:new i.Uniform1f(m)}),globeRaster:m=>({u_proj_matrix:new i.UniformMatrix4f(m),u_globe_matrix:new i.UniformMatrix4f(m),u_normalize_matrix:new i.UniformMatrix4f(m),u_merc_matrix:new i.UniformMatrix4f(m),u_zoom_transition:new i.Uniform1f(m),u_merc_center:new i.Uniform2f(m),u_image0:new i.Uniform1i(m),u_grid_matrix:new i.UniformMatrix3f(m),u_skirt_height:new i.Uniform1f(m),u_frustum_tl:new i.Uniform3f(m),u_frustum_tr:new i.Uniform3f(m),u_frustum_br:new i.Uniform3f(m),u_frustum_bl:new i.Uniform3f(m),u_globe_pos:new i.Uniform3f(m),u_globe_radius:new i.Uniform1f(m),u_viewport:new i.Uniform2f(m)}),globeAtmosphere:m=>({u_frustum_tl:new i.Uniform3f(m),u_frustum_tr:new i.Uniform3f(m),u_frustum_br:new i.Uniform3f(m),u_frustum_bl:new i.Uniform3f(m),u_horizon:new i.Uniform1f(m),u_transition:new i.Uniform1f(m),u_fadeout_range:new i.Uniform1f(m),u_color:new i.Uniform4f(m),u_high_color:new i.Uniform4f(m),u_space_color:new i.Uniform4f(m),u_star_intensity:new i.Uniform1f(m),u_star_density:new i.Uniform1f(m),u_star_size:new i.Uniform1f(m),u_temporal_offset:new i.Uniform1f(m),u_horizon_angle:new i.Uniform1f(m),u_rotation_matrix:new i.UniformMatrix4f(m)})},vu;function bu(m,l,h,_,x,D,k){let R=m.context,z=R.gl,G=m.transform,H=m.useProgram("collisionBox"),K=[],se=0,le=0;for(let _e=0;_e<_.length;_e++){let Ae=_[_e],Re=l.getTile(Ae),Me=Re.getBucket(h);if(!Me)continue;let Be=Eo(Ae,Me,G),Fe=Be;x[0]===0&&x[1]===0||(Fe=m.translatePosMatrix(Be,Re,x,D));let je=k?Me.textCollisionBox:Me.iconCollisionBox,mt=Me.collisionCircleArray;if(mt.length>0){let He=i.create(),it=Fe;i.mul(He,Me.placementInvProjMatrix,G.glCoordMatrix),i.mul(He,He,Me.placementViewportMatrix),K.push({circleArray:mt,circleOffset:le,transform:it,invTransform:He,projection:Me.getProjection()}),se+=mt.length/4,le=se}je&&(m.terrain&&m.terrain.setupElevationDraw(Re,H),H.draw(R,z.LINES,i.DepthMode.disabled,i.StencilMode.disabled,m.colorModeForRenderPass(),i.CullFaceMode.disabled,xl(Fe,G,Re,Me.getProjection()),h.id,je.layoutVertexBuffer,je.indexBuffer,je.segments,null,G.zoom,null,[je.collisionVertexBuffer,je.collisionVertexBufferExt]))}if(!k||!K.length)return;let fe=m.useProgram("collisionCircle"),he=new i.StructArrayLayout2f1f2i16;he.resize(4*se),he._trim();let pe=0;for(let _e of K)for(let Ae=0;Ae<_e.circleArray.length/4;Ae++){let Re=4*Ae,Me=_e.circleArray[Re+0],Be=_e.circleArray[Re+1],Fe=_e.circleArray[Re+2],je=_e.circleArray[Re+3];he.emplace(pe++,Me,Be,Fe,je,0),he.emplace(pe++,Me,Be,Fe,je,1),he.emplace(pe++,Me,Be,Fe,je,2),he.emplace(pe++,Me,Be,Fe,je,3)}(!vu||vu.length<2*se)&&(vu=function(_e){let Ae=2*_e,Re=new i.StructArrayLayout3ui6;Re.resize(Ae),Re._trim();for(let Me=0;Me<Ae;Me++){let Be=6*Me;Re.uint16[Be+0]=4*Me+0,Re.uint16[Be+1]=4*Me+1,Re.uint16[Be+2]=4*Me+2,Re.uint16[Be+3]=4*Me+2,Re.uint16[Be+4]=4*Me+3,Re.uint16[Be+5]=4*Me+0}return Re}(se));let Q=R.createIndexBuffer(vu,!0),ue=R.createVertexBuffer(he,i.collisionCircleLayout.members,!0);for(let _e of K){let Ae={u_matrix:_e.transform,u_inv_matrix:_e.invTransform,u_camera_to_center_distance:(ye=G).getCameraToCenterDistance(_e.projection),u_viewport_size:[ye.width,ye.height]};fe.draw(R,z.TRIANGLES,i.DepthMode.disabled,i.StencilMode.disabled,m.colorModeForRenderPass(),i.CullFaceMode.disabled,Ae,h.id,ue,Q,i.SegmentVector.simpleSegment(0,2*_e.circleOffset,_e.circleArray.length,_e.circleArray.length/2),null,G.zoom)}var ye;ue.destroy(),Q.destroy()}let mc=i.create();function aa({width:m,height:l,anchor:h,textOffset:_,textScale:x},D){let{horizontalAlign:k,verticalAlign:R}=i.getAnchorAlignment(h),z=-(k-.5)*m,G=-(R-.5)*l,H=i.evaluateVariableOffset(h,_);return new i.Point((z/x+H[0])*D,(G/x+H[1])*D)}function ny(m,l,h,_,x,D,k,R,z,G,H){let K=m.text.placedSymbolArray,se=m.text.dynamicLayoutVertexArray,le=m.icon.dynamicLayoutVertexArray,fe={},he=m.getProjection(),pe=Ti(R,he,D),Q=D.elevation,ue=he.upVectorScale(R.canonical,D.center.lat,D.worldSize).metersToTile;se.clear();for(let ye=0;ye<K.length;ye++){let _e=K.get(ye),{tileAnchorX:Ae,tileAnchorY:Re,numGlyphs:Me}=_e,Be=_e.hidden||!_e.crossTileID||m.allowVerticalPlacement&&!_e.placedOrientation?null:_[_e.crossTileID];if(Be){let Fe=0,je=0,mt=0;if(Q){let _t=Q?Q.getAtTileOffset(R,Ae,Re):0,[$t,sn,Ft]=he.upVector(R.canonical,Ae,Re);Fe=_t*$t*ue,je=_t*sn*ue,mt=_t*Ft*ue}let[He,it,Ze,ht]=kr(_e.projectedAnchorX+Fe,_e.projectedAnchorY+je,_e.projectedAnchorZ+mt,h?pe:k),Ge=ru(D.getCameraToCenterDistance(he),ht),tt=x.evaluateSizeForFeature(m.textSizeData,G,_e)*Ge/i.ONE_EM;h&&(tt*=m.tilePixelRatio/z);let gt=aa(Be,tt);h?({x:He,y:it,z:Ze}=he.projectTilePoint(Ae+gt.x,Re+gt.y,R.canonical),[He,it,Ze]=kr(He+Fe,it+je,Ze+mt,k)):(l&&gt._rotate(-D.angle),He+=gt.x,it+=gt.y,Ze=0);let at=m.allowVerticalPlacement&&_e.placedOrientation===i.WritingMode.vertical?Math.PI/2:0;for(let _t=0;_t<Me;_t++)i.addDynamicAttributes(se,He,it,Ze,at);H&&_e.associatedIconIndex>=0&&(fe[_e.associatedIconIndex]={x:He,y:it,z:Ze,angle:at})}else Jo(Me,se)}if(H){le.clear();let ye=m.icon.placedSymbolArray;for(let _e=0;_e<ye.length;_e++){let Ae=ye.get(_e),{numGlyphs:Re}=Ae,Me=fe[_e];if(Ae.hidden||!Me)Jo(Re,le);else{let{x:Be,y:Fe,z:je,angle:mt}=Me;for(let He=0;He<Re;He++)i.addDynamicAttributes(le,Be,Fe,je,mt)}}m.icon.dynamicLayoutVertexBuffer.updateData(le)}m.text.dynamicLayoutVertexBuffer.updateData(se)}function Yh(m,l,h){return h.iconsInText&&l?"symbolTextAndIcon":m?"symbolSDF":"symbolIcon"}function Ap(m,l,h,_,x,D,k,R,z,G,H,K){let se=m.context,le=se.gl,fe=m.transform,he=R==="map",pe=z==="map",Q=he&&h.layout.get("symbol-placement")!=="point",ue=he&&!pe&&!Q,ye=h.layout.get("symbol-sort-key").constantOr(1)!==void 0,_e=!1,Ae=m.depthModeForSublayer(0,i.DepthMode.ReadOnly),Re=[i.mercatorXfromLng(fe.center.lng),i.mercatorYfromLat(fe.center.lat)],Me=h.layout.get("text-variable-anchor"),Be=fe.projection.name==="globe",Fe=[],je=[0,-1,0],mt=je;!Be&&!fe.mercatorFromTransition||he||(mt=function(He){let it=He._camera.getWorldToCamera(He.worldSize,1),Ze=i.multiply([],it,He.globeMatrix);i.invert(Ze,Ze);let ht=[0,0,0],Ge=[0,1,0,0];return i.transformMat4$1(Ge,Ge,Ze),ht[0]=Ge[0],ht[1]=Ge[1],ht[2]=Ge[2],i.normalize(ht,ht),ht}(fe));for(let He of _){let it=l.getTile(He),Ze=it.getBucket(h);if(!Ze||Ze.projection.name==="mercator"&&Be)continue;let ht=x?Ze.text:Ze.icon;if(!ht||Ze.fullyClipped||!ht.segments.get().length)continue;let Ge=ht.programConfigurations.get(h.id),tt=x||Ze.sdfIcons,gt=x?Ze.textSizeData:Ze.iconSizeData,at=pe||fe.pitch!==0,_t=i.evaluateSizeForZoom(gt,fe.zoom),$t,sn,Ft,Xt,Gt=[0,0],Mn=null;if(x)sn=it.glyphAtlasTexture,Ft=le.LINEAR,$t=it.glyphAtlasTexture.size,Ze.iconsInText&&(Gt=it.imageAtlasTexture.size,Mn=it.imageAtlasTexture,Xt=at||m.options.rotating||m.options.zooming||gt.kind==="composite"||gt.kind==="camera"?le.LINEAR:le.NEAREST);else{let ca=h.layout.get("icon-size").constantOr(0)!==1||Ze.iconsNeedLinear;sn=it.imageAtlasTexture,Ft=tt||m.options.rotating||m.options.zooming||ca||at?le.LINEAR:le.NEAREST,$t=it.imageAtlasTexture.size}let Vt=Ze.projection.name==="globe",Qn=Vt?mt:je,ui=Vt?i.globeToMercatorTransition(fe.zoom):0,di=Ti(He,Ze.getProjection(),fe),hi=fe.calculatePixelsToTileUnitsMatrix(it),dr=Je(di,it.tileID.canonical,pe,he,fe,Ze.getProjection(),hi),vr=m.terrain&&pe&&Q?i.invert(i.create(),dr):mc,To=ur(di,it.tileID.canonical,pe,he,fe,Ze.getProjection(),hi),is=Me&&Ze.hasTextData(),Si=h.layout.get("icon-text-fit")!=="none"&&is&&Ze.hasIconData();if(Q){let ca=fe.elevation,ua=ca?ca.getAtTileOffsetFunc(He,fe.center.lat,fe.worldSize,Ze.getProjection()):null,Ba=na(di,it.tileID.canonical,pe,he,fe,Ze.getProjection(),hi);_d(Ze,di,m,x,Ba,To,pe,G,ua,He)}let fi=Q||x&&Me||Si,rn=m.translatePosMatrix(di,it,D,k),hr=fi?mc:dr,ro=m.translatePosMatrix(To,it,D,k,!0),xi=Ze.getProjection().createInversionMatrix(fe,He.canonical),Nr=[];m.terrainRenderModeElevated()&&pe&&Nr.push("PITCH_WITH_MAP_TERRAIN"),Vt&&Nr.push("PROJECTION_GLOBE_VIEW"),fi&&Nr.push("PROJECTED_POS_ON_VIEWPORT");let la=tt&&h.paint.get(x?"text-halo-width":"icon-halo-width").constantOr(1)!==0,Rl;Rl=tt?Ze.iconsInText?Sp(gt.kind,_t,ue,pe,m,rn,hr,ro,$t,Gt,He,ui,Re,xi,Qn,Ze.getProjection()):Od(gt.kind,_t,ue,pe,m,rn,hr,ro,x,$t,!0,He,ui,Re,xi,Qn,Ze.getProjection()):Pd(gt.kind,_t,ue,pe,m,rn,hr,ro,x,$t,He,ui,Re,xi,Qn,Ze.getProjection());let mi={program:m.useProgram(Yh(tt,x,Ze),Ge,Nr),buffers:ht,uniformValues:Rl,atlasTexture:sn,atlasTextureIcon:Mn,atlasInterpolation:Ft,atlasInterpolationIcon:Xt,isSDF:tt,hasHalo:la,tile:it,labelPlaneMatrixInv:vr};if(ye&&Ze.canOverlap){_e=!0;let ca=ht.segments.get();for(let ua of ca)Fe.push({segments:new i.SegmentVector([ua]),sortKey:ua.sortKey,state:mi})}else Fe.push({segments:ht.segments,sortKey:0,state:mi})}_e&&Fe.sort((He,it)=>He.sortKey-it.sortKey);for(let He of Fe){let it=He.state;if(m.terrain&&m.terrain.setupElevationDraw(it.tile,it.program,{useDepthForOcclusion:!Be,labelPlaneMatrixInv:it.labelPlaneMatrixInv}),se.activeTexture.set(le.TEXTURE0),it.atlasTexture.bind(it.atlasInterpolation,le.CLAMP_TO_EDGE),it.atlasTextureIcon&&(se.activeTexture.set(le.TEXTURE1),it.atlasTextureIcon&&it.atlasTextureIcon.bind(it.atlasInterpolationIcon,le.CLAMP_TO_EDGE)),it.isSDF){let Ze=it.uniformValues;it.hasHalo&&(Ze.u_is_halo=1,xu(it.buffers,He.segments,h,m,it.program,Ae,H,K,Ze)),Ze.u_is_halo=0}xu(it.buffers,He.segments,h,m,it.program,Ae,H,K,it.uniformValues)}}function xu(m,l,h,_,x,D,k,R,z){let G=_.context,H=[m.dynamicLayoutVertexBuffer,m.opacityVertexBuffer,m.globeExtVertexBuffer];x.draw(G,G.gl.TRIANGLES,D,k,R,i.CullFaceMode.disabled,z,h.id,m.layoutVertexBuffer,m.indexBuffer,l,h.paint,_.transform.zoom,m.programConfigurations.get(h.id),H)}function kp(m,l,h,_,x,D,k){let R=m.context.gl,z=h.paint.get("fill-pattern"),G=z&&z.constantOr(1),H,K,se,le,fe;k?(K=G&&!h.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",H=R.LINES):(K=G?"fillPattern":"fill",H=R.TRIANGLES);for(let he of _){let pe=l.getTile(he);if(G&&!pe.patternsLoaded())continue;let Q=pe.getBucket(h);if(!Q)continue;m.prepareDrawTile();let ue=Q.programConfigurations.get(h.id),ye=m.useProgram(K,ue);G&&(m.context.activeTexture.set(R.TEXTURE0),pe.imageAtlasTexture.bind(R.LINEAR,R.CLAMP_TO_EDGE),ue.updatePaintBuffers());let _e=z.constantOr(null);if(_e&&pe.imageAtlas){let Re=pe.imageAtlas.patternPositions[_e.toString()];Re&&ue.setConstantPatternPositions(Re)}let Ae=m.translatePosMatrix(he.projMatrix,pe,h.paint.get("fill-translate"),h.paint.get("fill-translate-anchor"));if(k){le=Q.indexBuffer2,fe=Q.segments2;let Re=m.terrain&&m.terrain.renderingToTexture?m.terrain.drapeBufferSize:[R.drawingBufferWidth,R.drawingBufferHeight];se=K==="fillOutlinePattern"&&G?Jg(Ae,m,pe,Re):_l(Ae,Re)}else le=Q.indexBuffer,fe=Q.segments,se=G?hc(Ae,m,pe):Oa(Ae);m.prepareDrawProgram(m.context,ye,he.toUnwrapped()),ye.draw(m.context,H,x,m.stencilModeForClipping(he),D,i.CullFaceMode.disabled,se,h.id,Q.layoutVertexBuffer,le,fe,h.paint,m.transform.zoom,ue)}}function wl(m,l,h,_,x,D,k){let R=m.context,z=R.gl,G=m.transform,H=h.paint.get("fill-extrusion-pattern"),K=H.constantOr(1),se=h.paint.get("fill-extrusion-opacity"),le=[h.paint.get("fill-extrusion-ambient-occlusion-intensity"),h.paint.get("fill-extrusion-ambient-occlusion-radius")],fe=h.layout.get("fill-extrusion-edge-radius"),he=fe>0&&!h.paint.get("fill-extrusion-rounded-roof"),pe=he?0:fe,Q=G.projection.name==="globe"?i.fillExtrusionHeightLift():0,ue=G.projection.name==="globe",ye=ue?i.globeToMercatorTransition(G.zoom):0,_e=[i.mercatorXfromLng(G.center.lng),i.mercatorYfromLat(G.center.lat)],Ae=[];ue&&Ae.push("PROJECTION_GLOBE_VIEW"),le[0]>0&&Ae.push("FAUX_AO"),he&&Ae.push("ZERO_ROOF_RADIUS");for(let Re of _){let Me=l.getTile(Re),Be=Me.getBucket(h);if(!Be||Be.projection.name!==G.projection.name)continue;let Fe=Be.programConfigurations.get(h.id),je=m.useProgram(K?"fillExtrusionPattern":"fillExtrusion",Fe,Ae);if(m.terrain){let tt=m.terrain;if(m.style.terrainSetForDrapingOnly())tt.setupElevationDraw(Me,je,{useMeterToDem:!0});else{if(!Be.enableTerrain)continue;if(tt.setupElevationDraw(Me,je,{useMeterToDem:!0}),Ld(R,l,Re,Be,h,tt),!Be.centroidVertexBuffer){let gt=je.attributes.a_centroid_pos;gt!==void 0&&z.vertexAttrib2f(gt,0,0)}}}K&&(m.context.activeTexture.set(z.TEXTURE0),Me.imageAtlasTexture.bind(z.LINEAR,z.CLAMP_TO_EDGE),Fe.updatePaintBuffers());let mt=H.constantOr(null);if(mt&&Me.imageAtlas){let tt=Me.imageAtlas.patternPositions[mt.toString()];tt&&Fe.setConstantPatternPositions(tt)}let He=m.translatePosMatrix(Re.projMatrix,Me,h.paint.get("fill-extrusion-translate"),h.paint.get("fill-extrusion-translate-anchor")),it=G.projection.createInversionMatrix(G,Re.canonical),Ze=h.paint.get("fill-extrusion-vertical-gradient"),ht=K?Ip(He,m,Ze,se,le,pe,Re,Me,Q,ye,_e,it):dc(He,m,Ze,se,le,pe,Re,Q,ye,_e,it);m.prepareDrawProgram(R,je,Re.toUnwrapped());let Ge=[];m.terrain&&Ge.push(Be.centroidVertexBuffer),ue&&Ge.push(Be.layoutVertexExtBuffer),je.draw(R,R.gl.TRIANGLES,x,D,k,i.CullFaceMode.backCCW,ht,h.id,Be.layoutVertexBuffer,Be.indexBuffer,Be.segments,h.paint,m.transform.zoom,Fe,Ge)}}function Ld(m,l,h,_,x,D){let k=[Q=>{let ue=Q.canonical.x-1,ye=Q.wrap;return ue<0&&(ue=(1<<Q.canonical.z)-1,ye--),new i.OverscaledTileID(Q.overscaledZ,ye,Q.canonical.z,ue,Q.canonical.y)},Q=>{let ue=Q.canonical.x+1,ye=Q.wrap;return ue===1<<Q.canonical.z&&(ue=0,ye++),new i.OverscaledTileID(Q.overscaledZ,ye,Q.canonical.z,ue,Q.canonical.y)},Q=>new i.OverscaledTileID(Q.overscaledZ,Q.wrap,Q.canonical.z,Q.canonical.x,(Q.canonical.y===0?1<<Q.canonical.z:Q.canonical.y)-1),Q=>new i.OverscaledTileID(Q.overscaledZ,Q.wrap,Q.canonical.z,Q.canonical.x,Q.canonical.y===(1<<Q.canonical.z)-1?0:Q.canonical.y+1)],R=Q=>{let ue=l.getSource().minzoom,ye=Ae=>{let Re=l.getTileByID(Ae);if(Re&&Re.hasData())return Re.getBucket(x)},_e=[0,-1,1];for(let Ae of _e){if(Q.overscaledZ+Ae<ue)continue;let Re=ye(Q.calculateScaledKey(Q.overscaledZ+Ae));if(Re)return Re}},z=[0,0,0],G=(Q,ue)=>(z[0]=Math.min(Q.min.y,ue.min.y),z[1]=Math.max(Q.max.y,ue.max.y),z[2]=i.EXTENT-ue.min.x>Q.max.x?ue.min.x-i.EXTENT:Q.max.x,z),H=(Q,ue)=>(z[0]=Math.min(Q.min.x,ue.min.x),z[1]=Math.max(Q.max.x,ue.max.x),z[2]=i.EXTENT-ue.min.y>Q.max.y?ue.min.y-i.EXTENT:Q.max.y,z),K=[(Q,ue)=>G(Q,ue),(Q,ue)=>G(ue,Q),(Q,ue)=>H(Q,ue),(Q,ue)=>H(ue,Q)],se=new i.Point(0,0),le,fe,he,pe=(Q,ue,ye,_e,Ae)=>{let Re=[[_e?ye:Q,_e?Q:ye,0],[_e?ye:ue,_e?ue:ye,0]],Me=Ae<0?i.EXTENT+Ae:Ae,Be=[_e?Me:(Q+ue)/2,_e?(Q+ue)/2:Me,0];return ye===0&&Ae<0||ye!==0&&Ae>0?D.getForTilePoints(he,[Be],!0,fe):Re.push(Be),D.getForTilePoints(h,Re,!0,le),Math.max(Re[0][2],Re[1][2],Be[2])/D.exaggeration()};for(let Q=0;Q<4;Q++){let ue=(Q<2?1:5)-Q,ye=_.borders[Q];if(ye.length===0)continue;let _e=he=k[Q](h),Ae=R(_e);if(!(Ae&&Ae instanceof i.FillExtrusionBucket&&Ae.enableTerrain)||_.borderDoneWithNeighborZ[Q]===Ae.canonical.z&&Ae.borderDoneWithNeighborZ[ue]===_.canonical.z||(fe=D.findDEMTileFor(_e),!fe||!fe.dem))continue;if(!le){let Fe=D.findDEMTileFor(h);if(!Fe||!Fe.dem)return;le=Fe}let Re=Ae.borders[ue],Me=0,Be=Ae.borderDoneWithNeighborZ[ue]!==_.canonical.z;if(_.canonical.z===Ae.canonical.z){for(let Fe=0;Fe<ye.length;Fe++){let je=_.featuresOnBorder[ye[Fe]],mt=je.borders[Q],He;for(;Me<Re.length&&(He=Ae.featuresOnBorder[Re[Me]],!(He.borders[ue][1]>mt[0]+3));)Be&&Ae.encodeCentroid(void 0,He,!1),Me++;if(He&&Me<Re.length){let it=Me,Ze=0;for(;!(He.borders[ue][0]>mt[1]-3)&&(Ze++,++Me!==Re.length);)He=Ae.featuresOnBorder[Re[Me]];if(He=Ae.featuresOnBorder[Re[it]],je.intersectsCount()>1||He.intersectsCount()>1||Ze!==1){Ze!==1&&(Me=it),_.encodeCentroid(void 0,je,!1),Be&&Ae.encodeCentroid(void 0,He,!1);continue}let ht=K[Q](je,He),Ge=Q%2?i.EXTENT-1:0;se.x=pe(ht[0],Math.min(i.EXTENT-1,ht[1]),Ge,Q<2,ht[2]),se.y=0,_.encodeCentroid(se,je,!1),Be&&Ae.encodeCentroid(se,He,!1)}else _.encodeCentroid(void 0,je,!1)}_.borderDoneWithNeighborZ[Q]=Ae.canonical.z,_.needsCentroidUpdate=!0,Be&&(Ae.borderDoneWithNeighborZ[ue]=_.canonical.z,Ae.needsCentroidUpdate=!0)}else{for(let Fe of ye)_.encodeCentroid(void 0,_.featuresOnBorder[Fe],!1);if(Be){for(let Fe of Re)Ae.encodeCentroid(void 0,Ae.featuresOnBorder[Fe],!1);Ae.borderDoneWithNeighborZ[ue]=_.canonical.z,Ae.needsCentroidUpdate=!0}_.borderDoneWithNeighborZ[Q]=Ae.canonical.z,_.needsCentroidUpdate=!0}}(_.needsCentroidUpdate||!_.centroidVertexBuffer&&_.centroidVertexArray.length!==0)&&_.uploadCentroid(m)}let gc=new i.Color(1,0,0,1),Fd=new i.Color(0,1,0,1),Kh=new i.Color(0,0,1,1),iy=new i.Color(1,0,1,1),Rp=new i.Color(0,1,1,1);function wu(m,l,h){let _=m.context,x=m.transform,D=_.gl,k=x.projection.name==="globe",R=k?["PROJECTION_GLOBE_VIEW"]:null,z=h.projMatrix;if(k&&i.globeToMercatorTransition(x.zoom)>0){let je=i.transitionTileAABBinECEF(h.canonical,x),mt=i.globeDenormalizeECEF(je);z=i.multiply(new Float32Array(16),x.globeMatrix,mt),i.multiply(z,x.projMatrix,z)}let G=m.useProgram("debug",null,R),H=l.getTileByID(h.key);m.terrain&&m.terrain.setupElevationDraw(H,G);let K=i.DepthMode.disabled,se=i.StencilMode.disabled,le=m.colorModeForRenderPass(),fe="$debug";_.activeTexture.set(D.TEXTURE0),m.emptyTexture.bind(D.LINEAR,D.CLAMP_TO_EDGE),k?H._makeGlobeTileDebugBuffers(m.context,x):H._makeDebugTileBoundsBuffers(m.context,x.projection);let he=H._tileDebugBuffer||m.debugBuffer,pe=H._tileDebugIndexBuffer||m.debugIndexBuffer,Q=H._tileDebugSegments||m.debugSegments;G.draw(_,D.LINE_STRIP,K,se,le,i.CullFaceMode.disabled,Sd(z,i.Color.red),fe,he,pe,Q,null,null,null,[H._globeTileDebugBorderBuffer]);let ue=H.latestRawTileData,ye=Math.floor((ue&&ue.byteLength||0)/1024),_e=l.getTile(h).tileSize,Ae=512/Math.min(_e,512)*(h.overscaledZ/x.zoom)*.5,Re=h.canonical.toString();h.overscaledZ!==h.canonical.z&&(Re+=` => ${h.overscaledZ}`),Re+=` ${ye}kb`,function(je,mt){je.initDebugOverlayCanvas();let He=je.debugOverlayCanvas,it=je.context.gl,Ze=je.debugOverlayCanvas.getContext("2d");Ze.clearRect(0,0,He.width,He.height),Ze.shadowColor="white",Ze.shadowBlur=2,Ze.lineWidth=1.5,Ze.strokeStyle="white",Ze.textBaseline="top",Ze.font="bold 36px Open Sans, sans-serif",Ze.fillText(mt,5,5),Ze.strokeText(mt,5,5),je.debugOverlayTexture.update(He),je.debugOverlayTexture.bind(it.LINEAR,it.CLAMP_TO_EDGE)}(m,Re);let Me=H._tileDebugTextBuffer||m.debugBuffer,Be=H._tileDebugTextIndexBuffer||m.quadTriangleIndexBuffer,Fe=H._tileDebugTextSegments||m.debugSegments;G.draw(_,D.TRIANGLES,K,se,i.ColorMode.alphaBlended,i.CullFaceMode.disabled,Sd(z,i.Color.transparent,Ae),fe,Me,Be,Fe,null,null,null,[H._globeTileDebugTextBuffer])}function Pp(m,l,h,_){yc(m,0,l+h/2,m.transform.width,h,_)}function Cl(m,l,h,_){yc(m,l-h/2,0,h,m.transform.height,_)}function yc(m,l,h,_,x,D){let k=m.context,R=k.gl;R.enable(R.SCISSOR_TEST),R.scissor(l*i.exported.devicePixelRatio,h*i.exported.devicePixelRatio,_*i.exported.devicePixelRatio,x*i.exported.devicePixelRatio),k.clear({color:D}),R.disable(R.SCISSOR_TEST)}let Op=i.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:Fo}=Op;function uo(m,l,h,_){m.emplaceBack(l,h,_)}class Nd{constructor(l){this.vertexArray=new i.StructArrayLayout3f12,this.indices=new i.StructArrayLayout3ui6,uo(this.vertexArray,-1,-1,1),uo(this.vertexArray,1,-1,1),uo(this.vertexArray,-1,1,1),uo(this.vertexArray,1,1,1),uo(this.vertexArray,-1,-1,-1),uo(this.vertexArray,1,-1,-1),uo(this.vertexArray,-1,1,-1),uo(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=l.createVertexBuffer(this.vertexArray,Fo),this.indexBuffer=l.createIndexBuffer(this.indices),this.segment=i.SegmentVector.simpleSegment(0,0,36,12)}}function Mo(m,l,h,_,x,D){let k=m.gl,R=l.paint.get("sky-atmosphere-color"),z=l.paint.get("sky-atmosphere-halo-color"),G=l.paint.get("sky-atmosphere-sun-intensity"),H=((K,se,le,fe,he)=>({u_matrix_3f:K,u_sun_direction:se,u_sun_intensity:le,u_color_tint_r:[fe.r,fe.g,fe.b,fe.a],u_color_tint_m:[he.r,he.g,he.b,he.a],u_luminance:5e-5}))(i.fromMat4(i.create$1(),_),x,G,R,z);k.framebufferTexture2D(k.FRAMEBUFFER,k.COLOR_ATTACHMENT0,k.TEXTURE_CUBE_MAP_POSITIVE_X+D,l.skyboxTexture,0),h.draw(m,k.TRIANGLES,i.DepthMode.disabled,i.StencilMode.disabled,i.ColorMode.unblended,i.CullFaceMode.frontCW,H,"skyboxCapture",l.skyboxGeometry.vertexBuffer,l.skyboxGeometry.indexBuffer,l.skyboxGeometry.segment)}let Cu=i.createLayout([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class zd{constructor(l){let h=new i.StructArrayLayout5f20;h.emplaceBack(-1,1,1,0,0),h.emplaceBack(1,1,1,1,0),h.emplaceBack(1,-1,1,1,1),h.emplaceBack(-1,-1,1,0,1);let _=new i.StructArrayLayout3ui6;_.emplaceBack(0,1,2),_.emplaceBack(2,3,0),this.vertexBuffer=l.createVertexBuffer(h,Cu.members),this.indexBuffer=l.createIndexBuffer(_),this.segments=i.SegmentVector.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}let El={symbol:function(m,l,h,_,x){if(m.renderPass!=="translucent")return;let D=i.StencilMode.disabled,k=m.colorModeForRenderPass();h.layout.get("text-variable-anchor")&&function(R,z,G,H,K,se,le){let fe=z.transform,he=K==="map",pe=se==="map";for(let Q of R){let ue=H.getTile(Q),ye=ue.getBucket(G);if(!ye||!ye.text||!ye.text.segments.get().length)continue;let _e=i.evaluateSizeForZoom(ye.textSizeData,fe.zoom),Ae=Ti(Q,ye.getProjection(),fe),Re=fe.calculatePixelsToTileUnitsMatrix(ue),Me=Je(Ae,ue.tileID.canonical,pe,he,fe,ye.getProjection(),Re),Be=G.layout.get("icon-text-fit")!=="none"&&ye.hasIconData();if(_e){let Fe=Math.pow(2,fe.zoom-ue.tileID.overscaledZ);ny(ye,he,pe,le,i.symbolSize,fe,Me,Q,Fe,_e,Be)}}}(_,m,h,l,h.layout.get("text-rotation-alignment"),h.layout.get("text-pitch-alignment"),x),h.paint.get("icon-opacity").constantOr(1)!==0&&Ap(m,l,h,_,!1,h.paint.get("icon-translate"),h.paint.get("icon-translate-anchor"),h.layout.get("icon-rotation-alignment"),h.layout.get("icon-pitch-alignment"),h.layout.get("icon-keep-upright"),D,k),h.paint.get("text-opacity").constantOr(1)!==0&&Ap(m,l,h,_,!0,h.paint.get("text-translate"),h.paint.get("text-translate-anchor"),h.layout.get("text-rotation-alignment"),h.layout.get("text-pitch-alignment"),h.layout.get("text-keep-upright"),D,k),l.map.showCollisionBoxes&&(bu(m,l,h,_,h.paint.get("text-translate"),h.paint.get("text-translate-anchor"),!0),bu(m,l,h,_,h.paint.get("icon-translate"),h.paint.get("icon-translate-anchor"),!1))},circle:function(m,l,h,_){if(m.renderPass!=="translucent")return;let x=h.paint.get("circle-opacity"),D=h.paint.get("circle-stroke-width"),k=h.paint.get("circle-stroke-opacity"),R=h.layout.get("circle-sort-key").constantOr(1)!==void 0;if(x.constantOr(1)===0&&(D.constantOr(1)===0||k.constantOr(1)===0))return;let z=m.context,G=z.gl,H=m.transform,K=m.depthModeForSublayer(0,i.DepthMode.ReadOnly),se=i.StencilMode.disabled,le=m.colorModeForRenderPass(),fe=H.projection.name==="globe",he=[i.mercatorXfromLng(H.center.lng),i.mercatorYfromLat(H.center.lat)],pe=[];for(let ue=0;ue<_.length;ue++){let ye=_[ue],_e=l.getTile(ye),Ae=_e.getBucket(h);if(!Ae||Ae.projection.name!==H.projection.name)continue;let Re=Ae.programConfigurations.get(h.id),Me=bl(h);fe&&Me.push("PROJECTION_GLOBE_VIEW");let Be=m.useProgram("circle",Re,Me),Fe=Ae.layoutVertexBuffer,je=Ae.globeExtVertexBuffer,mt=Ae.indexBuffer,He=H.projection.createInversionMatrix(H,ye.canonical),it={programConfiguration:Re,program:Be,layoutVertexBuffer:Fe,globeExtVertexBuffer:je,indexBuffer:mt,uniformValues:Wh(m,ye,_e,He,he,h),tile:_e};if(R){let Ze=Ae.segments.get();for(let ht of Ze)pe.push({segments:new i.SegmentVector([ht]),sortKey:ht.sortKey,state:it})}else pe.push({segments:Ae.segments,sortKey:0,state:it})}R&&pe.sort((ue,ye)=>ue.sortKey-ye.sortKey);let Q={useDepthForOcclusion:!fe};for(let ue of pe){let{programConfiguration:ye,program:_e,layoutVertexBuffer:Ae,globeExtVertexBuffer:Re,indexBuffer:Me,uniformValues:Be,tile:Fe}=ue.state,je=ue.segments;m.terrain&&m.terrain.setupElevationDraw(Fe,_e,Q),m.prepareDrawProgram(z,_e,Fe.tileID.toUnwrapped()),_e.draw(z,G.TRIANGLES,K,se,le,i.CullFaceMode.disabled,Be,h.id,Ae,Me,je,h.paint,H.zoom,ye,[Re])}},heatmap:function(m,l,h,_){if(h.paint.get("heatmap-opacity")!==0)if(m.renderPass==="offscreen"){let x=m.context,D=x.gl,k=i.StencilMode.disabled,R=new i.ColorMode([D.ONE,D.ONE],i.Color.transparent,[!0,!0,!0,!0]);(function(le,fe,he,pe){let Q=le.gl,ue=fe.width*pe,ye=fe.height*pe;le.activeTexture.set(Q.TEXTURE1),le.viewport.set([0,0,ue,ye]);let _e=he.heatmapFbo;if(!_e||_e&&(_e.width!==ue||_e.height!==ye)){_e&&_e.destroy();let Ae=Q.createTexture();Q.bindTexture(Q.TEXTURE_2D,Ae),Q.texParameteri(Q.TEXTURE_2D,Q.TEXTURE_WRAP_S,Q.CLAMP_TO_EDGE),Q.texParameteri(Q.TEXTURE_2D,Q.TEXTURE_WRAP_T,Q.CLAMP_TO_EDGE),Q.texParameteri(Q.TEXTURE_2D,Q.TEXTURE_MIN_FILTER,Q.LINEAR),Q.texParameteri(Q.TEXTURE_2D,Q.TEXTURE_MAG_FILTER,Q.LINEAR),_e=he.heatmapFbo=le.createFramebuffer(ue,ye,!1),function(Re,Me,Be,Fe,je,mt){let He=Re.gl;He.texImage2D(He.TEXTURE_2D,0,Re.isWebGL2&&Re.extRenderToTextureHalfFloat?He.RGBA16F:He.RGBA,je,mt,0,He.RGBA,Re.extRenderToTextureHalfFloat?Re.isWebGL2?He.HALF_FLOAT:Re.extTextureHalfFloat.HALF_FLOAT_OES:He.UNSIGNED_BYTE,null),Fe.colorAttachment.set(Be)}(le,0,Ae,_e,ue,ye)}else Q.bindTexture(Q.TEXTURE_2D,_e.colorAttachment.get()),le.bindFramebuffer.set(_e.framebuffer)})(x,m,h,m.transform.projection.name==="globe"?.5:.25),x.clear({color:i.Color.transparent});let z=m.transform,G=z.projection.name==="globe",H=G?["PROJECTION_GLOBE_VIEW"]:null,K=G?i.CullFaceMode.frontCCW:i.CullFaceMode.disabled,se=[i.mercatorXfromLng(z.center.lng),i.mercatorYfromLat(z.center.lat)];for(let le=0;le<_.length;le++){let fe=_[le];if(l.hasRenderableParent(fe))continue;let he=l.getTile(fe),pe=he.getBucket(h);if(!pe||pe.projection.name!==z.projection.name)continue;let Q=pe.programConfigurations.get(h.id),ue=m.useProgram("heatmap",Q,H),{zoom:ye}=m.transform;m.terrain&&m.terrain.setupElevationDraw(he,ue),m.prepareDrawProgram(x,ue,fe.toUnwrapped());let _e=z.projection.createInversionMatrix(z,fe.canonical);ue.draw(x,D.TRIANGLES,i.DepthMode.disabled,k,R,K,kd(m,fe,he,_e,se,ye,h.paint.get("heatmap-intensity")),h.id,pe.layoutVertexBuffer,pe.indexBuffer,pe.segments,h.paint,m.transform.zoom,Q,G?[pe.globeExtVertexBuffer]:null)}x.viewport.set([0,0,m.width,m.height])}else m.renderPass==="translucent"&&(m.context.setColorMode(m.colorModeForRenderPass()),function(x,D){let k=x.context,R=k.gl,z=D.heatmapFbo;if(!z)return;k.activeTexture.set(R.TEXTURE0),R.bindTexture(R.TEXTURE_2D,z.colorAttachment.get()),k.activeTexture.set(R.TEXTURE1);let G=D.colorRampTexture;G||(G=D.colorRampTexture=new i.Texture(k,D.colorRamp,R.RGBA)),G.bind(R.LINEAR,R.CLAMP_TO_EDGE),x.useProgram("heatmapTexture").draw(k,R.TRIANGLES,i.DepthMode.disabled,i.StencilMode.disabled,x.colorModeForRenderPass(),i.CullFaceMode.disabled,((H,K,se,le)=>({u_image:0,u_color_ramp:1,u_opacity:K.paint.get("heatmap-opacity")}))(0,D),D.id,x.viewportBuffer,x.quadTriangleIndexBuffer,x.viewportSegments,D.paint,x.transform.zoom)}(m,h))},line:function(m,l,h,_){if(m.renderPass!=="translucent")return;let x=h.paint.get("line-opacity"),D=h.paint.get("line-width");if(x.constantOr(1)===0||D.constantOr(1)===0)return;let k=m.depthModeForSublayer(0,i.DepthMode.ReadOnly),R=m.colorModeForRenderPass(),z=m.terrain&&m.terrain.renderingToTexture?1:i.exported.devicePixelRatio,G=h.paint.get("line-dasharray"),H=G.constantOr(1),K=h.layout.get("line-cap"),se=h.paint.get("line-pattern"),le=se.constantOr(1),fe=h.paint.get("line-gradient"),he=le?"linePattern":"line",pe=m.context,Q=pe.gl,ue=(_e=>{let Ae=[];_u(_e)&&Ae.push("RENDER_LINE_DASH"),_e.paint.get("line-gradient")&&Ae.push("RENDER_LINE_GRADIENT");let Re=_e.paint.get("line-trim-offset");Re[0]===0&&Re[1]===0||Ae.push("RENDER_LINE_TRIM_OFFSET");let Me=_e.paint.get("line-pattern").constantOr(1),Be=_e.paint.get("line-opacity").constantOr(1)!==1;return!Me&&Be&&Ae.push("RENDER_LINE_ALPHA_DISCARD"),Ae})(h),ye=ue.includes("RENDER_LINE_ALPHA_DISCARD");m.terrain&&m.terrain.clipOrMaskOverlapStencilType()&&(ye=!1);for(let _e of _){let Ae=l.getTile(_e);if(le&&!Ae.patternsLoaded())continue;let Re=Ae.getBucket(h);if(!Re)continue;m.prepareDrawTile();let Me=Re.programConfigurations.get(h.id),Be=m.useProgram(he,Me,ue),Fe=se.constantOr(null);if(Fe&&Ae.imageAtlas){let tt=Ae.imageAtlas.patternPositions[Fe.toString()];tt&&Me.setConstantPatternPositions(tt)}let je=G.constantOr(null),mt=K.constantOr(null);if(!le&&je&&mt&&Ae.lineAtlas){let tt=Ae.lineAtlas.getDash(je,mt);tt&&Me.setConstantPatternPositions(tt)}let[He,it]=h.paint.get("line-trim-offset");(mt==="round"||mt==="square")&&He!==it&&(He===0&&(He-=1),it===1&&(it+=1));let Ze=m.terrain?_e.projMatrix:null,ht=le?yu(m,Ae,h,Ze,z):ey(m,Ae,h,Ze,Re.lineClipsArray.length,z,[He,it]);if(fe){let tt=Re.gradients[h.id],gt=tt.texture;if(h.gradientVersion!==tt.version){let at=256;if(h.stepInterpolant){let _t=l.getSource().maxzoom,$t=_e.canonical.z===_t?Math.ceil(1<<m.transform.maxZoom-_e.canonical.z):1;at=i.clamp(i.nextPowerOfTwo(Re.maxLineLength/i.EXTENT*1024*$t),256,pe.maxTextureSize)}tt.gradient=i.renderColorRamp({expression:h.gradientExpression(),evaluationKey:"lineProgress",resolution:at,image:tt.gradient||void 0,clips:Re.lineClipsArray}),tt.texture?tt.texture.update(tt.gradient):tt.texture=new i.Texture(pe,tt.gradient,Q.RGBA),tt.version=h.gradientVersion,gt=tt.texture}pe.activeTexture.set(Q.TEXTURE1),gt.bind(h.stepInterpolant?Q.NEAREST:Q.LINEAR,Q.CLAMP_TO_EDGE)}H&&(pe.activeTexture.set(Q.TEXTURE0),Ae.lineAtlasTexture.bind(Q.LINEAR,Q.REPEAT),Me.updatePaintBuffers()),le&&(pe.activeTexture.set(Q.TEXTURE0),Ae.imageAtlasTexture.bind(Q.LINEAR,Q.CLAMP_TO_EDGE),Me.updatePaintBuffers()),m.prepareDrawProgram(pe,Be,_e.toUnwrapped());let Ge=tt=>{Be.draw(pe,Q.TRIANGLES,k,tt,R,i.CullFaceMode.disabled,ht,h.id,Re.layoutVertexBuffer,Re.indexBuffer,Re.segments,h.paint,m.transform.zoom,Me,[Re.layoutVertexBuffer2])};if(ye){let tt=m.stencilModeForClipping(_e).ref;tt===0&&m.terrain&&pe.clear({stencil:0});let gt={func:Q.EQUAL,mask:255};ht.u_alpha_discard_threshold=.8,Ge(new i.StencilMode(gt,tt,255,Q.KEEP,Q.KEEP,Q.INVERT)),ht.u_alpha_discard_threshold=0,Ge(new i.StencilMode(gt,tt,255,Q.KEEP,Q.KEEP,Q.KEEP))}else Ge(m.stencilModeForClipping(_e))}ye&&(m.resetStencilClippingMasks(),m.terrain&&pe.clear({stencil:0}))},fill:function(m,l,h,_){let x=h.paint.get("fill-color"),D=h.paint.get("fill-opacity");if(D.constantOr(1)===0)return;let k=m.colorModeForRenderPass(),R=h.paint.get("fill-pattern"),z=m.opaquePassEnabledForLayer()&&!R.constantOr(1)&&x.constantOr(i.Color.transparent).a===1&&D.constantOr(0)===1?"opaque":"translucent";if(m.renderPass===z){let G=m.depthModeForSublayer(1,m.renderPass==="opaque"?i.DepthMode.ReadWrite:i.DepthMode.ReadOnly);kp(m,l,h,_,G,k,!1)}if(m.renderPass==="translucent"&&h.paint.get("fill-antialias")){let G=m.depthModeForSublayer(h.getPaintProperty("fill-outline-color")?2:0,i.DepthMode.ReadOnly);kp(m,l,h,_,G,k,!0)}},"fill-extrusion":function(m,l,h,_){let x=h.paint.get("fill-extrusion-opacity");if(x!==0&&m.renderPass==="translucent"){let D=new i.DepthMode(m.context.gl.LEQUAL,i.DepthMode.ReadWrite,m.depthRangeFor3D);if(x!==1||h.paint.get("fill-extrusion-pattern").constantOr(1))wl(m,l,h,_,D,i.StencilMode.disabled,i.ColorMode.disabled),wl(m,l,h,_,D,m.stencilModeFor3D(),m.colorModeForRenderPass()),m.resetStencilClippingMasks();else{let k=m.colorModeForRenderPass();wl(m,l,h,_,D,i.StencilMode.disabled,k)}}},hillshade:function(m,l,h,_){if(m.renderPass!=="offscreen"&&m.renderPass!=="translucent")return;let x=m.context,D=m.depthModeForSublayer(0,i.DepthMode.ReadOnly),k=m.colorModeForRenderPass(),R=m.terrain&&m.terrain.renderingToTexture,[z,G]=m.renderPass!=="translucent"||R?[{},_]:m.stencilConfigForOverlap(_);for(let H of G){let K=l.getTile(H);if(K.needsHillshadePrepare&&m.renderPass==="offscreen")Tp(m,K,h,D,i.StencilMode.disabled,k);else if(m.renderPass==="translucent"){let se=R&&m.terrain?m.terrain.stencilModeForRTTOverlap(H):z[H.overscaledZ];wd(m,H,K,h,D,se,k)}}x.viewport.set([0,0,m.width,m.height]),m.resetStencilClippingMasks()},raster:function(m,l,h,_,x,D){if(m.renderPass!=="translucent"||h.paint.get("raster-opacity")===0||!_.length)return;let k=m.context,R=k.gl,z=l.getSource(),G=m.useProgram("raster"),H=m.colorModeForRenderPass(),K=m.terrain&&m.terrain.renderingToTexture,[se,le]=z instanceof In||K?[{},_]:m.stencilConfigForOverlap(_),fe=le[le.length-1].overscaledZ,he=!m.options.moving;for(let pe of le){let Q=K?i.DepthMode.disabled:m.depthModeForSublayer(pe.overscaledZ-fe,h.paint.get("raster-opacity")===1?i.DepthMode.ReadWrite:i.DepthMode.ReadOnly,R.LESS),ue=pe.toUnwrapped(),ye=l.getTile(pe);if(K&&(!ye||!ye.hasData()))continue;let _e=K?pe.projMatrix:m.transform.calculateProjMatrix(ue,he),Ae=m.terrain&&K?m.terrain.stencilModeForRTTOverlap(pe):se[pe.overscaledZ],Re=D?0:h.paint.get("raster-fade-duration");ye.registerFadeDuration(Re);let Me=l.findLoadedParent(pe,0),Be=Dd(ye,Me,l,m.transform,Re),Fe,je;m.terrain&&m.terrain.prepareDrawTile();let mt=h.paint.get("raster-resampling")==="nearest"?R.NEAREST:R.LINEAR;k.activeTexture.set(R.TEXTURE0),ye.texture.bind(mt,R.CLAMP_TO_EDGE),k.activeTexture.set(R.TEXTURE1),Me?(Me.texture.bind(mt,R.CLAMP_TO_EDGE),Fe=Math.pow(2,Me.tileID.overscaledZ-ye.tileID.overscaledZ),je=[ye.tileID.canonical.x*Fe%1,ye.tileID.canonical.y*Fe%1]):ye.texture.bind(mt,R.CLAMP_TO_EDGE),ye.texture.useMipmap&&k.extTextureFilterAnisotropic&&m.transform.pitch>20&&R.texParameterf(R.TEXTURE_2D,k.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,k.extTextureFilterAnisotropicMax);let He=qh(_e,je||[0,0],Fe||1,Be,h,z instanceof In?z.perspectiveTransform:[0,0]);if(m.prepareDrawProgram(k,G,ue),z instanceof In)z.boundsBuffer&&z.boundsSegments&&G.draw(k,R.TRIANGLES,Q,i.StencilMode.disabled,H,i.CullFaceMode.disabled,He,h.id,z.boundsBuffer,m.quadTriangleIndexBuffer,z.boundsSegments);else{let{tileBoundsBuffer:it,tileBoundsIndexBuffer:Ze,tileBoundsSegments:ht}=m.getTileBoundsBuffers(ye);G.draw(k,R.TRIANGLES,Q,Ae,H,i.CullFaceMode.disabled,He,h.id,it,Ze,ht)}}m.resetStencilClippingMasks()},background:function(m,l,h,_){let x=h.paint.get("background-color"),D=h.paint.get("background-opacity");if(D===0)return;let k=m.context,R=k.gl,z=m.transform,G=z.tileSize,H=h.paint.get("background-pattern");if(m.isPatternMissing(H))return;let K=!H&&x.a===1&&D===1&&m.opaquePassEnabledForLayer()?"opaque":"translucent";if(m.renderPass!==K)return;let se=i.StencilMode.disabled,le=m.depthModeForSublayer(0,K==="opaque"?i.DepthMode.ReadWrite:i.DepthMode.ReadOnly),fe=m.colorModeForRenderPass(),he=m.useProgram(H?"backgroundPattern":"background"),pe,Q=_;Q||(pe=m.getBackgroundTiles(),Q=Object.values(pe).map(ue=>ue.tileID)),H&&(k.activeTexture.set(R.TEXTURE0),m.imageManager.bind(m.context));for(let ue of Q){let ye=ue.toUnwrapped(),_e=_?ue.projMatrix:m.transform.calculateProjMatrix(ye);m.prepareDrawTile();let Ae=l?l.getTile(ue):pe?pe[ue.key]:new i.Tile(ue,G,z.zoom,m),Re=H?ty(_e,D,m,H,{tileID:ue,tileSize:G}):Zh(_e,D,x);m.prepareDrawProgram(k,he,ye);let{tileBoundsBuffer:Me,tileBoundsIndexBuffer:Be,tileBoundsSegments:Fe}=m.getTileBoundsBuffers(Ae);he.draw(k,R.TRIANGLES,le,se,fe,i.CullFaceMode.disabled,Re,h.id,Me,Be,Fe)}},sky:function(m,l,h){let _=m.transform,x=_.projection.name==="mercator"||_.projection.name==="globe"?1:i.smoothstep(7,8,_.zoom),D=h.paint.get("sky-opacity")*x;if(D===0)return;let k=m.context,R=h.paint.get("sky-type"),z=new i.DepthMode(k.gl.LEQUAL,i.DepthMode.ReadOnly,[0,1]),G=m.frameCounter/1e3%1;R==="atmosphere"?m.renderPass==="offscreen"?h.needsSkyboxCapture(m)&&(function(H,K,se,le){let fe=H.context,he=fe.gl,pe=K.skyboxFbo;if(!pe){pe=K.skyboxFbo=fe.createFramebuffer(32,32,!1),K.skyboxGeometry=new Nd(fe),K.skyboxTexture=fe.gl.createTexture(),he.bindTexture(he.TEXTURE_CUBE_MAP,K.skyboxTexture),he.texParameteri(he.TEXTURE_CUBE_MAP,he.TEXTURE_WRAP_S,he.CLAMP_TO_EDGE),he.texParameteri(he.TEXTURE_CUBE_MAP,he.TEXTURE_WRAP_T,he.CLAMP_TO_EDGE),he.texParameteri(he.TEXTURE_CUBE_MAP,he.TEXTURE_MIN_FILTER,he.LINEAR),he.texParameteri(he.TEXTURE_CUBE_MAP,he.TEXTURE_MAG_FILTER,he.LINEAR);for(let _e=0;_e<6;++_e)he.texImage2D(he.TEXTURE_CUBE_MAP_POSITIVE_X+_e,0,he.RGBA,32,32,0,he.RGBA,he.UNSIGNED_BYTE,null)}fe.bindFramebuffer.set(pe.framebuffer),fe.viewport.set([0,0,32,32]);let Q=K.getCenter(H,!0),ue=H.useProgram("skyboxCapture"),ye=new Float64Array(16);i.identity(ye),i.rotateY(ye,ye,.5*-Math.PI),Mo(fe,K,ue,ye,Q,0),i.identity(ye),i.rotateY(ye,ye,.5*Math.PI),Mo(fe,K,ue,ye,Q,1),i.identity(ye),i.rotateX(ye,ye,.5*-Math.PI),Mo(fe,K,ue,ye,Q,2),i.identity(ye),i.rotateX(ye,ye,.5*Math.PI),Mo(fe,K,ue,ye,Q,3),i.identity(ye),Mo(fe,K,ue,ye,Q,4),i.identity(ye),i.rotateY(ye,ye,Math.PI),Mo(fe,K,ue,ye,Q,5),fe.viewport.set([0,0,H.width,H.height])}(m,h),h.markSkyboxValid(m)):m.renderPass==="sky"&&function(H,K,se,le,fe){let he=H.context,pe=he.gl,Q=H.transform,ue=H.useProgram("skybox");he.activeTexture.set(pe.TEXTURE0),pe.bindTexture(pe.TEXTURE_CUBE_MAP,K.skyboxTexture);let ye=((_e,Ae,Re,Me,Be)=>({u_matrix:_e,u_sun_direction:Ae,u_cubemap:0,u_opacity:Me,u_temporal_offset:Be}))(Q.skyboxMatrix,K.getCenter(H,!1),0,le,fe);H.prepareDrawProgram(he,ue),ue.draw(he,pe.TRIANGLES,se,i.StencilMode.disabled,H.colorModeForRenderPass(),i.CullFaceMode.backCW,ye,"skybox",K.skyboxGeometry.vertexBuffer,K.skyboxGeometry.indexBuffer,K.skyboxGeometry.segment)}(m,h,z,D,G):R==="gradient"&&m.renderPass==="sky"&&function(H,K,se,le,fe){let he=H.context,pe=he.gl,Q=H.transform,ue=H.useProgram("skyboxGradient");K.skyboxGeometry||(K.skyboxGeometry=new Nd(he)),he.activeTexture.set(pe.TEXTURE0);let ye=K.colorRampTexture;ye||(ye=K.colorRampTexture=new i.Texture(he,K.colorRamp,pe.RGBA)),ye.bind(pe.LINEAR,pe.CLAMP_TO_EDGE);let _e=((Ae,Re,Me,Be,Fe)=>({u_matrix:Ae,u_color_ramp:0,u_center_direction:Re,u_radius:i.degToRad(Me),u_opacity:Be,u_temporal_offset:Fe}))(Q.skyboxMatrix,K.getCenter(H,!1),K.paint.get("sky-gradient-radius"),le,fe);H.prepareDrawProgram(he,ue),ue.draw(he,pe.TRIANGLES,se,i.StencilMode.disabled,H.colorModeForRenderPass(),i.CullFaceMode.backCW,_e,"skyboxGradient",K.skyboxGeometry.vertexBuffer,K.skyboxGeometry.indexBuffer,K.skyboxGeometry.segment)}(m,h,z,D,G)},debug:function(m,l,h){for(let _=0;_<h.length;_++)wu(m,l,h[_])},custom:function(m,l,h,_){let x=m.context,D=h.implementation;if(!m.transform.projection.unsupportedLayers||!m.transform.projection.unsupportedLayers.includes("custom")||m.terrain&&(m.terrain.renderingToTexture||m.renderPass==="offscreen")&&h.isLayerDraped()){if(m.renderPass==="offscreen"){let k=D.prerender;if(k){if(m.setCustomLayerDefaults(),x.setColorMode(m.colorModeForRenderPass()),m.transform.projection.name==="globe"){let R=m.transform.pointMerc;k.call(D,x.gl,m.transform.customLayerMatrix(),m.transform.getProjection(),m.transform.globeToMercatorMatrix(),i.globeToMercatorTransition(m.transform.zoom),[R.x,R.y],m.transform.pixelsPerMeterRatio)}else k.call(D,x.gl,m.transform.customLayerMatrix());x.setDirty(),m.setBaseState()}}else if(m.renderPass==="translucent"){if(m.terrain&&m.terrain.renderingToTexture){let R=D.renderToTile;if(R){let z=_[0].canonical,G=new i.MercatorCoordinate(z.x+_[0].wrap*(1<<z.z),z.y,z.z);x.setDepthMode(i.DepthMode.disabled),x.setStencilMode(i.StencilMode.disabled),x.setColorMode(m.colorModeForRenderPass()),m.setCustomLayerDefaults(),R.call(D,x.gl,G),x.setDirty(),m.setBaseState()}return}m.setCustomLayerDefaults(),x.setColorMode(m.colorModeForRenderPass()),x.setStencilMode(i.StencilMode.disabled);let k=D.renderingMode==="3d"?new i.DepthMode(m.context.gl.LEQUAL,i.DepthMode.ReadWrite,m.depthRangeFor3D):m.depthModeForSublayer(0,i.DepthMode.ReadOnly);if(x.setDepthMode(k),m.transform.projection.name==="globe"){let R=m.transform.pointMerc;D.render(x.gl,m.transform.customLayerMatrix(),m.transform.getProjection(),m.transform.globeToMercatorMatrix(),i.globeToMercatorTransition(m.transform.zoom),[R.x,R.y],m.transform.pixelsPerMeterRatio)}else D.render(x.gl,m.transform.customLayerMatrix());x.setDirty(),m.setBaseState(),x.bindFramebuffer.set(null)}}else i.warnOnce("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")}};class _c{constructor(l,h,_=!1){this.context=new Ct(l,_),this.transform=h,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=i.SourceCache.maxUnderzooming+i.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={}}updateTerrain(l,h){let _=!!l&&!!l.terrain&&this.transform.projection.supportsTerrain;if(!(_||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new Gh(this,l));let x=this._terrain;this.transform.elevation=_?x:null,x.update(l,this.transform,h)}_updateFog(l){let h=l.fog;if(!h||this.transform.projection.name==="globe"||h.getOpacity(this.transform.pitch)<1||h.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);let[_,x]=h.getFovAdjustedRange(this.transform._fov);if(_>x)return void(this.transform.fogCullDistSq=null);let D=_+.78*(x-_);this.transform.fogCullDistSq=D*D}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}resize(l,h){if(this.width=l*i.exported.devicePixelRatio,this.height=h*i.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(let _ of this.style.order)this.style._layers[_].resize()}setup(){let l=this.context,h=new i.StructArrayLayout2i4;h.emplaceBack(0,0),h.emplaceBack(i.EXTENT,0),h.emplaceBack(0,i.EXTENT),h.emplaceBack(i.EXTENT,i.EXTENT),this.tileExtentBuffer=l.createVertexBuffer(h,i.posAttributes.members),this.tileExtentSegments=i.SegmentVector.simpleSegment(0,0,4,2);let _=new i.StructArrayLayout2i4;_.emplaceBack(0,0),_.emplaceBack(i.EXTENT,0),_.emplaceBack(0,i.EXTENT),_.emplaceBack(i.EXTENT,i.EXTENT),this.debugBuffer=l.createVertexBuffer(_,i.posAttributes.members),this.debugSegments=i.SegmentVector.simpleSegment(0,0,4,5);let x=new i.StructArrayLayout2i4;x.emplaceBack(-1,-1),x.emplaceBack(1,-1),x.emplaceBack(-1,1),x.emplaceBack(1,1),this.viewportBuffer=l.createVertexBuffer(x,i.posAttributes.members),this.viewportSegments=i.SegmentVector.simpleSegment(0,0,4,2);let D=new i.StructArrayLayout4i8;D.emplaceBack(0,0,0,0),D.emplaceBack(i.EXTENT,0,i.EXTENT,0),D.emplaceBack(0,i.EXTENT,0,i.EXTENT),D.emplaceBack(i.EXTENT,i.EXTENT,i.EXTENT,i.EXTENT),this.mercatorBoundsBuffer=l.createVertexBuffer(D,i.boundsAttributes.members),this.mercatorBoundsSegments=i.SegmentVector.simpleSegment(0,0,4,2);let k=new i.StructArrayLayout3ui6;k.emplaceBack(0,1,2),k.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=l.createIndexBuffer(k);let R=new i.StructArrayLayout1ui2;for(let G of[0,1,3,2,0])R.emplaceBack(G);this.debugIndexBuffer=l.createIndexBuffer(R),this.emptyTexture=new i.Texture(l,new i.RGBAImage({width:1,height:1},Uint8Array.of(0,0,0,0)),l.gl.RGBA),this.identityMat=i.create();let z=this.context.gl;this.stencilClearMode=new i.StencilMode({func:z.ALWAYS,mask:0},0,255,z.ZERO,z.ZERO,z.ZERO),this.loadTimeStamps.push(i.window.performance.now()),this.atmosphereBuffer=new zd(this.context)}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(l){return l._makeTileBoundsBuffers(this.context,this.transform.projection),l._tileBoundsBuffer?{tileBoundsBuffer:l._tileBoundsBuffer,tileBoundsIndexBuffer:l._tileBoundsIndexBuffer,tileBoundsSegments:l._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){let l=this.context,h=l.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.useProgram("clippingMask").draw(l,h.TRIANGLES,i.DepthMode.disabled,this.stencilClearMode,i.ColorMode.disabled,i.CullFaceMode.disabled,Cs(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(l,h,_){if(!h||this.currentStencilSource===h.id||!l.isTileClipped()||!_||_.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let R=!1;for(let z of _)if(this._tileClippingMaskIDs[z.key]===void 0){R=!0;break}if(!R)return}this.currentStencilSource=h.id;let x=this.context,D=x.gl;this.nextStencilID+_.length>256&&this.clearStencil(),x.setColorMode(i.ColorMode.disabled),x.setDepthMode(i.DepthMode.disabled);let k=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(let R of _){let z=h.getTile(R),G=this._tileClippingMaskIDs[R.key]=this.nextStencilID++,{tileBoundsBuffer:H,tileBoundsIndexBuffer:K,tileBoundsSegments:se}=this.getTileBoundsBuffers(z);k.draw(x,D.TRIANGLES,i.DepthMode.disabled,new i.StencilMode({func:D.ALWAYS,mask:0},G,255,D.KEEP,D.KEEP,D.REPLACE),i.ColorMode.disabled,i.CullFaceMode.disabled,Cs(R.projMatrix),"$clipping",H,K,se)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();let l=this.nextStencilID++,h=this.context.gl;return new i.StencilMode({func:h.NOTEQUAL,mask:255},l,255,h.KEEP,h.KEEP,h.REPLACE)}stencilModeForClipping(l){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(l);let h=this.context.gl;return new i.StencilMode({func:h.EQUAL,mask:255},this._tileClippingMaskIDs[l.key],0,h.KEEP,h.KEEP,h.REPLACE)}stencilConfigForOverlap(l){let h=this.context.gl,_=l.sort((k,R)=>R.overscaledZ-k.overscaledZ),x=_[_.length-1].overscaledZ,D=_[0].overscaledZ-x+1;if(D>1){this.currentStencilSource=void 0,this.nextStencilID+D>256&&this.clearStencil();let k={};for(let R=0;R<D;R++)k[R+x]=new i.StencilMode({func:h.GEQUAL,mask:255},R+this.nextStencilID,255,h.KEEP,h.KEEP,h.REPLACE);return this.nextStencilID+=D,[k,_]}return[{[x]:i.StencilMode.disabled},_]}colorModeForRenderPass(){let l=this.context.gl;return this._showOverdrawInspector?new i.ColorMode([l.CONSTANT_COLOR,l.ONE],new i.Color(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?i.ColorMode.unblended:i.ColorMode.alphaBlended}depthModeForSublayer(l,h,_){if(!this.opaquePassEnabledForLayer())return i.DepthMode.disabled;let x=1-((1+this.currentLayer)*this.numSublayers+l)*this.depthEpsilon;return new i.DepthMode(_||this.context.gl.LEQUAL,h,[x,x])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(l,h){this.style=l,this.options=h,this.imageManager=l.imageManager,this.glyphManager=l.glyphManager,this.symbolFadeChange=l.placement.symbolFadeChange(i.exported.now()),this.imageManager.beginFrame();let _=this.style.order,x=this.style._sourceCaches;for(let G in x){let H=x[G];H.used&&H.prepare(this.context)}let D={},k={},R={};for(let G in x){let H=x[G];D[G]=H.getVisibleCoordinates(),k[G]=D[G].slice().reverse(),R[G]=H.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let G=0;G<_.length;G++)if(this.style._layers[_[G]].is3D()){this.opaquePassCutoff=G;break}if(this.terrain&&(this.terrain.updateTileBinding(R),this.opaquePassCutoff=0),this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new i.GlobeSharedBuffers(this.context)),!i.isMapAuthenticated(this.context.gl))return;this.renderPass="offscreen";for(let G of _){let H=this.style._layers[G],K=l._getLayerSourceCache(H);if(!H.hasOffscreenPass()||H.isHidden(this.transform.zoom))continue;let se=K?k[K.id]:void 0;(H.type==="custom"||H.isSky()||se&&se.length)&&this.renderLayer(this,K,H,se)}this.depthRangeFor3D=[0,1-(l.order.length+2)*this.numSublayers*this.depthEpsilon];let z=this.terrain;if(z&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&z.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]),this.context.clear({color:h.showOverdrawInspector?i.Color.black:i.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=h.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=_.length-1;this.currentLayer>=0;this.currentLayer--){let G=this.style._layers[_[this.currentLayer]],H=l._getLayerSourceCache(G);if(G.isSky())continue;let K=H?k[H.id]:void 0;this._renderTileClippingMasks(G,H,K),this.renderLayer(this,H,G,K)}if(this.style.fog&&this.transform.projection.supportsFog&&function(G,H){let K=G.context,se=K.gl,le=G.transform,fe=new i.DepthMode(se.LEQUAL,i.DepthMode.ReadOnly,[0,1]),he=G.useProgram("globeAtmosphere",null,le.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"]),pe=i.globeToMercatorTransition(le.zoom),Q=H.properties.get("color").toArray01(),ue=H.properties.get("high-color").toArray01(),ye=H.properties.get("space-color").toArray01PremultipliedAlpha(),_e=i.identity$1([]);i.rotateY$1(_e,_e,-i.degToRad(le._center.lng)),i.rotateX$1(_e,_e,i.degToRad(le._center.lat)),i.rotateZ$1(_e,_e,le.angle),i.rotateX$1(_e,_e,-le._pitch);let Ae=i.fromQuat(new Float32Array(16),_e),Re=i.mapValue(H.properties.get("star-intensity"),0,1,0,.25),Me=5e-4,Be=i.mapValue(H.properties.get("horizon-blend"),0,1,Me,.25),Fe=i.globeUseCustomAntiAliasing(G,K,le)&&Be===Me?le.worldSize/(2*Math.PI*1.025)-1:le.globeRadius,je=G.frameCounter/1e3%1,mt=i.length(le.globeCenterInViewSpace),He=Math.sqrt(Math.pow(mt,2)-Math.pow(Fe,2)),it=Math.acos(He/mt),Ze=((Ge,tt,gt,at,_t,$t,sn,Ft,Xt,Gt,Mn,Vt,Qn,ui)=>({u_frustum_tl:Ge,u_frustum_tr:tt,u_frustum_br:gt,u_frustum_bl:at,u_horizon:_t,u_transition:$t,u_fadeout_range:sn,u_color:Ft,u_high_color:Xt,u_space_color:Gt,u_star_intensity:Mn,u_star_size:5*i.exported.devicePixelRatio,u_star_density:0,u_temporal_offset:Vt,u_horizon_angle:Qn,u_rotation_matrix:ui}))(le.frustumCorners.TL,le.frustumCorners.TR,le.frustumCorners.BR,le.frustumCorners.BL,le.frustumCorners.horizon,pe,Be,Q,ue,ye,Re,je,it,Ae);G.prepareDrawProgram(K,he);let ht=G.atmosphereBuffer;ht&&he.draw(K,se.TRIANGLES,fe,i.StencilMode.disabled,i.ColorMode.alphaBlended,i.CullFaceMode.backCW,Ze,"skybox",ht.vertexBuffer,ht.indexBuffer,ht.segments)}(this,this.style.fog),this.renderPass="sky",(i.globeToMercatorTransition(this.transform.zoom)>0||this.transform.projection.name!=="globe")&&this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<_.length;this.currentLayer++){let G=this.style._layers[_[this.currentLayer]],H=l._getLayerSourceCache(G);G.isSky()&&this.renderLayer(this,H,G,H?k[H.id]:void 0)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<_.length;){let G=this.style._layers[_[this.currentLayer]],H=l._getLayerSourceCache(G);if(G.isSky()){++this.currentLayer;continue}if(this.terrain&&this.style.isLayerDraped(G)){if(G.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer);continue}let K=H?(G.type==="symbol"?R:k)[H.id]:void 0;this._renderTileClippingMasks(G,H,H?D[H.id]:void 0),this.renderLayer(this,H,G,K),++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let G=null;i.values(this.style._layers).forEach(H=>{let K=l._getLayerSourceCache(H);K&&!H.isHidden(this.transform.zoom)&&(!G||G.getSource().maxzoom<K.getSource().maxzoom)&&(G=K)}),G&&this.options.showTileBoundaries&&El.debug(this,G,G.getVisibleCoordinates())}this.options.showPadding&&function(G){let H=G.transform.padding;Pp(G,G.transform.height-(H.top||0),3,gc),Pp(G,H.bottom||0,3,Fd),Cl(G,H.left||0,3,Kh),Cl(G,G.transform.width-(H.right||0),3,iy);let K=G.transform.centerPoint;(function(se,le,fe,he){yc(se,le-1,fe-10,2,20,he),yc(se,le-10,fe-1,20,2,he)})(G,K.x,G.transform.height-K.y,Rp)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(i.window.performance.now()),this.saveCanvasCopy())}renderLayer(l,h,_,x){_.isHidden(this.transform.zoom)||(_.type==="background"||_.type==="sky"||_.type==="custom"||x&&x.length)&&(this.id=_.id,this.gpuTimingStart(_),(!l.transform.projection.unsupportedLayers||!l.transform.projection.unsupportedLayers.includes(_.type)||l.terrain&&_.type==="custom")&&El[_.type](l,h,_,x,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(l){if(!this.options.gpuTiming)return;let h=this.context.extTimerQuery,_=this.gpuTimers[l.id];_||(_=this.gpuTimers[l.id]={calls:0,cpuTime:0,query:h.createQueryEXT()}),_.calls++,h.beginQueryEXT(h.TIME_ELAPSED_EXT,_.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){let l=this.context.extTimerQuery,h=l.createQueryEXT();this.deferredRenderGpuTimeQueries.push(h),l.beginQueryEXT(l.TIME_ELAPSED_EXT,h)}}gpuTimingDeferredRenderEnd(){if(!this.options.gpuTimingDeferredRender)return;let l=this.context.extTimerQuery;l.endQueryEXT(l.TIME_ELAPSED_EXT)}gpuTimingEnd(){if(!this.options.gpuTiming)return;let l=this.context.extTimerQuery;l.endQueryEXT(l.TIME_ELAPSED_EXT)}collectGpuTimers(){let l=this.gpuTimers;return this.gpuTimers={},l}collectDeferredRenderGpuQueries(){let l=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],l}queryGpuTimers(l){let h={};for(let _ in l){let x=l[_],D=this.context.extTimerQuery,k=D.getQueryObjectEXT(x.query,D.QUERY_RESULT_EXT)/1e6;D.deleteQueryEXT(x.query),h[_]=k}return h}queryGpuTimeDeferredRender(l){if(!this.options.gpuTimingDeferredRender)return 0;let h=this.context.extTimerQuery,_=0;for(let x of l)_+=h.getQueryObjectEXT(x,h.QUERY_RESULT_EXT)/1e6,h.deleteQueryEXT(x);return _}translatePosMatrix(l,h,_,x,D){if(!_[0]&&!_[1])return l;let k=D?x==="map"?this.transform.angle:0:x==="viewport"?-this.transform.angle:0;if(k){let G=Math.sin(k),H=Math.cos(k);_=[_[0]*H-_[1]*G,_[0]*G+_[1]*H]}let R=[D?_[0]:wr(h,_[0],this.transform.zoom),D?_[1]:wr(h,_[1],this.transform.zoom),0],z=new Float32Array(16);return i.translate(z,l,R),z}saveTileTexture(l){let h=this._tileTextures[l.size[0]];h?h.push(l):this._tileTextures[l.size[0]]=[l]}getTileTexture(l){let h=this._tileTextures[l];return h&&h.length>0?h.pop():null}isPatternMissing(l){return l===null||l!==void 0&&!this.imageManager.getPattern(l.toString())}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture}currentGlobalDefines(){let l=this.terrain&&this.terrain.renderingToTexture,h=this.terrain&&this.terrain.exaggeration()===0,_=this.style&&this.style.fog,x=[];return this.terrainRenderModeElevated()&&x.push("TERRAIN"),this.transform.projection.name==="globe"&&x.push("GLOBE"),h&&x.push("ZERO_EXAGGERATION"),_&&!l&&_.getOpacity(this.transform.pitch)!==0&&x.push("FOG"),l&&x.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&x.push("OVERDRAW_INSPECTOR"),x}useProgram(l,h,_){this.cache=this.cache||{};let x=_||[],D=this.currentGlobalDefines().concat(x),k=Fn.cacheKey(mu[l],l,D,h);return this.cache[k]||(this.cache[k]=new Fn(this.context,l,mu[l],h,Xh[l],D)),this.cache[k]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){let l=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(l.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=i.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new i.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this.atmosphereBuffer&&this.atmosphereBuffer.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}prepareDrawProgram(l,h,_){if(this.terrain&&this.terrain.renderingToTexture)return;let x=this.style.fog;if(x){let D=x.getOpacity(this.transform.pitch),k=((R,z,G,H,K,se,le,fe,he,pe,Q)=>{let ue=R.transform,ye=z.properties.get("color").toArray01();ye[3]=H;let _e=R.frameCounter/1e3%1;return{u_fog_matrix:G?ue.calculateFogTileMatrix(G):R.identityMat,u_fog_range:z.getFovAdjustedRange(ue._fov),u_fog_color:ye,u_fog_horizon_blend:z.properties.get("horizon-blend"),u_fog_temporal_offset:_e,u_frustum_tl:K,u_frustum_tr:se,u_frustum_br:le,u_frustum_bl:fe,u_globe_pos:he,u_globe_radius:pe,u_viewport:Q,u_globe_transition:i.globeToMercatorTransition(ue.zoom),u_is_globe:+(ue.projection.name==="globe")}})(this,x,_,D,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*i.exported.devicePixelRatio,this.transform.height*i.exported.devicePixelRatio]);h.setFogUniformValues(l,k)}}setTileLoadedFlag(l){this.tileLoaded=l}saveCanvasCopy(){let l=this.canvasCopy();l&&(this.frameCopies.push(l),this.tileLoaded=!1)}canvasCopy(){let l=this.context.gl,h=l.createTexture();return l.bindTexture(l.TEXTURE_2D,h),l.copyTexImage2D(l.TEXTURE_2D,0,l.RGBA,0,0,l.drawingBufferWidth,l.drawingBufferHeight,0),h}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;let l=this.style&&this.style.fog;return!!l&&l.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){let l=this._backgroundTiles,h=this._backgroundTiles={},_=this.transform.coveringTiles({tileSize:512});for(let x of _)h[x.key]=l[x.key]||new i.Tile(x,512,this.transform.tileZoom,this);return h}clearBackgroundTiles(){this._backgroundTiles={}}}class Eu{constructor(l=0,h=0,_=0,x=0){if(isNaN(l)||l<0||isNaN(h)||h<0||isNaN(_)||_<0||isNaN(x)||x<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=l,this.bottom=h,this.left=_,this.right=x}interpolate(l,h,_){return h.top!=null&&l.top!=null&&(this.top=i.number(l.top,h.top,_)),h.bottom!=null&&l.bottom!=null&&(this.bottom=i.number(l.bottom,h.bottom,_)),h.left!=null&&l.left!=null&&(this.left=i.number(l.left,h.left,_)),h.right!=null&&l.right!=null&&(this.right=i.number(l.right,h.right,_)),this}getCenter(l,h){let _=i.clamp((this.left+l-this.right)/2,0,l),x=i.clamp((this.top+h-this.bottom)/2,0,h);return new i.Point(_,x)}equals(l){return this.top===l.top&&this.bottom===l.bottom&&this.left===l.left&&this.right===l.right}clone(){return new Eu(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function Bd(m,l){let h=i.getColumn(m,3);i.fromQuat(m,l),i.setColumn(m,3,h)}function Wn(m,l){let h=i.identity$1([]);return i.rotateZ$1(h,h,-l),i.rotateX$1(h,h,-m),h}function Fr(m,l){let h=[m[0],m[1],0],_=[l[0],l[1],0];if(i.length(h)>=1e-15){let k=i.normalize([],h);i.scale$2(_,k,i.dot(_,k)),l[0]=_[0],l[1]=_[1]}let x=i.cross([],l,m);if(i.len(x)<1e-15)return null;let D=Math.atan2(-x[1],x[0]);return Wn(Math.atan2(Math.sqrt(m[0]*m[0]+m[1]*m[1]),-m[2]),D)}class pi{constructor(l,h){this.position=l,this.orientation=h}get position(){return this._position}set position(l){if(l){let h=l instanceof i.MercatorCoordinate?l:new i.MercatorCoordinate(l[0],l[1],l[2]);this._renderWorldCopies&&(h.x=i.wrap(h.x,0,1)),this._position=h}else this._position=null}lookAtPoint(l,h){if(this.orientation=null,!this.position)return;let _=this.position,x=this._elevation?this._elevation.getAtPointOrZero(i.MercatorCoordinate.fromLngLat(l)):0,D=i.MercatorCoordinate.fromLngLat(l,x),k=[D.x-_.x,D.y-_.y,D.z-_.z];h||(h=[0,0,1]),h[2]=Math.abs(h[2]),this.orientation=Fr(k,h)}setPitchBearing(l,h){this.orientation=Wn(i.degToRad(l),i.degToRad(-h))}}class jd{constructor(l,h){this._transform=i.identity([]),this.orientation=h,this.position=l}get mercatorPosition(){let l=this.position;return new i.MercatorCoordinate(l[0],l[1],l[2])}get position(){let l=i.getColumn(this._transform,3);return[l[0],l[1],l[2]]}set position(l){var h;l&&i.setColumn(this._transform,3,[(h=l)[0],h[1],h[2],1])}get orientation(){return this._orientation}set orientation(l){this._orientation=l||i.identity$1([]),l&&Bd(this._transform,this._orientation)}getPitchBearing(){let l=this.forward(),h=this.right();return{bearing:Math.atan2(-h[1],h[0]),pitch:Math.atan2(Math.sqrt(l[0]*l[0]+l[1]*l[1]),-l[2])}}setPitchBearing(l,h){this._orientation=Wn(l,h),Bd(this._transform,this._orientation)}forward(){let l=i.getColumn(this._transform,2);return[-l[0],-l[1],-l[2]]}up(){let l=i.getColumn(this._transform,1);return[-l[0],-l[1],-l[2]]}right(){let l=i.getColumn(this._transform,0);return[l[0],l[1],l[2]]}getCameraToWorld(l,h){let _=new Float64Array(16);return i.invert(_,this.getWorldToCamera(l,h)),_}getWorldToCameraPosition(l,h,_){let x=this.position;i.scale$2(x,x,-l);let D=new Float64Array(16);return i.fromScaling(D,[_,_,_]),i.translate(D,D,x),D[10]*=h,D}getWorldToCamera(l,h){let _=new Float64Array(16),x=new Float64Array(4),D=this.position;return i.conjugate(x,this._orientation),i.scale$2(D,D,-l),i.fromQuat(_,x),i.translate(_,_,D),_[1]*=-1,_[5]*=-1,_[9]*=-1,_[13]*=-1,_[8]*=h,_[9]*=h,_[10]*=h,_[11]*=h,_}getCameraToClipPerspective(l,h,_,x){let D=new Float64Array(16);return i.perspective(D,l,h,_,x),D}getDistanceToElevation(l,h=!1){let _=l===0?0:i.mercatorZfromAltitude(l,h?i.latFromMercatorY(this.position[1]):this.position[1]),x=this.forward();return(_-this.position[2])/x[2]}clone(){return new jd([...this.position],[...this.orientation])}}function Dl(m,l){let h=Ml(m.projection,m.zoom,m.width,m.height),_=function(D,k,R,z,G){let H=new i.LngLat(R.lng-180*ci,R.lat),K=new i.LngLat(R.lng+180*ci,R.lat),se=D.project(H.lng,H.lat),le=D.project(K.lng,K.lat),fe=-Math.atan2(le.y-se.y,le.x-se.x),he=i.MercatorCoordinate.fromLngLat(R);he.y=i.clamp(he.y,-1+ci,1-ci);let pe=he.toLngLat(),Q=D.project(pe.lng,pe.lat),ue=i.MercatorCoordinate.fromLngLat(pe);ue.x+=ci;let ye=ue.toLngLat(),_e=D.project(ye.lng,ye.lat),Ae=Ud(_e.x-Q.x,_e.y-Q.y,fe),Re=i.MercatorCoordinate.fromLngLat(pe);Re.y+=ci;let Me=Re.toLngLat(),Be=D.project(Me.lng,Me.lat),Fe=Ud(Be.x-Q.x,Be.y-Q.y,fe),je=Math.abs(Ae.x)/Math.abs(Fe.y),mt=i.identity([]);i.rotateZ(mt,mt,-fe*(1-(G?0:z)));let He=i.identity([]);return i.scale(He,He,[1,1-(1-je)*z,1]),He[4]=-Fe.x/Fe.y*z,i.rotateZ(He,He,fe),i.multiply(He,mt,He),He}(m.projection,0,m.center,h,l),x=Vd(m);return i.scale(_,_,[x,x,1]),_}function Vd(m){let l=m.projection,h=Ml(m.projection,m.zoom,m.width,m.height),_=Qh(l,m.center),x=Qh(l,i.LngLat.convert(l.center));return Math.pow(2,_*h+(1-h)*x)}function Ml(m,l,h,_,x=1/0){let D=m.range;if(!D)return 0;let k=Math.min(x,Math.max(h,_)),R=Math.log(k/1024)/Math.LN2;return i.smoothstep(D[0]+R,D[1]+R,l)}let ci=1/4e4;function Qh(m,l){let h=i.clamp(l.lat,-i.MAX_MERCATOR_LATITUDE,i.MAX_MERCATOR_LATITUDE),_=new i.LngLat(l.lng-180*ci,h),x=new i.LngLat(l.lng+180*ci,h),D=m.project(_.lng,h),k=m.project(x.lng,h),R=i.MercatorCoordinate.fromLngLat(_),z=i.MercatorCoordinate.fromLngLat(x),G=k.x-D.x,H=k.y-D.y,K=z.x-R.x,se=z.y-R.y,le=Math.sqrt((K*K+se*se)/(G*G+H*H));return Math.log(le)/Math.LN2}function Ud(m,l,h){let _=Math.cos(h),x=Math.sin(h);return{x:m*_-l*x,y:m*x+l*_}}class Tl{constructor(l,h,_,x,D,k,R){this.tileSize=512,this._renderWorldCopies=D===void 0||D,this._minZoom=l||0,this._maxZoom=h||22,this._minPitch=_??0,this._maxPitch=x??60,this.setProjection(k),this.setMaxBounds(R),this.width=0,this.height=0,this._center=new i.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new Eu,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._distanceTileDataCache={},this._camera=new jd,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._horizonShift=.1}clone(){let l=new Tl(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return l._elevation=this._elevation,l._centerAltitude=this._centerAltitude,l._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,l.tileSize=this.tileSize,l.mercatorFromTransition=this.mercatorFromTransition,l.width=this.width,l.height=this.height,l.cameraElevationReference=this.cameraElevationReference,l._center=this._center,l._setZoom(this.zoom),l._seaLevelZoom=this._seaLevelZoom,l.angle=this.angle,l._fov=this._fov,l._pitch=this._pitch,l._nearZ=this._nearZ,l._farZ=this._farZ,l._averageElevation=this._averageElevation,l._unmodified=this._unmodified,l._edgeInsets=this._edgeInsets.clone(),l._camera=this._camera.clone(),l._calcMatrices(),l.freezeTileCoverage=this.freezeTileCoverage,l.frustumCorners=this.frustumCorners,l}get elevation(){return this._elevation}set elevation(l){this._elevation!==l&&(this._elevation=l,this._updateCameraOnTerrain(),this._calcMatrices())}updateElevation(l,h=!1){let _=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||_)&&this._updateCameraOnTerrain(),(l||_)&&this._constrainCamera(h),this._calcMatrices()}getProjection(){return i.pick(this.projection,["name","center","parallels"])}setProjection(l){this.projectionOptions=l||{name:"mercator"};let h=this.projection?this.getProjection():void 0;this.projection=i.getProjection(this.projectionOptions);let _=!E(h,this.getProjection());return _&&this._calcMatrices(),this.mercatorFromTransition=!1,_}setMercatorFromTransition(){let l=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=i.getProjection({name:"mercator"});let h=l!==this.projection.name;return h&&this._calcMatrices(),h}get minZoom(){return this._minZoom}set minZoom(l){this._minZoom!==l&&(this._minZoom=l,this.zoom=Math.max(this.zoom,l))}get maxZoom(){return this._maxZoom}set maxZoom(l){this._maxZoom!==l&&(this._maxZoom=l,this.zoom=Math.min(this.zoom,l))}get minPitch(){return this._minPitch}set minPitch(l){this._minPitch!==l&&(this._minPitch=l,this.pitch=Math.max(this.pitch,l))}get maxPitch(){return this._maxPitch}set maxPitch(l){this._maxPitch!==l&&(this._maxPitch=l,this.pitch=Math.min(this.pitch,l))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(l){l===void 0?l=!0:l===null&&(l=!1),this._renderWorldCopies=l}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){let l=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(l))}get cameraWorldSize(){let l=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(l))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return i.mercatorZfromAltitude(this.center.lat,this.cameraWorldSizeForFog)}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new i.Point(this.width,this.height)}get bearing(){return i.wrap(this.rotation,-180,180)}set bearing(l){this.rotation=l}get rotation(){return-this.angle/Math.PI*180}set rotation(l){let h=-l*Math.PI/180;var _;this.angle!==h&&(this._unmodified=!1,this.angle=h,this._calcMatrices(),this.rotationMatrix=(_=new i.ARRAY_TYPE(4),i.ARRAY_TYPE!=Float32Array&&(_[1]=0,_[2]=0),_[0]=1,_[3]=1,_),function(x,D,k){var R=D[0],z=D[1],G=D[2],H=D[3],K=Math.sin(k),se=Math.cos(k);x[0]=R*se+G*K,x[1]=z*se+H*K,x[2]=R*-K+G*se,x[3]=z*-K+H*se}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(l){let h=i.clamp(l,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==h&&(this._unmodified=!1,this._pitch=h,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){let l=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/l)}set fov(l){l=Math.max(.01,Math.min(60,l)),this._fov!==l&&(this._unmodified=!1,this._fov=i.degToRad(l),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(l){this._averageElevation=l,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(l){let h=Math.min(Math.max(l,this.minZoom),this.maxZoom);this._zoom!==h&&(this._unmodified=!1,this._setZoom(h),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(l){this._zoom=l,this.scale=this.zoomScale(l),this.tileZoom=Math.floor(l),this.zoomFraction=l-this.tileZoom}_updateCameraOnTerrain(){if(!this._elevation||!this._elevation.isDataAvailableAtPoint(this.locationCoordinate(this.center)))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);let l=this._elevation;this._centerAltitude=l.getAtPointOrZero(this.locationCoordinate(this.center)),this._centerAltitudeValidForExaggeration=l.exaggeration(),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){this._centerAltitudeValidForExaggeration!==void 0&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;let l=this._elevation,h=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],_=this.horizonLineFromTop(),x=0,D=0;for(let k=0;k<h.length;k++){let R=new i.Point(h[k][0]*this.width,_+h[k][1]*(this.height-_)),z=l.pointCoordinate(R);if(!z)continue;let G=1/Math.hypot(z[0]-this._camera.position[0],z[1]-this._camera.position[1]);x+=z[3]*G,D+=G}return D===0?NaN:x/D}get center(){return this._center}set center(l){l.lat===this._center.lat&&l.lng===this._center.lng||(this._unmodified=!1,this._center=l,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;let l=this._seaLevelZoom,h=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),_=this.pixelsPerMeter/this.worldSize*h,x=this._mercatorZfromZoom(l),D=this._mercatorZfromZoom(this._maxZoom),k=Math.max(x-_,D);this._setZoom(this._zoomFromMercatorZ(k))}get padding(){return this._edgeInsets.toJSON()}set padding(l){this._edgeInsets.equals(l)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,l,1),this._calcMatrices())}computeZoomRelativeTo(l){let h=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,l.toAltitude())),_;_=l.z<this._camera.position[2]?[h.x,h.y,h.z]:[l.x,l.y,l.z];let x=i.length(i.sub([],this._camera.position,_));return i.clamp(this._zoomFromMercatorZ(x),this._minZoom,this._maxZoom)}setFreeCameraOptions(l){if(!this.height||!l.position&&!l.orientation)return;this._updateCameraState();let h=!1;if(l.orientation&&!i.exactEquals(l.orientation,this._camera.orientation)&&(h=this._setCameraOrientation(l.orientation)),l.position){let _=[l.position.x,l.position.y,l.position.z];i.exactEquals$1(_,this._camera.position)||(this._setCameraPosition(_),h=!0)}h&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();let l=this._camera.position,h=new pi;return h.position=new i.MercatorCoordinate(l[0],l[1],l[2]),h.orientation=this._camera.orientation,h._elevation=this.elevation,h._renderWorldCopies=this.renderWorldCopies,h}_setCameraOrientation(l){if(!i.length$1(l))return!1;i.normalize$1(l,l);let h=i.transformQuat([],[0,0,-1],l),_=i.transformQuat([],[0,-1,0],l);if(_[2]<0)return!1;let x=Fr(h,_);return!!x&&(this._camera.orientation=x,!0)}_setCameraPosition(l){let h=this.zoomScale(this.minZoom)*this.tileSize,_=this.zoomScale(this.maxZoom)*this.tileSize,x=this.cameraToCenterDistance;l[2]=i.clamp(l[2],x/_,x/h),this._camera.position=l}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(l){return this._edgeInsets.equals(l)}interpolatePadding(l,h,_){this._unmodified=!1,this._edgeInsets.interpolate(l,h,_),this._constrain(),this._calcMatrices()}coveringZoomLevel(l){let h=(l.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/l.tileSize));return Math.max(0,h)}getVisibleUnwrappedCoordinates(l){let h=[new i.UnwrappedTileID(0,l)];if(this.renderWorldCopies){let _=this.pointCoordinate(new i.Point(0,0)),x=this.pointCoordinate(new i.Point(this.width,0)),D=this.pointCoordinate(new i.Point(this.width,this.height)),k=this.pointCoordinate(new i.Point(0,this.height)),R=Math.floor(Math.min(_.x,x.x,D.x,k.x)),z=Math.floor(Math.max(_.x,x.x,D.x,k.x)),G=1;for(let H=R-G;H<=z+G;H++)H!==0&&h.push(new i.UnwrappedTileID(H,l))}return h}coveringTiles(l){let h=this.coveringZoomLevel(l),_=h,x=this.elevation&&!l.isTerrainDEM,D=this.projection.name==="mercator";if(l.minzoom!==void 0&&h<l.minzoom)return[];l.maxzoom!==void 0&&h>l.maxzoom&&(h=l.maxzoom);let k=this.locationCoordinate(this.center),R=this.center.lat,z=1<<h,G=[z*k.x,z*k.y,0],H=this.projection.name==="globe",K=!H,se=i.Frustum.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,h,K),le=H?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),fe=z*i.mercatorZfromAltitude(1,this.center.lat),he=this._camera.position[2]/i.mercatorZfromAltitude(1,this.center.lat),pe=[z*le.x,z*le.y,he*(K?1:fe)],Q=this.cameraToCenterDistance/l.tileSize*(l.roundZoom?1:.502),ue=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace?h:0,ye=l.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,_e=l.isTerrainDEM?-ye:this._elevation?this._elevation.getMinElevationBelowMSL():0,Ae=this.projection.isReprojectedInTileSpace?Vd(this):1,Re=Ge=>{let gt=new i.MercatorCoordinate(Ge.x+25e-6,Ge.y,Ge.z),at=new i.MercatorCoordinate(Ge.x,Ge.y+25e-6,Ge.z),_t=Ge.toLngLat(),$t=gt.toLngLat(),sn=at.toLngLat(),Ft=this.locationCoordinate(_t),Xt=this.locationCoordinate($t),Gt=this.locationCoordinate(sn),Mn=Math.hypot(Xt.x-Ft.x,Xt.y-Ft.y),Vt=Math.hypot(Gt.x-Ft.x,Gt.y-Ft.y);return Math.sqrt(Mn*Vt)*Ae/25e-6},Me=Ge=>{let tt=ye,gt=_e;return{aabb:i.tileAABB(this,z,0,0,0,Ge,gt,tt,this.projection),zoom:0,x:0,y:0,minZ:gt,maxZ:tt,wrap:Ge,fullyVisible:!1}},Be=[],Fe=[],je=h,mt=l.reparseOverscaled?_:h,He=Ge=>Ge*Ge,it=He((he-this._centerAltitude)*fe),Ze=Ge=>{if(!this._elevation||!Ge.tileID||!D)return;let tt=this._elevation.getMinMaxForTile(Ge.tileID),gt=Ge.aabb;tt?(gt.min[2]=tt.min,gt.max[2]=tt.max,gt.center[2]=(gt.min[2]+gt.max[2])/2):(Ge.shouldSplit=ht(Ge),Ge.shouldSplit||(gt.min[2]=gt.max[2]=gt.center[2]=this._centerAltitude))},ht=Ge=>{if(Ge.zoom<ue)return!0;if(Ge.zoom===je)return!1;if(Ge.shouldSplit!=null)return Ge.shouldSplit;let tt=Ge.aabb.distanceX(pe),gt=Ge.aabb.distanceY(pe),at=it,_t=1;if(H){at=He(Ge.aabb.distanceZ(pe));let Ft=Math.pow(2,Ge.zoom),Xt=i.latFromMercatorY((Ge.y+1)/Ft),Gt=i.latFromMercatorY(Ge.y/Ft),Mn=Math.min(Math.max(R,Xt),Gt),Vt=i.circumferenceAtLatitude(Mn)/i.circumferenceAtLatitude(R);if(_t=Mn===R?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,Vt/this._mercatorScaleRatio),this.zoom<=i.GLOBE_ZOOM_THRESHOLD_MIN&&Ge.zoom===je-1&&Vt>=.9)return!0}else if(x&&(at=He(Ge.aabb.distanceZ(pe)*fe)),this.projection.isReprojectedInTileSpace&&_<=5){let Ft=Math.pow(2,Ge.zoom),Xt=Re(new i.MercatorCoordinate((Ge.x+.5)/Ft,(Ge.y+.5)/Ft));_t=Xt>.85?1:Xt}let $t=tt*tt+gt*gt+at,sn=He((1<<je-Ge.zoom)*Q*_t*((Ft,Xt)=>{if(Xt*He(.707)<Ft)return 1;let Gt=Math.sqrt(Xt/Ft);return Gt/(1.4144271570014144+(Math.pow(1.1,Gt-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(at,it),$t));return $t<sn};if(this.renderWorldCopies)for(let Ge=1;Ge<=3;Ge++)Be.push(Me(-Ge)),Be.push(Me(Ge));for(Be.push(Me(0));Be.length>0;){let Ge=Be.pop(),tt=Ge.x,gt=Ge.y,at=Ge.fullyVisible;if(!at){let _t=Ge.aabb.intersects(se);if(_t===0)continue;at=_t===2}if(Ge.zoom!==je&&ht(Ge))for(let _t=0;_t<4;_t++){let $t=(tt<<1)+_t%2,sn=(gt<<1)+(_t>>1),Ft={aabb:D?Ge.aabb.quadrant(_t):i.tileAABB(this,z,Ge.zoom+1,$t,sn,Ge.wrap,Ge.minZ,Ge.maxZ,this.projection),zoom:Ge.zoom+1,x:$t,y:sn,wrap:Ge.wrap,fullyVisible:at,tileID:void 0,shouldSplit:void 0,minZ:Ge.minZ,maxZ:Ge.maxZ};x&&!H&&(Ft.tileID=new i.OverscaledTileID(Ge.zoom+1===je?mt:Ge.zoom+1,Ge.wrap,Ge.zoom+1,$t,sn),Ze(Ft)),Be.push(Ft)}else{let _t=Ge.zoom===je?mt:Ge.zoom;if(l.minzoom&&l.minzoom>_t)continue;let $t=G[0]-(.5+tt+(Ge.wrap<<Ge.zoom))*(1<<h-Ge.zoom),sn=G[1]-.5-gt,Ft=Ge.tileID?Ge.tileID:new i.OverscaledTileID(_t,Ge.wrap,Ge.zoom,tt,gt);Fe.push({tileID:Ft,distanceSq:$t*$t+sn*sn})}}if(this.fogCullDistSq){let Ge=this.fogCullDistSq,tt=this.horizonLineFromTop();Fe=Fe.filter(gt=>{let at=[0,0,0,1],_t=[i.EXTENT,i.EXTENT,0,1],$t=this.calculateFogTileMatrix(gt.tileID.toUnwrapped());i.transformMat4$1(at,at,$t),i.transformMat4$1(_t,_t,$t);let sn=i.getAABBPointSquareDist(at,_t);if(sn===0)return!0;let Ft=!1,Xt=this._elevation;if(Xt&&sn>Ge&&tt!==0){let Gt=this.calculateProjMatrix(gt.tileID.toUnwrapped()),Mn;l.isTerrainDEM||(Mn=Xt.getMinMaxForTile(gt.tileID)),Mn||(Mn={min:_e,max:ye});let Vt=i.furthestTileCorner(this.rotation),Qn=[Vt[0]*i.EXTENT,Vt[1]*i.EXTENT,Mn.max];i.transformMat4(Qn,Qn,Gt),Ft=(1-Qn[1])*this.height*.5<tt}return sn<Ge||Ft})}return Fe.sort((Ge,tt)=>Ge.distanceSq-tt.distanceSq).map(Ge=>Ge.tileID)}resize(l,h){this.width=l,this.height=h,this.pixelsToGLUnits=[2/l,-2/h],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(l){return Math.pow(2,l)}scaleZoom(l){return Math.log(l)/Math.LN2}project(l){let h=i.clamp(l.lat,-i.MAX_MERCATOR_LATITUDE,i.MAX_MERCATOR_LATITUDE),_=this.projection.project(l.lng,h);return new i.Point(_.x*this.worldSize,_.y*this.worldSize)}unproject(l){return this.projection.unproject(l.x/this.worldSize,l.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/i.mercatorZfromAltitude(1,this.center.lat)/this.worldSize}setLocationAtPoint(l,h){let _,x,D=this.centerPoint;if(this.projection.name==="globe"){let R=this.worldSize;_=(h.x-D.x)/R,x=(h.y-D.y)/R}else{let R=this.pointCoordinate(h),z=this.pointCoordinate(D);_=R.x-z.x,x=R.y-z.y}let k=this.locationCoordinate(l);this.setLocation(new i.MercatorCoordinate(k.x-_,k.y-x))}setLocation(l){this.center=this.coordinateLocation(l),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(l){return this.projection.locationPoint(this,l)}locationPoint3D(l){return this.projection.locationPoint(this,l,!0)}pointLocation(l){return this.coordinateLocation(this.pointCoordinate(l))}pointLocation3D(l){return this.coordinateLocation(this.pointCoordinate3D(l))}locationCoordinate(l,h){let _=h?i.mercatorZfromAltitude(h,l.lat):void 0,x=this.projection.project(l.lng,l.lat);return new i.MercatorCoordinate(x.x,x.y,_)}coordinateLocation(l){return this.projection.unproject(l.x,l.y)}pointRayIntersection(l,h){let _=h??this._centerAltitude,x=[l.x,l.y,0,1],D=[l.x,l.y,1,1];i.transformMat4$1(x,x,this.pixelMatrixInverse),i.transformMat4$1(D,D,this.pixelMatrixInverse);let k=D[3];i.scale$1(x,x,1/x[3]),i.scale$1(D,D,1/k);let R=x[2],z=D[2];return{p0:x,p1:D,t:R===z?0:(_-R)/(z-R)}}screenPointToMercatorRay(l){let h=[l.x,l.y,0,1],_=[l.x,l.y,1,1];return i.transformMat4$1(h,h,this.pixelMatrixInverse),i.transformMat4$1(_,_,this.pixelMatrixInverse),i.scale$1(h,h,1/h[3]),i.scale$1(_,_,1/_[3]),h[2]=i.mercatorZfromAltitude(h[2],this._center.lat)*this.worldSize,_[2]=i.mercatorZfromAltitude(_[2],this._center.lat)*this.worldSize,i.scale$1(h,h,1/this.worldSize),i.scale$1(_,_,1/this.worldSize),new i.Ray([h[0],h[1],h[2]],i.normalize([],i.sub([],_,h)))}rayIntersectionCoordinate(l){let{p0:h,p1:_,t:x}=l,D=i.mercatorZfromAltitude(h[2],this._center.lat),k=i.mercatorZfromAltitude(_[2],this._center.lat);return new i.MercatorCoordinate(i.number(h[0],_[0],x)/this.worldSize,i.number(h[1],_[1],x)/this.worldSize,i.number(D,k,x))}pointCoordinate(l,h=this._centerAltitude){return this.projection.pointCoordinate(this,l.x,l.y,h)}pointCoordinate3D(l){if(!this.elevation)return this.pointCoordinate(l);let h=this.projection.pointCoordinate3D(this,l.x,l.y);if(h)return new i.MercatorCoordinate(h[0],h[1],h[2]);let _=0,x=this.horizonLineFromTop();if(l.y>x)return this.pointCoordinate(l);let D=.02*x,k=l.clone();for(let R=0;R<10&&x-_>D;R++){k.y=i.number(_,x,.66);let z=this.projection.pointCoordinate3D(this,k.x,k.y);z?(x=k.y,h=z):_=k.y}return h?new i.MercatorCoordinate(h[0],h[1],h[2]):this.pointCoordinate(l)}isPointAboveHorizon(l){return this.projection.isPointAboveHorizon(this,l)}isPointOnSurface(l){if(l.y<0||l.y>this.height||l.x<0||l.x>this.width)return!1;if(this.elevation||this.zoom>=i.GLOBE_ZOOM_THRESHOLD_MAX)return!this.isPointAboveHorizon(l);let h=this.pointCoordinate(l);return h.y>=0&&h.y<=1}_coordinatePoint(l,h){let _=h&&this.elevation?this.elevation.getAtPointOrZero(l,this._centerAltitude):this._centerAltitude,x=[l.x*this.worldSize,l.y*this.worldSize,_+l.toAltitude(),1];return i.transformMat4$1(x,x,this.pixelMatrix),x[3]>0?new i.Point(x[0]/x[3],x[1]/x[3]):new i.Point(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){let{top:l,left:h}=this._edgeInsets,_=this.height-this._edgeInsets.bottom,x=this.width-this._edgeInsets.right,D=this.pointLocation3D(new i.Point(h,l)),k=this.pointLocation3D(new i.Point(x,l)),R=this.pointLocation3D(new i.Point(x,_)),z=this.pointLocation3D(new i.Point(h,_)),G=Math.min(D.lng,k.lng,R.lng,z.lng),H=Math.max(D.lng,k.lng,R.lng,z.lng),K=Math.min(D.lat,k.lat,R.lat,z.lat),se=Math.max(D.lat,k.lat,R.lat,z.lat),le=Math.pow(2,-this.zoom)/16*270,fe=this.projection.name==="globe"?1:4,he=(pe,Q,ue,ye,_e)=>{let Ae=(pe+ue)/2,Re=(Q+ye)/2,Me=new i.Point(Ae,Re),{lng:Be,lat:Fe}=this.pointLocation3D(Me),je=Math.max(0,G-Be,K-Fe,Be-H,Fe-se);G=Math.min(G,Be),H=Math.max(H,Be),K=Math.min(K,Fe),se=Math.max(se,Fe),(_e<fe||je>le)&&(he(pe,Q,Ae,Re,_e+1),he(Ae,Re,ue,ye,_e+1))};if(he(h,l,x,l,1),he(x,l,x,_,1),he(x,_,h,_,1),he(h,_,h,l,1),this.projection.name==="globe"){let[pe,Q]=i.polesInViewport(this);pe?(se=90,H=180,G=-180):Q&&(K=-90,H=180,G=-180)}return new i.LngLatBounds(new i.LngLat(G,K),new i.LngLat(H,se))}_getBoundsRectangular(l,h){let{top:_,left:x}=this._edgeInsets,D=this.height-this._edgeInsets.bottom,k=this.width-this._edgeInsets.right,R=new i.Point(x,_),z=new i.Point(k,_),G=new i.Point(k,D),H=new i.Point(x,D),K=this.pointCoordinate(R,l),se=this.pointCoordinate(z,l),le=this.pointCoordinate(G,h),fe=this.pointCoordinate(H,h),he=(pe,Q)=>(Q.y-pe.y)/(Q.x-pe.x);return K.y>1&&se.y>=0?K=new i.MercatorCoordinate((1-fe.y)/he(fe,K)+fe.x,1):K.y<0&&se.y<=1&&(K=new i.MercatorCoordinate(-fe.y/he(fe,K)+fe.x,0)),se.y>1&&K.y>=0?se=new i.MercatorCoordinate((1-le.y)/he(le,se)+le.x,1):se.y<0&&K.y<=1&&(se=new i.MercatorCoordinate(-le.y/he(le,se)+le.x,0)),new i.LngLatBounds().extend(this.coordinateLocation(K)).extend(this.coordinateLocation(se)).extend(this.coordinateLocation(fe)).extend(this.coordinateLocation(le))}_getBoundsRectangularTerrain(){let l=this.elevation;if(!l.visibleDemTiles.length||l.isUsingMockSource())return this._getBoundsRectangular(0,0);let h=l.visibleDemTiles.reduce((_,x)=>{if(x.dem){let D=x.dem.tree;_.min=Math.min(_.min,D.minimums[0]),_.max=Math.max(_.max,D.maximums[0])}return _},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(h.min*l.exaggeration(),h.max*l.exaggeration())}getBounds(){return this.projection.name==="mercator"||this.projection.name==="equirectangular"?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(l=!0){let h=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,_=this.height/2-h*(1-this._horizonShift);return l?Math.max(0,_):_}getMaxBounds(){return this.maxBounds}setMaxBounds(l){this.maxBounds=l,this.minLat=-i.MAX_MERCATOR_LATITUDE,this.maxLat=i.MAX_MERCATOR_LATITUDE,this.minLng=-180,this.maxLng=180,l&&(this.minLat=l.getSouth(),this.maxLat=l.getNorth(),this.minLng=l.getWest(),this.maxLng=l.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=i.mercatorXfromLng(this.minLng)*this.tileSize,this.worldMaxX=i.mercatorXfromLng(this.maxLng)*this.tileSize,this.worldMinY=i.mercatorYfromLat(this.maxLat)*this.tileSize,this.worldMaxY=i.mercatorYfromLat(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(l,h){return this.projection.createTileMatrix(this,h,l)}calculateDistanceTileData(l){let h=l.key,_=this._distanceTileDataCache;if(_[h])return _[h];let x=l.canonical,D=1/this.height,k=this.cameraWorldSize,R=k/this.zoomScale(x.z),z=(x.x+Math.pow(2,x.z)*l.wrap)*R,G=x.y*R,H=this.point;H.x*=k/this.worldSize,H.y*=k/this.worldSize;let K=this.angle,se=Math.sin(-K),le=-Math.cos(-K);return _[h]={bearing:[se,le],center:[(H.x-z)*D,(H.y-G)*D],scale:R/i.EXTENT*D},_[h]}calculateFogTileMatrix(l){let h=l.key,_=this._fogTileMatrixCache;if(_[h])return _[h];let x=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,l);return i.multiply(x,this.worldToFogMatrix,x),_[h]=new Float32Array(x),_[h]}calculateProjMatrix(l,h=!1){let _=l.key,x=h?this._alignedProjMatrixCache:this._projMatrixCache;if(x[_])return x[_];let D=this.calculatePosMatrix(l,this.worldSize);return i.multiply(D,this.projection.isReprojectedInTileSpace?this.mercatorMatrix:h?this.alignedProjMatrix:this.projMatrix,D),x[_]=new Float32Array(D),x[_]}calculatePixelsToTileUnitsMatrix(l){let h=l.tileID.key,_=this._pixelsToTileUnitsCache;if(_[h])return _[h];let x=function(D,k){let{scale:R}=D.tileTransform,z=R*i.EXTENT/(D.tileSize*Math.pow(2,k.zoom-D.tileID.overscaledZ+D.tileID.canonical.z));return G=new Float32Array(4),se=(H=k.inverseAdjustmentMatrix)[1],le=H[2],fe=H[3],pe=(K=[z,z])[1],G[0]=H[0]*(he=K[0]),G[1]=se*he,G[2]=le*pe,G[3]=fe*pe,G;var G,H,K,se,le,fe,he,pe}(l,this);return _[h]=x,_[h]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if(this.projection.name==="globe"){let l=1/this.worldSize,h=i.fromScaling([],[l,l,l]);return i.multiply(h,h,this.globeMatrix),h}}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;let l=this._elevation;this._updateCameraState();let h=i.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,_=this._computeCameraPosition(h),x=this._camera.forward(),D=i.mercatorZfromAltitude(1,this._center.lat);_[2]/=D,x[2]/=D,i.normalize(x,x);let k=l.raycast(_,x,l.exaggeration());if(k){let R=i.scaleAndAdd([],_,x,k),z=new i.MercatorCoordinate(R[0],R[1],i.mercatorZfromAltitude(R[2],i.latFromMercatorY(R[1]))),G=(z.z+i.length([z.x-_[0],z.y-_[1],z.z-_[2]*D]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(G),this._centerAltitude=z.toAltitude(),this._center=this.coordinateLocation(z),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(l=!1){if(!this._elevation)return;let h=this._elevation,_=i.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,x=this._computeCameraPosition(_),D=h.getAtPointOrZero(new i.MercatorCoordinate(...x)),k=this.pixelsPerMeter/this.worldSize*D,R=this._minimumHeightOverTerrain(),z=x[2]-k;if(z<=R)if(z<0||l){let G=this.locationCoordinate(this._center,this._centerAltitude),H=[x[0],x[1],G.z-x[2]],K=i.length(H);H[2]-=(R-z)/this._pixelsPerMercatorPixel;let se=i.length(H);if(se===0)return;i.scale$2(H,H,K/se*this._pixelsPerMercatorPixel),this._camera.position=[x[0],x[1],G.z*this._pixelsPerMercatorPixel-H[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;let l=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||l){let se=this.center;return se.lat=i.clamp(se.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!l)&&(se.lng=i.clamp(se.lng,this.minLng,this.maxLng)),this.center=se,void(this._constraining=!1)}let h=this._unmodified,{x:_,y:x}=this.point,D=0,k=_,R=x,z=this.width/2,G=this.height/2,H=this.worldMinY*this.scale,K=this.worldMaxY*this.scale;if(x-G<H&&(R=H+G),x+G>K&&(R=K-G),K-H<this.height&&(D=Math.max(D,this.height/(K-H)),R=(K+H)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){let se=this.worldMinX*this.scale,le=this.worldMaxX*this.scale,fe=this.worldSize/2-(se+le)/2;k=(_+fe+this.worldSize)%this.worldSize-fe,k-z<se&&(k=se+z),k+z>le&&(k=le-z),le-se<this.width&&(D=Math.max(D,this.width/(le-se)),k=(le+se)/2)}k===_&&R===x||(this.center=this.unproject(new i.Point(k,R))),D&&(this.zoom+=this.scaleZoom(D)),this._constrainCamera(),this._unmodified=h,this._constraining=!1}_minZoomForBounds(){let l=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(l=Math.max(l,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),l}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;let l=this.centerOffset,h=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=i.mercatorZfromAltitude(1,this.center.lat)/i.mercatorZfromAltitude(1,i.GLOBE_SCALE_MATCH_LATITUDE));let _=Ml(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,_),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;let x=this.projection.zAxisUnit==="meters"?h:1,D=this._camera.getWorldToCamera(this.worldSize,x),k=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);k[8]=2*-l.x/this.width,k[9]=2*l.y/this.height;let R=i.mul([],k,D);if(this.projection.isReprojectedInTileSpace){let Re=this.locationCoordinate(this.center),Me=i.identity([]);i.translate(Me,Me,[Re.x*this.worldSize,Re.y*this.worldSize,0]),i.multiply(Me,Me,Dl(this)),i.translate(Me,Me,[-Re.x*this.worldSize,-Re.y*this.worldSize,0]),i.multiply(R,R,Me),this.inverseAdjustmentMatrix=function(Be){let Fe=Dl(Be,!0);return It([],[Fe[0],Fe[1],Fe[4],Fe[5]])}(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];this.mercatorMatrix=i.scale([],R,[this.worldSize,this.worldSize,this.worldSize/x,1]),this.projMatrix=R,this.invProjMatrix=i.invert(new Float64Array(16),this.projMatrix);let z=i.invert([],k);this.frustumCorners=i.FrustumCorners.fromInvProjectionMatrix(z,this.horizonLineFromTop(),this.height);let G=new Float32Array(16);i.identity(G),i.scale(G,G,[1,-1,1]),i.rotateX(G,G,this._pitch),i.rotateZ(G,G,this.angle);let H=i.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ),K=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;H[8]=2*-l.x/this.width,H[9]=2*(l.y+K)/this.height,this.skyboxMatrix=i.multiply(G,H,G);let se=this.point,le=se.x,fe=se.y,he=this.width%2/2,pe=this.height%2/2,Q=Math.cos(this.angle),ue=Math.sin(this.angle),ye=le-Math.round(le)+Q*he+ue*pe,_e=fe-Math.round(fe)+Q*pe+ue*he,Ae=new Float64Array(R);if(i.translate(Ae,Ae,[ye>.5?ye-1:ye,_e>.5?_e-1:_e,0]),this.alignedProjMatrix=Ae,R=i.create(),i.scale(R,R,[this.width/2,-this.height/2,1]),i.translate(R,R,[1,-1,0]),this.labelPlaneMatrix=R,R=i.create(),i.scale(R,R,[1,-1,1]),i.translate(R,R,[-1,-1,0]),i.scale(R,R,[2/this.width,2/this.height,1]),this.glCoordMatrix=R,this.pixelMatrix=i.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),this._distanceTileDataCache={},R=i.invert(new Float64Array(16),this.pixelMatrix),!R)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=R,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=i.calculateGlobeMatrix(this);let Re=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=i.transformMat4(Re,Re,D),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=R;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};let l=this.cameraWorldSizeForFog,h=this.cameraPixelsPerMeter,_=this._camera.position,x=1/this.height/this._pixelsPerMercatorPixel,D=[l,l,h];i.scale$2(D,D,x),i.scale$2(_,_,-1),i.multiply$2(_,_,D);let k=i.create();i.translate(k,k,_),i.scale(k,k,D),this.mercatorFogMatrix=k,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(l,h,x)}_computeCameraPosition(l){let h=(l=l||this.pixelsPerMeter)/this.pixelsPerMeter,_=this._camera.forward(),x=this.point,D=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*h-l/this.worldSize*this._centerAltitude;return[x.x/this.worldSize-_[0]*D,x.y/this.worldSize-_[1]*D,l/this.worldSize*this._centerAltitude-_[2]*D]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(l){let h=this._maxCameraBoundsDistance()*Math.cos(this._pitch),_=this._camera.position[2],x=l[2],D=1;this.projection.wrap&&(this.center=this.center.wrap()),x>0&&(D=Math.min((h-_)/x,1)),this._camera.position=i.scaleAndAdd([],this._camera.position,l,D),this._updateStateFromCamera()}_updateStateFromCamera(){let l=this._camera.position,h=this._camera.forward(),{pitch:_,bearing:x}=this._camera.getPitchBearing(),D=i.mercatorZfromAltitude(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,k=this._mercatorZfromZoom(this._maxZoom)*Math.cos(i.degToRad(this._maxPitch)),R=Math.max((l[2]-D)/Math.cos(_),k),z=this._zoomFromMercatorZ(R);i.scaleAndAdd(l,l,h,R),this._pitch=i.clamp(_,i.degToRad(this.minPitch),i.degToRad(this.maxPitch)),this.angle=i.wrap(x,-Math.PI,Math.PI),this._setZoom(i.clamp(z,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new i.MercatorCoordinate(l[0],l[1],l[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(l){return Math.pow(2,l)*this.tileSize}_mercatorZfromZoom(l){return this.cameraToCenterDistance/this._worldSizeFromZoom(l)}_minimumHeightOverTerrain(){let l=Math.min((this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom)+4,this._maxZoom);return this._mercatorZfromZoom(l)}_zoomFromMercatorZ(l){return this.scaleZoom(this.cameraToCenterDistance/(l*this.tileSize))}zoomFromMercatorZAdjusted(l){let h=0,_=i.GLOBE_ZOOM_THRESHOLD_MAX,x=0,D=1/0;for(;_-h>1e-6&&_>h;){let k=h+.5*(_-h),R=this.tileSize*Math.pow(2,k),z=this.getCameraToCenterDistance(this.projection,k,R),G=this.scaleZoom(z/(l*this.tileSize)),H=Math.abs(k-G);H<D&&(D=H,x=k),k<G?h=k:_=k}return x}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(i.warnOnce("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(l,h){let _=Math.min(l.x,h.x),x=Math.max(l.x,h.x),D=Math.min(l.y,h.y),k=Math.max(l.y,h.y);if(D<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;let R=[new i.Point(_,D),new i.Point(x,k),new i.Point(_,k),new i.Point(x,D)],z=this.renderWorldCopies?-3:0,G=this.renderWorldCopies?4:1;for(let H of R){let K=this.pointRayIntersection(H);if(K.t<0)return!0;let se=this.rayIntersectionCoordinate(K);if(se.x<z||se.y<0||se.x>G||se.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+i.radToDeg(this.fovAboveCenter)>88||this.anyCornerOffEdge(new i.Point(0,0),new i.Point(this.width,this.height))}zoomDeltaToMovement(l,h){let _=i.length(i.sub([],this._camera.position,l)),x=this._zoomFromMercatorZ(_)+h;return _-this._mercatorZfromZoom(x)}getCameraPoint(){if(this.projection.name==="globe"){let l=function([h,_,x],D){let k=[h,_,x,1];i.transformMat4$1(k,k,D);let R=k[3]=Math.max(k[3],1e-6);return k[0]/=R,k[1]/=R,k[2]/=R,k}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new i.Point(l[0],l[1])}{let l=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new i.Point(0,l))}}getCameraToCenterDistance(l,h=this.zoom,_=this.worldSize){let x=Ml(l,h,this.width,this.height,1024),D=l.pixelSpaceConversion(this.center.lat,_,x);return .5/Math.tan(.5*this._fov)*this.height*D}getWorldToCameraMatrix(){let l=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&i.multiply(l,l,this.globeMatrix),l}}function Kt(m,l){let h=!1,_=null,x=()=>{_=null,h&&(m(),_=setTimeout(x,l),h=!1)};return()=>(h=!0,_||x(),_)}class $d{constructor(l){this._hashName=l&&encodeURIComponent(l),i.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=Kt(this._updateHashUnthrottled.bind(this),300)}addTo(l){return this._map=l,i.window.addEventListener("hashchange",this._onHashChange,!1),l.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),i.window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){let l=this._map;if(!l)return"";let h=La(l);if(this._hashName){let _=this._hashName,x=!1,D=i.window.location.hash.slice(1).split("&").map(k=>{let R=k.split("=")[0];return R===_?(x=!0,`${R}=${h}`):k}).filter(k=>k);return x||D.push(`${_}=${h}`),`#${D.join("&")}`}return`#${h}`}_getCurrentHash(){let l=i.window.location.hash.replace("#","");if(this._hashName){let h;return l.split("&").map(_=>_.split("=")).forEach(_=>{_[0]===this._hashName&&(h=_)}),(h&&h[1]||"").split("/")}return l.split("/")}_onHashChange(){let l=this._map;if(!l)return!1;let h=this._getCurrentHash();if(h.length>=3&&!h.some(_=>isNaN(_))){let _=l.dragRotate.isEnabled()&&l.touchZoomRotate.isEnabled()?+(h[3]||0):l.getBearing();return l.jumpTo({center:[+h[2],+h[1]],zoom:+h[0],bearing:_,pitch:+(h[4]||0)}),!0}return!1}_updateHashUnthrottled(){let l=i.window.location.href.replace(/(#.+)?$/,this.getHashString());i.window.history.replaceState(i.window.history.state,null,l)}}function La(m,l){let h=m.getCenter(),_=Math.round(100*m.getZoom())/100,x=Math.ceil((_*Math.LN2+Math.log(512/360/.5))/Math.LN10),D=Math.pow(10,x),k=Math.round(h.lng*D)/D,R=Math.round(h.lat*D)/D,z=m.getBearing(),G=m.getPitch(),H=l?`/${k}/${R}/${_}`:`${_}/${R}/${k}`;return(z||G)&&(H+="/"+Math.round(10*z)/10),G&&(H+=`/${Math.round(G)}`),H}let Du={linearity:.3,easing:i.bezier(0,0,.3,1)},Il=i.extend({deceleration:2500,maxSpeed:1400},Du),bn=i.extend({deceleration:20,maxSpeed:1400},Du),Rt=i.extend({deceleration:1e3,maxSpeed:360},Du),ts=i.extend({deceleration:1e3,maxSpeed:90},Du);class Lp{constructor(l){this._map=l,this.clear()}clear(){this._inertiaBuffer=[]}record(l){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:i.exported.now(),settings:l})}_drainInertiaBuffer(){let l=this._inertiaBuffer,h=i.exported.now();for(;l.length>0&&h-l[0].time>160;)l.shift()}_onMoveEnd(l){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;let h={zoom:0,bearing:0,pitch:0,pan:new i.Point(0,0),pinchAround:void 0,around:void 0};for(let{settings:D}of this._inertiaBuffer)h.zoom+=D.zoomDelta||0,h.bearing+=D.bearingDelta||0,h.pitch+=D.pitchDelta||0,D.panDelta&&h.pan._add(D.panDelta),D.around&&(h.around=D.around),D.pinchAround&&(h.pinchAround=D.pinchAround);let _=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,x={};if(h.pan.mag()){let D=vc(h.pan.mag(),_,i.extend({},Il,l||{}));x.offset=h.pan.mult(D.amount/h.pan.mag()),x.center=this._map.transform.center,Mu(x,D)}if(h.zoom){let D=vc(h.zoom,_,bn);x.zoom=this._map.transform.zoom+D.amount,Mu(x,D)}if(h.bearing){let D=vc(h.bearing,_,Rt);x.bearing=this._map.transform.bearing+i.clamp(D.amount,-179,179),Mu(x,D)}if(h.pitch){let D=vc(h.pitch,_,ts);x.pitch=this._map.transform.pitch+D.amount,Mu(x,D)}if(x.zoom||x.bearing){let D=h.pinchAround===void 0?h.around:h.pinchAround;x.around=D?this._map.unproject(D):this._map.getCenter()}return this.clear(),x.noMoveStart=!0,x}}function Mu(m,l){(!m.duration||m.duration<l.duration)&&(m.duration=l.duration,m.easing=l.easing)}function vc(m,l,h){let{maxSpeed:_,linearity:x,deceleration:D}=h,k=i.clamp(m*x/(l/1e3),-_,_),R=Math.abs(k)/(D*x);return{easing:h.easing,duration:1e3*R,amount:k*(R/2)}}class _r extends i.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(l,h,_,x={}){let D=Gn(h.getCanvasContainer(),_),k=h.unproject(D);super(l,i.extend({point:D,lngLat:k,originalEvent:_},x)),this._defaultPrevented=!1,this.target=h}}class Tu extends i.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(l,h,_){let x=l==="touchend"?_.changedTouches:_.touches,D=Ro(h.getCanvasContainer(),x),k=D.map(z=>h.unproject(z)),R=D.reduce((z,G,H,K)=>z.add(G.div(K.length)),new i.Point(0,0));super(l,{points:D,point:R,lngLats:k,lngLat:h.unproject(R),originalEvent:_}),this._defaultPrevented=!1}}class Hd extends i.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(l,h,_){super(l,{originalEvent:_}),this._defaultPrevented=!1}}class Jh{constructor(l,h){this._map=l,this._clickTolerance=h.clickTolerance}reset(){this._mousedownPos=void 0}wheel(l){return this._firePreventable(new Hd(l.type,this._map,l))}mousedown(l,h){return this._mousedownPos=h,this._firePreventable(new _r(l.type,this._map,l))}mouseup(l){this._map.fire(new _r(l.type,this._map,l))}preclick(l){let h=i.extend({},l);h.type="preclick",this._map.fire(new _r(h.type,this._map,h))}click(l,h){this._mousedownPos&&this._mousedownPos.dist(h)>=this._clickTolerance||(this.preclick(l),this._map.fire(new _r(l.type,this._map,l)))}dblclick(l){return this._firePreventable(new _r(l.type,this._map,l))}mouseover(l){this._map.fire(new _r(l.type,this._map,l))}mouseout(l){this._map.fire(new _r(l.type,this._map,l))}touchstart(l){return this._firePreventable(new Tu(l.type,this._map,l))}touchmove(l){this._map.fire(new Tu(l.type,this._map,l))}touchend(l){this._map.fire(new Tu(l.type,this._map,l))}touchcancel(l){this._map.fire(new Tu(l.type,this._map,l))}_firePreventable(l){if(this._map.fire(l),l.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Sl{constructor(l){this._map=l}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(l){this._map.fire(new _r(l.type,this._map,l))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new _r("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(l){this._delayContextMenu?this._contextMenuEvent=l:this._map.fire(new _r(l.type,this._map,l)),this._map.listens("contextmenu")&&l.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Fp{constructor(l,h){this._map=l,this._el=l.getCanvasContainer(),this._container=l.getContainer(),this._clickTolerance=h.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(l,h){this.isEnabled()&&l.shiftKey&&l.button===0&&(bt(),this._startPos=this._lastPos=h,this._active=!0)}mousemoveWindow(l,h){if(!this._active)return;let _=h,x=this._startPos,D=this._lastPos;if(!x||!D||D.equals(_)||!this._box&&_.dist(x)<this._clickTolerance)return;this._lastPos=_,this._box||(this._box=oe("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",l));let k=Math.min(x.x,_.x),R=Math.max(x.x,_.x),z=Math.min(x.y,_.y),G=Math.max(x.y,_.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${k}px,${z}px)`,this._box.style.width=R-k+"px",this._box.style.height=G-z+"px")})}mouseupWindow(l,h){if(!this._active)return;let _=this._startPos,x=h;if(_&&l.button===0){if(this.reset(),_i(),_.x!==x.x||_.y!==x.y)return this._map.fire(new i.Event("boxzoomend",{originalEvent:l})),{cameraAnimation:D=>D.fitScreenCoordinates(_,x,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",l)}}keydown(l){this._active&&l.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",l))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),Ut(),delete this._startPos,delete this._lastPos}_fireEvent(l,h){return this._map.fire(new i.Event(l,{originalEvent:h}))}}function Iu(m,l){let h={};for(let _=0;_<m.length;_++)h[m[_].identifier]=l[_];return h}class bc{constructor(l){this.reset(),this.numTouches=l.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(l,h,_){(this.centroid||_.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=l.timeStamp),_.length===this.numTouches&&(this.centroid=function(x){let D=new i.Point(0,0);for(let k of x)D._add(k);return D.div(x.length)}(h),this.touches=Iu(_,h)))}touchmove(l,h,_){if(this.aborted||!this.centroid)return;let x=Iu(_,h);for(let D in this.touches){let k=x[D];(!k||k.dist(this.touches[D])>30)&&(this.aborted=!0)}}touchend(l,h,_){if((!this.centroid||l.timeStamp-this.startTime>500)&&(this.aborted=!0),_.length===0){let x=!this.aborted&&this.centroid;if(this.reset(),x)return x}}}class ef{constructor(l){this.singleTap=new bc(l),this.numTaps=l.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(l,h,_){this.singleTap.touchstart(l,h,_)}touchmove(l,h,_){this.singleTap.touchmove(l,h,_)}touchend(l,h,_){let x=this.singleTap.touchend(l,h,_);if(x){let D=l.timeStamp-this.lastTime<500,k=!this.lastTap||this.lastTap.dist(x)<30;if(D&&k||this.reset(),this.count++,this.lastTime=l.timeStamp,this.lastTap=x,this.count===this.numTaps)return this.reset(),x}}}class ry{constructor(){this._zoomIn=new ef({numTouches:1,numTaps:2}),this._zoomOut=new ef({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(l,h,_){this._zoomIn.touchstart(l,h,_),this._zoomOut.touchstart(l,h,_)}touchmove(l,h,_){this._zoomIn.touchmove(l,h,_),this._zoomOut.touchmove(l,h,_)}touchend(l,h,_){let x=this._zoomIn.touchend(l,h,_),D=this._zoomOut.touchend(l,h,_);return x?(this._active=!0,l.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:k=>k.easeTo({duration:300,zoom:k.getZoom()+1,around:k.unproject(x)},{originalEvent:l})}):D?(this._active=!0,l.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:k=>k.easeTo({duration:300,zoom:k.getZoom()-1,around:k.unproject(D)},{originalEvent:l})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}let Np={0:1,2:2};class xc{constructor(l){this.reset(),this._clickTolerance=l.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(l,h){return!1}_move(l,h){return{}}mousedown(l,h){if(this._lastPoint)return;let _=lt(l);this._correctButton(l,_)&&(this._lastPoint=h,this._eventButton=_)}mousemoveWindow(l,h){let _=this._lastPoint;if(_){if(l.preventDefault(),this._eventButton!=null&&function(x,D){let k=Np[D];return x.buttons===void 0||(x.buttons&k)!==k}(l,this._eventButton))this.reset();else if(this._moved||!(h.dist(_)<this._clickTolerance))return this._moved=!0,this._lastPoint=h,this._move(_,h)}}mouseupWindow(l){this._lastPoint&&lt(l)===this._eventButton&&(this._moved&&_i(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Gd extends xc{mousedown(l,h){super.mousedown(l,h),this._lastPoint&&(this._active=!0)}_correctButton(l,h){return h===0&&!l.ctrlKey}_move(l,h){return{around:h,panDelta:h.sub(l)}}}class tf extends xc{_correctButton(l,h){return h===0&&l.ctrlKey||h===2}_move(l,h){let _=.8*(h.x-l.x);if(_)return this._active=!0,{bearingDelta:_}}contextmenu(l){l.preventDefault()}}class nf extends xc{_correctButton(l,h){return h===0&&l.ctrlKey||h===2}_move(l,h){let _=-.5*(h.y-l.y);if(_)return this._active=!0,{pitchDelta:_}}contextmenu(l){l.preventDefault()}}class Su{constructor(l,h){this._map=l,this._el=l.getCanvasContainer(),this._minTouches=1,this._clickTolerance=h.clickTolerance||1,this.reset(),i.bindAll(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new i.Point(0,0)}touchstart(l,h,_){return this._calculateTransform(l,h,_)}touchmove(l,h,_){if(this._active&&!(_.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(_.length===1&&!i.isFullscreen())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return l.cancelable&&l.preventDefault(),this._calculateTransform(l,h,_)}}touchend(l,h,_){this._calculateTransform(l,h,_),this._active&&_.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(l,h,_){_.length>0&&(this._active=!0);let x=Iu(_,h),D=new i.Point(0,0),k=new i.Point(0,0),R=0;for(let G in x){let H=x[G],K=this._touches[G];K&&(D._add(H),k._add(H.sub(K)),R++,x[G]=H)}if(this._touches=x,R<this._minTouches||!k.mag())return;let z=k.div(R);return this._sum._add(z),this._sum.mag()<this._clickTolerance?void 0:{around:D.div(R),panDelta:z}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=oe("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","null")},500)}}class wc{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(l){}_move(l,h,_){return{}}touchstart(l,h,_){this._firstTwoTouches||_.length<2||(this._firstTwoTouches=[_[0].identifier,_[1].identifier],this._start([h[0],h[1]]))}touchmove(l,h,_){let x=this._firstTwoTouches;if(!x)return;l.preventDefault();let[D,k]=x,R=ho(_,h,D),z=ho(_,h,k);if(!R||!z)return;let G=this._aroundCenter?null:R.add(z).div(2);return this._move([R,z],G,l)}touchend(l,h,_){if(!this._firstTwoTouches)return;let[x,D]=this._firstTwoTouches,k=ho(_,h,x),R=ho(_,h,D);k&&R||(this._active&&_i(),this.reset())}touchcancel(){this.reset()}enable(l){this._enabled=!0,this._aroundCenter=!!l&&l.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function ho(m,l,h){for(let _=0;_<m.length;_++)if(m[_].identifier===h)return l[_]}function rf(m,l){return Math.log(m/l)/Math.LN2}class zp extends wc{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(l){this._startDistance=this._distance=l[0].dist(l[1])}_move(l,h){let _=this._distance;if(this._distance=l[0].dist(l[1]),this._active||!(Math.abs(rf(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:rf(this._distance,_),pinchAround:h}}}function of(m,l){return 180*m.angleWith(l)/Math.PI}class sf extends wc{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(l){this._startVector=this._vector=l[0].sub(l[1]),this._minDiameter=l[0].dist(l[1])}_move(l,h){let _=this._vector;if(this._vector=l[0].sub(l[1]),_&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:of(this._vector,_),pinchAround:h}}_isBelowThreshold(l){this._minDiameter=Math.min(this._minDiameter,l.mag());let h=25/(Math.PI*this._minDiameter)*360,_=this._startVector;if(!_)return!1;let x=of(l,_);return Math.abs(x)<h}}function Fa(m){return Math.abs(m.y)>Math.abs(m.x)}class Bp extends wc{constructor(l){super(),this._map=l}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(l){this._lastPoints=l,Fa(l[0].sub(l[1]))&&(this._valid=!1)}_move(l,h,_){let x=this._lastPoints;if(!x)return;let D=l[0].sub(x[0]),k=l[1].sub(x[1]);return this._map._cooperativeGestures&&!i.isFullscreen()&&_.touches.length<3||(this._valid=this.gestureBeginsVertically(D,k,_.timeStamp),!this._valid)?void 0:(this._lastPoints=l,this._active=!0,{pitchDelta:(D.y+k.y)/2*-.5})}gestureBeginsVertically(l,h,_){if(this._valid!==void 0)return this._valid;let x=l.mag()>=2,D=h.mag()>=2;if(!x&&!D)return;if(!x||!D)return this._firstMove==null&&(this._firstMove=_),_-this._firstMove<100&&void 0;let k=l.y>0==h.y>0;return Fa(l)&&Fa(h)&&k}}let Au={panStep:100,bearingStep:15,pitchStep:10};class oy{constructor(){let l=Au;this._panStep=l.panStep,this._bearingStep=l.bearingStep,this._pitchStep=l.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(l){if(l.altKey||l.ctrlKey||l.metaKey)return;let h=0,_=0,x=0,D=0,k=0;switch(l.keyCode){case 61:case 107:case 171:case 187:h=1;break;case 189:case 109:case 173:h=-1;break;case 37:l.shiftKey?_=-1:(l.preventDefault(),D=-1);break;case 39:l.shiftKey?_=1:(l.preventDefault(),D=1);break;case 38:l.shiftKey?x=1:(l.preventDefault(),k=-1);break;case 40:l.shiftKey?x=-1:(l.preventDefault(),k=1);break;default:return}return this._rotationDisabled&&(_=0,x=0),{cameraAnimation:R=>{let z=R.getZoom();R.easeTo({duration:300,easeId:"keyboardHandler",easing:af,zoom:h?Math.round(z)+h*(l.shiftKey?2:1):z,bearing:R.getBearing()+_*this._bearingStep,pitch:R.getPitch()+x*this._pitchStep,offset:[-D*this._panStep,-k*this._panStep],center:R.getCenter()},{originalEvent:l})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function af(m){return m*(2-m)}let lf=4.000244140625;class jp{constructor(l,h){this._map=l,this._el=l.getCanvasContainer(),this._handler=h,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,i.bindAll(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(l){this._defaultZoomRate=l}setWheelZoomRate(l){this._wheelZoomRate=l}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(l){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!l&&l.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(l){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(l.ctrlKey||l.metaKey||this.isZooming()||i.isFullscreen()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let h=l.deltaMode===i.window.WheelEvent.DOM_DELTA_LINE?40*l.deltaY:l.deltaY,_=i.exported.now(),x=_-(this._lastWheelEventTime||0);this._lastWheelEventTime=_,h!==0&&h%lf==0?this._type="wheel":h!==0&&Math.abs(h)<4?this._type="trackpad":x>400?(this._type=null,this._lastValue=h,this._timeout=setTimeout(this._onTimeout,40,l)):this._type||(this._type=Math.abs(x*h)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,h+=this._lastValue)),l.shiftKey&&h&&(h/=4),this._type&&(this._lastWheelEvent=l,this._delta-=h,this._active||this._start(l)),l.preventDefault()}_onTimeout(l){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(l)}_start(l){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);let h=Gn(this._el,l);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:h,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;let l=this._map.transform;this._type==="wheel"&&l.projection.wrap&&(l._center.lng>=180||l._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);let h=()=>l._terrainEnabled()&&this._aroundCoord?l.computeZoomRelativeTo(this._aroundCoord):l.zoom;if(this._delta!==0){let z=this._type==="wheel"&&Math.abs(this._delta)>lf?this._wheelZoomRate:this._defaultZoomRate,G=2/(1+Math.exp(-Math.abs(this._delta*z)));this._delta<0&&G!==0&&(G=1/G);let H=h(),K=Math.pow(2,H),se=typeof this._targetZoom=="number"?l.zoomScale(this._targetZoom):K;this._targetZoom=Math.min(l.maxZoom,Math.max(l.minZoom,l.scaleZoom(se*G))),this._type==="wheel"&&(this._startZoom=H,this._easing=this._smoothOutEasing(200)),this._delta=0}let _=typeof this._targetZoom=="number"?this._targetZoom:h(),x=this._startZoom,D=this._easing,k,R=!1;if(this._type==="wheel"&&x&&D){let z=Math.min((i.exported.now()-this._lastWheelEventTime)/200,1),G=D(z);k=i.number(x,_,G),z<1?this._frameId||(this._frameId=!0):R=!0}else k=_,R=!0;return this._active=!0,R&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!R,zoomDelta:k-h(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(l){let h=i.ease;if(this._prevEase){let _=this._prevEase,x=(i.exported.now()-_.start)/_.duration,D=_.easing(x+.01)-_.easing(x),k=.27/Math.sqrt(D*D+1e-4)*.01,R=Math.sqrt(.0729-k*k);h=i.bezier(k,R,.25,1)}return this._prevEase={start:i.exported.now(),duration:l,easing:h},h}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=oe("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(i.window.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","null")},200)}}class cf{constructor(l,h){this._clickZoom=l,this._tapZoom=h}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Zr{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(l,h){return l.preventDefault(),{cameraAnimation:_=>{_.easeTo({duration:300,zoom:_.getZoom()+(l.shiftKey?-1:1),around:_.unproject(h)},{originalEvent:l})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class sy{constructor(){this._tap=new ef({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(l,h,_){this._swipePoint||(this._tapTime&&l.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?_.length>0&&(this._swipePoint=h[0],this._swipeTouch=_[0].identifier):this._tap.touchstart(l,h,_))}touchmove(l,h,_){if(this._tapTime){if(this._swipePoint){if(_[0].identifier!==this._swipeTouch)return;let x=h[0],D=x.y-this._swipePoint.y;return this._swipePoint=x,l.preventDefault(),this._active=!0,{zoomDelta:D/128}}}else this._tap.touchmove(l,h,_)}touchend(l,h,_){this._tapTime?this._swipePoint&&_.length===0&&this.reset():this._tap.touchend(l,h,_)&&(this._tapTime=l.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Vp{constructor(l,h,_){this._el=l,this._mousePan=h,this._touchPan=_}enable(l){this._inertiaOptions=l||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Cc{constructor(l,h,_){this._pitchWithRotate=l.pitchWithRotate,this._mouseRotate=h,this._mousePitch=_}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class Up{constructor(l,h,_,x){this._el=l,this._touchZoom=h,this._touchRotate=_,this._tapDragZoom=x,this._rotationDisabled=!1,this._enabled=!0}enable(l){this._touchZoom.enable(l),this._rotationDisabled||this._touchRotate.enable(l),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}let No=m=>m.zoom||m.drag||m.pitch||m.rotate;class $p extends i.Event{}class Hp{constructor(){this.constants=[1,1,.01],this.radius=0}setup(l,h){let _=i.sub([],h,l);this.radius=i.length(_[2]<0?i.div([],_,this.constants):[_[0],_[1],0])}projectRay(l){i.div(l,l,this.constants),i.normalize(l,l),i.mul$1(l,l,this.constants);let h=i.scale$2([],l,this.radius);if(h[2]>0){let _=i.scale$2([],[0,0,1],i.dot(h,[0,0,1])),x=i.scale$2([],i.normalize([],[h[0],h[1],0]),this.radius),D=i.add([],h,i.scale$2([],i.sub([],i.add([],x,_),h),2));h[0]=D[0],h[1]=D[1]}return h}}function ns(m){return m.panDelta&&m.panDelta.mag()||m.zoomDelta||m.bearingDelta||m.pitchDelta}class Es{constructor(l,h){this._map=l,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Lp(l),this._bearingSnap=h.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new Hp,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(h),i.bindAll(["handleEvent","handleWindowEvent"],this);let _=this._el;this._listeners=[[_,"touchstart",{passive:!0}],[_,"touchmove",{passive:!1}],[_,"touchend",void 0],[_,"touchcancel",void 0],[_,"mousedown",void 0],[_,"mousemove",void 0],[_,"mouseup",void 0],[i.window.document,"mousemove",{capture:!0}],[i.window.document,"mouseup",void 0],[_,"mouseover",void 0],[_,"mouseout",void 0],[_,"dblclick",void 0],[_,"click",void 0],[_,"keydown",{capture:!1}],[_,"keyup",void 0],[_,"wheel",{passive:!1}],[_,"contextmenu",void 0],[i.window,"blur",void 0]];for(let[x,D,k]of this._listeners)x.addEventListener(D,x===i.window.document?this.handleWindowEvent:this.handleEvent,k)}destroy(){for(let[l,h,_]of this._listeners)l.removeEventListener(h,l===i.window.document?this.handleWindowEvent:this.handleEvent,_)}_addDefaultHandlers(l){let h=this._map,_=h.getCanvasContainer();this._add("mapEvent",new Jh(h,l));let x=h.boxZoom=new Fp(h,l);this._add("boxZoom",x);let D=new ry,k=new Zr;h.doubleClickZoom=new cf(k,D),this._add("tapZoom",D),this._add("clickZoom",k);let R=new sy;this._add("tapDragZoom",R);let z=h.touchPitch=new Bp(h);this._add("touchPitch",z);let G=new tf(l),H=new nf(l);h.dragRotate=new Cc(l,G,H),this._add("mouseRotate",G,["mousePitch"]),this._add("mousePitch",H,["mouseRotate"]);let K=new Gd(l),se=new Su(h,l);h.dragPan=new Vp(_,K,se),this._add("mousePan",K),this._add("touchPan",se,["touchZoom","touchRotate"]);let le=new sf,fe=new zp;h.touchZoomRotate=new Up(_,fe,le,R),this._add("touchRotate",le,["touchPan","touchZoom"]),this._add("touchZoom",fe,["touchPan","touchRotate"]),this._add("blockableMapEvent",new Sl(h));let he=h.scrollZoom=new jp(h,this);this._add("scrollZoom",he,["mousePan"]);let pe=h.keyboard=new oy;this._add("keyboard",pe);for(let Q of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])l.interactive&&l[Q]&&h[Q].enable(l[Q])}_add(l,h,_){this._handlers.push({handlerName:l,handler:h,allowed:_}),this._handlersById[l]=h}stop(l){if(!this._updatingCamera){for(let{handler:h}of this._handlers)h.reset();this._inertia.clear(),this._fireEvents({},{},l),this._changes=[]}}isActive(){for(let{handler:l}of this._handlers)if(l.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!No(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(l,h,_){for(let x in l)if(x!==_&&(!h||h.indexOf(x)<0))return!0;return!1}handleWindowEvent(l){this.handleEvent(l,`${l.type}Window`)}_getMapTouches(l){let h=[];for(let _ of l)this._el.contains(_.target)&&h.push(_);return h}handleEvent(l,h){this._updatingCamera=!0;let _=l.type==="renderFrame",x=_?void 0:l,D={needsRenderFrame:!1},k={},R={},z=l.touches?this._getMapTouches(l.touches):void 0,G=z?Ro(this._el,z):_?void 0:Gn(this._el,l);for(let{handlerName:se,handler:le,allowed:fe}of this._handlers){if(!le.isEnabled())continue;let he;this._blockedByActive(R,fe,se)?le.reset():le[h||l.type]&&(he=le[h||l.type](l,G,z),this.mergeHandlerResult(D,k,he,se,x),he&&he.needsRenderFrame&&this._triggerRenderFrame()),(he||le.isActive())&&(R[se]=le)}let H={};for(let se in this._previousActiveHandlers)R[se]||(H[se]=x);this._previousActiveHandlers=R,(Object.keys(H).length||ns(D))&&(this._changes.push([D,k,H]),this._triggerRenderFrame()),(Object.keys(R).length||ns(D))&&this._map._stop(!0),this._updatingCamera=!1;let{cameraAnimation:K}=D;K&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],K(this._map))}mergeHandlerResult(l,h,_,x,D){if(!_)return;i.extend(l,_);let k={handlerName:x,originalEvent:_.originalEvent||D};_.zoomDelta!==void 0&&(h.zoom=k),_.panDelta!==void 0&&(h.drag=k),_.pitchDelta!==void 0&&(h.pitch=k),_.bearingDelta!==void 0&&(h.rotate=k)}_applyChanges(){let l={},h={},_={};for(let[x,D,k]of this._changes)x.panDelta&&(l.panDelta=(l.panDelta||new i.Point(0,0))._add(x.panDelta)),x.zoomDelta&&(l.zoomDelta=(l.zoomDelta||0)+x.zoomDelta),x.bearingDelta&&(l.bearingDelta=(l.bearingDelta||0)+x.bearingDelta),x.pitchDelta&&(l.pitchDelta=(l.pitchDelta||0)+x.pitchDelta),x.around!==void 0&&(l.around=x.around),x.aroundCoord!==void 0&&(l.aroundCoord=x.aroundCoord),x.pinchAround!==void 0&&(l.pinchAround=x.pinchAround),x.noInertia&&(l.noInertia=x.noInertia),i.extend(h,D),i.extend(_,k);this._updateMapTransform(l,h,_),this._changes=[]}_updateMapTransform(l,h,_){let x=this._map,D=x.transform,k=ue=>[ue.x,ue.y,ue.z];if((ue=>{let ye=this._eventsInProgress.drag;return ye&&!this._handlersById[ye.handlerName].isActive()})()&&!ns(l)){let ue=D.zoom;D.cameraElevationReference="sea",D.recenterOnTerrain(),D.cameraElevationReference="ground",ue!==D.zoom&&this._map._update(!0)}if(D._isCameraConstrained&&x._stop(!0),!ns(l))return void this._fireEvents(h,_,!0);let{panDelta:R,zoomDelta:z,bearingDelta:G,pitchDelta:H,around:K,aroundCoord:se,pinchAround:le}=l;D._isCameraConstrained&&(z>0&&(z=0),D._isCameraConstrained=!1),le!==void 0&&(K=le),(z||(ue=>h[ue]&&!this._eventsInProgress[ue])("drag"))&&K&&(this._dragOrigin=k(D.pointCoordinate3D(K)),this._trackingEllipsoid.setup(D._camera.position,this._dragOrigin)),D.cameraElevationReference="sea",x._stop(!0),K=K||x.transform.centerPoint,G&&(D.bearing+=G),H&&(D.pitch+=H),D._updateCameraState();let fe=[0,0,0];if(R)if(D.projection.name==="mercator"){let ue=this._trackingEllipsoid.projectRay(D.screenPointToMercatorRay(K).dir),ye=this._trackingEllipsoid.projectRay(D.screenPointToMercatorRay(K.sub(R)).dir);fe[0]=ye[0]-ue[0],fe[1]=ye[1]-ue[1]}else{let ue=D.pointCoordinate(K);if(D.projection.name==="globe"){R=R.rotate(-D.angle);let ye=D._pixelsPerMercatorPixel/D.worldSize;fe[0]=-R.x*i.mercatorScale(i.latFromMercatorY(ue.y))*ye,fe[1]=-R.y*i.mercatorScale(D.center.lat)*ye}else{let ye=D.pointCoordinate(K.sub(R));ue&&ye&&(fe[0]=ye.x-ue.x,fe[1]=ye.y-ue.y)}}let he=D.zoom,pe=[0,0,0];if(z){let ue=k(se||D.pointCoordinate3D(K)),ye={dir:i.normalize([],i.sub([],ue,D._camera.position))};if(ye.dir[2]<0){let _e=D.zoomDeltaToMovement(ue,z);i.scale$2(pe,ye.dir,_e)}}let Q=i.add(fe,fe,pe);D._translateCameraConstrained(Q),z&&Math.abs(D.zoom-he)>1e-4&&D.recenterOnTerrain(),D.cameraElevationReference="ground",this._map._update(),l.noInertia||this._inertia.record(l),this._fireEvents(h,_,!0)}_fireEvents(l,h,_){let x=No(this._eventsInProgress),D=No(l),k={};for(let H in l){let{originalEvent:K}=l[H];this._eventsInProgress[H]||(k[`${H}start`]=K),this._eventsInProgress[H]=l[H]}!x&&D&&this._fireEvent("movestart",D.originalEvent);for(let H in k)this._fireEvent(H,k[H]);D&&this._fireEvent("move",D.originalEvent);for(let H in l){let{originalEvent:K}=l[H];this._fireEvent(H,K)}let R={},z;for(let H in this._eventsInProgress){let{handlerName:K,originalEvent:se}=this._eventsInProgress[H];this._handlersById[K].isActive()||(delete this._eventsInProgress[H],z=h[K]||se,R[`${H}end`]=z)}for(let H in R)this._fireEvent(H,R[H]);let G=No(this._eventsInProgress);if(_&&(x||D)&&!G){this._updatingCamera=!0;let H=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),K=se=>se!==0&&-this._bearingSnap<se&&se<this._bearingSnap;H?(K(H.bearing||this._map.getBearing())&&(H.bearing=0),this._map.easeTo(H,{originalEvent:z})):(this._map.fire(new i.Event("moveend",{originalEvent:z})),K(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(l,h){this._map.fire(new i.Event(l,h?{originalEvent:h}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(l=>{this._frameId=void 0,this.handleEvent(new $p("renderFrame",{timeStamp:l})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}let Al="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class Ec extends i.Evented{constructor(l,h){super(),this._moving=!1,this._zooming=!1,this.transform=l,this._bearingSnap=h.bearingSnap,this._respectPrefersReducedMotion=h.respectPrefersReducedMotion!==!1,i.bindAll(["_renderFrameCallback"],this)}getCenter(){return new i.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(l,h){return this.jumpTo({center:l},h)}panBy(l,h,_){return l=i.Point.convert(l).mult(-1),this.panTo(this.transform.center,i.extend({offset:l},h),_)}panTo(l,h,_){return this.easeTo(i.extend({center:l},h),_)}getZoom(){return this.transform.zoom}setZoom(l,h){return this.jumpTo({zoom:l},h),this}zoomTo(l,h,_){return this.easeTo(i.extend({zoom:l},h),_)}zoomIn(l,h){return this.zoomTo(this.getZoom()+1,l,h),this}zoomOut(l,h){return this.zoomTo(this.getZoom()-1,l,h),this}getBearing(){return this.transform.bearing}setBearing(l,h){return this.jumpTo({bearing:l},h),this}getPadding(){return this.transform.padding}setPadding(l,h){return this.jumpTo({padding:l},h),this}rotateTo(l,h,_){return this.easeTo(i.extend({bearing:l},h),_)}resetNorth(l,h){return this.rotateTo(0,i.extend({duration:1e3},l),h),this}resetNorthPitch(l,h){return this.easeTo(i.extend({bearing:0,pitch:0,duration:1e3},l),h),this}snapToNorth(l,h){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(l,h):this}getPitch(){return this.transform.pitch}setPitch(l,h){return this.jumpTo({pitch:l},h),this}cameraForBounds(l,h){l=i.LngLatBounds.convert(l);let _=h&&h.bearing||0,x=h&&h.pitch||0,D=l.getNorthWest(),k=l.getSouthEast();return this._cameraForBounds(this.transform,D,k,_,x,h)}_extendCameraOptions(l){let h={top:0,bottom:0,right:0,left:0};if(typeof(l=i.extend({padding:h,offset:[0,0],maxZoom:this.transform.maxZoom},l)).padding=="number"){let _=l.padding;l.padding={top:_,bottom:_,right:_,left:_}}return l.padding=i.extend(h,l.padding),l}_minimumAABBFrustumDistance(l,h){let _=h.max[0]-h.min[0],x=h.max[1]-h.min[1];return _/x>l.aspect?_/(2*Math.tan(.5*l.fovX)*l.aspect):x/(2*Math.tan(.5*l.fovY)*l.aspect)}_cameraForBoundsOnGlobe(l,h,_,x,D,k){let R=l.clone(),z=this._extendCameraOptions(k);R.bearing=x,R.pitch=D;let G=i.LngLat.convert(h),H=i.LngLat.convert(_),K=.5*(G.lat+H.lat),se=.5*(G.lng+H.lng),le=i.latLngToECEF(K,se),fe=i.normalize([],le),he=i.normalize([],i.cross([],fe,[0,1,0])),pe=i.cross([],he,fe),Q=[he[0],he[1],he[2],0,pe[0],pe[1],pe[2],0,fe[0],fe[1],fe[2],0,0,0,0,1],ue=[le,i.latLngToECEF(G.lat,G.lng),i.latLngToECEF(H.lat,G.lng),i.latLngToECEF(H.lat,H.lng),i.latLngToECEF(G.lat,H.lng),i.latLngToECEF(K,G.lng),i.latLngToECEF(K,H.lng),i.latLngToECEF(G.lat,se),i.latLngToECEF(H.lat,se)],ye=i.Aabb.fromPoints(ue.map(at=>[i.dot(he,at),i.dot(pe,at),i.dot(fe,at)])),_e=i.transformMat4([],ye.center,Q);i.squaredLength(_e)===0&&i.set(_e,0,0,1),i.normalize(_e,_e),i.scale$2(_e,_e,i.GLOBE_RADIUS),R.center=i.ecefToLatLng(_e);let Ae=R.getWorldToCameraMatrix(),Re=i.invert(new Float64Array(16),Ae);ye=i.Aabb.applyTransform(ye,i.multiply([],Ae,Q)),i.transformMat4(_e,_e,Ae);let Me=.5*(ye.max[2]-ye.min[2]),Be=this._minimumAABBFrustumDistance(R,ye),Fe=i.scale$2([],[0,0,1],Me),je=i.add(Fe,_e,Fe),mt=Be+(R.pitch===0?0:i.distance(_e,je)),He=R.globeCenterInViewSpace,it=i.sub([],_e,[He[0],He[1],He[2]]);i.normalize(it,it),i.scale$2(it,it,mt);let Ze=i.add([],_e,it);i.transformMat4(Ze,Ze,Re);let ht=i.earthRadius/i.GLOBE_RADIUS,Ge=i.length(Ze),tt=i.mercatorZfromAltitude(Math.max(Ge*ht-i.earthRadius,Number.EPSILON),0),gt=Math.min(R.zoomFromMercatorZAdjusted(tt),z.maxZoom);return gt>.5*(i.GLOBE_ZOOM_THRESHOLD_MIN+i.GLOBE_ZOOM_THRESHOLD_MAX)?(R.setProjection({name:"mercator"}),R.zoom=gt,this._cameraForBounds(R,h,_,x,D,k)):{center:R.center,zoom:gt,bearing:x,pitch:D}}queryTerrainElevation(l,h){let _=this.transform.elevation;return _?(h=i.extend({},{exaggerated:!0},h),_.getAtPoint(i.MercatorCoordinate.fromLngLat(l),null,h.exaggerated)):null}_cameraForBounds(l,h,_,x,D,k){if(l.projection.name==="globe")return this._cameraForBoundsOnGlobe(l,h,_,x,D,k);let R=l.clone(),z=this._extendCameraOptions(k),G=R.padding;R.bearing=x,R.pitch=D;let H=i.LngLat.convert(h),K=i.LngLat.convert(_),se=new i.LngLat(H.lng,K.lat),le=new i.LngLat(K.lng,H.lat),fe=R.project(H),he=R.project(K),pe=this.queryTerrainElevation(H),Q=this.queryTerrainElevation(K),ue=this.queryTerrainElevation(se),ye=this.queryTerrainElevation(le),_e=[[fe.x,fe.y,Math.min(pe||0,Q||0,ue||0,ye||0)],[he.x,he.y,Math.max(pe||0,Q||0,ue||0,ye||0)]],Ae=i.Aabb.fromPoints(_e),Re=R.getWorldToCameraMatrix(),Me=i.invert(new Float64Array(16),Re);Ae=i.Aabb.applyTransform(Ae,Re);let Be=i.sub([],Ae.max,Ae.min),Fe=G.left||0,je=G.right||0,mt=G.bottom||0,He=G.top||0,{left:it,right:Ze,top:ht,bottom:Ge}=z.padding,tt=.5*(Fe+je),gt=.5*(He+mt),at=Math.min(R.scaleZoom(R.scale*Math.min((R.width-(Fe+je+it+Ze))/Be[0],(R.height-(mt+He+Ge+ht))/Be[1])),z.maxZoom),_t=R.scale/R.zoomScale(at);Ae=new i.Aabb([Ae.min[0]-(it+tt)*_t,Ae.min[1]-(Ge+gt)*_t,Ae.min[2]],[Ae.max[0]+(Ze+tt)*_t,Ae.max[1]+(ht+gt)*_t,Ae.max[2]]);let $t=.5*Be[2],sn=this._minimumAABBFrustumDistance(R,Ae),Ft=[0,0,1,0];i.transformMat4$1(Ft,Ft,Re),i.normalize$2(Ft,Ft);let Xt=i.scale$2([],Ft,sn+$t),Gt=i.add([],Ae.center,Xt),Mn=(typeof z.offset.x=="number"&&typeof z.offset.y=="number"?new i.Point(z.offset.x,z.offset.y):i.Point.convert(z.offset)).rotate(-i.degToRad(x));Ae.center[0]-=Mn.x*_t,Ae.center[1]+=Mn.y*_t,i.transformMat4(Ae.center,Ae.center,Me),i.transformMat4(Gt,Gt,Me);let Vt=[Ae.center[0],Ae.center[1],Gt[2]*R.pixelsPerMeter];i.scale$2(Vt,Vt,1/R.worldSize);let Qn=i.lngFromMercatorX(Vt[0]),ui=i.latFromMercatorY(Vt[1]),di=Math.min(R._zoomFromMercatorZ(Vt[2]),z.maxZoom),hi=new i.LngLat(Qn,ui);return R.mercatorFromTransition&&di<.5*(i.GLOBE_ZOOM_THRESHOLD_MIN+i.GLOBE_ZOOM_THRESHOLD_MAX)?(R.setProjection({name:"globe"}),R.zoom=di,this._cameraForBounds(R,h,_,x,D,k)):{center:hi,zoom:di,bearing:x,pitch:D}}fitBounds(l,h,_){let x=this.cameraForBounds(l,h);return this._fitInternal(x,h,_)}fitScreenCoordinates(l,h,_,x,D){let k=i.Point.convert(l),R=i.Point.convert(h),z=new i.Point(Math.min(k.x,R.x),Math.min(k.y,R.y)),G=new i.Point(Math.max(k.x,R.x),Math.max(k.y,R.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(k,R))return this;let H=this.transform.pointLocation3D(z),K=this.transform.pointLocation3D(G),se=this.transform.pointLocation3D(new i.Point(z.x,G.y)),le=this.transform.pointLocation3D(new i.Point(G.x,z.y)),fe=[Math.min(H.lng,K.lng,se.lng,le.lng),Math.min(H.lat,K.lat,se.lat,le.lat)],he=[Math.max(H.lng,K.lng,se.lng,le.lng),Math.max(H.lat,K.lat,se.lat,le.lat)],pe=x&&x.pitch?x.pitch:this.getPitch(),Q=this._cameraForBounds(this.transform,fe,he,_,pe,x);return this._fitInternal(Q,x,D)}_fitInternal(l,h,_){return l?(delete(h=i.extend(l,h)).padding,h.linear?this.easeTo(h,_):this.flyTo(h,_)):this}jumpTo(l,h){this.stop();let _=l.preloadOnly?this.transform.clone():this.transform,x=!1,D=!1,k=!1;return"zoom"in l&&_.zoom!==+l.zoom&&(x=!0,_.zoom=+l.zoom),l.center!==void 0&&(_.center=i.LngLat.convert(l.center)),"bearing"in l&&_.bearing!==+l.bearing&&(D=!0,_.bearing=+l.bearing),"pitch"in l&&_.pitch!==+l.pitch&&(k=!0,_.pitch=+l.pitch),l.padding==null||_.isPaddingEqual(l.padding)||(_.padding=l.padding),l.preloadOnly?(this._preloadTiles(_),this):(this.fire(new i.Event("movestart",h)).fire(new i.Event("move",h)),x&&this.fire(new i.Event("zoomstart",h)).fire(new i.Event("zoom",h)).fire(new i.Event("zoomend",h)),D&&this.fire(new i.Event("rotatestart",h)).fire(new i.Event("rotate",h)).fire(new i.Event("rotateend",h)),k&&this.fire(new i.Event("pitchstart",h)).fire(new i.Event("pitch",h)).fire(new i.Event("pitchend",h)),this.fire(new i.Event("moveend",h)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||i.warnOnce(Al),this.transform.getFreeCameraOptions()}setFreeCameraOptions(l,h){let _=this.transform;if(!_.projection.supportsFreeCamera)return i.warnOnce(Al),this;this.stop();let x=_.zoom,D=_.pitch,k=_.bearing;_.setFreeCameraOptions(l);let R=x!==_.zoom,z=D!==_.pitch,G=k!==_.bearing;return this.fire(new i.Event("movestart",h)).fire(new i.Event("move",h)),R&&this.fire(new i.Event("zoomstart",h)).fire(new i.Event("zoom",h)).fire(new i.Event("zoomend",h)),G&&this.fire(new i.Event("rotatestart",h)).fire(new i.Event("rotate",h)).fire(new i.Event("rotateend",h)),z&&this.fire(new i.Event("pitchstart",h)).fire(new i.Event("pitch",h)).fire(new i.Event("pitchend",h)),this.fire(new i.Event("moveend",h)),this}easeTo(l,h){this._stop(!1,l.easeId),((l=i.extend({offset:[0,0],duration:500,easing:i.ease},l)).animate===!1||this._prefersReducedMotion(l))&&(l.duration=0);let _=this.transform,x=this.getZoom(),D=this.getBearing(),k=this.getPitch(),R=this.getPadding(),z="zoom"in l?+l.zoom:x,G="bearing"in l?this._normalizeBearing(l.bearing,D):D,H="pitch"in l?+l.pitch:k,K="padding"in l?l.padding:_.padding,se=i.Point.convert(l.offset),le,fe,he;if(_.projection.name==="globe"){let Fe=i.MercatorCoordinate.fromLngLat(_.center),je=se.rotate(-_.angle);Fe.x+=je.x/_.worldSize,Fe.y+=je.y/_.worldSize;let mt=Fe.toLngLat(),He=i.LngLat.convert(l.center||mt);this._normalizeCenter(He),le=_.centerPoint.add(je),fe=new i.Point(Fe.x,Fe.y).mult(_.worldSize),he=new i.Point(i.mercatorXfromLng(He.lng),i.mercatorYfromLat(He.lat)).mult(_.worldSize).sub(fe)}else{le=_.centerPoint.add(se);let Fe=_.pointLocation(le),je=i.LngLat.convert(l.center||Fe);this._normalizeCenter(je),fe=_.project(Fe),he=_.project(je).sub(fe)}let pe=_.zoomScale(z-x),Q,ue;l.around&&(Q=i.LngLat.convert(l.around),ue=_.locationPoint(Q));let ye=this._zooming||z!==x,_e=this._rotating||D!==G,Ae=this._pitching||H!==k,Re=!_.isPaddingEqual(K),Me=Fe=>je=>{if(ye&&(Fe.zoom=i.number(x,z,je)),_e&&(Fe.bearing=i.number(D,G,je)),Ae&&(Fe.pitch=i.number(k,H,je)),Re&&(Fe.interpolatePadding(R,K,je),le=Fe.centerPoint.add(se)),Q)Fe.setLocationAtPoint(Q,ue);else{let mt=Fe.zoomScale(Fe.zoom-x),He=z>x?Math.min(2,pe):Math.max(.5,pe),it=Math.pow(He,1-je),Ze=Fe.unproject(fe.add(he.mult(je*it)).mult(mt));Fe.setLocationAtPoint(Fe.renderWorldCopies?Ze.wrap():Ze,le)}return l.preloadOnly||this._fireMoveEvents(h),Fe};if(l.preloadOnly){let Fe=this._emulate(Me,l.duration,_);return this._preloadTiles(Fe),this}let Be={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=ye,this._rotating=_e,this._pitching=Ae,this._padding=Re,this._easeId=l.easeId,this._prepareEase(h,l.noMoveStart,Be),this._ease(Me(_),Fe=>{_.recenterOnTerrain(),this._afterEase(h,Fe)},l),this}_prepareEase(l,h,_={}){this._moving=!0,this.transform.cameraElevationReference="sea",h||_.moving||this.fire(new i.Event("movestart",l)),this._zooming&&!_.zooming&&this.fire(new i.Event("zoomstart",l)),this._rotating&&!_.rotating&&this.fire(new i.Event("rotatestart",l)),this._pitching&&!_.pitching&&this.fire(new i.Event("pitchstart",l))}_fireMoveEvents(l){this.fire(new i.Event("move",l)),this._zooming&&this.fire(new i.Event("zoom",l)),this._rotating&&this.fire(new i.Event("rotate",l)),this._pitching&&this.fire(new i.Event("pitch",l))}_afterEase(l,h){if(this._easeId&&h&&this._easeId===h)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";let _=this._zooming,x=this._rotating,D=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,_&&this.fire(new i.Event("zoomend",l)),x&&this.fire(new i.Event("rotateend",l)),D&&this.fire(new i.Event("pitchend",l)),this.fire(new i.Event("moveend",l))}flyTo(l,h){if(this._prefersReducedMotion(l)){let at=i.pick(l,["center","zoom","bearing","pitch","around"]);return this.jumpTo(at,h)}this.stop(),l=i.extend({offset:[0,0],speed:1.2,curve:1.42,easing:i.ease},l);let _=this.transform,x=this.getZoom(),D=this.getBearing(),k=this.getPitch(),R=this.getPadding(),z="zoom"in l?i.clamp(+l.zoom,_.minZoom,_.maxZoom):x,G="bearing"in l?this._normalizeBearing(l.bearing,D):D,H="pitch"in l?+l.pitch:k,K="padding"in l?l.padding:_.padding,se=_.zoomScale(z-x),le=i.Point.convert(l.offset),fe=_.centerPoint.add(le),he=_.pointLocation(fe),pe=i.LngLat.convert(l.center||he);this._normalizeCenter(pe);let Q=_.project(he),ue=_.project(pe).sub(Q),ye=l.curve,_e=Math.max(_.width,_.height),Ae=_e/se,Re=ue.mag();if("minZoom"in l){let at=i.clamp(Math.min(l.minZoom,x,z),_.minZoom,_.maxZoom),_t=_e/_.zoomScale(at-x);ye=Math.sqrt(_t/Re*2)}let Me=ye*ye;function Be(at){let _t=(Ae*Ae-_e*_e+(at?-1:1)*Me*Me*Re*Re)/(2*(at?Ae:_e)*Me*Re);return Math.log(Math.sqrt(_t*_t+1)-_t)}function Fe(at){return(Math.exp(at)-Math.exp(-at))/2}function je(at){return(Math.exp(at)+Math.exp(-at))/2}let mt=Be(0),He=function(at){return je(mt)/je(mt+ye*at)},it=function(at){return _e*((je(mt)*(Fe(_t=mt+ye*at)/je(_t))-Fe(mt))/Me)/Re;var _t},Ze=(Be(1)-mt)/ye;if(Math.abs(Re)<1e-6||!isFinite(Ze)){if(Math.abs(_e-Ae)<1e-6)return this.easeTo(l,h);let at=Ae<_e?-1:1;Ze=Math.abs(Math.log(Ae/_e))/ye,it=function(){return 0},He=function(_t){return Math.exp(at*ye*_t)}}l.duration="duration"in l?+l.duration:1e3*Ze/("screenSpeed"in l?+l.screenSpeed/ye:+l.speed),l.maxDuration&&l.duration>l.maxDuration&&(l.duration=0);let ht=D!==G,Ge=H!==k,tt=!_.isPaddingEqual(K),gt=at=>_t=>{let $t=_t*Ze,sn=1/He($t);at.zoom=_t===1?z:x+at.scaleZoom(sn),ht&&(at.bearing=i.number(D,G,_t)),Ge&&(at.pitch=i.number(k,H,_t)),tt&&(at.interpolatePadding(R,K,_t),fe=at.centerPoint.add(le));let Ft=_t===1?pe:at.unproject(Q.add(ue.mult(it($t))).mult(sn));return at.setLocationAtPoint(at.renderWorldCopies?Ft.wrap():Ft,fe),at._updateCameraOnTerrain(),l.preloadOnly||this._fireMoveEvents(h),at};if(l.preloadOnly){let at=this._emulate(gt,l.duration,_);return this._preloadTiles(at),this}return this._zooming=!0,this._rotating=ht,this._pitching=Ge,this._padding=tt,this._prepareEase(h,!1),this._ease(gt(_),()=>this._afterEase(h),l),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(l,h){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){let _=this._onEaseEnd;this._onEaseEnd=void 0,_.call(this,h)}if(!l){let _=this.handlers;_&&_.stop(!1)}return this}_ease(l,h,_){_.animate===!1||_.duration===0?(l(1),h()):(this._easeStart=i.exported.now(),this._easeOptions=_,this._onEaseFrame=l,this._onEaseEnd=h,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){let l=Math.min((i.exported.now()-this._easeStart)/this._easeOptions.duration,1),h=this._onEaseFrame;h&&h(this._easeOptions.easing(l)),l<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(l,h){l=i.wrap(l,-180,180);let _=Math.abs(l-h);return Math.abs(l-360-h)<_&&(l-=360),Math.abs(l+360-h)<_&&(l+=360),l}_normalizeCenter(l){let h=this.transform;if(!h.renderWorldCopies||h.maxBounds)return;let _=l.lng-h.center.lng;l.lng+=_>180?-360:_<-180?360:0}_prefersReducedMotion(l){return this._respectPrefersReducedMotion&&i.exported.prefersReducedMotion&&!(l&&l.essential)}_emulate(l,h,_){let x=Math.ceil(15*h/1e3),D=[],k=l(_.clone());for(let R=0;R<=x;R++){let z=k(R/x);D.push(z.clone())}return D}}class Ot{constructor(l={}){this.options=l,i.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(l){let h=this.options&&this.options.compact;return this._map=l,this._container=oe("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=oe("button","mapboxgl-ctrl-attrib-button",this._container),oe("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=oe("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),h&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),h===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(l,h){let _=this._map._getUIString(`AttributionControl.${h}`);l.setAttribute("aria-label",_),l.removeAttribute("title"),l.firstElementChild&&l.firstElementChild.setAttribute("title",_)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let l=this._editLink;l||(l=this._editLink=this._container.querySelector(".mapbox-improve-map"));let h=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||i.config.ACCESS_TOKEN}];if(l){let _=h.reduce((x,D,k)=>(D.value&&(x+=`${D.key}=${D.value}${k<h.length-1?"&":""}`),x),"?");l.href=`${i.config.FEEDBACK_URL}/${_}#${La(this._map,!0)}`,l.rel="noopener nofollow",this._setElementTitle(l,"MapFeedback")}}_updateData(l){!l||l.sourceDataType!=="metadata"&&l.sourceDataType!=="visibility"&&l.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let l=[];if(this._map.style.stylesheet){let x=this._map.style.stylesheet;this.styleOwner=x.owner,this.styleId=x.id}let h=this._map.style._sourceCaches;for(let x in h){let D=h[x];if(D.used){let k=D.getSource();k.attribution&&l.indexOf(k.attribution)<0&&l.push(k.attribution)}}l.sort((x,D)=>x.length-D.length),l=l.filter((x,D)=>{for(let k=D+1;k<l.length;k++)if(l[k].indexOf(x)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?l=[...this.options.customAttribution,...l]:l.unshift(this.options.customAttribution));let _=l.join(" | ");_!==this._attribHTML&&(this._attribHTML=_,l.length?(this._innerContainer.innerHTML=_,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class Na{constructor(){i.bindAll(["_updateLogo","_updateCompact"],this)}onAdd(l){this._map=l,this._container=oe("div","mapboxgl-ctrl");let h=oe("a","mapboxgl-ctrl-logo");return h.target="_blank",h.rel="noopener nofollow",h.href="https://www.mapbox.com/",h.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),h.setAttribute("rel","noopener nofollow"),this._container.appendChild(h),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(l){l&&l.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;let l=this._map.style._sourceCaches;if(Object.entries(l).length===0)return!0;for(let h in l){let _=l[h].getSource();if(_.hasOwnProperty("mapbox_logo")&&!_.mapbox_logo)return!1}return!0}_updateCompact(){let l=this._container.children;if(l.length){let h=l[0];this._map.getCanvasContainer().offsetWidth<250?h.classList.add("mapboxgl-compact"):h.classList.remove("mapboxgl-compact")}}}class uf{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(l){let h=++this._id;return this._queue.push({callback:l,id:h,cancelled:!1}),h}remove(l){let h=this._currentlyRunning,_=h?this._queue.concat(h):this._queue;for(let x of _)if(x.id===l)return void(x.cancelled=!0)}run(l=0){let h=this._currentlyRunning=this._queue;this._queue=[];for(let _ of h)if(!_.cancelled&&(_.callback(l),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function za(m,l,h){if(m=new i.LngLat(m.lng,m.lat),l){let _=new i.LngLat(m.lng-360,m.lat),x=new i.LngLat(m.lng+360,m.lat),D=360*Math.ceil(Math.abs(m.lng-h.center.lng)/360),k=h.locationPoint(m).distSqr(l),R=l.x<0||l.y<0||l.x>h.width||l.y>h.height;h.locationPoint(_).distSqr(l)<k&&(R||Math.abs(_.lng-h.center.lng)<D)?m=_:h.locationPoint(x).distSqr(l)<k&&(R||Math.abs(x.lng-h.center.lng)<D)&&(m=x)}for(;Math.abs(m.lng-h.center.lng)>180;){let _=h.locationPoint(m);if(_.x>=0&&_.y>=0&&_.x<=h.width&&_.y<=h.height)break;m.lng>h.center.lng?m.lng-=360:m.lng+=360}return m}let kl={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class At extends i.Evented{constructor(l,h){if(super(),(l instanceof i.window.HTMLElement||h)&&(l=i.extend({element:l},h)),i.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=l&&l.anchor||"center",this._color=l&&l.color||"#3FB1CE",this._scale=l&&l.scale||1,this._draggable=l&&l.draggable||!1,this._clickTolerance=l&&l.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=l&&l.rotation||0,this._rotationAlignment=l&&l.rotationAlignment||"auto",this._pitchAlignment=l&&l.pitchAlignment&&l.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=l&&l.occludedOpacity||.2,l&&l.element)this._element=l.element,this._offset=i.Point.convert(l&&l.offset||[0,0]);else{this._defaultMarker=!0,this._element=oe("div");let x=41,D=27,k=Ee("svg",{display:"block",height:x*this._scale+"px",width:D*this._scale+"px",viewBox:`0 0 ${D} ${x}`},this._element),R=Ee("radialGradient",{id:"shadowGradient"},Ee("defs",{},k));Ee("stop",{offset:"10%","stop-opacity":.4},R),Ee("stop",{offset:"100%","stop-opacity":.05},R),Ee("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},k),Ee("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},k),Ee("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},k),Ee("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},k),this._offset=i.Point.convert(l&&l.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",x=>{x.preventDefault()}),this._element.addEventListener("mousedown",x=>{x.preventDefault()});let _=this._element.classList;for(let x in kl)_.remove(`mapboxgl-marker-anchor-${x}`);_.add(`mapboxgl-marker-anchor-${this._anchor}`),this._popup=null}addTo(l){return l===this._map||(this.remove(),this._map=l,l.getCanvasContainer().appendChild(this._element),l.on("move",this._updateMoving),l.on("moveend",this._update),l.on("remove",this._clearFadeTimer),l._addMarker(this),this.setDraggable(this._draggable),this._update(),l.on("click",this._onMapClick)),this}remove(){let l=this._map;return l&&(l.off("click",this._onMapClick),l.off("move",this._updateMoving),l.off("moveend",this._update),l.off("mousedown",this._addDragHandler),l.off("touchstart",this._addDragHandler),l.off("mouseup",this._onUp),l.off("touchend",this._onUp),l.off("mousemove",this._onMove),l.off("touchmove",this._onMove),l.off("remove",this._clearFadeTimer),l._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(l){return this._lngLat=i.LngLat.convert(l),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(l){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),l){if(!("offset"in l.options)){let x=Math.sqrt(Math.pow(13.5,2)/2);l.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[x,-1*(38.1-13.5+x)],"bottom-right":[-x,-1*(38.1-13.5+x)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=l,l._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(l){let h=l.code,_=l.charCode||l.keyCode;h!=="Space"&&h!=="Enter"&&_!==32&&_!==13||this.togglePopup()}_onMapClick(l){let h=l.originalEvent.target,_=this._element;this._popup&&(h===_||_.contains(h))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){let l=this._popup;return l?(l.isOpen()?(l.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(l.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){let l=this._map,h=this._pos;if(!l||!h)return!1;let _=l.unproject(h),x=l.getFreeCameraOptions();if(!x.position)return!1;let D=x.position.toLngLat();return D.distanceTo(_)<.9*D.distanceTo(this._lngLat)}_evaluateOpacity(){let l=this._map;if(!l)return;let h=this._pos;if(!h||h.x<0||h.x>l.transform.width||h.y<0||h.y>l.transform.height)return void this._clearFadeTimer();let _=l.unproject(h),x;l._showingGlobe()&&i.isLngLatBehindGlobe(l.transform,this._lngLat)?x=0:(x=1-l._queryFogOpacity(_),l.transform._terrainEnabled()&&l.getTerrain()&&this._behindTerrain()&&(x*=this._occludedOpacity)),this._element.style.opacity=`${x}`,this._element.style.pointerEvents=x>0?"auto":"none",this._popup&&this._popup._setOpacity(x),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){let l=this._pos;if(!l||!this._map)return;let h=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${l.x}px,${l.y}px)
            ${kl[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${h.x}px,${h.y}px)
        `}_calculateXYTransform(){let l=this._pos,h=this._map,_=this.getPitchAlignment();if(!h||!l||_!=="map")return"";if(!h._showingGlobe()){let z=h.getPitch();return z?`rotateX(${z}deg)`:""}let x=i.radToDeg(i.globeTiltAtLngLat(h.transform,this._lngLat)),D=l.sub(i.globeCenterToScreenPoint(h.transform)),k=Math.abs(D.x)+Math.abs(D.y);if(k===0)return"";let R=x/k;return`rotateX(${-D.y*R}deg) rotateY(${D.x*R}deg)`}_calculateZTransform(){let l=this._pos,h=this._map;if(!h||!l)return"";let _=0,x=this.getRotationAlignment();if(x==="map")if(h._showingGlobe()){let D=h.project(new i.LngLat(this._lngLat.lng,this._lngLat.lat+.001)),k=h.project(new i.LngLat(this._lngLat.lng,this._lngLat.lat-.001)).sub(D);_=i.radToDeg(Math.atan2(k.y,k.x))-90}else _=-h.getBearing();else if(x==="horizon"){let D=i.smoothstep(4,6,h.getZoom()),k=i.globeCenterToScreenPoint(h.transform);k.y+=D*h.transform.height;let R=l.sub(k),z=i.radToDeg(Math.atan2(R.y,R.x));_=(z>90?z-270:z+90)*(1-D)}return _+=this._rotation,_?`rotateZ(${_}deg)`:""}_update(l){i.window.cancelAnimationFrame(this._updateFrameId);let h=this._map;h&&(h.transform.renderWorldCopies&&(this._lngLat=za(this._lngLat,this._pos,h.transform)),this._pos=h.project(this._lngLat),l===!0?this._updateFrameId=i.window.requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),h._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(h._showingGlobe()||h.getTerrain()||h.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(l){return this._offset=i.Point.convert(l),this._update(),this}_onMove(l){let h=this._map;if(!h)return;let _=this._pointerdownPos,x=this._positionDelta;if(_&&x){if(!this._isDragging){let D=this._clickTolerance||h._clickTolerance;if(l.point.dist(_)<D)return;this._isDragging=!0}this._pos=l.point.sub(x),this._lngLat=h.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new i.Event("dragstart"))),this.fire(new i.Event("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;let l=this._map;l&&(l.off("mousemove",this._onMove),l.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new i.Event("dragend")),this._state="inactive"}_addDragHandler(l){let h=this._map,_=this._pos;h&&_&&this._element.contains(l.originalEvent.target)&&(l.preventDefault(),this._positionDelta=l.point.sub(_),this._pointerdownPos=l.point,this._state="pending",h.on("mousemove",this._onMove),h.on("touchmove",this._onMove),h.once("mouseup",this._onUp),h.once("touchend",this._onUp))}setDraggable(l){this._draggable=!!l;let h=this._map;return h&&(l?(h.on("mousedown",this._addDragHandler),h.on("touchstart",this._addDragHandler)):(h.off("mousedown",this._addDragHandler),h.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(l){return this._rotation=l||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(l){return this._rotationAlignment=l||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(l){return this._pitchAlignment=l||"auto",this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(l){return this._occludedOpacity=l||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}let Wd={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},ay=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Gp(m=new i.Point(0,0),l="bottom"){if(typeof m=="number"){let h=Math.round(Math.sqrt(.5*Math.pow(m,2)));switch(l){case"top":return new i.Point(0,m);case"top-left":return new i.Point(h,h);case"top-right":return new i.Point(-h,h);case"bottom":return new i.Point(0,-m);case"bottom-left":return new i.Point(h,-h);case"bottom-right":return new i.Point(-h,-h);case"left":return new i.Point(m,0);case"right":return new i.Point(-m,0)}return new i.Point(0,0)}return m instanceof i.Point||Array.isArray(m)?i.Point.convert(m):i.Point.convert(m[l]||[0,0])}class df{constructor(l){this.jumpTo(l)}getValue(l){if(l<=this._startTime)return this._start;if(l>=this._endTime)return this._end;let h=i.easeCubicInOut((l-this._startTime)/(this._endTime-this._startTime));return this._start*(1-h)+this._end*h}isEasing(l){return l>=this._startTime&&l<=this._endTime}jumpTo(l){this._startTime=-1/0,this._endTime=-1/0,this._start=l,this._end=l}easeTo(l,h,_){this._start=this.getValue(h),this._end=l,this._startTime=h,this._endTime=h+_}}let Wp={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use \u2318 + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},qp={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0},ly={showCompass:!0,showZoom:!0,visualizePitch:!1};class qd{constructor(l,h,_=!1){this._clickTolerance=10,this.element=h,this.mouseRotate=new tf({clickTolerance:l.dragRotate._mouseRotate._clickTolerance}),this.map=l,_&&(this.mousePitch=new nf({clickTolerance:l.dragRotate._mousePitch._clickTolerance})),i.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),h.addEventListener("mousedown",this.mousedown),h.addEventListener("touchstart",this.touchstart,{passive:!1}),h.addEventListener("touchmove",this.touchmove),h.addEventListener("touchend",this.touchend),h.addEventListener("touchcancel",this.reset)}down(l,h){this.mouseRotate.mousedown(l,h),this.mousePitch&&this.mousePitch.mousedown(l,h),bt()}move(l,h){let _=this.map,x=this.mouseRotate.mousemoveWindow(l,h),D=x&&x.bearingDelta;if(D&&_.setBearing(_.getBearing()+D),this.mousePitch){let k=this.mousePitch.mousemoveWindow(l,h),R=k&&k.pitchDelta;R&&_.setPitch(_.getPitch()+R)}}off(){let l=this.element;l.removeEventListener("mousedown",this.mousedown),l.removeEventListener("touchstart",this.touchstart,{passive:!1}),l.removeEventListener("touchmove",this.touchmove),l.removeEventListener("touchend",this.touchend),l.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){Ut(),i.window.removeEventListener("mousemove",this.mousemove),i.window.removeEventListener("mouseup",this.mouseup)}mousedown(l){this.down(i.extend({},l,{ctrlKey:!0,preventDefault:()=>l.preventDefault()}),Gn(this.element,l)),i.window.addEventListener("mousemove",this.mousemove),i.window.addEventListener("mouseup",this.mouseup)}mousemove(l){this.move(l,Gn(this.element,l))}mouseup(l){this.mouseRotate.mouseupWindow(l),this.mousePitch&&this.mousePitch.mouseupWindow(l),this.offTemp()}touchstart(l){l.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=Ro(this.element,l.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>l.preventDefault()},this._startPos))}touchmove(l){l.targetTouches.length!==1?this.reset():(this._lastPos=Ro(this.element,l.targetTouches)[0],this.move({preventDefault:()=>l.preventDefault()},this._lastPos))}touchend(l){l.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}let ku={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},hf={maxWidth:100,unit:"metric"},ff={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},Dc={version:i.version,supported:L,setRTLTextPlugin:i.setRTLTextPlugin,getRTLTextPluginStatus:i.getRTLTextPluginStatus,Map:class extends Ec{constructor(m){if(i.LivePerformanceUtils.mark(i.PerformanceMarkers.create),(m=i.extend({},qp,m)).minZoom!=null&&m.maxZoom!=null&&m.minZoom>m.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(m.minPitch!=null&&m.maxPitch!=null&&m.minPitch>m.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(m.minPitch!=null&&m.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(m.maxPitch!=null&&m.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(m.antialias&&i.isSafariWithAntialiasingBug(i.window)&&(m.antialias=!1,i.warnOnce("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new Tl(m.minZoom,m.maxZoom,m.minPitch,m.maxPitch,m.renderWorldCopies),m),this._interactive=m.interactive,this._minTileCacheSize=m.minTileCacheSize,this._maxTileCacheSize=m.maxTileCacheSize,this._failIfMajorPerformanceCaveat=m.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=m.preserveDrawingBuffer,this._antialias=m.antialias,this._useWebGL2=m.useWebGL2,this._trackResize=m.trackResize,this._bearingSnap=m.bearingSnap,this._refreshExpiredTiles=m.refreshExpiredTiles,this._fadeDuration=m.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=m.crossSourceCollisions,this._collectResourceTiming=m.collectResourceTiming,this._optimizeForTerrain=m.optimizeForTerrain,this._language=this._parseLanguage(m.language),this._worldview=m.worldview,this._renderTaskQueue=new uf,this._domRenderTaskQueue=new uf,this._controls=[],this._markers=[],this._popups=[],this._mapId=i.uniqueId(),this._locale=i.extend({},Wp,m.locale),this._clickTolerance=m.clickTolerance,this._cooperativeGestures=m.cooperativeGestures,this._performanceMetricsCollection=m.performanceMetricsCollection,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new df(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._requestManager=new i.RequestManager(m.transformRequest,m.accessToken,m.testMode),this._silenceAuthErrors=!!m.testMode,typeof m.container=="string"){if(this._container=i.window.document.getElementById(m.container),!this._container)throw new Error(`Container '${m.container}' not found.`)}else{if(!(m.container instanceof i.window.HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=m.container}if(this._container.childNodes.length>0&&i.warnOnce("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),m.maxBounds&&this.setMaxBounds(m.maxBounds),i.bindAll(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),i.window!==void 0&&(i.window.addEventListener("online",this._onWindowOnline,!1),i.window.addEventListener("resize",this._onWindowResize,!1),i.window.addEventListener("orientationchange",this._onWindowResize,!1),i.window.addEventListener("webkitfullscreenchange",this._onWindowResize,!1),i.window.addEventListener("visibilitychange",this._onVisibilityChange,!1)),this.handlers=new Es(this,m),this._localFontFamily=m.localFontFamily,this._localIdeographFontFamily=m.localIdeographFontFamily,m.style&&this.setStyle(m.style,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),m.projection&&this.setProjection(m.projection),this._hash=m.hash&&new $d(typeof m.hash=="string"&&m.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:m.center,zoom:m.zoom,bearing:m.bearing,pitch:m.pitch}),m.bounds&&(this.resize(),this.fitBounds(m.bounds,i.extend({},m.fitBoundsOptions,{duration:0})))),this.resize(),m.attributionControl&&this.addControl(new Ot({customAttribution:m.customAttribution})),this._logoControl=new Na,this.addControl(this._logoControl,m.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",l=>{this._update(l.dataType==="style"),this.fire(new i.Event(`${l.dataType}data`,l))}),this.on("dataloading",l=>{this.fire(new i.Event(`${l.dataType}dataloading`,l))})}_getMapId(){return this._mapId}addControl(m,l){if(l===void 0&&(l=m.getDefaultPosition?m.getDefaultPosition():"top-right"),!m||!m.onAdd)return this.fire(new i.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));let h=m.onAdd(this);this._controls.push(m);let _=this._controlPositions[l];return l.indexOf("bottom")!==-1?_.insertBefore(h,_.firstChild):_.appendChild(h),this}removeControl(m){if(!m||!m.onRemove)return this.fire(new i.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));let l=this._controls.indexOf(m);return l>-1&&this._controls.splice(l,1),m.onRemove(this),this}hasControl(m){return this._controls.indexOf(m)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(m){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));let l=!this._moving;return l&&this.fire(new i.Event("movestart",m)).fire(new i.Event("move",m)),this.fire(new i.Event("resize",m)),l&&this.fire(new i.Event("moveend",m)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(m){return this.transform.setMaxBounds(i.LngLatBounds.convert(m)),this._update()}setMinZoom(m){if((m=m??-2)>=-2&&m<=this.transform.maxZoom)return this.transform.minZoom=m,this._update(),this.getZoom()<m?this.setZoom(m):this.fire(new i.Event("zoomstart")).fire(new i.Event("zoom")).fire(new i.Event("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(m){if((m=m??22)>=this.transform.minZoom)return this.transform.maxZoom=m,this._update(),this.getZoom()>m?this.setZoom(m):this.fire(new i.Event("zoomstart")).fire(new i.Event("zoom")).fire(new i.Event("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(m){if((m=m??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(m>=0&&m<=this.transform.maxPitch)return this.transform.minPitch=m,this._update(),this.getPitch()<m?this.setPitch(m):this.fire(new i.Event("pitchstart")).fire(new i.Event("pitch")).fire(new i.Event("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(m){if((m=m??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(m>=this.transform.minPitch)return this.transform.maxPitch=m,this._update(),this.getPitch()>m?this.setPitch(m):this.fire(new i.Event("pitchstart")).fire(new i.Event("pitch")).fire(new i.Event("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(m){return this.transform.renderWorldCopies=m,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(m){return m==="auto"?i.window.navigator.language:Array.isArray(m)?m.length===0?void 0:m.map(l=>l==="auto"?i.window.navigator.language:l):m}setLanguage(m){let l=this._parseLanguage(m);if(!this.style||l===this._language)return this;this._language=l,this.style._reloadSources();for(let h of this._controls)h._setLanguage&&h._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(m){return this.style&&m!==this._worldview?(this._worldview=m,this.style._reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(m){return this._lazyInitEmptyStyle(),m?typeof m=="string"&&(m={name:m}):m=null,this._useExplicitProjection=!!m,this._prioritizeAndUpdateProjection(m,this.style.stylesheet?this.style.stylesheet.projection:null)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;let m=this.transform,l=m.projection.name,h;l==="globe"&&m.zoom>=i.GLOBE_ZOOM_THRESHOLD_MAX?(m.setMercatorFromTransition(),h=!0):l==="mercator"&&m.zoom<i.GLOBE_ZOOM_THRESHOLD_MAX&&(m.setProjection({name:"globe"}),h=!0),h&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(m,l){return this._updateProjection(m||l||{name:"mercator"})}_updateProjection(m){let l;if(l=m.name==="globe"&&this.transform.zoom>=i.GLOBE_ZOOM_THRESHOLD_MAX?this.transform.setMercatorFromTransition():this.transform.setProjection(m),this.style.applyProjectionUpdate(),l){this.painter.clearBackgroundTiles();for(let h in this.style._sourceCaches)this.style._sourceCaches[h].clearTiles();this._update(!0),this._forceMarkerAndPopupUpdate(!0)}return this}project(m){return this.transform.locationPoint3D(i.LngLat.convert(m))}unproject(m){return this.transform.pointLocation3D(i.Point.convert(m))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(m,l,h){if(m==="mouseenter"||m==="mouseover"){let _=!1,x=k=>{let R=l.filter(G=>this.getLayer(G)),z=R.length?this.queryRenderedFeatures(k.point,{layers:R}):[];z.length?_||(_=!0,h.call(this,new _r(m,this,k.originalEvent,{features:z}))):_=!1},D=()=>{_=!1};return{layers:new Set(l),listener:h,delegates:{mousemove:x,mouseout:D}}}if(m==="mouseleave"||m==="mouseout"){let _=!1,x=k=>{let R=l.filter(z=>this.getLayer(z));(R.length?this.queryRenderedFeatures(k.point,{layers:R}):[]).length?_=!0:_&&(_=!1,h.call(this,new _r(m,this,k.originalEvent)))},D=k=>{_&&(_=!1,h.call(this,new _r(m,this,k.originalEvent)))};return{layers:new Set(l),listener:h,delegates:{mousemove:x,mouseout:D}}}{let _=x=>{let D=l.filter(R=>this.getLayer(R)),k=D.length?this.queryRenderedFeatures(x.point,{layers:D}):[];k.length&&(x.features=k,h.call(this,x),delete x.features)};return{layers:new Set(l),listener:h,delegates:{[m]:_}}}}on(m,l,h){if(h===void 0)return super.on(m,l);Array.isArray(l)||(l=[l]);let _=this._createDelegatedListener(m,l,h);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[m]=this._delegatedListeners[m]||[],this._delegatedListeners[m].push(_);for(let x in _.delegates)this.on(x,_.delegates[x]);return this}once(m,l,h){if(h===void 0)return super.once(m,l);Array.isArray(l)||(l=[l]);let _=this._createDelegatedListener(m,l,h);for(let x in _.delegates)this.once(x,_.delegates[x]);return this}off(m,l,h){if(h===void 0)return super.off(m,l);l=new Set(Array.isArray(l)?l:[l]);let _=(D,k)=>{if(D.size!==k.size)return!1;for(let R of D)if(!k.has(R))return!1;return!0},x=this._delegatedListeners?this._delegatedListeners[m]:void 0;return x&&(D=>{for(let k=0;k<D.length;k++){let R=D[k];if(R.listener===h&&_(R.layers,l)){for(let z in R.delegates)this.off(z,R.delegates[z]);return D.splice(k,1),this}}})(x),this}queryRenderedFeatures(m,l){return this.style?(l!==void 0||m===void 0||m instanceof i.Point||Array.isArray(m)||(l=m,m=void 0),this.style.queryRenderedFeatures(m=m||[[0,0],[this.transform.width,this.transform.height]],l=l||{},this.transform)):[]}querySourceFeatures(m,l){return this.style.querySourceFeatures(m,l)}isPointOnSurface(m){let{name:l}=this.transform.projection;return l!=="globe"&&l!=="mercator"&&i.warnOnce(`${l} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(i.Point.convert(m))}setStyle(m,l){return(l=i.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},l)).diff!==!1&&l.localIdeographFontFamily===this._localIdeographFontFamily&&l.localFontFamily===this._localFontFamily&&this.style&&m?(this._diffStyle(m,l),this):(this._localIdeographFontFamily=l.localIdeographFontFamily,this._localFontFamily=l.localFontFamily,this._updateStyle(m,l))}_getUIString(m){let l=this._locale[m];if(l==null)throw new Error(`Missing UI string '${m}'`);return l}_updateStyle(m,l){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),m&&(this.style=new bs(this,l||{}),this.style.setEventedParent(this,{style:this.style}),typeof m=="string"?this.style.loadURL(m):this.style.loadJSON(m)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new bs(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(m,l){if(typeof m=="string"){let h=this._requestManager.normalizeStyleURL(m),_=this._requestManager.transformRequest(h,i.ResourceType.Style);i.getJSON(_,(x,D)=>{x?this.fire(new i.ErrorEvent(x)):D&&this._updateDiff(D,l)})}else typeof m=="object"&&this._updateDiff(m,l)}_updateDiff(m,l){try{this.style.setState(m)&&this._update(!0)}catch(h){i.warnOnce(`Unable to perform style diff: ${h.message||h.error||h}.  Rebuilding the style from scratch.`),this._updateStyle(m,l)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(i.warnOnce("There is no style added to the map."),!1)}addSource(m,l){return this._lazyInitEmptyStyle(),this.style.addSource(m,l),this._update(!0)}isSourceLoaded(m){return!!this.style&&this.style._isSourceCacheLoaded(m)}areTilesLoaded(){let m=this.style&&this.style._sourceCaches;for(let l in m){let h=m[l]._tiles;for(let _ in h){let x=h[_];if(x.state!=="loaded"&&x.state!=="errored")return!1}}return!0}addSourceType(m,l,h){this._lazyInitEmptyStyle(),this.style.addSourceType(m,l,h)}removeSource(m){return this.style.removeSource(m),this._updateTerrain(),this._update(!0)}getSource(m){return this.style.getSource(m)}addImage(m,l,{pixelRatio:h=1,sdf:_=!1,stretchX:x,stretchY:D,content:k}={}){if(this._lazyInitEmptyStyle(),l instanceof i.window.HTMLImageElement||i.window.ImageBitmap&&l instanceof i.window.ImageBitmap){let{width:R,height:z,data:G}=i.exported.getImageData(l);this.style.addImage(m,{data:new i.RGBAImage({width:R,height:z},G),pixelRatio:h,stretchX:x,stretchY:D,content:k,sdf:_,version:0})}else if(l.width===void 0||l.height===void 0)this.fire(new i.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{let{width:R,height:z}=l,G=l;this.style.addImage(m,{data:new i.RGBAImage({width:R,height:z},new Uint8Array(G.data)),pixelRatio:h,stretchX:x,stretchY:D,content:k,sdf:_,version:0,userImage:G}),G.onAdd&&G.onAdd(this,m)}}updateImage(m,l){let h=this.style.getImage(m);if(!h)return void this.fire(new i.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));let _=l instanceof i.window.HTMLImageElement||i.window.ImageBitmap&&l instanceof i.window.ImageBitmap?i.exported.getImageData(l):l,{width:x,height:D}=_;x!==void 0&&D!==void 0?x===h.data.width&&D===h.data.height?(h.data.replace(_.data,!(l instanceof i.window.HTMLImageElement||i.window.ImageBitmap&&l instanceof i.window.ImageBitmap)),this.style.updateImage(m,h)):this.fire(new i.ErrorEvent(new Error(`The width and height of the updated image (${x}, ${D})
                must be that same as the previous version of the image
                (${h.data.width}, ${h.data.height})`))):this.fire(new i.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")))}hasImage(m){return m?!!this.style.getImage(m):(this.fire(new i.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(m){this.style.removeImage(m)}loadImage(m,l){i.getImage(this._requestManager.transformRequest(m,i.ResourceType.Image),(h,_)=>{l(h,_ instanceof i.window.HTMLImageElement?i.exported.getImageData(_):_)})}listImages(){return this.style.listImages()}addLayer(m,l){return this._lazyInitEmptyStyle(),this.style.addLayer(m,l),this._update(!0)}moveLayer(m,l){return this.style.moveLayer(m,l),this._update(!0)}removeLayer(m){return this.style.removeLayer(m),this._update(!0)}getLayer(m){return this.style.getLayer(m)}setLayerZoomRange(m,l,h){return this.style.setLayerZoomRange(m,l,h),this._update(!0)}setFilter(m,l,h={}){return this.style.setFilter(m,l,h),this._update(!0)}getFilter(m){return this.style.getFilter(m)}setPaintProperty(m,l,h,_={}){return this.style.setPaintProperty(m,l,h,_),this._update(!0)}getPaintProperty(m,l){return this.style.getPaintProperty(m,l)}setLayoutProperty(m,l,h,_={}){return this.style.setLayoutProperty(m,l,h,_),this._update(!0)}getLayoutProperty(m,l){return this.style.getLayoutProperty(m,l)}setLight(m,l={}){return this._lazyInitEmptyStyle(),this.style.setLight(m,l),this._update(!0)}getLight(){return this.style.getLight()}setTerrain(m){return this._lazyInitEmptyStyle(),!m&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(m),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(m){return this._lazyInitEmptyStyle(),this.style.setFog(m),this._update(!0)}getFog(){return this.style?this.style.getFog():null}_queryFogOpacity(m){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(i.LngLat.convert(m),this.transform):0}setFeatureState(m,l){return this.style.setFeatureState(m,l),this._update()}removeFeatureState(m,l){return this.style.removeFeatureState(m,l),this._update()}getFeatureState(m){return this.style.getFeatureState(m)}_updateContainerDimensions(){if(!this._container)return;let m=this._container.getBoundingClientRect().width||400,l=this._container.getBoundingClientRect().height||300,h,_,x,D=this._container;for(;D&&(!_||!x);){let k=i.window.getComputedStyle(D).transform;k&&k!=="none"&&(h=k.match(/matrix.*\((.+)\)/)[1].split(", "),h[0]&&h[0]!=="0"&&h[0]!=="1"&&(_=h[0]),h[3]&&h[3]!=="0"&&h[3]!=="1"&&(x=h[3])),D=D.parentElement}this._containerWidth=_?Math.abs(m/_):m,this._containerHeight=x?Math.abs(l/x):l}_detectMissingCSS(){i.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&i.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){let m=this._container;m.classList.add("mapboxgl-map"),(this._missingCSSCanary=oe("div","mapboxgl-canary",m)).style.visibility="hidden",this._detectMissingCSS();let l=this._canvasContainer=oe("div","mapboxgl-canvas-container",m);this._interactive&&l.classList.add("mapboxgl-interactive"),this._canvas=oe("canvas","mapboxgl-canvas",l),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);let h=this._controlContainer=oe("div","mapboxgl-control-container",m),_=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(x=>{_[x]=oe("div",`mapboxgl-ctrl-${x}`,h)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(m,l){let h=i.exported.devicePixelRatio||1;this._canvas.width=h*Math.ceil(m),this._canvas.height=h*Math.ceil(l),this._canvas.style.width=`${m}px`,this._canvas.style.height=`${l}px`}_addMarker(m){this._markers.push(m)}_removeMarker(m){let l=this._markers.indexOf(m);l!==-1&&this._markers.splice(l,1)}_addPopup(m){this._popups.push(m)}_removePopup(m){let l=this._popups.indexOf(m);l!==-1&&this._popups.splice(l,1)}_setupPainter(){let m=i.extend({},L.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),l=this._useWebGL2&&this._canvas.getContext("webgl2",m),h=l||this._canvas.getContext("webgl",m)||this._canvas.getContext("experimental-webgl",m);h?(this._useWebGL2&&!l&&i.warnOnce("Failed to create WebGL 2 context. Using WebGL 1."),i.storeAuthState(h,!0),this.painter=new _c(h,this.transform,!!l),this.on("data",_=>{_.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),i.exported$1.testSupport(h)):this.fire(new i.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(m){m.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new i.Event("webglcontextlost",{originalEvent:m}))}_contextRestored(m){this._setupPainter(),this.resize(),this._update(),this.fire(new i.Event("webglcontextrestored",{originalEvent:m}))}_onMapScroll(m){if(m.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(m){return this.style?(this._styleDirty=this._styleDirty||m,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(m){return this._update(),this._renderTaskQueue.add(m)}_cancelRenderFrame(m){this._renderTaskQueue.remove(m)}_requestDomTask(m){!this.loaded()||this.loaded()&&!this.isMoving()?m():this._domRenderTaskQueue.add(m)}_render(m){let l,h=this.painter.context.extTimerQuery,_=i.exported.now();if(this.listens("gpu-timing-frame")&&(l=h.createQueryEXT(),h.beginQueryEXT(h.TIME_ELAPSED_EXT,l)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],i.window.performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],i.window.performance.now())),this._renderTaskQueue.run(m),this._domRenderTaskQueue.run(m),this._removed)return;this._updateProjectionTransition();let x=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;let R=this.transform.zoom,z=this.transform.pitch,G=i.exported.now(),H=new i.EvaluationParameters(R,{now:G,fadeDuration:x,pitch:z,transition:this.style.getTransition()});this.style.update(H)}this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let D=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),D=this._updateAverageElevation(_),this.style._updateSources(this.transform),this._forceMarkerAndPopupUpdate()):D=this._updateAverageElevation(_),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,x,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:x,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new i.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new i.Event("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),l){let R=i.exported.now()-_;h.endQueryEXT(h.TIME_ELAPSED_EXT,l),setTimeout(()=>{let z=h.getQueryObjectEXT(l,h.QUERY_RESULT_EXT)/1e6;h.deleteQueryEXT(l),this.fire(new i.Event("gpu-timing-frame",{cpuTime:R,gpuTime:z})),i.window.performance.mark("frame-gpu",{startTime:_,detail:{gpuTime:z}})},50)}if(this.listens("gpu-timing-layer")){let R=this.painter.collectGpuTimers();setTimeout(()=>{let z=this.painter.queryGpuTimers(R);this.fire(new i.Event("gpu-timing-layer",{layerTimes:z}))},50)}if(this.listens("gpu-timing-deferred-render")){let R=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{let z=this.painter.queryGpuTimeDeferredRender(R);this.fire(new i.Event("gpu-timing-deferred-render",{gpuTime:z}))},50)}let k=this._sourcesDirty||this._styleDirty||this._placementDirty||D;if(k||this._repaint)this.triggerRepaint();else{let R=!this.isMoving()&&this.loaded();if(R&&(D=this._updateAverageElevation(_,!0)),D)this.triggerRepaint();else if(this._triggerFrame(!1),R&&(this.fire(new i.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){let z=this._calculateSpeedIndex();this.fire(new i.Event("speedindexcompleted",{speedIndex:z})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||k||(this._fullyLoaded=!0,i.LivePerformanceUtils.mark(i.PerformanceMarkers.fullLoad),this._performanceMetricsCollection&&i.postPerformanceEvent(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(m){for(let l of this._markers)m&&!this.getRenderWorldCopies()&&(l._lngLat=l._lngLat.wrap()),l._update();for(let l of this._popups)!m||this.getRenderWorldCopies()||l._trackPointer||(l._lngLat=l._lngLat.wrap()),l._update()}_updateAverageElevation(m,l=!1){let h=_=>(this.transform.averageElevation=_,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&h(0);if((l||m-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(m)){let _=this.transform.averageElevation,x=this.transform.sampleAverageElevation(),D=!1;this.transform.elevation&&(D=this.transform.elevation.exaggeration()!==this._averageElevationExaggeration,this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(x)?x=0:this._averageElevationLastSampledAt=m;let k=Math.abs(_-x);if(k>1){if(this._isInitialLoad||D)return this._averageElevation.jumpTo(x),h(x);this._averageElevation.easeTo(x,m,300)}else if(k>1e-4)return this._averageElevation.jumpTo(x),h(x)}return!!this._averageElevation.isEasing(m)&&h(this._averageElevation.getValue(m))}_authenticate(){i.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,m=>{if(m&&(m.message===i.AUTH_ERR_MSG||m.status===401)){let l=this.painter.context.gl;i.storeAuthState(l,!1),this._logoControl instanceof Na&&this._logoControl._updateLogo(),l&&l.clear(l.DEPTH_BUFFER_BIT|l.COLOR_BUFFER_BIT|l.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new i.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),i.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){let m=this._isDragging();this.painter.updateTerrain(this.style,m)}_calculateSpeedIndex(){let m=this.painter.canvasCopy(),l=this.painter.getCanvasCopiesAndTimestamps();l.timeStamps.push(performance.now());let h=this.painter.context.gl,_=h.createFramebuffer();function x(D){h.framebufferTexture2D(h.FRAMEBUFFER,h.COLOR_ATTACHMENT0,h.TEXTURE_2D,D,0);let k=new Uint8Array(h.drawingBufferWidth*h.drawingBufferHeight*4);return h.readPixels(0,0,h.drawingBufferWidth,h.drawingBufferHeight,h.RGBA,h.UNSIGNED_BYTE,k),k}return h.bindFramebuffer(h.FRAMEBUFFER,_),this._canvasPixelComparison(x(m),l.canvasCopies.map(x),l.timeStamps)}_canvasPixelComparison(m,l,h){let _=h[1]-h[0],x=m.length/4;for(let D=0;D<l.length;D++){let k=l[D],R=0;for(let z=0;z<k.length;z+=4)k[z]===m[z]&&k[z+1]===m[z+1]&&k[z+2]===m[z+2]&&k[z+3]===m[z+3]&&(R+=1);_+=(h[D+2]-h[D+1])*(1-R/x)}return _}remove(){this._hash&&this._hash.remove();for(let l of this._controls)l.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),i.window!==void 0&&(i.window.removeEventListener("resize",this._onWindowResize,!1),i.window.removeEventListener("orientationchange",this._onWindowResize,!1),i.window.removeEventListener("webkitfullscreenchange",this._onWindowResize,!1),i.window.removeEventListener("online",this._onWindowOnline,!1),i.window.removeEventListener("visibilitychange",this._onVisibilityChange,!1));let m=this.painter.context.gl.getExtension("WEBGL_lose_context");m&&m.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),i.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new i.Event("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(m){this._renderNextFrame=this._renderNextFrame||m,this.style&&!this._frame&&(this._frame=i.exported.frame(l=>{let h=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,h&&this._render(l)}))}_preloadTiles(m){let l=this.style?Object.values(this.style._sourceCaches):[];return i.asyncAll(l,(h,_)=>h._preloadTiles(m,_),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(m){this._trackResize&&this.resize({originalEvent:m})._update()}_onVisibilityChange(){i.window.document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(m){this._showTileBoundaries!==m&&(this._showTileBoundaries=m,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(m){this._showTerrainWireframe!==m&&(this._showTerrainWireframe=m,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(m){this._speedIndexTiming!==m&&(this._speedIndexTiming=m,this._update())}get showPadding(){return!!this._showPadding}set showPadding(m){this._showPadding!==m&&(this._showPadding=m,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(m){this._showCollisionBoxes!==m&&(this._showCollisionBoxes=m,m?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(m){this._showOverdrawInspector!==m&&(this._showOverdrawInspector=m,this._update())}get repaint(){return!!this._repaint}set repaint(m){this._repaint!==m&&(this._repaint=m,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(m){this._vertices=m,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(m){this._showTileAABBs!==m&&(this._showTileAABBs=m,m&&this._update())}_setCacheLimits(m,l){i.setCacheLimits(m,l)}get version(){return i.version}},NavigationControl:class{constructor(m){this.options=i.extend({},ly,m),this._container=oe("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",l=>l.preventDefault()),this.options.showZoom&&(i.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",l=>{this._map&&this._map.zoomIn({},{originalEvent:l})}),oe("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",l=>{this._map&&this._map.zoomOut({},{originalEvent:l})}),oe("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(i.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",l=>{let h=this._map;h&&(this.options.visualizePitch?h.resetNorthPitch({},{originalEvent:l}):h.resetNorth({},{originalEvent:l}))}),this._compassIcon=oe("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){let m=this._map;if(!m)return;let l=m.getZoom(),h=l===m.getMaxZoom(),_=l===m.getMinZoom();this._zoomInButton.disabled=h,this._zoomOutButton.disabled=_,this._zoomInButton.setAttribute("aria-disabled",h.toString()),this._zoomOutButton.setAttribute("aria-disabled",_.toString())}_rotateCompassArrow(){let m=this._map;if(!m)return;let l=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(m.transform.pitch*(Math.PI/180)),.5)}) rotateX(${m.transform.pitch}deg) rotateZ(${m.transform.angle*(180/Math.PI)}deg)`:`rotate(${m.transform.angle*(180/Math.PI)}deg)`;m._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=l)})}onAdd(m){return this._map=m,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),m.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&m.on("pitch",this._rotateCompassArrow),m.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new qd(m,this._compass,this.options.visualizePitch)),this._container}onRemove(){let m=this._map;m&&(this._container.remove(),this.options.showZoom&&m.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&m.off("pitch",this._rotateCompassArrow),m.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(m,l){let h=oe("button",m,this._container);return h.type="button",h.addEventListener("click",l),h}_setButtonTitle(m,l){if(!this._map)return;let h=this._map._getUIString(`NavigationControl.${l}`);m.setAttribute("aria-label",h),m.firstElementChild&&m.firstElementChild.setAttribute("title",h)}},GeolocateControl:class extends i.Evented{constructor(m){super(),this.options=i.extend({geolocation:i.window.navigator.geolocation},ku,m),i.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=Kt(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(m){return this._map=m,this._container=oe("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(m){let l=(h=!!this.options.geolocation)=>{this._supportsGeolocation=h,m(h)};this._supportsGeolocation!==void 0?m(this._supportsGeolocation):i.window.navigator.permissions!==void 0?i.window.navigator.permissions.query({name:"geolocation"}).then(h=>l(h.state!=="denied")).catch(()=>l()):l()}_isOutOfMapMaxBounds(m){let l=this._map.getMaxBounds(),h=m.coords;return!!l&&(h.longitude<l.getWest()||h.longitude>l.getEast()||h.latitude<l.getSouth()||h.latitude>l.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(m){if(this._map){if(this._isOutOfMapMaxBounds(m))return this._setErrorState(),this.fire(new i.Event("outofmaxbounds",m)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=m,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(m),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(m),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new i.Event("geolocate",m)),this._finish()}}_updateCamera(m){let l=new i.LngLat(m.coords.longitude,m.coords.latitude),h=m.coords.accuracy,_=this._map.getBearing(),x=i.extend({bearing:_},this.options.fitBoundsOptions);this._map.fitBounds(l.toBounds(h),x,{geolocateSource:!0})}_updateMarker(m){if(m){let l=new i.LngLat(m.coords.longitude,m.coords.latitude);this._accuracyCircleMarker.setLngLat(l).addTo(this._map),this._userLocationDotMarker.setLngLat(l).addTo(this._map),this._accuracy=m.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){let m=this._map.transform,l=i.mercatorZfromAltitude(1,m._center.lat)*m.worldSize,h=Math.ceil(2*this._accuracy*l);this._circleElement.style.width=`${h}px`,this._circleElement.style.height=`${h}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._dotElement.classList.add("mapboxgl-user-location-show-heading")):(this._dotElement.classList.remove("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(m){if(this._map){if(this.options.trackUserLocation)if(m.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;let l=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",l),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",l),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(m.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new i.Event("error",m)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(m){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",l=>l.preventDefault()),this._geolocateButton=oe("button","mapboxgl-ctrl-geolocate",this._container),oe("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",m===!1){i.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");let l=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",l),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",l)}else{let l=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",l),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",l)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=oe("div","mapboxgl-user-location"),this._dotElement.appendChild(oe("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(oe("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new At({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=oe("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new At({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",l=>{l.geolocateSource||this._watchState!=="ACTIVE_LOCK"||l.originalEvent&&l.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new i.Event("trackuserlocationend")))})}}_onDeviceOrientation(m){this._userLocationDotMarker&&(m.webkitCompassHeading?this._heading=m.webkitCompassHeading:m.absolute===!0&&(this._heading=-1*m.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return i.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new i.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new i.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new i.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let m;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(m={maximumAge:6e5,timeout:0},this._noTimeout=!0):(m=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,m),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){let m=()=>{i.window.addEventListener("ondeviceorientationabsolute"in i.window?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientation)};i.window.DeviceMotionEvent!==void 0&&typeof i.window.DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(l=>{l==="granted"&&m()}).catch(console.error):m()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),i.window.removeEventListener("deviceorientation",this._onDeviceOrientation),i.window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:Ot,ScaleControl:class{constructor(m){this.options=i.extend({},hf,m),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}}(),i.bindAll(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){let m=this.options.maxWidth||100,l=this._map,h=l._containerHeight/2,_=l._containerWidth/2-m/2,x=l.unproject([_,h]),D=l.unproject([_+m,h]),k=x.distanceTo(D);if(this.options.unit==="imperial"){let R=3.2808*k;R>5280?this._setScale(m,R/5280,"mile"):this._setScale(m,R,"foot")}else this.options.unit==="nautical"?this._setScale(m,k/1852,"nautical-mile"):k>=1e3?this._setScale(m,k/1e3,"kilometer"):this._setScale(m,k,"meter")}_setScale(m,l,h){this._map._requestDomTask(()=>{let _=function(D){let k=Math.pow(10,`${Math.floor(D)}`.length-1),R=D/k;return R=R>=10?10:R>=5?5:R>=3?3:R>=2?2:R>=1?1:function(z){let G=Math.pow(10,Math.ceil(-Math.log(z)/Math.LN10));return Math.round(z*G)/G}(R),k*R}(l),x=_/l;this._container.innerHTML=this._isNumberFormatSupported&&h!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:h}).format(_):`${_}&nbsp;${ff[h]}`,this._container.style.width=m*x+"px"})}onAdd(m){return this._map=m,this._language=m.getLanguage(),this._container=oe("div","mapboxgl-ctrl mapboxgl-ctrl-scale",m.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(m){this._language=m,this._update()}setUnit(m){this.options.unit=m,this._update()}},FullscreenControl:class{constructor(m){this._fullscreen=!1,m&&m.container&&(m.container instanceof i.window.HTMLElement?this._container=m.container:i.warnOnce("Full screen control 'container' must be a DOM element.")),i.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in i.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in i.window.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(m){return this._map=m,this._container||(this._container=this._map.getContainer()),this._controlContainer=oe("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",i.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,i.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!i.window.document.fullscreenEnabled&&!i.window.document.webkitFullscreenEnabled)}_setupUI(){let m=this._fullscreenButton=oe("button","mapboxgl-ctrl-fullscreen",this._controlContainer);oe("span","mapboxgl-ctrl-icon",m).setAttribute("aria-hidden","true"),m.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),i.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){let m=this._getTitle();this._fullscreenButton.setAttribute("aria-label",m),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",m)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(i.window.document.fullscreenElement||i.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?i.window.document.exitFullscreen?i.window.document.exitFullscreen():i.window.document.webkitCancelFullScreen&&i.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends i.Evented{constructor(m){super(),this.options=i.extend(Object.create(Wd),m),i.bindAll(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(m&&m.className?m.className.trim().split(/\s+/):[])}addTo(m){return this._map&&this.remove(),this._map=m,this.options.closeOnClick&&m.on("preclick",this._onClose),this.options.closeOnMove&&m.on("move",this._onClose),m.on("remove",this.remove),this._update(),m._addPopup(this),this._focusFirstElement(),this._trackPointer?(m.on("mousemove",this._onMouseEvent),m.on("mouseup",this._onMouseEvent),m._canvasContainer.classList.add("mapboxgl-track-pointer")):m.on("move",this._update),this.fire(new i.Event("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);let m=this._map;return m&&(m.off("move",this._update),m.off("move",this._onClose),m.off("preclick",this._onClose),m.off("click",this._onClose),m.off("remove",this.remove),m.off("mousemove",this._onMouseEvent),m.off("mouseup",this._onMouseEvent),m.off("drag",this._onMouseEvent),m._canvasContainer&&m._canvasContainer.classList.remove("mapboxgl-track-pointer"),m._removePopup(this),this._map=void 0),this.fire(new i.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(m){this._lngLat=i.LngLat.convert(m),this._pos=null,this._trackPointer=!1,this._update();let l=this._map;return l&&(l.on("move",this._update),l.off("mousemove",this._onMouseEvent),l._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();let m=this._map;return m&&(m.off("move",this._update),m.on("mousemove",this._onMouseEvent),m.on("drag",this._onMouseEvent),m._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(m){return this.setDOMContent(i.window.document.createTextNode(m))}setHTML(m){let l=i.window.document.createDocumentFragment(),h=i.window.document.createElement("body"),_;for(h.innerHTML=m;_=h.firstChild,_;)l.appendChild(_);return this.setDOMContent(l)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(m){return this.options.maxWidth=m,this._update(),this}setDOMContent(m){let l=this._content;if(l)for(;l.hasChildNodes();)l.firstChild&&l.removeChild(l.firstChild);else l=this._content=oe("div","mapboxgl-popup-content",this._container||void 0);if(l.appendChild(m),this.options.closeButton){let h=this._closeButton=oe("button","mapboxgl-popup-close-button",l);h.type="button",h.setAttribute("aria-label","Close popup"),h.setAttribute("aria-hidden","true"),h.innerHTML="&#215;",h.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(m){return this._classList.add(m),this._updateClassList(),this}removeClassName(m){return this._classList.delete(m),this._updateClassList(),this}setOffset(m){return this.options.offset=m,this._update(),this}toggleClassName(m){let l;return this._classList.delete(m)?l=!1:(this._classList.add(m),l=!0),this._updateClassList(),l}_onMouseEvent(m){this._update(m.point)}_getAnchor(m){if(this.options.anchor)return this.options.anchor;let l=this._map,h=this._container,_=this._pos;if(!l||!h||!_)return"bottom";let x=h.offsetWidth,D=h.offsetHeight,k=_.x<x/2,R=_.x>l.transform.width-x/2;if(_.y+m<D)return k?"top-left":R?"top-right":"top";if(_.y>l.transform.height-D){if(k)return"bottom-left";if(R)return"bottom-right"}return k?"left":R?"right":"bottom"}_updateClassList(){let m=this._container;if(!m)return;let l=[...this._classList];l.push("mapboxgl-popup"),this._anchor&&l.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&l.push("mapboxgl-popup-track-pointer"),m.className=l.join(" ")}_update(m){let l=this._map,h=this._content;if(!l||!this._lngLat&&!this._trackPointer||!h)return;let _=this._container;if(_||(_=this._container=oe("div","mapboxgl-popup",l.getContainer()),this._tip=oe("div","mapboxgl-popup-tip",_),_.appendChild(h)),this.options.maxWidth&&_.style.maxWidth!==this.options.maxWidth&&(_.style.maxWidth=this.options.maxWidth),l.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=za(this._lngLat,this._pos,l.transform)),!this._trackPointer||m){let x=this._pos=this._trackPointer&&m?m:l.project(this._lngLat),D=Gp(this.options.offset),k=this._anchor=this._getAnchor(D.y),R=Gp(this.options.offset,k),z=x.add(R).round();l._requestDomTask(()=>{this._container&&k&&(this._container.style.transform=`${kl[k]} translate(${z.x}px,${z.y}px)`)})}if(!this._marker&&l._showingGlobe()){let x=i.isLngLatBehindGlobe(l.transform,this._lngLat)?0:1;this._setOpacity(x)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;let m=this._container.querySelector(ay);m&&m.focus()}_onClose(){this.remove()}_setOpacity(m){this._container&&(this._container.style.opacity=`${m}`),this._content&&(this._content.style.pointerEvents=m?"auto":"none")}},Marker:At,Style:bs,LngLat:i.LngLat,LngLatBounds:i.LngLatBounds,Point:i.Point,MercatorCoordinate:i.MercatorCoordinate,FreeCameraOptions:pi,Evented:i.Evented,config:i.config,prewarm:function(){oc().acquire(_s)},clearPrewarmedResources:function(){let m=Gr;m&&(m.isPreloaded()&&m.numActive()===1?(m.release(_s),Gr=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return i.config.ACCESS_TOKEN},set accessToken(m){i.config.ACCESS_TOKEN=m},get baseApiUrl(){return i.config.API_URL},set baseApiUrl(m){i.config.API_URL=m},get workerCount(){return Ar.workerCount},set workerCount(m){Ar.workerCount=m},get maxParallelImageRequests(){return i.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(m){i.config.MAX_PARALLEL_IMAGE_REQUESTS=m},clearStorage(m){i.clearTileCache(m)},workerUrl:"",workerClass:null,setNow:i.exported.setNow,restoreNow:i.exported.restoreNow};return Dc});var u=e;return u})});var jL=$I((Mv,ST)=>{"use strict";(function(n,r){typeof Mv=="object"&&typeof ST=="object"?(n._Highcharts=r(),ST.exports=n._Highcharts):typeof define=="function"&&define.amd?define("highcharts/highcharts",[],r):typeof Mv=="object"?(n._Highcharts=r(),Mv.highcharts=n._Highcharts):(n.Highcharts&&n.Highcharts.error(16,!0),n.Highcharts=r())})(typeof window>"u"?Mv:window,()=>(()=>{"use strict";let n,r;var e,s,u,i,E,L,j,Y,oe,Ee,Ye,Ne,ct,bt,Ut,Qt,_i,Gn={};Gn.d=(P,d)=>{for(var p in d)Gn.o(d,p)&&!Gn.o(P,p)&&Object.defineProperty(P,p,{enumerable:!0,get:d[p]})},Gn.o=(P,d)=>Object.prototype.hasOwnProperty.call(P,d);var Ro={};Gn.d(Ro,{default:()=>p1}),function(P){P.SVG_NS="http://www.w3.org/2000/svg",P.product="Highcharts",P.version="12.1.2",P.win=typeof window<"u"?window:{},P.doc=P.win.document,P.svg=P.doc&&P.doc.createElementNS&&!!P.doc.createElementNS(P.SVG_NS,"svg").createSVGRect,P.pageLang=P.doc?.documentElement?.closest("[lang]")?.lang,P.userAgent=P.win.navigator&&P.win.navigator.userAgent||"",P.isChrome=P.win.chrome,P.isFirefox=P.userAgent.indexOf("Firefox")!==-1,P.isMS=/(edge|msie|trident)/i.test(P.userAgent)&&!P.win.opera,P.isSafari=!P.isChrome&&P.userAgent.indexOf("Safari")!==-1,P.isTouchDevice=/(Mobile|Android|Windows Phone)/.test(P.userAgent),P.isWebKit=P.userAgent.indexOf("AppleWebKit")!==-1,P.deg2rad=2*Math.PI/360,P.marginNames=["plotTop","marginRight","marginBottom","plotLeft"],P.noop=function(){},P.supportsPassiveEvents=function(){let d=!1;if(!P.isMS){let p=Object.defineProperty({},"passive",{get:function(){d=!0}});P.win.addEventListener&&P.win.removeEventListener&&(P.win.addEventListener("testPassive",P.noop,p),P.win.removeEventListener("testPassive",P.noop,p))}return d}(),P.charts=[],P.composed=[],P.dateFormats={},P.seriesTypes={},P.symbolSizes={},P.chartCount=0}(e||(e={}));let lt=e,{charts:_o,doc:It,win:qs}=lt;function Ja(P,d,p,y){let b=d?"Highcharts error":"Highcharts warning";P===32&&(P=`${b}: Deprecated member`);let w=Tn(P),M=w?`${b} #${P}: www.highcharts.com/errors/${P}/`:P.toString();if(y!==void 0){let T="";w&&(M+="?"),gs(y,function(S,O){T+=`
 - ${O}: ${S}`,w&&(M+=encodeURI(O)+"="+encodeURI(S))}),M+=T}nl(lt,"displayError",{chart:p,code:P,message:M,params:y},function(){if(d)throw Error(M);qs.console&&Ja.messages.indexOf(M)===-1&&console.warn(M)}),Ja.messages.push(M)}function Pn(P,d){return parseInt(P,d||10)}function tr(P){return typeof P=="string"}function ec(P){let d=Object.prototype.toString.call(P);return d==="[object Array]"||d==="[object Array Iterator]"}function Zs(P,d){return!!P&&typeof P=="object"&&(!d||!ec(P))}function el(P){return Zs(P)&&typeof P.nodeType=="number"}function eu(P){let d=P&&P.constructor;return!!(Zs(P,!0)&&!el(P)&&d&&d.name&&d.name!=="Object")}function Tn(P){return typeof P=="number"&&!isNaN(P)&&P<1/0&&P>-1/0}function Yo(P){return P!=null}function gr(P,d,p){let y,b=tr(d)&&!Yo(p),w=(M,T)=>{Yo(M)?P.setAttribute(T,M):b?(y=P.getAttribute(T))||T!=="class"||(y=P.getAttribute(T+"Name")):P.removeAttribute(T)};return tr(d)?w(p,d):gs(d,w),y}function wr(P){return ec(P)?P:[P]}function vo(P,d){let p;for(p in P||(P={}),d)P[p]=d[p];return P}function Bi(){let P=arguments,d=P.length;for(let p=0;p<d;p++){let y=P[p];if(y!=null)return y}}function ms(P,d){vo(P.style,d)}function tl(P){return Math.pow(10,Math.floor(Math.log(P)/Math.LN10))}function Xs(P,d){return P>1e14?P:parseFloat(P.toPrecision(d||14))}(Ja||(Ja={})).messages=[],Math.easeInOutSine=function(P){return-.5*(Math.cos(Math.PI*P)-1)};let Ys=Array.prototype.find?function(P,d){return P.find(d)}:function(P,d){let p,y=P.length;for(p=0;p<y;p++)if(d(P[p],p))return P[p]};function gs(P,d,p){for(let y in P)Object.hasOwnProperty.call(P,y)&&d.call(p||P[y],P[y],y,P)}function Ma(P,d,p){function y(M,T){let S=P.removeEventListener;S&&S.call(P,M,T,!1)}function b(M){let T,S;P.nodeName&&(d?(T={})[d]=!0:T=M,gs(T,function(O,B){if(M[B])for(S=M[B].length;S--;)y(B,M[B][S].fn)}))}let w=typeof P=="function"&&P.prototype||P;if(Object.hasOwnProperty.call(w,"hcEvents")){let M=w.hcEvents;if(d){let T=M[d]||[];p?(M[d]=T.filter(function(S){return p!==S.fn}),y(d,p)):(b(M),M[d]=[])}else b(M),delete w.hcEvents}}function nl(P,d,p,y){if(p=p||{},It.createEvent&&(P.dispatchEvent||P.fireEvent&&P!==lt)){let b=It.createEvent("Events");b.initEvent(d,!0,!0),p=vo(b,p),P.dispatchEvent?P.dispatchEvent(p):P.fireEvent(d,p)}else if(P.hcEvents){p.target||vo(p,{preventDefault:function(){p.defaultPrevented=!0},target:P,type:d});let b=[],w=P,M=!1;for(;w.hcEvents;)Object.hasOwnProperty.call(w,"hcEvents")&&w.hcEvents[d]&&(b.length&&(M=!0),b.unshift.apply(b,w.hcEvents[d])),w=Object.getPrototypeOf(w);M&&b.sort((T,S)=>T.order-S.order),b.forEach(T=>{T.fn.call(P,p)===!1&&p.preventDefault()})}y&&!p.defaultPrevented&&y.call(P,p)}let jn=function(){let P=Math.random().toString(36).substring(2,9)+"-",d=0;return function(){return"highcharts-"+(n?"":P)+d++}}();qs.jQuery&&(qs.jQuery.fn.highcharts=function(){let P=[].slice.call(arguments);if(this[0])return P[0]?(new lt[tr(P[0])?P.shift():"Chart"](this[0],P[0],P[1]),this):_o[gr(this[0],"data-highcharts-chart")]});let Zt={addEvent:function(P,d,p,y={}){let b=typeof P=="function"&&P.prototype||P;Object.hasOwnProperty.call(b,"hcEvents")||(b.hcEvents={});let w=b.hcEvents;lt.Point&&P instanceof lt.Point&&P.series&&P.series.chart&&(P.series.chart.runTrackerClick=!0);let M=P.addEventListener;M&&M.call(P,d,p,!!lt.supportsPassiveEvents&&{passive:y.passive===void 0?d.indexOf("touch")!==-1:y.passive,capture:!1}),w[d]||(w[d]=[]);let T={fn:p,order:typeof y.order=="number"?y.order:1/0};return w[d].push(T),w[d].sort((S,O)=>S.order-O.order),function(){Ma(P,d,p)}},arrayMax:function(P){let d=P.length,p=P[0];for(;d--;)P[d]>p&&(p=P[d]);return p},arrayMin:function(P){let d=P.length,p=P[0];for(;d--;)P[d]<p&&(p=P[d]);return p},attr:gr,clamp:function(P,d,p){return P>d?P<p?P:p:d},clearTimeout:function(P){Yo(P)&&clearTimeout(P)},correctFloat:Xs,createElement:function(P,d,p,y,b){let w=It.createElement(P);return d&&vo(w,d),b&&ms(w,{padding:"0",border:"none",margin:"0"}),p&&ms(w,p),y&&y.appendChild(w),w},crisp:function(P,d=0,p){let y=d%2/2,b=p?-1:1;return(Math.round(P*b-y)+y)*b},css:ms,defined:Yo,destroyObjectProperties:function(P,d,p){gs(P,function(y,b){y!==d&&y?.destroy&&y.destroy(),(y?.destroy||!p)&&delete P[b]})},diffObjects:function(P,d,p,y){let b={};return function w(M,T,S,O){let B=p?T:M;gs(M,function(N,U){if(!O&&y&&y.indexOf(U)>-1&&T[U]){N=wr(N),S[U]=[];for(let X=0;X<Math.max(N.length,T[U].length);X++)T[U][X]&&(N[X]===void 0?S[U][X]=T[U][X]:(S[U][X]={},w(N[X],T[U][X],S[U][X],O+1)))}else Zs(N,!0)&&!N.nodeType?(S[U]=ec(N)?[]:{},w(N,T[U]||{},S[U],O+1),Object.keys(S[U]).length!==0||U==="colorAxis"&&O===0||delete S[U]):(M[U]!==T[U]||U in M&&!(U in T))&&U!=="__proto__"&&U!=="constructor"&&(S[U]=B[U])})}(P,d,b,0),b},discardElement:function(P){P&&P.parentElement&&P.parentElement.removeChild(P)},erase:function(P,d){let p=P.length;for(;p--;)if(P[p]===d){P.splice(p,1);break}},error:Ja,extend:vo,extendClass:function(P,d){let p=function(){};return p.prototype=new P,vo(p.prototype,d),p},find:Ys,fireEvent:nl,getAlignFactor:(P="")=>({center:.5,right:1,middle:.5,bottom:1})[P]||0,getClosestDistance:function(P,d){let p,y,b,w,M=!d;return P.forEach(T=>{if(T.length>1)for(w=y=T.length-1;w>0;w--)(b=T[w]-T[w-1])<0&&!M?(d?.(),d=void 0):b&&(p===void 0||b<p)&&(p=b)}),p},getMagnitude:tl,getNestedProperty:function(P,d){let p=P.split(".");for(;p.length&&Yo(d);){let y=p.shift();if(y===void 0||y==="__proto__")return;if(y==="this"){let w;return Zs(d)&&(w=d["@this"]),w??d}let b=d[y.replace(/[\\'"]/g,"")];if(!Yo(b)||typeof b=="function"||typeof b.nodeType=="number"||b===qs)return;d=b}return d},getStyle:function P(d,p,y){let b;if(p==="width"){let M=Math.min(d.offsetWidth,d.scrollWidth),T=d.getBoundingClientRect&&d.getBoundingClientRect().width;return T<M&&T>=M-1&&(M=Math.floor(T)),Math.max(0,M-(P(d,"padding-left",!0)||0)-(P(d,"padding-right",!0)||0))}if(p==="height")return Math.max(0,Math.min(d.offsetHeight,d.scrollHeight)-(P(d,"padding-top",!0)||0)-(P(d,"padding-bottom",!0)||0));let w=qs.getComputedStyle(d,void 0);return w&&(b=w.getPropertyValue(p),Bi(y,p!=="opacity")&&(b=Pn(b))),b},insertItem:function(P,d){let p,y=P.options.index,b=d.length;for(p=P.options.isInternal?b:0;p<b+1;p++)if(!d[p]||Tn(y)&&y<Bi(d[p].options.index,d[p]._i)||d[p].options.isInternal){d.splice(p,0,P);break}return p},isArray:ec,isClass:eu,isDOMElement:el,isFunction:function(P){return typeof P=="function"},isNumber:Tn,isObject:Zs,isString:tr,merge:function(P,...d){let p,y=[P,...d],b={},w=function(T,S){return typeof T!="object"&&(T={}),gs(S,function(O,B){B!=="__proto__"&&B!=="constructor"&&(!Zs(O,!0)||eu(O)||el(O)?T[B]=S[B]:T[B]=w(T[B]||{},O))}),T};P===!0&&(b=y[1],y=Array.prototype.slice.call(y,2));let M=y.length;for(p=0;p<M;p++)b=w(b,y[p]);return b},normalizeTickInterval:function(P,d,p,y,b){let w,M=P;p=Bi(p,tl(P));let T=P/p;for(!d&&(d=b?[1,1.2,1.5,2,2.5,3,4,5,6,8,10]:[1,2,2.5,5,10],y===!1&&(p===1?d=d.filter(function(S){return S%1==0}):p<=.1&&(d=[1/p]))),w=0;w<d.length&&(M=d[w],(!b||!(M*p>=P))&&(b||!(T<=(d[w]+(d[w+1]||d[w]))/2)));w++);return Xs(M*p,-Math.round(Math.log(.001)/Math.LN10))},objectEach:gs,offset:function(P){let d=It.documentElement,p=P.parentElement||P.parentNode?P.getBoundingClientRect():{top:0,left:0,width:0,height:0};return{top:p.top+(qs.pageYOffset||d.scrollTop)-(d.clientTop||0),left:p.left+(qs.pageXOffset||d.scrollLeft)-(d.clientLeft||0),width:p.width,height:p.height}},pad:function(P,d,p){return Array((d||2)+1-String(P).replace("-","").length).join(p||"0")+P},pick:Bi,pInt:Pn,pushUnique:function(P,d){return 0>P.indexOf(d)&&!!P.push(d)},relativeLength:function(P,d,p){return/%$/.test(P)?d*parseFloat(P)/100+(p||0):parseFloat(P)},removeEvent:Ma,replaceNested:function(P,...d){let p,y;do for(y of(p=P,d))P=P.replace(y[0],y[1]);while(P!==p);return P},splat:wr,stableSort:function(P,d){let p,y,b=P.length;for(y=0;y<b;y++)P[y].safeI=y;for(P.sort(function(w,M){return(p=d(w,M))===0?w.safeI-M.safeI:p}),y=0;y<b;y++)delete P[y].safeI},syncTimeout:function(P,d,p){return d>0?setTimeout(P,d,p):(P.call(0,p),-1)},timeUnits:{millisecond:1,second:1e3,minute:6e4,hour:36e5,day:864e5,week:6048e5,month:24192e5,year:314496e5},ucfirst:function(P){return tr(P)?P.substring(0,1).toUpperCase()+P.substring(1):String(P)},uniqueKey:jn,useSerialIds:function(P){return n=Bi(P,n)},wrap:function(P,d,p){let y=P[d];P[d]=function(){let b=arguments,w=this;return p.apply(this,[function(){return y.apply(w,arguments.length?arguments:b)}].concat([].slice.call(arguments)))}}},{pageLang:bo,win:Ta}=lt,{defined:vi,error:xo,extend:il,isNumber:ys,isObject:to,isString:Ks,merge:tc,objectEach:tu,pad:no,splat:nc,timeUnits:Mi,ucfirst:gd}=Zt,Po=lt.isSafari&&Ta.Intl&&!Ta.Intl.DateTimeFormat.prototype.formatRange,Ia=P=>P.main===void 0,ic=P=>["D","L","M","X","J","V","S"].indexOf(P),Qs=class{constructor(P){this.options={timezone:"UTC"},this.variableTimezone=!1,this.Date=Ta.Date,this.update(P)}update(P={}){this.dTLCache={},this.options=P=tc(!0,this.options,P);let{timezoneOffset:d,useUTC:p}=P;this.Date=P.Date||Ta.Date||Date;let y=P.timezone;vi(p)&&(y=p?"UTC":void 0),d&&d%60==0&&(y="Etc/GMT"+(d>0?"+":"")+d/60),this.variableTimezone=y!=="UTC"&&y?.indexOf("Etc/GMT")!==0,this.timezone=y,["months","shortMonths","weekdays","shortWeekdays"].forEach(b=>{let w=/months/i.test(b),M=/short/.test(b),T={timeZone:"UTC"};T[w?"month":"weekday"]=M?"short":"long",this[b]=(w?[0,1,2,3,4,5,6,7,8,9,10,11]:[3,4,5,6,7,8,9]).map(S=>this.dateFormat(T,(w?31:1)*24*36e5*S))})}toParts(P){let[d,p,y,b,w,M,T]=this.dateTimeFormat({weekday:"narrow",day:"numeric",month:"numeric",year:"numeric",hour:"numeric",minute:"numeric",second:"numeric"},P,"es").split(/(?:, |\/|:)/g);return[b,+y-1,p,w,M,T,Math.floor(Number(P)||0)%1e3,ic(d)].map(Number)}dateTimeFormat(P,d,p=this.options.locale||bo){let y=JSON.stringify(P)+p;Ks(P)&&(P=this.str2dtf(P));let b=this.dTLCache[y];if(!b){P.timeZone??(P.timeZone=this.timezone);try{b=new Intl.DateTimeFormat(p,P)}catch(w){/Invalid time zone/i.test(w.message)?(xo(34),P.timeZone="UTC",b=new Intl.DateTimeFormat(p,P)):xo(w.message,!1)}}return this.dTLCache[y]=b,b?.format(d)||""}str2dtf(P,d={}){let p={L:{fractionalSecondDigits:3},S:{second:"2-digit"},M:{minute:"numeric"},H:{hour:"2-digit"},k:{hour:"numeric"},E:{weekday:"narrow"},a:{weekday:"short"},A:{weekday:"long"},d:{day:"2-digit"},e:{day:"numeric"},b:{month:"short"},B:{month:"long"},m:{month:"2-digit"},o:{month:"numeric"},y:{year:"2-digit"},Y:{year:"numeric"}};return Object.keys(p).forEach(y=>{P.indexOf(y)!==-1&&il(d,p[y])}),d}makeTime(P,d,p=1,y=0,b,w,M){let T=this.Date.UTC(P,d,p,y,b||0,w||0,M||0);if(this.timezone!=="UTC"){let S=this.getTimezoneOffset(T);if(T+=S,[2,3,8,9,10,11].indexOf(d)!==-1&&(y<5||y>20)){let O=this.getTimezoneOffset(T);S!==O?T+=O-S:S-36e5!==this.getTimezoneOffset(T-36e5)||Po||(T-=36e5)}}return T}parse(P){if(!Ks(P))return P??void 0;let d=(P=P.replace(/\//g,"-").replace(/(GMT|UTC)/,"")).indexOf("Z")>-1||/([+-][0-9]{2}):?[0-9]{2}$/.test(P),p=/^[0-9]{4}-[0-9]{2}-[0-9]{2}$/.test(P);d||p||(P+="Z");let y=Date.parse(P);if(ys(y))return y+(!d||p?this.getTimezoneOffset(y):0)}getTimezoneOffset(P){if(this.timezone!=="UTC"){let[d,p,y,b,w=0]=this.dateTimeFormat({timeZoneName:"shortOffset"},P,"en").split(/(GMT|:)/).map(Number),M=-(36e5*(y+w/60));if(ys(M))return M}return 0}dateFormat(P,d,p){let y=lt.defaultOptions?.lang;if(!vi(d)||isNaN(d))return y?.invalidDate||"";if(Ks(P=P??"%Y-%m-%d %H:%M:%S")){let b,w=/%\[([a-zA-Z]+)\]/g;for(;b=w.exec(P);)P=P.replace(b[0],this.dateTimeFormat(b[1],d))}if(Ks(P)&&P.indexOf("%")!==-1){let b=this,[w,M,T,S,O,B,N,U]=this.toParts(d),X=y?.weekdays||this.weekdays,Z=y?.shortWeekdays||this.shortWeekdays,te=y?.months||this.months,ne=y?.shortMonths||this.shortMonths;tu(il({a:Z?Z[U]:X[U].substr(0,3),A:X[U],d:no(T),e:no(T,2," "),w:U,b:ne[M],B:te[M],m:no(M+1),o:M+1,y:w.toString().substr(2,2),Y:w,H:no(S),k:S,I:no(S%12||12),l:S%12||12,M:no(O),p:S<12?"AM":"PM",P:S<12?"am":"pm",S:no(B),L:no(N,3)},lt.dateFormats),function(J,ce){if(Ks(P))for(;P.indexOf("%"+ce)!==-1;)P=P.replace("%"+ce,typeof J=="function"?J.call(b,d):J)})}else if(to(P)){let b=(this.getTimezoneOffset(d)||0)/36e5,w=this.timezone||"Etc/GMT"+(b>=0?"+":"")+b,{prefix:M="",suffix:T=""}=P;P=M+this.dateTimeFormat(il({timeZone:w},P),d)+T}return p?gd(P):P}resolveDTLFormat(P){return to(P,!0)?to(P,!0)&&Ia(P)?{main:P}:P:{main:(P=nc(P))[0],from:P[1],to:P[2]}}getTimeTicks(P,d,p,y){let b=this,w=[],M={},{count:T=1,unitRange:S}=P,[O,B,N,U,X,Z]=b.toParts(d),te=(d||0)%1e3,ne;if(y??(y=1),vi(d)){if(te=S>=Mi.second?0:T*Math.floor(te/T),S>=Mi.second&&(Z=S>=Mi.minute?0:T*Math.floor(Z/T)),S>=Mi.minute&&(X=S>=Mi.hour?0:T*Math.floor(X/T)),S>=Mi.hour&&(U=S>=Mi.day?0:T*Math.floor(U/T)),S>=Mi.day&&(N=S>=Mi.month?1:Math.max(1,T*Math.floor(N/T))),S>=Mi.month&&(B=S>=Mi.year?0:T*Math.floor(B/T)),S>=Mi.year&&(O-=O%T),S===Mi.week){T&&(d=b.makeTime(O,B,N,U,X,Z,te));let de=ic(this.dateTimeFormat({timeZone:this.timezone,weekday:"narrow"},d,"es"));N+=-de+y+(de<y?-7:0)}d=b.makeTime(O,B,N,U,X,Z,te),b.variableTimezone&&vi(p)&&(ne=p-d>4*Mi.month||b.getTimezoneOffset(d)!==b.getTimezoneOffset(p));let J=d,ce=1;for(;J<p;)w.push(J),S===Mi.year?J=b.makeTime(O+ce*T,0):S===Mi.month?J=b.makeTime(O,B+ce*T):ne&&(S===Mi.day||S===Mi.week)?J=b.makeTime(O,B,N+ce*T*(S===Mi.day?1:7)):ne&&S===Mi.hour&&T>1?J=b.makeTime(O,B,N,U+ce*T):J+=S*T,ce++;w.push(J),S<=Mi.hour&&w.length<1e4&&w.forEach(de=>{de%18e5==0&&b.dateFormat("%H%M%S%L",de)==="000000000"&&(M[de]="day")})}return w.info=il(P,{higherRanks:M,totalRange:S*T}),w}getDateFormat(P,d,p,y){let b=this.dateFormat("%m-%d %H:%M:%S.%L",d),w="01-01 00:00:00.000",M={millisecond:15,second:12,minute:9,hour:6,day:3},T="millisecond",S=T;for(T in Mi){if(P===Mi.week&&+this.dateFormat("%w",d)===p&&b.substr(6)===w.substr(6)){T="week";break}if(Mi[T]>P){T=S;break}if(M[T]&&b.substr(M[T])!==w.substr(M[T]))break;T!=="week"&&(S=T)}return this.resolveDTLFormat(y[T]).main}},{isTouchDevice:rc}=lt,{fireEvent:nu,merge:rl}=Zt,wo={colors:["#2caffe","#544fc5","#00e272","#fe6a35","#6b8abc","#d568fb","#2ee0ca","#fa4b42","#feb56a","#91e8e1"],symbols:["circle","diamond","square","triangle","triangle-down"],lang:{locale:void 0,loading:"Loading...",months:void 0,shortMonths:void 0,weekdays:void 0,numericSymbols:["k","M","G","T","P","E"],resetZoom:"Reset zoom",resetZoomTitle:"Reset zoom level 1:1"},global:{buttonTheme:{fill:"#f7f7f7",padding:8,r:2,stroke:"#cccccc","stroke-width":1,style:{color:"#333333",cursor:"pointer",fontSize:"0.8em",fontWeight:"normal"},states:{hover:{fill:"#e6e6e6"},select:{fill:"#e6e9ff",style:{color:"#000000",fontWeight:"bold"}},disabled:{style:{color:"#cccccc"}}}}},time:{Date:void 0,timezone:"UTC",timezoneOffset:0,useUTC:void 0},chart:{alignThresholds:!1,panning:{enabled:!1,type:"x"},styledMode:!1,borderRadius:0,colorCount:10,allowMutatingData:!0,ignoreHiddenSeries:!0,spacing:[10,10,15,10],resetZoomButton:{theme:{},position:{}},reflow:!0,type:"line",zooming:{singleTouch:!1,resetButton:{theme:{zIndex:6},position:{align:"right",x:-10,y:10}}},width:null,height:null,borderColor:"#334eff",backgroundColor:"#ffffff",plotBorderColor:"#cccccc"},title:{style:{color:"#333333",fontWeight:"bold"},text:"Chart title",margin:15,minScale:.67},subtitle:{style:{color:"#666666",fontSize:"0.8em"},text:""},caption:{margin:15,style:{color:"#666666",fontSize:"0.8em"},text:"",align:"left",verticalAlign:"bottom"},plotOptions:{},legend:{enabled:!0,align:"center",alignColumns:!0,className:"highcharts-no-tooltip",events:{},layout:"horizontal",itemMarginBottom:2,itemMarginTop:2,labelFormatter:function(){return this.name},borderColor:"#999999",borderRadius:0,navigation:{style:{fontSize:"0.8em"},activeColor:"#0022ff",inactiveColor:"#cccccc"},itemStyle:{color:"#333333",cursor:"pointer",fontSize:"0.8em",textDecoration:"none",textOverflow:"ellipsis"},itemHoverStyle:{color:"#000000"},itemHiddenStyle:{color:"#666666",textDecoration:"line-through"},shadow:!1,itemCheckboxStyle:{position:"absolute",width:"13px",height:"13px"},squareSymbol:!0,symbolPadding:5,verticalAlign:"bottom",x:0,y:0,title:{style:{fontSize:"0.8em",fontWeight:"bold"}}},loading:{labelStyle:{fontWeight:"bold",position:"relative",top:"45%"},style:{position:"absolute",backgroundColor:"#ffffff",opacity:.5,textAlign:"center"}},tooltip:{enabled:!0,animation:{duration:300,easing:P=>Math.sqrt(1-Math.pow(P-1,2))},borderRadius:3,dateTimeLabelFormats:{millisecond:"%[AebHMSL]",second:"%[AebHMS]",minute:"%[AebHM]",hour:"%[AebHM]",day:"%[AebY]",week:"Week from %[AebY]",month:"%[BY]",year:"%Y"},footerFormat:"",headerShape:"callout",hideDelay:500,padding:8,shape:"callout",shared:!1,snap:rc?25:10,headerFormat:'<span style="font-size: 0.8em">{ucfirst point.key}</span><br/>',pointFormat:'<span style="color:{point.color}">\u25CF</span> {series.name}: <b>{point.y}</b><br/>',backgroundColor:"#ffffff",borderWidth:void 0,shadow:!0,stickOnContact:!1,style:{color:"#333333",cursor:"default",fontSize:"0.8em"},useHTML:!1},credits:{enabled:!0,href:"https://www.highcharts.com?credits",position:{align:"right",x:-10,verticalAlign:"bottom",y:-5},style:{cursor:"pointer",color:"#999999",fontSize:"0.6em"},text:"Highcharts.com"}},Js=new Qs(wo.time),Sr={defaultOptions:wo,defaultTime:Js,getOptions:function(){return wo},setOptions:function(P){return nu(lt,"setOptions",{options:P}),rl(!0,wo,P),P.time&&Js.update(wo.time),P.lang&&"locale"in P.lang&&Js.update({locale:P.lang.locale}),wo}},{isNumber:ea,merge:yd,pInt:be,defined:ie}=Zt;class re{static parse(d){return d?new re(d):re.None}constructor(d){let p,y,b,w;this.rgba=[NaN,NaN,NaN,NaN],this.input=d;let M=lt.Color;if(M&&M!==re)return new M(d);if(typeof d=="object"&&d.stops!==void 0)this.stops=d.stops.map(T=>new re(T[1]));else if(typeof d=="string")for(this.input=d=re.names[d.toLowerCase()]||d,b=re.parsers.length;b--&&!y;)(p=(w=re.parsers[b]).regex.exec(d))&&(y=w.parse(p));y&&(this.rgba=y)}get(d){let p=this.input,y=this.rgba;if(typeof p=="object"&&this.stops!==void 0){let b=yd(p);return b.stops=[].slice.call(b.stops),this.stops.forEach((w,M)=>{b.stops[M]=[b.stops[M][0],w.get(d)]}),b}return y&&ea(y[0])?d!=="rgb"&&(d||y[3]!==1)?d==="a"?`${y[3]}`:"rgba("+y.join(",")+")":"rgb("+y[0]+","+y[1]+","+y[2]+")":p}brighten(d){let p=this.rgba;if(this.stops)this.stops.forEach(function(y){y.brighten(d)});else if(ea(d)&&d!==0)for(let y=0;y<3;y++)p[y]+=be(255*d),p[y]<0&&(p[y]=0),p[y]>255&&(p[y]=255);return this}setOpacity(d){return this.rgba[3]=d,this}tweenTo(d,p){let y=this.rgba,b=d.rgba;if(!ea(y[0])||!ea(b[0]))return d.input||"none";let w=b[3]!==1||y[3]!==1,M=(S,O)=>S+(y[O]-S)*(1-p),T=b.slice(0,3).map(M).map(Math.round);return w&&T.push(M(b[3],3)),(w?"rgba(":"rgb(")+T.join(",")+")"}}re.names={white:"#ffffff",black:"#000000"},re.parsers=[{regex:/rgba\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d?(?:\.\d+)?)\s*\)/,parse:function(P){return[be(P[1]),be(P[2]),be(P[3]),parseFloat(P[4],10)]}},{regex:/rgb\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*\)/,parse:function(P){return[be(P[1]),be(P[2]),be(P[3]),1]}},{regex:/^#([a-f0-9])([a-f0-9])([a-f0-9])([a-f0-9])?$/i,parse:function(P){return[be(P[1]+P[1],16),be(P[2]+P[2],16),be(P[3]+P[3],16),ie(P[4])?be(P[4]+P[4],16)/255:1]}},{regex:/^#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})?$/i,parse:function(P){return[be(P[1],16),be(P[2],16),be(P[3],16),ie(P[4])?be(P[4],16)/255:1]}}],re.None=new re("");let{parse:ve}=re,{win:Ie}=lt,{isNumber:Pe,objectEach:$e}=Zt,Ve=(()=>{class P{constructor(p,y,b){this.pos=NaN,this.options=y,this.elem=p,this.prop=b}dSetter(){let p=this.paths,y=p&&p[0],b=p&&p[1],w=this.now||0,M=[];if(w!==1&&y&&b)if(y.length===b.length&&w<1)for(let T=0;T<b.length;T++){let S=y[T],O=b[T],B=[];for(let N=0;N<O.length;N++){let U=S[N],X=O[N];Pe(U)&&Pe(X)&&!(O[0]==="A"&&(N===4||N===5))?B[N]=U+w*(X-U):B[N]=X}M.push(B)}else M=b;else M=this.toD||[];this.elem.attr("d",M,void 0,!0)}update(){let p=this.elem,y=this.prop,b=this.now,w=this.options.step;this[y+"Setter"]?this[y+"Setter"]():p.attr?p.element&&p.attr(y,b,null,!0):p.style[y]=b+this.unit,w&&w.call(p,b,this)}run(p,y,b){let w=this,M=w.options,T=function(B){return!T.stopped&&w.step(B)},S=Ie.requestAnimationFrame||function(B){setTimeout(B,13)},O=function(){for(let B=0;B<P.timers.length;B++)P.timers[B]()||P.timers.splice(B--,1);P.timers.length&&S(O)};p!==y||this.elem["forceAnimate:"+this.prop]?(this.startTime=+new Date,this.start=p,this.end=y,this.unit=b,this.now=this.start,this.pos=0,T.elem=this.elem,T.prop=this.prop,T()&&P.timers.push(T)===1&&S(O)):(delete M.curAnim[this.prop],M.complete&&Object.keys(M.curAnim).length===0&&M.complete.call(this.elem))}step(p){let y,b,w=+new Date,M=this.options,T=this.elem,S=M.complete,O=M.duration,B=M.curAnim;return T.attr&&!T.element?y=!1:p||w>=O+this.startTime?(this.now=this.end,this.pos=1,this.update(),B[this.prop]=!0,b=!0,$e(B,function(N){N!==!0&&(b=!1)}),b&&S&&S.call(T),y=!1):(this.pos=M.easing((w-this.startTime)/O),this.now=this.start+(this.end-this.start)*this.pos,this.update(),y=!0),y}initPath(p,y,b){let w=p.startX,M=p.endX,T=b.slice(),S=p.isArea,O=S?2:1,B=y&&b.length>y.length&&b.hasStackedCliffs,N,U,X,Z,te=y&&y.slice();if(!te||B)return[T,T];function ne(ce,de){for(;ce.length<U;){let ke=ce[0],Ue=de[U-ce.length];if(Ue&&ke[0]==="M"&&(Ue[0]==="C"?ce[0]=["C",ke[1],ke[2],ke[1],ke[2],ke[1],ke[2]]:ce[0]=["L",ke[1],ke[2]]),ce.unshift(ke),S){let Le=ce.pop();ce.push(ce[ce.length-1],Le)}}}function J(ce){for(;ce.length<U;){let de=ce[Math.floor(ce.length/O)-1].slice();if(de[0]==="C"&&(de[1]=de[5],de[2]=de[6]),S){let ke=ce[Math.floor(ce.length/O)].slice();ce.splice(ce.length/2,0,de,ke)}else ce.push(de)}}if(w&&M&&M.length){for(X=0;X<w.length;X++){if(w[X]===M[0]){N=X;break}if(w[0]===M[M.length-w.length+X]){N=X,Z=!0;break}if(w[w.length-1]===M[M.length-w.length+X]){N=w.length-X;break}}N===void 0&&(te=[])}return te.length&&Pe(N)&&(U=T.length+N*O,Z?(ne(te,T),J(T)):(ne(T,te),J(te))),[te,T]}fillSetter(){P.prototype.strokeSetter.apply(this,arguments)}strokeSetter(){this.elem.attr(this.prop,ve(this.start).tweenTo(ve(this.end),this.pos),void 0,!0)}}return P.timers=[],P})(),{defined:Oe,getStyle:Xe,isArray:Ct,isNumber:Tt,isObject:yt,merge:cn,objectEach:In,pick:dn}=Zt;function vn(P){return yt(P)?cn({duration:500,defer:0},P):{duration:P?500:0,defer:0}}function On(P,d){let p=Ve.timers.length;for(;p--;)Ve.timers[p].elem!==P||d&&d!==Ve.timers[p].prop||(Ve.timers[p].stopped=!0)}let Ln={animate:function(P,d,p){let y,b="",w,M,T;yt(p)||(T=arguments,p={duration:T[2],easing:T[3],complete:T[4]}),Tt(p.duration)||(p.duration=400),p.easing=typeof p.easing=="function"?p.easing:Math[p.easing]||Math.easeInOutSine,p.curAnim=cn(d),In(d,function(S,O){On(P,O),M=new Ve(P,p,O),w=void 0,O==="d"&&Ct(d.d)?(M.paths=M.initPath(P,P.pathArray,d.d),M.toD=d.d,y=0,w=1):P.attr?y=P.attr(O):(y=parseFloat(Xe(P,O))||0,O!=="opacity"&&(b="px")),w||(w=S),typeof w=="string"&&w.match("px")&&(w=w.replace(/px/g,"")),M.run(y,w,b)})},animObject:vn,getDeferredAnimation:function(P,d,p){let y=vn(d),b=p?[p]:P.series,w=0,M=0;return b.forEach(T=>{let S=vn(T.options.animation);w=yt(d)&&Oe(d.defer)?y.defer:Math.max(w,S.duration+S.defer),M=Math.min(y.duration,S.duration)}),P.renderer.forExport&&(w=0),{defer:Math.max(0,w-M),duration:Math.min(w,M)}},setAnimation:function(P,d){d.renderer.globalAnimation=dn(P,d.options.chart.animation,!0)},stop:On},{SVG_NS:nr,win:Hr}=lt,{attr:yr,createElement:_s,css:Ar,error:Gr,isFunction:oc,isString:Dp,objectEach:Lh,splat:ri}=Zt,{trustedTypes:iu}=Hr,Sa=iu&&oc(iu.createPolicy)&&iu.createPolicy("highcharts",{createHTML:P=>P}),Fh=Sa?Sa.createHTML(""):"";class bi{static filterUserAttributes(d){return Lh(d,(p,y)=>{let b=!0;bi.allowedAttributes.indexOf(y)===-1&&(b=!1),["background","dynsrc","href","lowsrc","src"].indexOf(y)!==-1&&(b=Dp(p)&&bi.allowedReferences.some(w=>p.indexOf(w)===0)),b||(Gr(33,!1,void 0,{"Invalid attribute in config":`${y}`}),delete d[y]),Dp(p)&&d[y]&&(d[y]=p.replace(/</g,"&lt;"))}),d}static parseStyle(d){return d.split(";").reduce((p,y)=>{let b=y.split(":").map(M=>M.trim()),w=b.shift();return w&&b.length&&(p[w.replace(/-([a-z])/g,M=>M[1].toUpperCase())]=b.join(":")),p},{})}static setElementHTML(d,p){d.innerHTML=bi.emptyHTML,p&&new bi(p).addToDOM(d)}constructor(d){this.nodes=typeof d=="string"?this.parseMarkup(d):d}addToDOM(d){return function p(y,b){let w;return ri(y).forEach(function(M){let T,S=M.tagName,O=M.textContent?lt.doc.createTextNode(M.textContent):void 0,B=bi.bypassHTMLFiltering;if(S)if(S==="#text")T=O;else if(bi.allowedTags.indexOf(S)!==-1||B){let N=S==="svg"?nr:b.namespaceURI||nr,U=lt.doc.createElementNS(N,S),X=M.attributes||{};Lh(M,function(Z,te){te!=="tagName"&&te!=="attributes"&&te!=="children"&&te!=="style"&&te!=="textContent"&&(X[te]=Z)}),yr(U,B?X:bi.filterUserAttributes(X)),M.style&&Ar(U,M.style),O&&U.appendChild(O),p(M.children||[],U),T=U}else Gr(33,!1,void 0,{"Invalid tagName in config":S});T&&b.appendChild(T),w=T}),w}(this.nodes,d)}parseMarkup(d){let p,y=[];d=d.trim().replace(/ style=(["'])/g," data-style=$1");try{p=new DOMParser().parseFromString(Sa?Sa.createHTML(d):d,"text/html")}catch{}if(!p){let w=_s("div");w.innerHTML=d,p={body:w}}let b=(w,M)=>{let T=w.nodeName.toLowerCase(),S={tagName:T};T==="#text"&&(S.textContent=w.textContent||"");let O=w.attributes;if(O){let B={};[].forEach.call(O,N=>{N.name==="data-style"?S.style=bi.parseStyle(N.value):B[N.name]=N.value}),S.attributes=B}if(w.childNodes.length){let B=[];[].forEach.call(w.childNodes,N=>{b(N,B)}),B.length&&(S.children=B)}M.push(S)};return[].forEach.call(p.body.childNodes,w=>b(w,y)),y}}bi.allowedAttributes=["alt","aria-controls","aria-describedby","aria-expanded","aria-haspopup","aria-hidden","aria-label","aria-labelledby","aria-live","aria-pressed","aria-readonly","aria-roledescription","aria-selected","class","clip-path","color","colspan","cx","cy","d","dx","dy","disabled","fill","filterUnits","flood-color","flood-opacity","height","href","id","in","in2","markerHeight","markerWidth","offset","opacity","operator","orient","padding","paddingLeft","paddingRight","patternUnits","r","radius","refX","refY","role","scope","slope","src","startOffset","stdDeviation","stroke","stroke-linecap","stroke-width","style","tableValues","result","rowspan","summary","target","tabindex","text-align","text-anchor","textAnchor","textLength","title","type","valign","width","x","x1","x2","xlink:href","y","y1","y2","zIndex"],bi.allowedReferences=["https://","http://","mailto:","/","../","./","#"],bi.allowedTags=["a","abbr","b","br","button","caption","circle","clipPath","code","dd","defs","div","dl","dt","em","feComponentTransfer","feComposite","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feMorphology","feOffset","feMerge","feMergeNode","filter","h1","h2","h3","h4","h5","h6","hr","i","img","li","linearGradient","marker","ol","p","path","pattern","pre","rect","small","span","stop","strong","style","sub","sup","svg","table","text","textPath","thead","title","tbody","tspan","td","th","tr","u","ul","#text"],bi.emptyHTML=Fh,bi.bypassHTMLFiltering=!1;let{defaultOptions:Ko,defaultTime:vs}=Sr,{pageLang:Nh}=lt,{extend:zh,getNestedProperty:ol,isArray:ta,isNumber:sc,isObject:Je,isString:na,pick:ur,ucfirst:kr}=Zt,ru={add:(P,d)=>P+d,divide:(P,d)=>d!==0?P/d:"",eq:(P,d)=>P==d,each:function(P){let d=arguments[arguments.length-1];return!!ta(P)&&P.map((p,y)=>ou(d.body,zh(Je(p)?p:{"@this":p},{"@index":y,"@first":y===0,"@last":y===P.length-1}))).join("")},ge:(P,d)=>P>=d,gt:(P,d)=>P>d,if:P=>!!P,le:(P,d)=>P<=d,lt:(P,d)=>P<d,multiply:(P,d)=>P*d,ne:(P,d)=>P!=d,subtract:(P,d)=>P-d,ucfirst:kr,unless:P=>!P},Qo={},_d=P=>/^["'].+["']$/.test(P);function ou(P="",d,p){let y=/\{([\p{L}\d:\.,;\-\/<>\[\]%_@+"'’= #\(\)]+)\}/gu,b=/\(([\p{L}\d:\.,;\-\/<>\[\]%_@+"'= ]+)\)/gu,w=[],M=/f$/,T=/\.(\d)/,S=p?.options.lang||Ko.lang,O=p&&p.time||vs,B=p&&p.numberFormatter||sl,N=(ne="")=>{let J;return ne==="true"||ne!=="false"&&((J=Number(ne)).toString()===ne?J:_d(ne)?ne.slice(1,-1):ol(ne,d))},U,X,Z=0,te;for(;(U=y.exec(P))!==null;){let ne=U,J=b.exec(U[1]);J&&(U=J,te=!0),X&&X.isBlock||(X={ctx:d,expression:U[1],find:U[0],isBlock:U[1].charAt(0)==="#",start:U.index,startInner:U.index+U[0].length,length:U[0].length});let ce=(X.isBlock?ne:U)[1].split(" ")[0].replace("#","");ru[ce]&&(X.isBlock&&ce===X.fn&&Z++,X.fn||(X.fn=ce));let de=U[1]==="else";if(X.isBlock&&X.fn&&(U[1]===`/${X.fn}`||de))if(Z)!de&&Z--;else{let ke=X.startInner,Ue=P.substr(ke,U.index-ke);X.body===void 0?(X.body=Ue,X.startInner=U.index+U[0].length):X.elseBody=Ue,X.find+=Ue+U[0],de||(w.push(X),X=void 0)}else X.isBlock||w.push(X);if(J&&!X?.isBlock)break}return w.forEach(ne=>{let J,ce,{body:de,elseBody:ke,expression:Ue,fn:Le}=ne;if(Le){let Se=[ne],ze=[],nt=Ue.length,rt=0,pt;for(ce=0;ce<=nt;ce++){let Bt=Ue.charAt(ce);pt||Bt!=='"'&&Bt!=="'"?pt===Bt&&(pt=""):pt=Bt,pt||Bt!==" "&&ce!==nt||(ze.push(Ue.substr(rt,ce-rt)),rt=ce+1)}for(ce=ru[Le].length;ce--;)Se.unshift(N(ze[ce+1]));J=ru[Le].apply(d,Se),ne.isBlock&&typeof J=="boolean"&&(J=ou(J?de:ke,d,p))}else{let Se=_d(Ue)?[Ue]:Ue.split(":");if(J=N(Se.shift()||""),Se.length&&typeof J=="number"){let ze=Se.join(":");if(M.test(ze)){let nt=parseInt((ze.match(T)||["","-1"])[1],10);J!==null&&(J=B(J,nt,S.decimalPoint,ze.indexOf(",")>-1?S.thousandsSep:""))}else J=O.dateFormat(ze,J)}b.lastIndex=0,b.test(ne.find)&&na(J)&&(J=`"${J}"`)}P=P.replace(ne.find,ur(J,""))}),te?ou(P,d,p):P}function sl(P,d,p,y){d=+d;let b,w,[M,T]=(P=+P||0).toString().split("e").map(Number),S=this?.options?.lang||Ko.lang,O=(P.toString().split(".")[1]||"").split("e")[0].length,B=d,N={};p??(p=S.decimalPoint),y??(y=S.thousandsSep),d===-1?d=Math.min(O,20):sc(d)?d&&T<0&&((w=d+T)>=0?(M=+M.toExponential(w).split("e")[0],d=w):(M=Math.floor(M),P=d<20?+(M*Math.pow(10,T)).toFixed(d):0,T=0)):d=2,T&&(d??(d=2),P=M),sc(d)&&d>=0&&(N.minimumFractionDigits=d,N.maximumFractionDigits=d),y===""&&(N.useGrouping=!1);let U=y||p,X=U?"en":this?.locale||S.locale||Nh,Z=JSON.stringify(N)+X;return b=(Qo[Z]??(Qo[Z]=new Intl.NumberFormat(X,N))).format(P),U&&(b=b.replace(/([,\.])/g,"_$1").replace(/_\,/g,y??",").replace("_.",p??".")),(d||+b!=0)&&(!(T<0)||B)||(b="0"),T&&+b!=0&&(b+="e"+(T<0?"":"+")+T),b}let Mt={dateFormat:function(P,d,p){return vs.dateFormat(P,d,p)},format:ou,helpers:ru,numberFormat:sl};(function(P){let d;P.rendererTypes={},P.getRendererType=function(p=d){return P.rendererTypes[p]||P.rendererTypes[d]},P.registerRendererType=function(p,y,b){P.rendererTypes[p]=y,(!d||b)&&(d=p,lt.Renderer=y)}})(s||(s={}));let En=s,{clamp:kn,pick:Co,pushUnique:Jo,stableSort:Dn}=Zt;(u||(u={})).distribute=function P(d,p,y){let b=d,w=b.reducedLen||p,M=(de,ke)=>de.target-ke.target,T=[],S=d.length,O=[],B=T.push,N,U,X,Z=!0,te,ne,J=0,ce;for(N=S;N--;)J+=d[N].size;if(J>w){for(Dn(d,(de,ke)=>(ke.rank||0)-(de.rank||0)),X=(ce=d[0].rank===d[d.length-1].rank)?S/2:-1,U=ce?X:S-1;X&&J>w;)te=d[N=Math.floor(U)],Jo(O,N)&&(J-=te.size),U+=X,ce&&U>=d.length&&(X/=2,U=X);O.sort((de,ke)=>ke-de).forEach(de=>B.apply(T,d.splice(de,1)))}for(Dn(d,M),d=d.map(de=>({size:de.size,targets:[de.target],align:Co(de.align,.5)}));Z;){for(N=d.length;N--;)te=d[N],ne=(Math.min.apply(0,te.targets)+Math.max.apply(0,te.targets))/2,te.pos=kn(ne-te.size*te.align,0,p-te.size);for(N=d.length,Z=!1;N--;)N>0&&d[N-1].pos+d[N-1].size>d[N].pos&&(d[N-1].size+=d[N].size,d[N-1].targets=d[N-1].targets.concat(d[N].targets),d[N-1].align=.5,d[N-1].pos+d[N-1].size>p&&(d[N-1].pos=p-d[N-1].size),d.splice(N,1),Z=!0)}return B.apply(b,T),N=0,d.some(de=>{let ke=0;return(de.targets||[]).some(()=>(b[N].pos=de.pos+ke,y!==void 0&&Math.abs(b[N].pos-b[N].target)>y?(b.slice(0,N+1).forEach(Ue=>delete Ue.pos),b.reducedLen=(b.reducedLen||p)-.1*p,b.reducedLen>.1*p&&P(b,p,y),!0):(ke+=b[N].size,N++,!1)))}),Dn(b,M),b};let Wr=u,{animate:su,animObject:al,stop:Eo}=Ln,{deg2rad:Ti,doc:ll,svg:ia,SVG_NS:Aa,win:au,isFirefox:Bh}=lt,{addEvent:Mp,attr:cl,createElement:lu,crisp:ul,css:dl,defined:Wi,erase:ir,extend:hl,fireEvent:cu,getAlignFactor:qr,isArray:Do,isFunction:jh,isNumber:uu,isObject:qi,isString:ac,merge:du,objectEach:Oo,pick:Ii,pInt:lc,pushUnique:Vh,replaceNested:ra,syncTimeout:ka,uniqueKey:hu}=Zt;class Cr{_defaultGetter(d){let p=Ii(this[d+"Value"],this[d],this.element?this.element.getAttribute(d):null,0);return/^-?[\d\.]+$/.test(p)&&(p=parseFloat(p)),p}_defaultSetter(d,p,y){y.setAttribute(p,d)}add(d){let p,y=this.renderer,b=this.element;return d&&(this.parentGroup=d),this.textStr!==void 0&&this.element.nodeName==="text"&&y.buildText(this),this.added=!0,(!d||d.handleZ||this.zIndex)&&(p=this.zIndexSetter()),p||(d?d.element:y.box).appendChild(b),this.onAdd&&this.onAdd(),this}addClass(d,p){let y=p?"":this.attr("class")||"";return(d=(d||"").split(/ /g).reduce(function(b,w){return y.indexOf(w)===-1&&b.push(w),b},y?[y]:[]).join(" "))!==y&&this.attr("class",d),this}afterSetters(){this.doTransform&&(this.updateTransform(),this.doTransform=!1)}align(d,p,y,b=!0){let w=this.renderer,M=w.alignedObjects,T=!!d;d?(this.alignOptions=d,this.alignByTranslate=p,this.alignTo=y):(d=this.alignOptions||{},p=this.alignByTranslate,y=this.alignTo);let S=!y||ac(y)?y||"renderer":void 0;S&&(T&&Vh(M,this),y=void 0);let O=Ii(y,w[S],w),B=(O.x||0)+(d.x||0)+((O.width||0)-(d.width||0))*qr(d.align),N=(O.y||0)+(d.y||0)+((O.height||0)-(d.height||0))*qr(d.verticalAlign),U={"text-align":d?.align};return U[p?"translateX":"x"]=Math.round(B),U[p?"translateY":"y"]=Math.round(N),b&&(this[this.placed?"animate":"attr"](U),this.placed=!0),this.alignAttr=U,this}alignSetter(d){let p={left:"start",center:"middle",right:"end"};p[d]&&(this.alignValue=d,this.element.setAttribute("text-anchor",p[d]))}animate(d,p,y){let b=al(Ii(p,this.renderer.globalAnimation,!0)),w=b.defer;return ll.hidden&&(b.duration=0),b.duration!==0?(y&&(b.complete=y),ka(()=>{this.element&&su(this,d,b)},w)):(this.attr(d,void 0,y||b.complete),Oo(d,function(M,T){b.step&&b.step.call(this,M,{prop:T,pos:1,elem:this})},this)),this}applyTextOutline(d){let p=this.element;d.indexOf("contrast")!==-1&&(d=d.replace(/contrast/g,this.renderer.getContrast(p.style.fill)));let y=d.split(" "),b=y[y.length-1],w=y[0];if(w&&w!=="none"&&lt.svg){this.fakeTS=!0,w=w.replace(/(^[\d\.]+)(.*?)$/g,function(B,N,U){return 2*Number(N)+U}),this.removeTextOutline();let M=ll.createElementNS(Aa,"tspan");cl(M,{class:"highcharts-text-outline",fill:b,stroke:b,"stroke-width":w,"stroke-linejoin":"round"});let T=p.querySelector("textPath")||p;[].forEach.call(T.childNodes,B=>{let N=B.cloneNode(!0);N.removeAttribute&&["fill","stroke","stroke-width","stroke"].forEach(U=>N.removeAttribute(U)),M.appendChild(N)});let S=0;[].forEach.call(T.querySelectorAll("text tspan"),B=>{S+=Number(B.getAttribute("dy"))});let O=ll.createElementNS(Aa,"tspan");O.textContent="\u200B",cl(O,{x:Number(p.getAttribute("x")),dy:-S}),M.appendChild(O),T.insertBefore(M,T.firstChild)}}attr(d,p,y,b){let{element:w}=this,M=Cr.symbolCustomAttribs,T,S,O=this,B;return typeof d=="string"&&p!==void 0&&(T=d,(d={})[T]=p),typeof d=="string"?O=(this[d+"Getter"]||this._defaultGetter).call(this,d,w):(Oo(d,function(N,U){B=!1,b||Eo(this,U),this.symbolName&&M.indexOf(U)!==-1&&(S||(this.symbolAttr(d),S=!0),B=!0),this.rotation&&(U==="x"||U==="y")&&(this.doTransform=!0),B||(this[U+"Setter"]||this._defaultSetter).call(this,N,U,w)},this),this.afterSetters()),y&&y.call(this),O}clip(d){if(d&&!d.clipPath){let p=hu()+"-",y=this.renderer.createElement("clipPath").attr({id:p}).add(this.renderer.defs);hl(d,{clipPath:y,id:p,count:0}),d.add(y)}return this.attr("clip-path",d?`url(${this.renderer.url}#${d.id})`:"none")}crisp(d,p){p=Math.round(p||d.strokeWidth||0);let y=d.x||this.x||0,b=d.y||this.y||0,w=(d.width||this.width||0)+y,M=(d.height||this.height||0)+b,T=ul(y,p),S=ul(b,p);return hl(d,{x:T,y:S,width:ul(w,p)-T,height:ul(M,p)-S}),Wi(d.strokeWidth)&&(d.strokeWidth=p),d}complexColor(d,p,y){let b=this.renderer,w,M,T,S,O,B,N,U,X,Z,te=[],ne;cu(this.renderer,"complexColor",{args:arguments},function(){if(d.radialGradient?M="radialGradient":d.linearGradient&&(M="linearGradient"),M){if(T=d[M],O=b.gradients,B=d.stops,X=y.radialReference,Do(T)&&(d[M]=T={x1:T[0],y1:T[1],x2:T[2],y2:T[3],gradientUnits:"userSpaceOnUse"}),M==="radialGradient"&&X&&!Wi(T.gradientUnits)&&(S=T,T=du(T,b.getRadialAttr(X,S),{gradientUnits:"userSpaceOnUse"})),Oo(T,function(J,ce){ce!=="id"&&te.push(ce,J)}),Oo(B,function(J){te.push(J)}),O[te=te.join(",")])Z=O[te].attr("id");else{T.id=Z=hu();let J=O[te]=b.createElement(M).attr(T).add(b.defs);J.radAttr=S,J.stops=[],B.forEach(function(ce){ce[1].indexOf("rgba")===0?(N=(w=re.parse(ce[1])).get("rgb"),U=w.get("a")):(N=ce[1],U=1);let de=b.createElement("stop").attr({offset:ce[0],"stop-color":N,"stop-opacity":U}).add(J);J.stops.push(de)})}ne="url("+b.url+"#"+Z+")",y.setAttribute(p,ne),y.gradient=te,d.toString=function(){return ne}}})}css(d){let p=this.styles,y={},b=this.element,w,M=!p;if(p&&Oo(d,function(T,S){p&&p[S]!==T&&(y[S]=T,M=!0)}),M){p&&(d=hl(p,y)),d.width===null||d.width==="auto"?delete this.textWidth:b.nodeName.toLowerCase()==="text"&&d.width&&(w=this.textWidth=lc(d.width)),hl(this.styles,d),w&&!ia&&this.renderer.forExport&&delete d.width;let T=Bh&&d.fontSize||null;T&&(uu(T)||/^\d+$/.test(T))&&(d.fontSize+="px");let S=du(d);b.namespaceURI===this.SVG_NS&&(["textOutline","textOverflow","whiteSpace","width"].forEach(O=>S&&delete S[O]),S.color&&(S.fill=S.color)),dl(b,S)}return this.added&&(this.element.nodeName==="text"&&this.renderer.buildText(this),d.textOutline&&this.applyTextOutline(d.textOutline)),this}dashstyleSetter(d){let p,y=this["stroke-width"];if(y==="inherit"&&(y=1),d=d&&d.toLowerCase()){let b=d.replace("shortdashdotdot","3,1,1,1,1,1,").replace("shortdashdot","3,1,1,1").replace("shortdot","1,1,").replace("shortdash","3,1,").replace("longdash","8,3,").replace(/dot/g,"1,3,").replace("dash","4,3,").replace(/,$/,"").split(",");for(p=b.length;p--;)b[p]=""+lc(b[p])*Ii(y,NaN);d=b.join(",").replace(/NaN/g,"none"),this.element.setAttribute("stroke-dasharray",d)}}destroy(){let d=this,p=d.element||{},y=d.renderer,b=p.ownerSVGElement,w=p.nodeName==="SPAN"&&d.parentGroup||void 0,M,T;if(p.onclick=p.onmouseout=p.onmouseover=p.onmousemove=p.point=null,Eo(d),d.clipPath&&b){let S=d.clipPath;[].forEach.call(b.querySelectorAll("[clip-path],[CLIP-PATH]"),function(O){O.getAttribute("clip-path").indexOf(S.element.id)>-1&&O.removeAttribute("clip-path")}),d.clipPath=S.destroy()}if(d.connector=d.connector?.destroy(),d.stops){for(T=0;T<d.stops.length;T++)d.stops[T].destroy();d.stops.length=0,d.stops=void 0}for(d.safeRemoveChild(p);w&&w.div&&w.div.childNodes.length===0;)M=w.parentGroup,d.safeRemoveChild(w.div),delete w.div,w=M;d.alignOptions&&ir(y.alignedObjects,d),Oo(d,function(S,O){d[O]&&d[O].parentGroup===d&&d[O].destroy&&d[O].destroy(),delete d[O]})}dSetter(d,p,y){Do(d)&&(typeof d[0]=="string"&&(d=this.renderer.pathToSegments(d)),this.pathArray=d,d=d.reduce((b,w,M)=>w&&w.join?(M?b+" ":"")+w.join(" "):(w||"").toString(),"")),/(NaN| {2}|^$)/.test(d)&&(d="M 0 0"),this[p]!==d&&(y.setAttribute(p,d),this[p]=d)}fillSetter(d,p,y){typeof d=="string"?y.setAttribute(p,d):d&&this.complexColor(d,p,y)}hrefSetter(d,p,y){y.setAttributeNS("http://www.w3.org/1999/xlink",p,d)}getBBox(d,p){let y,b,w,M,{alignValue:T,element:S,renderer:O,styles:B,textStr:N}=this,{cache:U,cacheKeys:X}=O,Z=S.namespaceURI===this.SVG_NS,te=Ii(p,this.rotation,0),ne=O.styledMode?S&&Cr.prototype.getStyle.call(S,"font-size"):B.fontSize;if(Wi(N)&&((M=N.toString()).indexOf("<")===-1&&(M=M.replace(/\d/g,"0")),M+=["",O.rootFontSize,ne,te,this.textWidth,T,B.lineClamp,B.textOverflow,B.fontWeight].join(",")),M&&!d&&(y=U[M]),!y||y.polygon){if(Z||O.forExport){try{w=this.fakeTS&&function(ce){let de=S.querySelector(".highcharts-text-outline");de&&dl(de,{display:ce})},jh(w)&&w("none"),y=S.getBBox?hl({},S.getBBox()):{width:S.offsetWidth,height:S.offsetHeight,x:0,y:0},jh(w)&&w("")}catch{}(!y||y.width<0)&&(y={x:0,y:0,width:0,height:0})}else y=this.htmlGetBBox();b=y.height,Z&&(y.height=b={"11px,17":14,"13px,20":16}[`${ne||""},${Math.round(b)}`]||b),te&&(y=this.getRotatedBox(y,te));let J={bBox:y};cu(this,"afterGetBBox",J),y=J.bBox}if(M&&(N===""||y.height>0)){for(;X.length>250;)delete U[X.shift()];U[M]||X.push(M),U[M]=y}return y}getRotatedBox(d,p){let{x:y,y:b,width:w,height:M}=d,{alignValue:T,translateY:S,rotationOriginX:O=0,rotationOriginY:B=0}=this,N=qr(T),U=Number(this.element.getAttribute("y")||0)-(S?0:b),X=p*Ti,Z=(p-90)*Ti,te=Math.cos(X),ne=Math.sin(X),J=w*te,ce=w*ne,de=Math.cos(Z),ke=Math.sin(Z),[[Ue,Le],[Se,ze]]=[O,B].map(an=>[an-an*te,an*ne]),nt=y+N*(w-J)+Ue+ze+U*de,rt=nt+J,pt=rt-M*de,Bt=pt-J,Lt=b+U-N*ce-Le+Se+U*ke,jt=Lt+ce,Yt=jt-M*ke,zt=Yt-ce,Sn=Math.min(nt,rt,pt,Bt),hn=Math.min(Lt,jt,Yt,zt),fn=Math.max(nt,rt,pt,Bt)-Sn,qn=Math.max(Lt,jt,Yt,zt)-hn;return{x:Sn,y:hn,width:fn,height:qn,polygon:[[nt,Lt],[rt,jt],[pt,Yt],[Bt,zt]]}}getStyle(d){return au.getComputedStyle(this.element||this,"").getPropertyValue(d)}hasClass(d){return(""+this.attr("class")).split(" ").indexOf(d)!==-1}hide(){return this.attr({visibility:"hidden"})}htmlGetBBox(){return{height:0,width:0,x:0,y:0}}constructor(d,p){this.onEvents={},this.opacity=1,this.SVG_NS=Aa,this.element=p==="span"||p==="body"?lu(p):ll.createElementNS(this.SVG_NS,p),this.renderer=d,this.styles={},cu(this,"afterInit")}on(d,p){let{onEvents:y}=this;return y[d]&&y[d](),y[d]=Mp(this.element,d,p),this}opacitySetter(d,p,y){let b=Number(Number(d).toFixed(3));this.opacity=b,y.setAttribute(p,b)}reAlign(){this.alignOptions?.width&&this.alignOptions.align!=="left"&&(this.alignOptions.width=this.getBBox().width,this.placed=!1,this.align())}removeClass(d){return this.attr("class",(""+this.attr("class")).replace(ac(d)?RegExp(`(^| )${d}( |$)`):d," ").replace(/ +/g," ").trim())}removeTextOutline(){let d=this.element.querySelector("tspan.highcharts-text-outline");d&&this.safeRemoveChild(d)}safeRemoveChild(d){let p=d.parentNode;p&&p.removeChild(d)}setRadialReference(d){let p=this.element.gradient&&this.renderer.gradients[this.element.gradient];return this.element.radialReference=d,p&&p.radAttr&&p.animate(this.renderer.getRadialAttr(d,p.radAttr)),this}shadow(d){let{renderer:p}=this,y=du(this.parentGroup?.rotation===90?{offsetX:-1,offsetY:-1}:{},qi(d)?d:{}),b=p.shadowDefinition(y);return this.attr({filter:d?`url(${p.url}#${b})`:"none"})}show(d=!0){return this.attr({visibility:d?"inherit":"visible"})}"stroke-widthSetter"(d,p,y){this[p]=d,y.setAttribute(p,d)}strokeWidth(){if(!this.renderer.styledMode)return this["stroke-width"]||0;let d=this.getStyle("stroke-width"),p=0,y;return/px$/.test(d)?p=lc(d):d!==""&&(cl(y=ll.createElementNS(Aa,"rect"),{width:d,"stroke-width":0}),this.element.parentNode.appendChild(y),p=y.getBBox().width,y.parentNode.removeChild(y)),p}symbolAttr(d){let p=this;Cr.symbolCustomAttribs.forEach(function(y){p[y]=Ii(d[y],p[y])}),p.attr({d:p.renderer.symbols[p.symbolName](p.x,p.y,p.width,p.height,p)})}textSetter(d){d!==this.textStr&&(delete this.textPxLength,this.textStr=d,this.added&&this.renderer.buildText(this),this.reAlign())}titleSetter(d){let p=this.element,y=p.getElementsByTagName("title")[0]||ll.createElementNS(this.SVG_NS,"title");p.insertBefore?p.insertBefore(y,p.firstChild):p.appendChild(y),y.textContent=ra(Ii(d,""),[/<[^>]*>/g,""]).replace(/&lt;/g,"<").replace(/&gt;/g,">")}toFront(){let d=this.element;return d.parentNode.appendChild(d),this}translate(d,p){return this.attr({translateX:d,translateY:p})}updateTransform(d="transform"){let{element:p,matrix:y,rotation:b=0,rotationOriginX:w,rotationOriginY:M,scaleX:T,scaleY:S,translateX:O=0,translateY:B=0}=this,N=["translate("+O+","+B+")"];Wi(y)&&N.push("matrix("+y.join(",")+")"),b&&(N.push("rotate("+b+" "+Ii(w,p.getAttribute("x"),0)+" "+Ii(M,p.getAttribute("y")||0)+")"),this.text?.element.tagName==="SPAN"&&this.text.attr({rotation:b,rotationOriginX:(w||0)-this.padding,rotationOriginY:(M||0)-this.padding})),(Wi(T)||Wi(S))&&N.push("scale("+Ii(T,1)+" "+Ii(S,1)+")"),N.length&&!(this.text||this).textPath&&p.setAttribute(d,N.join(" "))}visibilitySetter(d,p,y){d==="inherit"?y.removeAttribute(p):this[p]!==d&&y.setAttribute(p,d),this[p]=d}xGetter(d){return this.element.nodeName==="circle"&&(d==="x"?d="cx":d==="y"&&(d="cy")),this._defaultGetter(d)}zIndexSetter(d,p){let y=this.renderer,b=this.parentGroup,w=(b||y).element||y.box,M=this.element,T=w===y.box,S,O,B,N=!1,U,X=this.added,Z;if(Wi(d)?(M.setAttribute("data-z-index",d),d=+d,this[p]===d&&(X=!1)):Wi(this[p])&&M.removeAttribute("data-z-index"),this[p]=d,X){for((d=this.zIndex)&&b&&(b.handleZ=!0),Z=(S=w.childNodes).length-1;Z>=0&&!N;Z--)U=!Wi(B=(O=S[Z]).getAttribute("data-z-index")),O!==M&&(d<0&&U&&!T&&!Z?(w.insertBefore(M,S[Z]),N=!0):(lc(B)<=d||U&&(!Wi(d)||d>=0))&&(w.insertBefore(M,S[Z+1]),N=!0));N||(w.insertBefore(M,S[T?3:0]),N=!0)}return N}}Cr.symbolCustomAttribs=["anchorX","anchorY","clockwise","end","height","innerR","r","start","width","x","y"],Cr.prototype.strokeSetter=Cr.prototype.fillSetter,Cr.prototype.yGetter=Cr.prototype.xGetter,Cr.prototype.matrixSetter=Cr.prototype.rotationOriginXSetter=Cr.prototype.rotationOriginYSetter=Cr.prototype.rotationSetter=Cr.prototype.scaleXSetter=Cr.prototype.scaleYSetter=Cr.prototype.translateXSetter=Cr.prototype.translateYSetter=Cr.prototype.verticalAlignSetter=function(P,d){this[d]=P,this.doTransform=!0};let Lo=Cr,{defined:fl,extend:bs,getAlignFactor:vd,isNumber:es,merge:oa,pick:Ra,removeEvent:xs}=Zt;class ws extends Lo{constructor(d,p,y,b,w,M,T,S,O,B){let N;super(d,"g"),this.paddingLeftSetter=this.paddingSetter,this.paddingRightSetter=this.paddingSetter,this.doUpdate=!1,this.textStr=p,this.x=y,this.y=b,this.anchorX=M,this.anchorY=T,this.baseline=O,this.className=B,this.addClass(B==="button"?"highcharts-no-tooltip":"highcharts-label"),B&&this.addClass("highcharts-"+B),this.text=d.text(void 0,0,0,S).attr({zIndex:1}),typeof w=="string"&&((N=/^url\((.*?)\)$/.test(w))||this.renderer.symbols[w])&&(this.symbolKey=w),this.bBox=ws.emptyBBox,this.padding=3,this.baselineOffset=0,this.needsBox=d.styledMode||N,this.deferredAttr={},this.alignFactor=0}alignSetter(d){let p=vd(d);this.textAlign=d,p!==this.alignFactor&&(this.alignFactor=p,this.bBox&&es(this.xSetting)&&this.attr({x:this.xSetting}))}anchorXSetter(d,p){this.anchorX=d,this.boxAttr(p,Math.round(d)-this.getCrispAdjust()-this.xSetting)}anchorYSetter(d,p){this.anchorY=d,this.boxAttr(p,d-this.ySetting)}boxAttr(d,p){this.box?this.box.attr(d,p):this.deferredAttr[d]=p}css(d){if(d){let p={};d=oa(d),ws.textProps.forEach(y=>{d[y]!==void 0&&(p[y]=d[y],delete d[y])}),this.text.css(p),"fontSize"in p||"fontWeight"in p?this.updateTextPadding():("width"in p||"textOverflow"in p)&&this.updateBoxSize()}return Lo.prototype.css.call(this,d)}destroy(){xs(this.element,"mouseenter"),xs(this.element,"mouseleave"),this.text&&this.text.destroy(),this.box&&(this.box=this.box.destroy()),Lo.prototype.destroy.call(this)}fillSetter(d,p){d&&(this.needsBox=!0),this.fill=d,this.boxAttr(p,d)}getBBox(d,p){this.textStr&&this.bBox.width===0&&this.bBox.height===0&&this.updateBoxSize();let{padding:y,height:b=0,translateX:w=0,translateY:M=0,width:T=0}=this,S=Ra(this.paddingLeft,y),O=p??(this.rotation||0),B={width:T,height:b,x:w+this.bBox.x-S,y:M+this.bBox.y-y+this.baselineOffset};return O&&(B=this.getRotatedBox(B,O)),B}getCrispAdjust(){return(this.renderer.styledMode&&this.box?this.box.strokeWidth():this["stroke-width"]?parseInt(this["stroke-width"],10):0)%2/2}heightSetter(d){this.heightSetting=d,this.doUpdate=!0}afterSetters(){super.afterSetters(),this.doUpdate&&(this.updateBoxSize(),this.doUpdate=!1)}onAdd(){this.text.add(this),this.attr({text:Ra(this.textStr,""),x:this.x||0,y:this.y||0}),this.box&&fl(this.anchorX)&&this.attr({anchorX:this.anchorX,anchorY:this.anchorY})}paddingSetter(d,p){es(d)?d!==this[p]&&(this[p]=d,this.updateTextPadding()):this[p]=void 0}rSetter(d,p){this.boxAttr(p,d)}strokeSetter(d,p){this.stroke=d,this.boxAttr(p,d)}"stroke-widthSetter"(d,p){d&&(this.needsBox=!0),this["stroke-width"]=d,this.boxAttr(p,d)}"text-alignSetter"(d){this.textAlign=this["text-align"]=d,this.updateTextPadding()}textSetter(d){d!==void 0&&this.text.attr({text:d}),this.updateTextPadding(),this.reAlign()}updateBoxSize(){let d,p=this.text,y={},b=this.padding,w=this.bBox=(!es(this.widthSetting)||!es(this.heightSetting)||this.textAlign)&&fl(p.textStr)?p.getBBox(void 0,0):ws.emptyBBox;this.width=this.getPaddedWidth(),this.height=(this.heightSetting||w.height||0)+2*b;let M=this.renderer.fontMetrics(p);if(this.baselineOffset=b+Math.min((this.text.firstLineMetrics||M).b,w.height||1/0),this.heightSetting&&(this.baselineOffset+=(this.heightSetting-M.h)/2),this.needsBox&&!p.textPath){if(!this.box){let T=this.box=this.symbolKey?this.renderer.symbol(this.symbolKey):this.renderer.rect();T.addClass((this.className==="button"?"":"highcharts-label-box")+(this.className?" highcharts-"+this.className+"-box":"")),T.add(this)}d=this.getCrispAdjust(),y.x=d,y.y=(this.baseline?-this.baselineOffset:0)+d,y.width=Math.round(this.width),y.height=Math.round(this.height),this.box.attr(bs(y,this.deferredAttr)),this.deferredAttr={}}}updateTextPadding(){let d=this.text,p=d.styles.textAlign||this.textAlign;if(!d.textPath){this.updateBoxSize();let y=this.baseline?0:this.baselineOffset,b=(this.paddingLeft??this.padding)+vd(p)*(this.widthSetting??this.bBox.width);(b!==d.x||y!==d.y)&&(d.attr({align:p,x:b}),y!==void 0&&d.attr("y",y)),d.x=b,d.y=y}}widthSetter(d){this.widthSetting=es(d)?d:void 0,this.doUpdate=!0}getPaddedWidth(){let d=this.padding,p=Ra(this.paddingLeft,d),y=Ra(this.paddingRight,d);return(this.widthSetting||this.bBox.width||0)+p+y}xSetter(d){this.x=d,this.alignFactor&&(d-=this.alignFactor*this.getPaddedWidth(),this["forceAnimate:x"]=!0),this.xSetting=Math.round(d),this.attr("translateX",this.xSetting)}ySetter(d){this.ySetting=this.y=Math.round(d),this.attr("translateY",this.ySetting)}}ws.emptyBBox={width:0,height:0,x:0,y:0},ws.textProps=["color","direction","fontFamily","fontSize","fontStyle","fontWeight","lineClamp","lineHeight","textAlign","textDecoration","textOutline","textOverflow","whiteSpace","width"];let{defined:pl,isNumber:fu,pick:cc}=Zt;function pu(P,d,p,y,b){let w=[];if(b){let M=b.start||0,T=cc(b.r,p),S=cc(b.r,y||p),O=2e-4/(b.borderRadius?1:Math.max(T,1)),B=Math.abs((b.end||0)-M-2*Math.PI)<O,N=(b.end||0)-(B?O:0),U=b.innerR,X=cc(b.open,B),Z=Math.cos(M),te=Math.sin(M),ne=Math.cos(N),J=Math.sin(N),ce=cc(b.longArc,N-M-Math.PI<O?0:1),de=["A",T,S,0,ce,cc(b.clockwise,1),P+T*ne,d+S*J];de.params={start:M,end:N,cx:P,cy:d},w.push(["M",P+T*Z,d+S*te],de),pl(U)&&((de=["A",U,U,0,ce,pl(b.clockwise)?1-b.clockwise:0,P+U*Z,d+U*te]).params={start:N,end:M,cx:P,cy:d},w.push(X?["M",P+U*ne,d+U*J]:["L",P+U*ne,d+U*J],de)),X||w.push(["Z"])}return w}function bd(P,d,p,y,b){return b&&b.r?mu(P,d,p,y,b):[["M",P,d],["L",P+p,d],["L",P+p,d+y],["L",P,d+y],["Z"]]}function mu(P,d,p,y,b){let w=b?.r||0;return[["M",P+w,d],["L",P+p-w,d],["A",w,w,0,0,1,P+p,d+w],["L",P+p,d+y-w],["A",w,w,0,0,1,P+p-w,d+y],["L",P+w,d+y],["A",w,w,0,0,1,P,d+y-w],["L",P,d+w],["A",w,w,0,0,1,P+w,d],["Z"]]}let ml={arc:pu,callout:function(P,d,p,y,b){let w=Math.min(b&&b.r||0,p,y),M=w+6,T=b&&b.anchorX,S=b&&b.anchorY||0,O=mu(P,d,p,y,{r:w});if(!fu(T)||T<p&&T>0&&S<y&&S>0)return O;if(P+T>p-M)if(S>d+M&&S<d+y-M)O.splice(3,1,["L",P+p,S-6],["L",P+p+6,S],["L",P+p,S+6],["L",P+p,d+y-w]);else if(T<p){let B=S<d+M,N=B?d:d+y;O.splice(B?2:5,0,["L",T,S],["L",P+p-w,N])}else O.splice(3,1,["L",P+p,y/2],["L",T,S],["L",P+p,y/2],["L",P+p,d+y-w]);else if(P+T<M)if(S>d+M&&S<d+y-M)O.splice(7,1,["L",P,S+6],["L",P-6,S],["L",P,S-6],["L",P,d+w]);else if(T>0){let B=S<d+M,N=B?d:d+y;O.splice(B?1:6,0,["L",T,S],["L",P+w,N])}else O.splice(7,1,["L",P,y/2],["L",T,S],["L",P,y/2],["L",P,d+w]);else S>y&&T<p-M?O.splice(5,1,["L",T+6,d+y],["L",T,d+y+6],["L",T-6,d+y],["L",P+w,d+y]):S<0&&T>M&&O.splice(1,1,["L",T-6,d],["L",T,d-6],["L",T+6,d],["L",p-w,d]);return O},circle:function(P,d,p,y){return pu(P+p/2,d+y/2,p/2,y/2,{start:.5*Math.PI,end:2.5*Math.PI,open:!1})},diamond:function(P,d,p,y){return[["M",P+p/2,d],["L",P+p,d+y/2],["L",P+p/2,d+y],["L",P,d+y/2],["Z"]]},rect:bd,roundedRect:mu,square:bd,triangle:function(P,d,p,y){return[["M",P+p/2,d],["L",P+p,d+y],["L",P,d+y],["Z"]]},"triangle-down":function(P,d,p,y){return[["M",P,d],["L",P+p,d],["L",P+p/2,d+y],["Z"]]}},{doc:Kn,SVG_NS:Qg,win:xd}=lt,{attr:wd,extend:Uh,fireEvent:Tp,isString:$h,objectEach:uc,pick:Cd}=Zt,Pa=(P,d)=>P.substring(0,d)+"\u2026",sa=class{constructor(P){let d=P.styles;this.renderer=P.renderer,this.svgElement=P,this.width=P.textWidth,this.textLineHeight=d&&d.lineHeight,this.textOutline=d&&d.textOutline,this.ellipsis=!!(d&&d.textOverflow==="ellipsis"),this.lineClamp=d?.lineClamp,this.noWrap=!!(d&&d.whiteSpace==="nowrap")}buildSVG(){let P=this.svgElement,d=P.element,p=P.renderer,y=Cd(P.textStr,"").toString(),b=y.indexOf("<")!==-1,w=d.childNodes,M=!P.added&&p.box,T=[y,this.ellipsis,this.noWrap,this.textLineHeight,this.textOutline,P.getStyle("font-size"),P.styles.lineClamp,this.width].join(",");if(T!==P.textCache){P.textCache=T,delete P.actualWidth;for(let S=w.length;S--;)d.removeChild(w[S]);if(b||this.ellipsis||this.width||P.textPath||y.indexOf(" ")!==-1&&(!this.noWrap||/<br.*?>/g.test(y))){if(y!==""){M&&M.appendChild(d);let S=new bi(y);this.modifyTree(S.nodes),S.addToDOM(d),this.modifyDOM(),this.ellipsis&&(d.textContent||"").indexOf("\u2026")!==-1&&P.attr("title",this.unescapeEntities(P.textStr||"",["&lt;","&gt;"])),M&&M.removeChild(d)}}else d.appendChild(Kn.createTextNode(this.unescapeEntities(y)));$h(this.textOutline)&&P.applyTextOutline&&P.applyTextOutline(this.textOutline)}}modifyDOM(){let P,d=this.svgElement,p=wd(d.element,"x");for(d.firstLineMetrics=void 0;(P=d.element.firstChild)&&/^[\s\u200B]*$/.test(P.textContent||" ");)d.element.removeChild(P);[].forEach.call(d.element.querySelectorAll("tspan.highcharts-br"),(M,T)=>{M.nextSibling&&M.previousSibling&&(T===0&&M.previousSibling.nodeType===1&&(d.firstLineMetrics=d.renderer.fontMetrics(M.previousSibling)),wd(M,{dy:this.getLineHeight(M.nextSibling),x:p}))});let y=this.width||0;if(!y)return;let b=(M,T)=>{let S=M.textContent||"",O=S.replace(/([^\^])-/g,"$1- ").split(" "),B=!this.noWrap&&(O.length>1||d.element.childNodes.length>1),N=this.getLineHeight(T),U=Math.max(0,y-.8*N),X=0,Z=d.actualWidth;if(B){let te=[],ne=[];for(;T.firstChild&&T.firstChild!==M;)ne.push(T.firstChild),T.removeChild(T.firstChild);for(;O.length;)if(O.length&&!this.noWrap&&X>0&&(te.push(M.textContent||""),M.textContent=O.join(" ").replace(/- /g,"-")),this.truncate(M,void 0,O,X===0&&Z||0,y,U,(J,ce)=>O.slice(0,ce).join(" ").replace(/- /g,"-")),Z=d.actualWidth,X++,this.lineClamp&&X>=this.lineClamp){O.length&&(this.truncate(M,M.textContent||"",void 0,0,y,U,Pa),M.textContent=M.textContent?.replace("\u2026","")+"\u2026");break}ne.forEach(J=>{T.insertBefore(J,M)}),te.forEach(J=>{T.insertBefore(Kn.createTextNode(J),M);let ce=Kn.createElementNS(Qg,"tspan");ce.textContent="\u200B",wd(ce,{dy:N,x:p}),T.insertBefore(ce,M)})}else this.ellipsis&&S&&this.truncate(M,S,void 0,0,y,U,Pa)},w=M=>{[].slice.call(M.childNodes).forEach(T=>{T.nodeType===xd.Node.TEXT_NODE?b(T,M):(T.className.baseVal.indexOf("highcharts-br")!==-1&&(d.actualWidth=0),w(T))})};w(d.element)}getLineHeight(P){let d=P.nodeType===xd.Node.TEXT_NODE?P.parentElement:P;return this.textLineHeight?parseInt(this.textLineHeight.toString(),10):this.renderer.fontMetrics(d||this.svgElement.element).h}modifyTree(P){let d=(p,y)=>{let{attributes:b={},children:w,style:M={},tagName:T}=p,S=this.renderer.styledMode;if(T==="b"||T==="strong"?S?b.class="highcharts-strong":M.fontWeight="bold":(T==="i"||T==="em")&&(S?b.class="highcharts-emphasized":M.fontStyle="italic"),M&&M.color&&(M.fill=M.color),T==="br"){b.class="highcharts-br",p.textContent="\u200B";let O=P[y+1];O&&O.textContent&&(O.textContent=O.textContent.replace(/^ +/gm,""))}else T==="a"&&w&&w.some(O=>O.tagName==="#text")&&(p.children=[{children:w,tagName:"tspan"}]);T!=="#text"&&T!=="a"&&(p.tagName="tspan"),Uh(p,{attributes:b,style:M}),w&&w.filter(O=>O.tagName!=="#text").forEach(d)};P.forEach(d),Tp(this.svgElement,"afterModifyTree",{nodes:P})}truncate(P,d,p,y,b,w,M){let T,S,O=this.svgElement,{rotation:B}=O,N=[],U=p&&!y?1:0,X=(d||p||"").length,Z=X;p||(b=w);let te=function(ne,J){let ce=J||ne,de=P.parentNode;if(de&&N[ce]===void 0&&de.getSubStringLength)try{N[ce]=y+de.getSubStringLength(0,p?ce+1:ce)}catch{}return N[ce]};if(O.rotation=0,y+(S=te(P.textContent.length))>b){for(;U<=X;)Z=Math.ceil((U+X)/2),p&&(T=M(p,Z)),S=te(Z,T&&T.length-1),U===X?U=X+1:S>b?X=Z-1:U=Z;X===0?P.textContent="":d&&X===d.length-1||(P.textContent=T||M(d||p,Z)),this.ellipsis&&S>b&&this.truncate(P,P.textContent||"",void 0,0,b,w,Pa)}p&&p.splice(0,Z),O.actualWidth=S,O.rotation=B}unescapeEntities(P,d){return uc(this.renderer.escapes,function(p,y){d&&d.indexOf(p)!==-1||(P=P.toString().replace(RegExp(p,"g"),y))}),P}},{defaultOptions:gl}=Sr,{charts:Ed,deg2rad:Hh,doc:Cs,isFirefox:Dd,isMS:Md,isWebKit:Td,noop:Id,SVG_NS:Gh,symbolSizes:Fn,win:yl}=lt,{addEvent:gu,attr:dc,createElement:Ip,crisp:Oa,css:hc,defined:_l,destroyObjectProperties:Jg,extend:vl,isArray:Wh,isNumber:bl,isObject:xl,isString:Sd,merge:Ad,pick:kd,pInt:ey,replaceNested:yu,uniqueKey:fc}=Zt;class pc{constructor(d,p,y,b,w,M,T){let S,O,B=this.createElement("svg").attr({version:"1.1",class:"highcharts-root"}),N=B.element;T||B.css(this.getStyle(b||{})),d.appendChild(N),dc(d,"dir","ltr"),d.innerHTML.indexOf("xmlns")===-1&&dc(N,"xmlns",this.SVG_NS),this.box=N,this.boxWrapper=B,this.alignedObjects=[],this.url=this.getReferenceURL(),this.createElement("desc").add().element.appendChild(Cs.createTextNode("Created with Highcharts 12.1.2")),this.defs=this.createElement("defs").add(),this.allowHTML=M,this.forExport=w,this.styledMode=T,this.gradients={},this.cache={},this.cacheKeys=[],this.imgCount=0,this.rootFontSize=B.getStyle("font-size"),this.setSize(p,y,!1),Dd&&d.getBoundingClientRect&&((S=function(){hc(d,{left:0,top:0}),O=d.getBoundingClientRect(),hc(d,{left:Math.ceil(O.left)-O.left+"px",top:Math.ceil(O.top)-O.top+"px"})})(),this.unSubPixelFix=gu(yl,"resize",S))}definition(d){return new bi([d]).addToDOM(this.defs.element)}getReferenceURL(){if((Dd||Td)&&Cs.getElementsByTagName("base").length){if(!_l(r)){let d=fc(),p=new bi([{tagName:"svg",attributes:{width:8,height:8},children:[{tagName:"defs",children:[{tagName:"clipPath",attributes:{id:d},children:[{tagName:"rect",attributes:{width:4,height:4}}]}]},{tagName:"rect",attributes:{id:"hitme",width:8,height:8,"clip-path":`url(#${d})`,fill:"rgba(0,0,0,0.001)"}}]}]).addToDOM(Cs.body);hc(p,{position:"fixed",top:0,left:0,zIndex:9e5});let y=Cs.elementFromPoint(6,6);r=(y&&y.id)==="hitme",Cs.body.removeChild(p)}if(r)return yu(yl.location.href.split("#")[0],[/<[^>]*>/g,""],[/([\('\)])/g,"\\$1"],[/ /g,"%20"])}return""}getStyle(d){return this.style=vl({fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", sans-serif',fontSize:"1rem"},d),this.style}setStyle(d){this.boxWrapper.css(this.getStyle(d))}isHidden(){return!this.boxWrapper.getBBox().width}destroy(){let d=this.defs;return this.box=null,this.boxWrapper=this.boxWrapper.destroy(),Jg(this.gradients||{}),this.gradients=null,this.defs=d.destroy(),this.unSubPixelFix&&this.unSubPixelFix(),this.alignedObjects=null,null}createElement(d){return new this.Element(this,d)}getRadialAttr(d,p){return{cx:d[0]-d[2]/2+(p.cx||0)*d[2],cy:d[1]-d[2]/2+(p.cy||0)*d[2],r:(p.r||0)*d[2]}}shadowDefinition(d){let p=[`highcharts-drop-shadow-${this.chartIndex}`,...Object.keys(d).map(b=>`${b}-${d[b]}`)].join("-").toLowerCase().replace(/[^a-z\d\-]/g,""),y=Ad({color:"#000000",offsetX:1,offsetY:1,opacity:.15,width:5},d);return this.defs.element.querySelector(`#${p}`)||this.definition({tagName:"filter",attributes:{id:p,filterUnits:y.filterUnits},children:this.getShadowFilterContent(y)}),p}getShadowFilterContent(d){return[{tagName:"feDropShadow",attributes:{dx:d.offsetX,dy:d.offsetY,"flood-color":d.color,"flood-opacity":Math.min(5*d.opacity,1),stdDeviation:d.width/2}}]}buildText(d){new sa(d).buildSVG()}getContrast(d){let p=re.parse(d).rgba.map(b=>{let w=b/255;return w<=.03928?w/12.92:Math.pow((w+.055)/1.055,2.4)}),y=.2126*p[0]+.7152*p[1]+.0722*p[2];return 1.05/(y+.05)>(y+.05)/.05?"#FFFFFF":"#000000"}button(d,p,y,b,w={},M,T,S,O,B){let N=this.label(d,p,y,O,void 0,void 0,B,void 0,"button"),U=this.styledMode,X=arguments,Z=0;w=Ad(gl.global.buttonTheme,w),U&&(delete w.fill,delete w.stroke,delete w["stroke-width"]);let te=w.states||{},ne=w.style||{};delete w.states,delete w.style;let J=[bi.filterUserAttributes(w)],ce=[ne];return U||["hover","select","disabled"].forEach((de,ke)=>{J.push(Ad(J[0],bi.filterUserAttributes(X[ke+5]||te[de]||{}))),ce.push(J[ke+1].style),delete J[ke+1].style}),gu(N.element,Md?"mouseover":"mouseenter",function(){Z!==3&&N.setState(1)}),gu(N.element,Md?"mouseout":"mouseleave",function(){Z!==3&&N.setState(Z)}),N.setState=(de=0)=>{if(de!==1&&(N.state=Z=de),N.removeClass(/highcharts-button-(normal|hover|pressed|disabled)/).addClass("highcharts-button-"+["normal","hover","pressed","disabled"][de]),!U){N.attr(J[de]);let ke=ce[de];xl(ke)&&N.css(ke)}},N.attr(J[0]),!U&&(N.css(vl({cursor:"default"},ne)),B&&N.text.css({pointerEvents:"none"})),N.on("touchstart",de=>de.stopPropagation()).on("click",function(de){Z!==3&&b.call(N,de)})}crispLine(d,p){let[y,b]=d;return _l(y[1])&&y[1]===b[1]&&(y[1]=b[1]=Oa(y[1],p)),_l(y[2])&&y[2]===b[2]&&(y[2]=b[2]=Oa(y[2],p)),d}path(d){let p=this.styledMode?{}:{fill:"none"};return Wh(d)?p.d=d:xl(d)&&vl(p,d),this.createElement("path").attr(p)}circle(d,p,y){let b=xl(d)?d:d===void 0?{}:{x:d,y:p,r:y},w=this.createElement("circle");return w.xSetter=w.ySetter=function(M,T,S){S.setAttribute("c"+T,M)},w.attr(b)}arc(d,p,y,b,w,M){let T;xl(d)?(p=(T=d).y,y=T.r,b=T.innerR,w=T.start,M=T.end,d=T.x):T={innerR:b,start:w,end:M};let S=this.symbol("arc",d,p,y,y,T);return S.r=y,S}rect(d,p,y,b,w,M){let T=xl(d)?d:d===void 0?{}:{x:d,y:p,r:w,width:Math.max(y||0,0),height:Math.max(b||0,0)},S=this.createElement("rect");return this.styledMode||(M!==void 0&&(T["stroke-width"]=M,vl(T,S.crisp(T))),T.fill="none"),S.rSetter=function(O,B,N){S.r=O,dc(N,{rx:O,ry:O})},S.rGetter=function(){return S.r||0},S.attr(T)}roundedRect(d){return this.symbol("roundedRect").attr(d)}setSize(d,p,y){this.width=d,this.height=p,this.boxWrapper.animate({width:d,height:p},{step:function(){this.attr({viewBox:"0 0 "+this.attr("width")+" "+this.attr("height")})},duration:kd(y,!0)?void 0:0}),this.alignElements()}g(d){let p=this.createElement("g");return d?p.attr({class:"highcharts-"+d}):p}image(d,p,y,b,w,M){let T={preserveAspectRatio:"none"};bl(p)&&(T.x=p),bl(y)&&(T.y=y),bl(b)&&(T.width=b),bl(w)&&(T.height=w);let S=this.createElement("image").attr(T),O=function(B){S.attr({href:d}),M.call(S,B)};if(M){S.attr({href:"data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="});let B=new yl.Image;gu(B,"load",O),B.src=d,B.complete&&O({})}else S.attr({href:d});return S}symbol(d,p,y,b,w,M){let T,S,O,B,N=this,U=/^url\((.*?)\)$/,X=U.test(d),Z=!X&&(this.symbols[d]?d:"circle"),te=Z&&this.symbols[Z];if(te)typeof p=="number"&&(S=te.call(this.symbols,p||0,y||0,b||0,w||0,M)),T=this.path(S),N.styledMode||T.attr("fill","none"),vl(T,{symbolName:Z||void 0,x:p,y,width:b,height:w}),M&&vl(T,M);else if(X){O=d.match(U)[1];let ne=T=this.image(O);ne.imgwidth=kd(M&&M.width,Fn[O]&&Fn[O].width),ne.imgheight=kd(M&&M.height,Fn[O]&&Fn[O].height),B=J=>J.attr({width:J.width,height:J.height}),["width","height"].forEach(J=>{ne[`${J}Setter`]=function(ce,de){this[de]=ce;let{alignByTranslate:ke,element:Ue,width:Le,height:Se,imgwidth:ze,imgheight:nt}=this,rt=de==="width"?ze:nt,pt=1;M&&M.backgroundSize==="within"&&Le&&Se&&ze&&nt?(pt=Math.min(Le/ze,Se/nt),dc(Ue,{width:Math.round(ze*pt),height:Math.round(nt*pt)})):Ue&&rt&&Ue.setAttribute(de,rt),!ke&&ze&&nt&&this.translate(((Le||0)-ze*pt)/2,((Se||0)-nt*pt)/2)}}),_l(p)&&ne.attr({x:p,y}),ne.isImg=!0,ne.symbolUrl=d,_l(ne.imgwidth)&&_l(ne.imgheight)?B(ne):(ne.attr({width:0,height:0}),Ip("img",{onload:function(){let J=Ed[N.chartIndex];this.width===0&&(hc(this,{position:"absolute",top:"-999em"}),Cs.body.appendChild(this)),Fn[O]={width:this.width,height:this.height},ne.imgwidth=this.width,ne.imgheight=this.height,ne.element&&B(ne),this.parentNode&&this.parentNode.removeChild(this),N.imgCount--,N.imgCount||!J||J.hasLoaded||J.onload()},src:O}),this.imgCount++)}return T}clipRect(d,p,y,b){return this.rect(d,p,y,b,0)}text(d,p,y,b){let w={};if(b&&(this.allowHTML||!this.forExport))return this.html(d,p,y);w.x=Math.round(p||0),y&&(w.y=Math.round(y)),_l(d)&&(w.text=d);let M=this.createElement("text").attr(w);return b&&(!this.forExport||this.allowHTML)||(M.xSetter=function(T,S,O){let B=O.getElementsByTagName("tspan"),N=O.getAttribute(S);for(let U=0,X;U<B.length;U++)(X=B[U]).getAttribute(S)===N&&X.setAttribute(S,T);O.setAttribute(S,T)}),M}fontMetrics(d){let p=ey(Lo.prototype.getStyle.call(d,"font-size")||0),y=p<24?p+3:Math.round(1.2*p),b=Math.round(.8*y);return{h:y,b,f:p}}rotCorr(d,p,y){let b=d;return p&&y&&(b=Math.max(b*Math.cos(p*Hh),4)),{x:-d/3*Math.sin(p*Hh),y:b}}pathToSegments(d){let p=[],y=[],b={A:8,C:7,H:2,L:3,M:3,Q:5,S:5,T:3,V:2};for(let w=0;w<d.length;w++)Sd(y[0])&&bl(d[w])&&y.length===b[y[0].toUpperCase()]&&d.splice(w,0,y[0].replace("M","L").replace("m","l")),typeof d[w]=="string"&&(y.length&&p.push(y.slice(0)),y.length=0),y.push(d[w]);return p.push(y.slice(0)),p}label(d,p,y,b,w,M,T,S,O){return new ws(this,d,p,y,b,w,M,T,S,O)}alignElements(){this.alignedObjects.forEach(d=>d.align())}}vl(pc.prototype,{Element:Lo,SVG_NS:Gh,escapes:{"&":"&amp;","<":"&lt;",">":"&gt;","'":"&#39;",'"':"&quot;"},symbols:ml,draw:Id}),En.registerRendererType("svg",pc,!0);let{composed:_u}=lt,{attr:qh,css:io,createElement:Rd,defined:Pd,extend:Od,getAlignFactor:Sp,isNumber:Zh,pInt:ty,pushUnique:Xh}=Zt;function vu(P,d,p){let y=this.div?.style||p.style;Lo.prototype[`${d}Setter`].call(this,P,d,p),y&&(y[d]=P)}let bu=(P,d)=>{if(!P.div){let p=qh(P.element,"class"),y=P.css,b=Rd("div",p?{className:p}:void 0,Cn(ut({position:"absolute",left:`${P.translateX||0}px`,top:`${P.translateY||0}px`},P.styles),{display:P.display,opacity:P.opacity,visibility:P.visibility}),P.parentGroup?.div||d);P.classSetter=(w,M,T)=>{T.setAttribute("class",w),b.className=w},P.translateXSetter=P.translateYSetter=(w,M)=>{P[M]=w,b.style[M==="translateX"?"left":"top"]=`${w}px`,P.doTransform=!0},P.opacitySetter=P.visibilitySetter=vu,P.css=w=>(y.call(P,w),w.cursor&&(b.style.cursor=w.cursor),w.pointerEvents&&(b.style.pointerEvents=w.pointerEvents),P),P.on=function(){return Lo.prototype.on.apply({element:b,onEvents:P.onEvents},arguments),P},P.div=b}return P.div};class mc extends Lo{static compose(d){Xh(_u,this.compose)&&(d.prototype.html=function(p,y,b){return new mc(this,"span").attr({text:p,x:Math.round(y),y:Math.round(b)})})}constructor(d,p){super(d,p),this.css(ut({position:"absolute"},d.styledMode?{}:{fontFamily:d.style.fontFamily,fontSize:d.style.fontSize}))}getSpanCorrection(d,p,y){this.xCorr=-d*y,this.yCorr=-p}css(d){let p,{element:y}=this,b=y.tagName==="SPAN"&&d&&"width"in d,w=b&&d.width;return b&&(delete d.width,this.textWidth=ty(w)||void 0,p=!0),d?.textOverflow==="ellipsis"&&(d.overflow="hidden"),d?.lineClamp&&(d.display="-webkit-box",d.WebkitLineClamp=d.lineClamp,d.WebkitBoxOrient="vertical",d.overflow="hidden"),Zh(Number(d?.fontSize))&&(d.fontSize=d.fontSize+"px"),Od(this.styles,d),io(y,d),p&&this.updateTransform(),this}htmlGetBBox(){let{element:d}=this;return{x:d.offsetLeft,y:d.offsetTop,width:d.offsetWidth,height:d.offsetHeight}}updateTransform(){if(!this.added){this.alignOnAdd=!0;return}let{element:d,renderer:p,rotation:y,rotationOriginX:b,rotationOriginY:w,scaleX:M,scaleY:T,styles:S,textAlign:O="left",textWidth:B,translateX:N=0,translateY:U=0,x:X=0,y:Z=0}=this,{display:te="block",whiteSpace:ne}=S;if(io(d,{marginLeft:`${N}px`,marginTop:`${U}px`}),d.tagName==="SPAN"){let J,ce=[y,O,d.innerHTML,B,this.textAlign].join(","),de=-(this.parentGroup?.padding*1)||0;if(B!==this.oldTextWidth){let Se=this.textPxLength?this.textPxLength:(io(d,{width:"",whiteSpace:ne||"nowrap"}),d.offsetWidth),ze=B||0;(ze>this.oldTextWidth||Se>ze)&&(/[ \-]/.test(d.textContent||d.innerText)||d.style.textOverflow==="ellipsis")&&(io(d,{width:Se>ze||y||M?B+"px":"auto",display:te,whiteSpace:ne||"normal"}),this.oldTextWidth=B)}ce!==this.cTT&&(J=p.fontMetrics(d).b,Pd(y)&&(y!==(this.oldRotation||0)||O!==this.oldAlign)&&this.setSpanRotation(y,de,de),this.getSpanCorrection(!Pd(y)&&!this.textWidth&&this.textPxLength||d.offsetWidth,J,Sp(O)));let{xCorr:ke=0,yCorr:Ue=0}=this,Le={left:`${X+ke}px`,top:`${Z+Ue}px`,textAlign:O,transformOrigin:`${(b??X)-ke-X-de}px ${(w??Z)-Ue-Z-de}px`};(M||T)&&(Le.transform=`scale(${M??1},${T??1})`),io(d,Le),this.cTT=ce,this.oldRotation=y,this.oldAlign=O}}setSpanRotation(d,p,y){io(this.element,{transform:`rotate(${d}deg)`,transformOrigin:`${p}% ${y}px`})}add(d){let p,y=this.renderer.box.parentNode,b=[];if(this.parentGroup=d,d&&!(p=d.div)){let w=d;for(;w;)b.push(w),w=w.parentGroup;for(let M of b.reverse())p=bu(M,y)}return(p||y).appendChild(this.element),this.added=!0,this.alignOnAdd&&this.updateTransform(),this}textSetter(d){d!==this.textStr&&(delete this.bBox,delete this.oldTextWidth,bi.setElementHTML(this.element,d??""),this.textStr=d,this.doTransform=!0)}alignSetter(d){this.alignValue=this.textAlign=d,this.doTransform=!0}xSetter(d,p){this[p]=d,this.doTransform=!0}}let aa=mc.prototype;aa.visibilitySetter=aa.opacitySetter=vu,aa.ySetter=aa.rotationSetter=aa.rotationOriginXSetter=aa.rotationOriginYSetter=aa.xSetter,function(P){P.xAxis={alignTicks:!0,allowDecimals:void 0,panningEnabled:!0,zIndex:2,zoomEnabled:!0,dateTimeLabelFormats:{millisecond:{main:"%[HMSL]",range:!1},second:{main:"%[HMS]",range:!1},minute:{main:"%[HM]",range:!1},hour:{main:"%[HM]",range:!1},day:{main:"%[eb]"},week:{main:"%[eb]"},month:{main:"%[bY]"},year:{main:"%Y"}},endOnTick:!1,gridLineDashStyle:"Solid",gridZIndex:1,labels:{autoRotationLimit:80,distance:15,enabled:!0,indentation:10,overflow:"justify",reserveSpace:void 0,rotation:void 0,staggerLines:0,step:0,useHTML:!1,zIndex:7,style:{color:"#333333",cursor:"default",fontSize:"0.8em",textOverflow:"ellipsis"}},maxPadding:.01,minorGridLineDashStyle:"Solid",minorTickLength:2,minorTickPosition:"outside",minorTicksPerMajor:5,minPadding:.01,offset:void 0,reversed:void 0,reversedStacks:!1,showEmpty:!0,showFirstLabel:!0,showLastLabel:!0,startOfWeek:1,startOnTick:!1,tickLength:10,tickPixelInterval:100,tickmarkPlacement:"between",tickPosition:"outside",title:{align:"middle",useHTML:!1,x:0,y:0,style:{color:"#666666",fontSize:"0.8em"}},visible:!0,minorGridLineColor:"#f2f2f2",minorGridLineWidth:1,minorTickColor:"#999999",lineColor:"#333333",lineWidth:1,gridLineColor:"#e6e6e6",gridLineWidth:void 0,tickColor:"#333333"},P.yAxis={reversedStacks:!0,endOnTick:!0,maxPadding:.05,minPadding:.05,tickPixelInterval:72,showLastLabel:!0,labels:{x:void 0},startOnTick:!0,title:{text:"Values"},stackLabels:{animation:{},allowOverlap:!1,enabled:!1,crop:!0,overflow:"justify",formatter:function(){let{numberFormatter:d}=this.axis.chart;return d(this.total||0,-1)},style:{color:"#000000",fontSize:"0.7em",fontWeight:"bold",textOutline:"1px contrast"}},gridLineWidth:1,lineWidth:0}}(i||(i={}));let ny=i,{addEvent:Yh,isFunction:Ap,objectEach:xu,removeEvent:kp}=Zt;(E||(E={})).registerEventOptions=function(P,d){P.eventOptions=P.eventOptions||{},xu(d.events,function(p,y){P.eventOptions[y]!==p&&(P.eventOptions[y]&&(kp(P,y,P.eventOptions[y]),delete P.eventOptions[y]),Ap(p)&&(P.eventOptions[y]=p,Yh(P,y,p,{order:0})))})};let wl=E,{deg2rad:Ld}=lt,{clamp:gc,correctFloat:Fd,defined:Kh,destroyObjectProperties:iy,extend:Rp,fireEvent:wu,getAlignFactor:Pp,isNumber:Cl,merge:yc,objectEach:Op,pick:Fo}=Zt,uo=class{constructor(P,d,p,y,b){this.isNew=!0,this.isNewLabel=!0,this.axis=P,this.pos=d,this.type=p||"",this.parameters=b||{},this.tickmarkOffset=this.parameters.tickmarkOffset,this.options=this.parameters.options,wu(this,"init"),p||y||this.addLabel()}addLabel(){let P=this,d=P.axis,p=d.options,y=d.chart,b=d.categories,w=d.logarithmic,M=d.names,T=P.pos,S=Fo(P.options&&P.options.labels,p.labels),O=d.tickPositions,B=T===O[0],N=T===O[O.length-1],U=(!S.step||S.step===1)&&d.tickInterval===1,X=O.info,Z=P.label,te,ne,J,ce=this.parameters.category||(b?Fo(b[T],M[T],T):T);w&&Cl(ce)&&(ce=Fd(w.lin2log(ce))),d.dateTime&&(X?te=(ne=y.time.resolveDTLFormat(p.dateTimeLabelFormats[!p.grid&&X.higherRanks[T]||X.unitName])).main:Cl(ce)&&(te=d.dateTime.getXDateFormat(ce,p.dateTimeLabelFormats||{}))),P.isFirst=B,P.isLast=N;let de={axis:d,chart:y,dateTimeLabelFormat:te,isFirst:B,isLast:N,pos:T,tick:P,tickPositionInfo:X,value:ce};wu(this,"labelFormat",de);let ke=Se=>S.formatter?S.formatter.call(Se,Se):S.format?(Se.text=d.defaultLabelFormatter.call(Se),Mt.format(S.format,Se,y)):d.defaultLabelFormatter.call(Se),Ue=ke.call(de,de),Le=ne&&ne.list;Le?P.shortenLabel=function(){for(J=0;J<Le.length;J++)if(Rp(de,{dateTimeLabelFormat:Le[J]}),Z.attr({text:ke.call(de,de)}),Z.getBBox().width<d.getSlotWidth(P)-2*(S.padding||0))return;Z.attr({text:""})}:P.shortenLabel=void 0,U&&d._addedPlotLB&&P.moveLabel(Ue,S),Kh(Z)||P.movedLabel?Z&&Z.textStr!==Ue&&!U&&(!Z.textWidth||S.style.width||Z.styles.width||Z.css({width:null}),Z.attr({text:Ue}),Z.textPxLength=Z.getBBox().width):(P.label=Z=P.createLabel(Ue,S),P.rotation=0)}createLabel(P,d,p){let y=this.axis,{renderer:b,styledMode:w}=y.chart,M=Kh(P)&&d.enabled?b.text(P,p?.x,p?.y,d.useHTML).add(y.labelGroup):void 0;if(M){let T=d.style.whiteSpace||"normal";w||M.css(yc(d.style,{whiteSpace:"nowrap"})),M.textPxLength=M.getBBox().width,w||M.css({whiteSpace:T})}return M}destroy(){iy(this,this.axis)}getPosition(P,d,p,y){let b=this.axis,w=b.chart,M=y&&w.oldChartHeight||w.chartHeight,T={x:P?Fd(b.translate(d+p,void 0,void 0,y)+b.transB):b.left+b.offset+(b.opposite?(y&&w.oldChartWidth||w.chartWidth)-b.right-b.left:0),y:P?M-b.bottom+b.offset-(b.opposite?b.height:0):Fd(M-b.translate(d+p,void 0,void 0,y)-b.transB)};return T.y=gc(T.y,-1e9,1e9),wu(this,"afterGetPosition",{pos:T}),T}getLabelPosition(P,d,p,y,b,w,M,T){let S,O,B=this.axis,N=B.transA,U=B.isLinked&&B.linkedParent?B.linkedParent.reversed:B.reversed,X=B.staggerLines,Z=B.tickRotCorr||{x:0,y:0},te=y||B.reserveSpaceDefault?0:-B.labelOffset*(B.labelAlign==="center"?.5:1),ne=b.distance,J={};return S=B.side===0?p.rotation?-ne:-p.getBBox().height:B.side===2?Z.y+ne:Math.cos(p.rotation*Ld)*(Z.y-p.getBBox(!1,0).height/2),Kh(b.y)&&(S=B.side===0&&B.horiz?b.y+S:b.y),P=P+Fo(b.x,[0,1,0,-1][B.side]*ne)+te+Z.x-(w&&y?w*N*(U?-1:1):0),d=d+S-(w&&!y?w*N*(U?1:-1):0),X&&(O=M/(T||1)%X,B.opposite&&(O=X-O-1),d+=O*(B.labelOffset/X)),J.x=P,J.y=Math.round(d),wu(this,"afterGetLabelPosition",{pos:J,tickmarkOffset:w,index:M}),J}getLabelSize(){return this.label?this.label.getBBox()[this.axis.horiz?"height":"width"]:0}getMarkPath(P,d,p,y,b=!1,w){return w.crispLine([["M",P,d],["L",P+(b?0:-p),d+(b?p:0)]],y)}handleOverflow(P){let d=this.axis,p=d.options.labels,y=P.x,b=d.chart.chartWidth,w=d.chart.spacing,M=Fo(d.labelLeft,Math.min(d.pos,w[3])),T=Fo(d.labelRight,Math.max(d.isRadial?0:d.pos+d.len,b-w[1])),S=this.label,O=this.rotation,B=Pp(d.labelAlign||S.attr("align")),N=S.getBBox().width,U=d.getSlotWidth(this),X=U,Z=1,te,ne,J;O||p.overflow!=="justify"?O<0&&y-B*N<M?J=Math.round(y/Math.cos(O*Ld)-M):O>0&&y+B*N>T&&(J=Math.round((b-y)/Math.cos(O*Ld))):(te=y-B*N,ne=y+(1-B)*N,te<M?X=P.x+X*(1-B)-M:ne>T&&(X=T-P.x+X*B,Z=-1),(X=Math.min(U,X))<U&&d.labelAlign==="center"&&(P.x+=Z*(U-X-B*(U-Math.min(N,X)))),(N>X||d.autoRotation&&(S.styles||{}).width)&&(J=X)),J&&S&&(this.shortenLabel?this.shortenLabel():S.css(Rp({},{width:Math.floor(J)+"px",lineClamp:d.isRadial?0:1})))}moveLabel(P,d){let p=this,y=p.label,b=p.axis,w=!1,M;y&&y.textStr===P?(p.movedLabel=y,w=!0,delete p.label):Op(b.ticks,function(T){w||T.isNew||T===p||!T.label||T.label.textStr!==P||(p.movedLabel=T.label,w=!0,T.labelPos=p.movedLabel.xy,delete T.label)}),!w&&(p.labelPos||y)&&(M=p.labelPos||y.xy,p.movedLabel=p.createLabel(P,d,M),p.movedLabel&&p.movedLabel.attr({opacity:0}))}render(P,d,p){let y=this.axis,b=y.horiz,w=this.pos,M=Fo(this.tickmarkOffset,y.tickmarkOffset),T=this.getPosition(b,w,M,d),S=T.x,O=T.y,B=y.pos,N=B+y.len,U=b?S:O;!y.chart.polar&&this.isNew&&(Fd(U)<B||U>N)&&(p=0);let X=Fo(p,this.label&&this.label.newOpacity,1);p=Fo(p,1),this.isActive=!0,this.renderGridLine(d,p),this.renderMark(T,p),this.renderLabel(T,d,X,P),this.isNew=!1,wu(this,"afterRender")}renderGridLine(P,d){let p=this.axis,y=p.options,b={},w=this.pos,M=this.type,T=Fo(this.tickmarkOffset,p.tickmarkOffset),S=p.chart.renderer,O=this.gridLine,B,N=y.gridLineWidth,U=y.gridLineColor,X=y.gridLineDashStyle;this.type==="minor"&&(N=y.minorGridLineWidth,U=y.minorGridLineColor,X=y.minorGridLineDashStyle),O||(p.chart.styledMode||(b.stroke=U,b["stroke-width"]=N||0,b.dashstyle=X),M||(b.zIndex=1),P&&(d=0),this.gridLine=O=S.path().attr(b).addClass("highcharts-"+(M?M+"-":"")+"grid-line").add(p.gridGroup)),O&&(B=p.getPlotLinePath({value:w+T,lineWidth:O.strokeWidth(),force:"pass",old:P,acrossPanes:!1}))&&O[P||this.isNew?"attr":"animate"]({d:B,opacity:d})}renderMark(P,d){let p=this.axis,y=p.options,b=p.chart.renderer,w=this.type,M=p.tickSize(w?w+"Tick":"tick"),T=P.x,S=P.y,O=Fo(y[w!=="minor"?"tickWidth":"minorTickWidth"],!w&&p.isXAxis?1:0),B=y[w!=="minor"?"tickColor":"minorTickColor"],N=this.mark,U=!N;M&&(p.opposite&&(M[0]=-M[0]),N||(this.mark=N=b.path().addClass("highcharts-"+(w?w+"-":"")+"tick").add(p.axisGroup),p.chart.styledMode||N.attr({stroke:B,"stroke-width":O})),N[U?"attr":"animate"]({d:this.getMarkPath(T,S,M[0],N.strokeWidth(),p.horiz,b),opacity:d}))}renderLabel(P,d,p,y){let b=this.axis,w=b.horiz,M=b.options,T=this.label,S=M.labels,O=S.step,B=Fo(this.tickmarkOffset,b.tickmarkOffset),N=P.x,U=P.y,X=!0;T&&Cl(N)&&(T.xy=P=this.getLabelPosition(N,U,T,w,S,B,y,O),(!this.isFirst||this.isLast||M.showFirstLabel)&&(!this.isLast||this.isFirst||M.showLastLabel)?!w||S.step||S.rotation||d||p===0||this.handleOverflow(P):X=!1,O&&y%O&&(X=!1),X&&Cl(P.y)?(P.opacity=p,T[this.isNewLabel?"attr":"animate"](P).show(!0),this.isNewLabel=!1):(T.hide(),this.isNewLabel=!0))}replaceMovedLabel(){let P=this.label,d=this.axis;P&&!this.isNew&&(P.animate({opacity:0},void 0,P.destroy),delete this.label),d.isDirty=!0,this.label=this.movedLabel,delete this.movedLabel}},{animObject:Nd}=Ln,{xAxis:Mo,yAxis:Cu}=ny,{defaultOptions:zd}=Sr,{registerEventOptions:El}=wl,{deg2rad:_c}=lt,{arrayMax:Eu,arrayMin:Bd,clamp:Wn,correctFloat:Fr,defined:pi,destroyObjectProperties:jd,erase:Dl,error:Vd,extend:Ml,fireEvent:ci,getClosestDistance:Qh,insertItem:Ud,isArray:Tl,isNumber:Kt,isString:$d,merge:La,normalizeTickInterval:Du,objectEach:Il,pick:bn,relativeLength:Rt,removeEvent:ts,splat:Lp,syncTimeout:Mu}=Zt,vc=(P,d)=>Du(d,void 0,void 0,bn(P.options.allowDecimals,d<.5||P.tickAmount!==void 0),!!P.tickAmount);Ml(zd,{xAxis:Mo,yAxis:La(Mo,Cu)});let _r=(()=>{class P{constructor(p,y,b){this.init(p,y,b)}init(p,y,b=this.coll){let w=b==="xAxis",M=this.isZAxis||(p.inverted?!w:w);this.chart=p,this.horiz=M,this.isXAxis=w,this.coll=b,ci(this,"init",{userOptions:y}),this.opposite=bn(y.opposite,this.opposite),this.side=bn(y.side,this.side,M?this.opposite?0:2:this.opposite?1:3),this.setOptions(y);let T=this.options,S=T.labels;this.type??(this.type=T.type||"linear"),this.uniqueNames??(this.uniqueNames=T.uniqueNames??!0),ci(this,"afterSetType"),this.userOptions=y,this.minPixelPadding=0,this.reversed=bn(T.reversed,this.reversed),this.visible=T.visible,this.zoomEnabled=T.zoomEnabled,this.hasNames=this.type==="category"||T.categories===!0,this.categories=Tl(T.categories)&&T.categories||(this.hasNames?[]:void 0),this.names||(this.names=[],this.names.keys={}),this.plotLinesAndBandsGroups={},this.positiveValuesOnly=!!this.logarithmic,this.isLinked=pi(T.linkedTo),this.ticks={},this.labelEdge=[],this.minorTicks={},this.plotLinesAndBands=[],this.alternateBands={},this.len??(this.len=0),this.minRange=this.userMinRange=T.minRange||T.maxZoom,this.range=T.range,this.offset=T.offset||0,this.max=void 0,this.min=void 0;let O=bn(T.crosshair,Lp(p.options.tooltip.crosshairs)[w?0:1]);this.crosshair=O===!0?{}:O,p.axes.indexOf(this)===-1&&(w?p.axes.splice(p.xAxis.length,0,this):p.axes.push(this),Ud(this,p[this.coll])),p.orderItems(this.coll),this.series=this.series||[],p.inverted&&!this.isZAxis&&w&&!pi(this.reversed)&&(this.reversed=!0),this.labelRotation=Kt(S.rotation)?S.rotation:void 0,El(this,T),ci(this,"afterInit")}setOptions(p){let y=this.horiz?{labels:{autoRotation:[-45],padding:3},margin:15}:{labels:{padding:1},title:{rotation:90*this.side}};this.options=La(y,zd[this.coll],p),ci(this,"afterSetOptions",{userOptions:p})}defaultLabelFormatter(){let p=this.axis,{numberFormatter:y}=this.chart,b=Kt(this.value)?this.value:NaN,w=p.chart.time,M=p.categories,T=this.dateTimeLabelFormat,S=zd.lang,O=S.numericSymbols,B=S.numericSymbolMagnitude||1e3,N=p.logarithmic?Math.abs(b):p.tickInterval,U=O&&O.length,X,Z;if(M)Z=`${this.value}`;else if(T)Z=w.dateFormat(T,b,!0);else if(U&&O&&N>=1e3)for(;U--&&Z===void 0;)N>=(X=Math.pow(B,U+1))&&10*b%X==0&&O[U]!==null&&b!==0&&(Z=y(b/X,-1)+O[U]);return Z===void 0&&(Z=Math.abs(b)>=1e4?y(b,-1):y(b,-1,void 0,"")),Z}getSeriesExtremes(){let p,y=this;ci(this,"getSeriesExtremes",null,function(){y.hasVisibleSeries=!1,y.dataMin=y.dataMax=y.threshold=void 0,y.softThreshold=!y.isXAxis,y.series.forEach(b=>{if(b.reserveSpace()){let w=b.options,M,T=w.threshold,S,O;if(y.hasVisibleSeries=!0,y.positiveValuesOnly&&0>=(T||0)&&(T=void 0),y.isXAxis)(M=b.getColumn("x")).length&&(M=y.logarithmic?M.filter(B=>B>0):M,S=(p=b.getXExtremes(M)).min,O=p.max,Kt(S)||S instanceof Date||(M=M.filter(Kt),S=(p=b.getXExtremes(M)).min,O=p.max),M.length&&(y.dataMin=Math.min(bn(y.dataMin,S),S),y.dataMax=Math.max(bn(y.dataMax,O),O)));else{let B=b.applyExtremes();Kt(B.dataMin)&&(S=B.dataMin,y.dataMin=Math.min(bn(y.dataMin,S),S)),Kt(B.dataMax)&&(O=B.dataMax,y.dataMax=Math.max(bn(y.dataMax,O),O)),pi(T)&&(y.threshold=T),(!w.softThreshold||y.positiveValuesOnly)&&(y.softThreshold=!1)}}})}),ci(this,"afterGetSeriesExtremes")}translate(p,y,b,w,M,T){let S=this.linkedParent||this,O=w&&S.old?S.old.min:S.min;if(!Kt(O))return NaN;let B=S.minPixelPadding,N=(S.isOrdinal||S.brokenAxis?.hasBreaks||S.logarithmic&&M)&&S.lin2val,U=1,X=0,Z=w&&S.old?S.old.transA:S.transA,te=0;return Z||(Z=S.transA),b&&(U*=-1,X=S.len),S.reversed&&(U*=-1,X-=U*(S.sector||S.len)),y?(te=(p=p*U+X-B)/Z+O,N&&(te=S.lin2val(te))):(N&&(p=S.val2lin(p)),te=U*(p-O)*Z+X+U*B+(Kt(T)?Z*T:0),S.isRadial||(te=Fr(te))),te}toPixels(p,y){return this.translate(this.chart?.time.parse(p)??NaN,!1,!this.horiz,void 0,!0)+(y?0:this.pos)}toValue(p,y){return this.translate(p-(y?0:this.pos),!0,!this.horiz,void 0,!0)}getPlotLinePath(p){let y=this,b=y.chart,w=y.left,M=y.top,T=p.old,S=p.value,O=p.lineWidth,B=T&&b.oldChartHeight||b.chartHeight,N=T&&b.oldChartWidth||b.chartWidth,U=y.transB,X=p.translatedValue,Z=p.force,te,ne,J,ce,de;function ke(Le,Se,ze){return Z!=="pass"&&(Le<Se||Le>ze)&&(Z?Le=Wn(Le,Se,ze):de=!0),Le}let Ue={value:S,lineWidth:O,old:T,force:Z,acrossPanes:p.acrossPanes,translatedValue:X};return ci(this,"getPlotLinePath",Ue,function(Le){te=J=(X=Wn(X=bn(X,y.translate(S,void 0,void 0,T)),-1e9,1e9))+U,ne=ce=B-X-U,Kt(X)?y.horiz?(ne=M,ce=B-y.bottom+(y.options.isInternal?0:b.scrollablePixelsY||0),te=J=ke(te,w,w+y.width)):(te=w,J=N-y.right+(b.scrollablePixelsX||0),ne=ce=ke(ne,M,M+y.height)):(de=!0,Z=!1),Le.path=de&&!Z?void 0:b.renderer.crispLine([["M",te,ne],["L",J,ce]],O||1)}),Ue.path}getLinearTickPositions(p,y,b){let w,M,T,S=Fr(Math.floor(y/p)*p),O=Fr(Math.ceil(b/p)*p),B=[];if(Fr(S+p)===S&&(T=20),this.single)return[y];for(w=S;w<=O&&(B.push(w),(w=Fr(w+p,T))!==M);)M=w;return B}getMinorTickInterval(){let{minorTicks:p,minorTickInterval:y}=this.options;return p===!0?bn(y,"auto"):p!==!1?y:void 0}getMinorTickPositions(){let p=this.options,y=this.tickPositions,b=this.minorTickInterval,w=this.pointRangePadding||0,M=(this.min||0)-w,T=(this.max||0)+w,S=this.brokenAxis?.hasBreaks?this.brokenAxis.unitLength:T-M,O=[],B;if(S&&S/b<this.len/3){let N=this.logarithmic;if(N)this.paddedTicks.forEach(function(U,X,Z){X&&O.push.apply(O,N.getLogTickPositions(b,Z[X-1],Z[X],!0))});else if(this.dateTime&&this.getMinorTickInterval()==="auto")O=O.concat(this.getTimeTicks(this.dateTime.normalizeTimeTickInterval(b),M,T,p.startOfWeek));else for(B=M+(y[0]-M)%b;B<=T&&B!==O[0];B+=b)O.push(B)}return O.length!==0&&this.trimTicks(O),O}adjustForMinRange(){let p=this.options,y=this.logarithmic,b=this.chart.time,{max:w,min:M,minRange:T}=this,S,O,B,N;this.isXAxis&&T===void 0&&!y&&(T=pi(p.min)||pi(p.max)||pi(p.floor)||pi(p.ceiling)?null:Math.min(5*(Qh(this.series.map(U=>{let X=U.getColumn("x");return U.xIncrement?X.slice(0,2):X}))||0),this.dataMax-this.dataMin)),Kt(w)&&Kt(M)&&Kt(T)&&w-M<T&&(O=this.dataMax-this.dataMin>=T,S=(T-w+M)/2,B=[M-S,b.parse(p.min)??M-S],O&&(B[2]=y?y.log2lin(this.dataMin):this.dataMin),N=[(M=Eu(B))+T,b.parse(p.max)??M+T],O&&(N[2]=y?y.log2lin(this.dataMax):this.dataMax),(w=Bd(N))-M<T&&(B[0]=w-T,B[1]=b.parse(p.min)??w-T,M=Eu(B))),this.minRange=T,this.min=M,this.max=w}getClosest(){let p,y;if(this.categories)y=1;else{let b=[];this.series.forEach(function(w){let M=w.closestPointRange,T=w.getColumn("x");T.length===1?b.push(T[0]):w.sorted&&pi(M)&&w.reserveSpace()&&(y=pi(y)?Math.min(y,M):M)}),b.length&&(b.sort((w,M)=>w-M),p=Qh([b]))}return p&&y?Math.min(p,y):p||y}nameToX(p){let y=Tl(this.options.categories),b=y?this.categories:this.names,w=p.options.x,M;return p.series.requireSorting=!1,pi(w)||(w=this.uniqueNames&&b?y?b.indexOf(p.name):bn(b.keys[p.name],-1):p.series.autoIncrement()),w===-1?!y&&b&&(M=b.length):Kt(w)&&(M=w),M!==void 0?(this.names[M]=p.name,this.names.keys[p.name]=M):p.x&&(M=p.x),M}updateNames(){let p=this,y=this.names;y.length>0&&(Object.keys(y.keys).forEach(function(b){delete y.keys[b]}),y.length=0,this.minRange=this.userMinRange,(this.series||[]).forEach(b=>{b.xIncrement=null,(!b.points||b.isDirtyData)&&(p.max=Math.max(p.max||0,b.dataTable.rowCount-1),b.processData(),b.generatePoints());let w=b.getColumn("x").slice();b.data.forEach((M,T)=>{let S=w[T];M?.options&&M.name!==void 0&&(S=p.nameToX(M))!==void 0&&S!==M.x&&(w[T]=M.x=S)}),b.dataTable.setColumn("x",w)}))}setAxisTranslation(){let p=this,y=p.max-p.min,b=p.linkedParent,w=!!p.categories,M=p.isXAxis,T=p.axisPointRange||0,S,O=0,B=0,N,U=p.transA;(M||w||T)&&(S=p.getClosest(),b?(O=b.minPointOffset,B=b.pointRangePadding):p.series.forEach(function(X){let Z=w?1:M?bn(X.options.pointRange,S,0):p.axisPointRange||0,te=X.options.pointPlacement;if(T=Math.max(T,Z),!p.single||w){let ne=X.is("xrange")?!M:M;O=Math.max(O,ne&&$d(te)?0:Z/2),B=Math.max(B,ne&&te==="on"?0:Z)}}),N=p.ordinal&&p.ordinal.slope&&S?p.ordinal.slope/S:1,p.minPointOffset=O*=N,p.pointRangePadding=B*=N,p.pointRange=Math.min(T,p.single&&w?1:y),M&&S&&(p.closestPointRange=S)),p.translationSlope=p.transA=U=p.staticScale||p.len/(y+B||1),p.transB=p.horiz?p.left:p.bottom,p.minPixelPadding=U*O,ci(this,"afterSetAxisTranslation")}minFromRange(){let{max:p,min:y}=this;return Kt(p)&&Kt(y)&&p-y||void 0}setTickInterval(p){let{categories:y,chart:b,dataMax:w,dataMin:M,dateTime:T,isXAxis:S,logarithmic:O,options:B,softThreshold:N}=this,U=b.time,X=Kt(this.threshold)?this.threshold:void 0,Z=this.minRange||0,{ceiling:te,floor:ne,linkedTo:J,softMax:ce,softMin:de}=B,ke=Kt(J)&&b[this.coll]?.[J],Ue=B.tickPixelInterval,Le=B.maxPadding,Se=B.minPadding,ze=0,nt,rt=Kt(B.tickInterval)&&B.tickInterval>=0?B.tickInterval:void 0,pt,Bt,Lt,jt;if(T||y||ke||this.getTickAmount(),Lt=bn(this.userMin,U.parse(B.min)),jt=bn(this.userMax,U.parse(B.max)),ke?(this.linkedParent=ke,nt=ke.getExtremes(),this.min=bn(nt.min,nt.dataMin),this.max=bn(nt.max,nt.dataMax),this.type!==ke.type&&Vd(11,!0,b)):(N&&pi(X)&&Kt(w)&&Kt(M)&&(M>=X?(pt=X,Se=0):w<=X&&(Bt=X,Le=0)),this.min=bn(Lt,pt,M),this.max=bn(jt,Bt,w)),Kt(this.max)&&Kt(this.min)&&(O&&(this.positiveValuesOnly&&!p&&0>=Math.min(this.min,bn(M,this.min))&&Vd(10,!0,b),this.min=Fr(O.log2lin(this.min),16),this.max=Fr(O.log2lin(this.max),16)),this.range&&Kt(M)&&(this.userMin=this.min=Lt=Math.max(M,this.minFromRange()||0),this.userMax=jt=this.max,this.range=void 0)),ci(this,"foundExtremes"),this.adjustForMinRange(),Kt(this.min)&&Kt(this.max)){if(!Kt(this.userMin)&&Kt(de)&&de<this.min&&(this.min=Lt=de),!Kt(this.userMax)&&Kt(ce)&&ce>this.max&&(this.max=jt=ce),y||this.axisPointRange||this.stacking?.usePercentage||ke||!(ze=this.max-this.min)||(!pi(Lt)&&Se&&(this.min-=ze*Se),pi(jt)||!Le||(this.max+=ze*Le)),!Kt(this.userMin)&&Kt(ne)&&(this.min=Math.max(this.min,ne)),!Kt(this.userMax)&&Kt(te)&&(this.max=Math.min(this.max,te)),N&&Kt(M)&&Kt(w)){let zt=X||0;!pi(Lt)&&this.min<zt&&M>=zt?this.min=B.minRange?Math.min(zt,this.max-Z):zt:!pi(jt)&&this.max>zt&&w<=zt&&(this.max=B.minRange?Math.max(zt,this.min+Z):zt)}!b.polar&&this.min>this.max&&(pi(B.min)?this.max=this.min:pi(B.max)&&(this.min=this.max)),ze=this.max-this.min}if(this.min!==this.max&&Kt(this.min)&&Kt(this.max)?ke&&!rt&&Ue===ke.options.tickPixelInterval?this.tickInterval=rt=ke.tickInterval:this.tickInterval=bn(rt,this.tickAmount?ze/Math.max(this.tickAmount-1,1):void 0,y?1:ze*Ue/Math.max(this.len,Ue)):this.tickInterval=1,S&&!p){let zt=this.min!==this.old?.min||this.max!==this.old?.max;this.series.forEach(function(Sn){Sn.forceCrop=Sn.forceCropping?.(),Sn.processData(zt)}),ci(this,"postProcessData",{hasExtremesChanged:zt})}this.setAxisTranslation(),ci(this,"initialAxisTranslation"),this.pointRange&&!rt&&(this.tickInterval=Math.max(this.pointRange,this.tickInterval));let Yt=bn(B.minTickInterval,T&&!this.series.some(zt=>!zt.sorted)?this.closestPointRange:0);!rt&&this.tickInterval<Yt&&(this.tickInterval=Yt),T||O||rt||(this.tickInterval=vc(this,this.tickInterval)),this.tickAmount||(this.tickInterval=this.unsquish()),this.setTickPositions()}setTickPositions(){let p=this.options,y=p.tickPositions,b=p.tickPositioner,w=this.getMinorTickInterval(),M=!this.isPanning,T=M&&p.startOnTick,S=M&&p.endOnTick,O=[],B;if(this.tickmarkOffset=this.categories&&p.tickmarkPlacement==="between"&&this.tickInterval===1?.5:0,this.single=this.min===this.max&&pi(this.min)&&!this.tickAmount&&(this.min%1==0||p.allowDecimals!==!1),y)O=y.slice();else if(Kt(this.min)&&Kt(this.max)){if(!this.ordinal?.positions&&(this.max-this.min)/this.tickInterval>Math.max(2*this.len,200))O=[this.min,this.max],Vd(19,!1,this.chart);else if(this.dateTime)O=this.getTimeTicks(this.dateTime.normalizeTimeTickInterval(this.tickInterval,p.units),this.min,this.max,p.startOfWeek,this.ordinal?.positions,this.closestPointRange,!0);else if(this.logarithmic)O=this.logarithmic.getLogTickPositions(this.tickInterval,this.min,this.max);else{let N=this.tickInterval,U=N;for(;U<=2*N&&(O=this.getLinearTickPositions(this.tickInterval,this.min,this.max),this.tickAmount&&O.length>this.tickAmount);)this.tickInterval=vc(this,U*=1.1)}O.length>this.len&&(O=[O[0],O[O.length-1]])[0]===O[1]&&(O.length=1),b&&(this.tickPositions=O,(B=b.apply(this,[this.min,this.max]))&&(O=B))}this.tickPositions=O,this.minorTickInterval=w==="auto"&&this.tickInterval?this.tickInterval/p.minorTicksPerMajor:w,this.paddedTicks=O.slice(0),this.trimTicks(O,T,S),!this.isLinked&&Kt(this.min)&&Kt(this.max)&&(this.single&&O.length<2&&!this.categories&&!this.series.some(N=>N.is("heatmap")&&N.options.pointPlacement==="between")&&(this.min-=.5,this.max+=.5),y||B||this.adjustTickAmount()),ci(this,"afterSetTickPositions")}trimTicks(p,y,b){let w=p[0],M=p[p.length-1],T=!this.isOrdinal&&this.minPointOffset||0;if(ci(this,"trimTicks"),!this.isLinked){if(y&&w!==-1/0)this.min=w;else for(;this.min-T>p[0];)p.shift();if(b)this.max=M;else for(;this.max+T<p[p.length-1];)p.pop();p.length===0&&pi(w)&&!this.options.tickPositions&&p.push((M+w)/2)}}alignToOthers(){let p,y=this,b=y.chart,w=[this],M=y.options,T=b.options.chart,S=this.coll==="yAxis"&&T.alignThresholds,O=[];if(y.thresholdAlignment=void 0,(T.alignTicks!==!1&&M.alignTicks||S)&&M.startOnTick!==!1&&M.endOnTick!==!1&&!y.logarithmic){let B=U=>{let{horiz:X,options:Z}=U;return[X?Z.left:Z.top,Z.width,Z.height,Z.pane].join(",")},N=B(this);b[this.coll].forEach(function(U){let{series:X}=U;X.length&&X.some(Z=>Z.visible)&&U!==y&&B(U)===N&&(p=!0,w.push(U))})}if(p&&S){w.forEach(N=>{let U=N.getThresholdAlignment(y);Kt(U)&&O.push(U)});let B=O.length>1?O.reduce((N,U)=>N+=U,0)/O.length:void 0;w.forEach(N=>{N.thresholdAlignment=B})}return p}getThresholdAlignment(p){if((!Kt(this.dataMin)||this!==p&&this.series.some(y=>y.isDirty||y.isDirtyData))&&this.getSeriesExtremes(),Kt(this.threshold)){let y=Wn((this.threshold-(this.dataMin||0))/((this.dataMax||0)-(this.dataMin||0)),0,1);return this.options.reversed&&(y=1-y),y}}getTickAmount(){let p=this.options,y=p.tickPixelInterval,b=p.tickAmount;pi(p.tickInterval)||b||!(this.len<y)||this.isRadial||this.logarithmic||!p.startOnTick||!p.endOnTick||(b=2),!b&&this.alignToOthers()&&(b=Math.ceil(this.len/y)+1),b<4&&(this.finalTickAmt=b,b=5),this.tickAmount=b}adjustTickAmount(){let p=this,{finalTickAmt:y,max:b,min:w,options:M,tickPositions:T,tickAmount:S,thresholdAlignment:O}=p,B=T?.length,N=bn(p.threshold,p.softThreshold?0:null),U,X,Z=p.tickInterval,te,ne=()=>T.push(Fr(T[T.length-1]+Z)),J=()=>T.unshift(Fr(T[0]-Z));if(Kt(O)&&(te=O<.5?Math.ceil(O*(S-1)):Math.floor(O*(S-1)),M.reversed&&(te=S-1-te)),p.hasData()&&Kt(w)&&Kt(b)){let ce=()=>{p.transA*=(B-1)/(S-1),p.min=M.startOnTick?T[0]:Math.min(w,T[0]),p.max=M.endOnTick?T[T.length-1]:Math.max(b,T[T.length-1])};if(Kt(te)&&Kt(p.threshold)){for(;T[te]!==N||T.length!==S||T[0]>w||T[T.length-1]<b;){for(T.length=0,T.push(p.threshold);T.length<S;)T[te]===void 0||T[te]>p.threshold?J():ne();if(Z>8*p.tickInterval)break;Z*=2}ce()}else if(B<S){for(;T.length<S;)T.length%2||w===N?ne():J();ce()}if(pi(y)){for(X=U=T.length;X--;)(y===3&&X%2==1||y<=2&&X>0&&X<U-1)&&T.splice(X,1);p.finalTickAmt=void 0}}}setScale(){let{coll:p,stacking:y}=this,b=!1,w=!1;this.series.forEach(T=>{b=b||T.isDirtyData||T.isDirty,w=w||T.xAxis&&T.xAxis.isDirty||!1}),this.setAxisSize();let M=this.len!==(this.old&&this.old.len);M||b||w||this.isLinked||this.forceRedraw||this.userMin!==(this.old&&this.old.userMin)||this.userMax!==(this.old&&this.old.userMax)||this.alignToOthers()?(y&&p==="yAxis"&&y.buildStacks(),this.forceRedraw=!1,this.userMinRange||(this.minRange=void 0),this.getSeriesExtremes(),this.setTickInterval(),y&&p==="xAxis"&&y.buildStacks(),this.isDirty||(this.isDirty=M||this.min!==this.old?.min||this.max!==this.old?.max)):y&&y.cleanStacks(),b&&delete this.allExtremes,ci(this,"afterSetScale")}setExtremes(p,y,b=!0,w,M){let T=this.chart;this.series.forEach(S=>{delete S.kdTree}),p=T.time.parse(p),y=T.time.parse(y),ci(this,"setExtremes",M=Ml(M,{min:p,max:y}),S=>{this.userMin=S.min,this.userMax=S.max,this.eventArgs=S,b&&T.redraw(w)})}setAxisSize(){let p=this.chart,y=this.options,b=y.offsets||[0,0,0,0],w=this.horiz,M=this.width=Math.round(Rt(bn(y.width,p.plotWidth-b[3]+b[1]),p.plotWidth)),T=this.height=Math.round(Rt(bn(y.height,p.plotHeight-b[0]+b[2]),p.plotHeight)),S=this.top=Math.round(Rt(bn(y.top,p.plotTop+b[0]),p.plotHeight,p.plotTop)),O=this.left=Math.round(Rt(bn(y.left,p.plotLeft+b[3]),p.plotWidth,p.plotLeft));this.bottom=p.chartHeight-T-S,this.right=p.chartWidth-M-O,this.len=Math.max(w?M:T,0),this.pos=w?O:S}getExtremes(){let p=this.logarithmic;return{min:p?Fr(p.lin2log(this.min)):this.min,max:p?Fr(p.lin2log(this.max)):this.max,dataMin:this.dataMin,dataMax:this.dataMax,userMin:this.userMin,userMax:this.userMax}}getThreshold(p){let y=this.logarithmic,b=y?y.lin2log(this.min):this.min,w=y?y.lin2log(this.max):this.max;return p===null||p===-1/0?p=b:p===1/0?p=w:b>p?p=b:w<p&&(p=w),this.translate(p,0,1,0,1)}autoLabelAlign(p){let y=(bn(p,0)-90*this.side+720)%360,b={align:"center"};return ci(this,"autoLabelAlign",b,function(w){y>15&&y<165?w.align="right":y>195&&y<345&&(w.align="left")}),b.align}tickSize(p){let y=this.options,b=bn(y[p==="tick"?"tickWidth":"minorTickWidth"],p==="tick"&&this.isXAxis&&!this.categories?1:0),w=y[p==="tick"?"tickLength":"minorTickLength"],M;b&&w&&(y[p+"Position"]==="inside"&&(w=-w),M=[w,b]);let T={tickSize:M};return ci(this,"afterTickSize",T),T.tickSize}labelMetrics(){let p=this.chart.renderer,y=this.ticks,b=y[Object.keys(y)[0]]||{};return this.chart.renderer.fontMetrics(b.label||b.movedLabel||p.box)}unsquish(){let p=this.options.labels,y=p.padding||0,b=this.horiz,w=this.tickInterval,M=this.len/(((this.categories?1:0)+this.max-this.min)/w),T=p.rotation,S=Fr(.8*this.labelMetrics().h),O=Math.max(this.max-this.min,0),B=function(te){let ne=(te+2*y)/(M||1);return(ne=ne>1?Math.ceil(ne):1)*w>O&&te!==1/0&&M!==1/0&&O&&(ne=Math.ceil(O/w)),Fr(ne*w)},N=w,U,X=Number.MAX_VALUE,Z;if(b){if(!p.staggerLines&&(Kt(T)?Z=[T]:M<p.autoRotationLimit&&(Z=p.autoRotation)),Z){let te,ne;for(let J of Z)(J===T||J&&J>=-90&&J<=90)&&(ne=(te=B(Math.abs(S/Math.sin(_c*J))))+Math.abs(J/360))<X&&(X=ne,U=J,N=te)}}else N=B(.75*S);return this.autoRotation=Z,this.labelRotation=bn(U,Kt(T)?T:0),p.step?w:N}getSlotWidth(p){let y=this.chart,b=this.horiz,w=this.options.labels,M=Math.max(this.tickPositions.length-(this.categories?0:1),1),T=y.margin[3];if(p&&Kt(p.slotWidth))return p.slotWidth;if(b&&w.step<2&&!this.isRadial)return w.rotation?0:(this.staggerLines||1)*this.len/M;if(!b){let S=w.style.width;if(S!==void 0)return parseInt(String(S),10);if(T)return T-y.spacing[3]}return .33*y.chartWidth}renderUnsquish(){let p=this.chart,y=p.renderer,b=this.tickPositions,w=this.ticks,M=this.options.labels,T=M.style,S=this.horiz,O=this.getSlotWidth(),B=Math.max(1,Math.round(O-(S?2*(M.padding||0):M.distance||0))),N={},U=this.labelMetrics(),X=T.lineClamp,Z,te=X??(Math.floor(this.len/(b.length*U.h))||1),ne=0;$d(M.rotation)||(N.rotation=M.rotation||0),b.forEach(function(J){let ce=w[J];ce.movedLabel&&ce.replaceMovedLabel();let de=ce.label?.textPxLength||0;de>ne&&(ne=de)}),this.maxLabelLength=ne,this.autoRotation?ne>B&&ne>U.h?N.rotation=this.labelRotation:this.labelRotation=0:O&&(Z=B),N.rotation&&(Z=ne>.5*p.chartHeight?.33*p.chartHeight:ne,X||(te=1)),this.labelAlign=M.align||this.autoLabelAlign(this.labelRotation),this.labelAlign&&(N.align=this.labelAlign),b.forEach(function(J){let ce=w[J],de=ce&&ce.label,ke=T.width,Ue={};de&&(de.attr(N),ce.shortenLabel?ce.shortenLabel():Z&&!ke&&T.whiteSpace!=="nowrap"&&(Z<(de.textPxLength||0)||de.element.tagName==="SPAN")?de.css(Ml(Ue,{width:`${Z}px`,lineClamp:te})):!de.styles.width||Ue.width||ke||de.css({width:"auto"}),ce.rotation=N.rotation)},this),this.tickRotCorr=y.rotCorr(U.b,this.labelRotation||0,this.side!==0)}hasData(){return this.series.some(function(p){return p.hasData()})||this.options.showEmpty&&pi(this.min)&&pi(this.max)}addTitle(p){let y,b=this.chart.renderer,w=this.horiz,M=this.opposite,T=this.options.title,S=this.chart.styledMode;this.axisTitle||((y=T.textAlign)||(y=(w?{low:"left",middle:"center",high:"right"}:{low:M?"right":"left",middle:"center",high:M?"left":"right"})[T.align]),this.axisTitle=b.text(T.text||"",0,0,T.useHTML).attr({zIndex:7,rotation:T.rotation||0,align:y}).addClass("highcharts-axis-title"),S||this.axisTitle.css(La(T.style)),this.axisTitle.add(this.axisGroup),this.axisTitle.isNew=!0),S||T.style.width||this.isRadial||this.axisTitle.css({width:this.len+"px"}),this.axisTitle[p?"show":"hide"](p)}generateTick(p){let y=this.ticks;y[p]?y[p].addLabel():y[p]=new uo(this,p)}createGroups(){let{axisParent:p,chart:y,coll:b,options:w}=this,M=y.renderer,T=(S,O,B)=>M.g(S).attr({zIndex:B}).addClass(`highcharts-${b.toLowerCase()}${O} `+(this.isRadial?`highcharts-radial-axis${O} `:"")+(w.className||"")).add(p);this.axisGroup||(this.gridGroup=T("grid","-grid",w.gridZIndex),this.axisGroup=T("axis","",w.zIndex),this.labelGroup=T("axis-labels","-labels",w.labels.zIndex))}getOffset(){let p=this,{chart:y,horiz:b,options:w,side:M,ticks:T,tickPositions:S,coll:O}=p,B=y.inverted&&!p.isZAxis?[1,0,3,2][M]:M,N=p.hasData(),U=w.title,X=w.labels,Z=Kt(w.crossing),te=y.axisOffset,ne=y.clipOffset,J=[-1,1,1,-1][M],ce,de=0,ke,Ue=0,Le=0,Se,ze;if(p.showAxis=ce=N||w.showEmpty,p.staggerLines=p.horiz&&X.staggerLines||void 0,p.createGroups(),N||p.isLinked?(S.forEach(function(nt){p.generateTick(nt)}),p.renderUnsquish(),p.reserveSpaceDefault=M===0||M===2||{1:"left",3:"right"}[M]===p.labelAlign,bn(X.reserveSpace,!Z&&null,p.labelAlign==="center"||null,p.reserveSpaceDefault)&&S.forEach(function(nt){Le=Math.max(T[nt].getLabelSize(),Le)}),p.staggerLines&&(Le*=p.staggerLines),p.labelOffset=Le*(p.opposite?-1:1)):Il(T,function(nt,rt){nt.destroy(),delete T[rt]}),U?.text&&U.enabled!==!1&&(p.addTitle(ce),ce&&!Z&&U.reserveSpace!==!1&&(p.titleOffset=de=p.axisTitle.getBBox()[b?"height":"width"],Ue=pi(ke=U.offset)?0:bn(U.margin,b?5:10))),p.renderLine(),p.offset=J*bn(w.offset,te[M]?te[M]+(w.margin||0):0),p.tickRotCorr=p.tickRotCorr||{x:0,y:0},ze=M===0?-p.labelMetrics().h:M===2?p.tickRotCorr.y:0,Se=Math.abs(Le)+Ue,Le&&(Se-=ze,Se+=J*(b?bn(X.y,p.tickRotCorr.y+J*X.distance):bn(X.x,J*X.distance))),p.axisTitleMargin=bn(ke,Se),p.getMaxLabelDimensions&&(p.maxLabelDimensions=p.getMaxLabelDimensions(T,S)),O!=="colorAxis"&&ne){let nt=this.tickSize("tick");te[M]=Math.max(te[M],(p.axisTitleMargin||0)+de+J*p.offset,Se,S&&S.length&&nt?nt[0]+J*p.offset:0);let rt=!p.axisLine||w.offset?0:p.axisLine.strokeWidth()/2;ne[B]=Math.max(ne[B],rt)}ci(this,"afterGetOffset")}getLinePath(p){let y=this.chart,b=this.opposite,w=this.offset,M=this.horiz,T=this.left+(b?this.width:0)+w,S=y.chartHeight-this.bottom-(b?this.height:0)+w;return b&&(p*=-1),y.renderer.crispLine([["M",M?this.left:T,M?S:this.top],["L",M?y.chartWidth-this.right:T,M?S:y.chartHeight-this.bottom]],p)}renderLine(){this.axisLine||(this.axisLine=this.chart.renderer.path().addClass("highcharts-axis-line").add(this.axisGroup),this.chart.styledMode||this.axisLine.attr({stroke:this.options.lineColor,"stroke-width":this.options.lineWidth,zIndex:7}))}getTitlePosition(p){let y=this.horiz,b=this.left,w=this.top,M=this.len,T=this.options.title,S=y?b:w,O=this.opposite,B=this.offset,N=T.x,U=T.y,X=this.chart.renderer.fontMetrics(p),Z=p?Math.max(p.getBBox(!1,0).height-X.h-1,0):0,te={low:S+(y?0:M),middle:S+M/2,high:S+(y?M:0)}[T.align],ne=(y?w+this.height:b)+(y?1:-1)*(O?-1:1)*(this.axisTitleMargin||0)+[-Z,Z,X.f,-Z][this.side],J={x:y?te+N:ne+(O?this.width:0)+B+N,y:y?ne+U-(O?this.height:0)+B:te+U};return ci(this,"afterGetTitlePosition",{titlePosition:J}),J}renderMinorTick(p,y){let b=this.minorTicks;b[p]||(b[p]=new uo(this,p,"minor")),y&&b[p].isNew&&b[p].render(null,!0),b[p].render(null,!1,1)}renderTick(p,y,b){let w=this.isLinked,M=this.ticks;(!w||p>=this.min&&p<=this.max||this.grid&&this.grid.isColumn)&&(M[p]||(M[p]=new uo(this,p)),b&&M[p].isNew&&M[p].render(y,!0,-1),M[p].render(y))}render(){let p,y,b=this,w=b.chart,M=b.logarithmic,T=w.renderer,S=b.options,O=b.isLinked,B=b.tickPositions,N=b.axisTitle,U=b.ticks,X=b.minorTicks,Z=b.alternateBands,te=S.stackLabels,ne=S.alternateGridColor,J=S.crossing,ce=b.tickmarkOffset,de=b.axisLine,ke=b.showAxis,Ue=Nd(T.globalAnimation);if(b.labelEdge.length=0,b.overlap=!1,[U,X,Z].forEach(function(Le){Il(Le,function(Se){Se.isActive=!1})}),Kt(J)){let Le=this.isXAxis?w.yAxis[0]:w.xAxis[0],Se=[1,-1,-1,1][this.side];if(Le){let ze=Le.toPixels(J,!0);b.horiz&&(ze=Le.len-ze),b.offset=Se*ze}}if(b.hasData()||O){let Le=b.chart.hasRendered&&b.old&&Kt(b.old.min);b.minorTickInterval&&!b.categories&&b.getMinorTickPositions().forEach(function(Se){b.renderMinorTick(Se,Le)}),B.length&&(B.forEach(function(Se,ze){b.renderTick(Se,ze,Le)}),ce&&(b.min===0||b.single)&&(U[-1]||(U[-1]=new uo(b,-1,null,!0)),U[-1].render(-1))),ne&&B.forEach(function(Se,ze){y=B[ze+1]!==void 0?B[ze+1]+ce:b.max-ce,ze%2==0&&Se<b.max&&y<=b.max+(w.polar?-ce:ce)&&(Z[Se]||(Z[Se]=new lt.PlotLineOrBand(b,{})),p=Se+ce,Z[Se].options={from:M?M.lin2log(p):p,to:M?M.lin2log(y):y,color:ne,className:"highcharts-alternate-grid"},Z[Se].render(),Z[Se].isActive=!0)}),b._addedPlotLB||(b._addedPlotLB=!0,(S.plotLines||[]).concat(S.plotBands||[]).forEach(function(Se){b.addPlotBandOrLine(Se)}))}[U,X,Z].forEach(function(Le){let Se=[],ze=Ue.duration;Il(Le,function(nt,rt){nt.isActive||(nt.render(rt,!1,0),nt.isActive=!1,Se.push(rt))}),Mu(function(){let nt=Se.length;for(;nt--;)Le[Se[nt]]&&!Le[Se[nt]].isActive&&(Le[Se[nt]].destroy(),delete Le[Se[nt]])},Le!==Z&&w.hasRendered&&ze?ze:0)}),de&&(de[de.isPlaced?"animate":"attr"]({d:this.getLinePath(de.strokeWidth())}),de.isPlaced=!0,de[ke?"show":"hide"](ke)),N&&ke&&(N[N.isNew?"attr":"animate"](b.getTitlePosition(N)),N.isNew=!1),te&&te.enabled&&b.stacking&&b.stacking.renderStackTotals(),b.old={len:b.len,max:b.max,min:b.min,transA:b.transA,userMax:b.userMax,userMin:b.userMin},b.isDirty=!1,ci(this,"afterRender")}redraw(){this.visible&&(this.render(),this.plotLinesAndBands.forEach(function(p){p.render()})),this.series.forEach(function(p){p.isDirty=!0})}getKeepProps(){return this.keepProps||P.keepProps}destroy(p){let y=this,b=y.plotLinesAndBands,w=this.eventOptions;if(ci(this,"destroy",{keepEvents:p}),p||ts(y),[y.ticks,y.minorTicks,y.alternateBands].forEach(function(M){jd(M)}),b){let M=b.length;for(;M--;)b[M].destroy()}for(let M in["axisLine","axisTitle","axisGroup","gridGroup","labelGroup","cross","scrollbar"].forEach(function(T){y[T]&&(y[T]=y[T].destroy())}),y.plotLinesAndBandsGroups)y.plotLinesAndBandsGroups[M]=y.plotLinesAndBandsGroups[M].destroy();Il(y,function(M,T){y.getKeepProps().indexOf(T)===-1&&delete y[T]}),this.eventOptions=w}drawCrosshair(p,y){let b=this.crosshair,w=bn(b&&b.snap,!0),M=this.chart,T,S,O,B=this.cross,N;if(ci(this,"drawCrosshair",{e:p,point:y}),p||(p=this.cross&&this.cross.e),b&&(pi(y)||!w)!==!1){if(w?pi(y)&&(S=bn(this.coll!=="colorAxis"?y.crosshairPos:null,this.isXAxis?y.plotX:this.len-y.plotY)):S=p&&(this.horiz?p.chartX-this.pos:this.len-p.chartY+this.pos),pi(S)&&(N={value:y&&(this.isXAxis?y.x:bn(y.stackY,y.y)),translatedValue:S},M.polar&&Ml(N,{isCrosshair:!0,chartX:p&&p.chartX,chartY:p&&p.chartY,point:y}),T=this.getPlotLinePath(N)||null),!pi(T)){this.hideCrosshair();return}O=this.categories&&!this.isRadial,B||(this.cross=B=M.renderer.path().addClass("highcharts-crosshair highcharts-crosshair-"+(O?"category ":"thin ")+(b.className||"")).attr({zIndex:bn(b.zIndex,2)}).add(),!M.styledMode&&(B.attr({stroke:b.color||(O?re.parse("#ccd3ff").setOpacity(.25).get():"#cccccc"),"stroke-width":bn(b.width,1)}).css({"pointer-events":"none"}),b.dashStyle&&B.attr({dashstyle:b.dashStyle}))),B.show().attr({d:T}),O&&!b.width&&B.attr({"stroke-width":this.transA}),this.cross.e=p}else this.hideCrosshair();ci(this,"afterDrawCrosshair",{e:p,point:y})}hideCrosshair(){this.cross&&this.cross.hide(),ci(this,"afterHideCrosshair")}update(p,y){let b=this.chart;p=La(this.userOptions,p),this.destroy(!0),this.init(b,p),b.isDirtyBox=!0,bn(y,!0)&&b.redraw()}remove(p){let y=this.chart,b=this.coll,w=this.series,M=w.length;for(;M--;)w[M]&&w[M].remove(!1);Dl(y.axes,this),Dl(y[b]||[],this),y.orderItems(b),this.destroy(),y.isDirtyBox=!0,bn(p,!0)&&y.redraw()}setTitle(p,y){this.update({title:p},y)}setCategories(p,y){this.update({categories:p},y)}}return P.keepProps=["coll","extKey","hcEvents","len","names","series","userMax","userMin"],P})(),{addEvent:Tu,getMagnitude:Hd,normalizeTickInterval:Jh,timeUnits:Sl}=Zt;(function(P){function d(){return this.chart.time.getTimeTicks.apply(this.chart.time,arguments)}function p(){if(this.type!=="datetime"){this.dateTime=void 0;return}this.dateTime||(this.dateTime=new y(this))}P.compose=function(b){return b.keepProps.includes("dateTime")||(b.keepProps.push("dateTime"),b.prototype.getTimeTicks=d,Tu(b,"afterSetType",p)),b};class y{constructor(w){this.axis=w}normalizeTimeTickInterval(w,M){let T=M||[["millisecond",[1,2,5,10,20,25,50,100,200,500]],["second",[1,2,5,10,15,30]],["minute",[1,2,5,10,15,30]],["hour",[1,2,3,4,6,8,12]],["day",[1,2]],["week",[1,2]],["month",[1,2,3,4,6]],["year",null]],S=T[T.length-1],O=Sl[S[0]],B=S[1],N;for(N=0;N<T.length&&(O=Sl[(S=T[N])[0]],B=S[1],!T[N+1]||!(w<=(O*B[B.length-1]+Sl[T[N+1][0]])/2));N++);O===Sl.year&&w<5*O&&(B=[1,2,5]);let U=Jh(w/O,B,S[0]==="year"?Math.max(Hd(w/O),1):1);return{unitRange:O,count:U,unitName:S[0]}}getXDateFormat(w,M){let{axis:T}=this,S=T.chart.time;return T.closestPointRange?S.getDateFormat(T.closestPointRange,w,T.options.startOfWeek,M)||S.resolveDTLFormat(M.year).main:S.resolveDTLFormat(M.day).main}}P.Additions=y})(L||(L={}));let Fp=L,{addEvent:Iu,normalizeTickInterval:bc,pick:ef}=Zt;(function(P){function d(){this.type!=="logarithmic"?this.logarithmic=void 0:this.logarithmic??(this.logarithmic=new y(this))}function p(){let b=this.logarithmic;b&&(this.lin2val=function(w){return b.lin2log(w)},this.val2lin=function(w){return b.log2lin(w)})}P.compose=function(b){return b.keepProps.includes("logarithmic")||(b.keepProps.push("logarithmic"),Iu(b,"afterSetType",d),Iu(b,"afterInit",p)),b};class y{constructor(w){this.axis=w}getLogTickPositions(w,M,T,S){let O=this.axis,B=O.len,N=O.options,U=[];if(S||(this.minorAutoInterval=void 0),w>=.5)w=Math.round(w),U=O.getLinearTickPositions(w,M,T);else if(w>=.08){let X,Z,te,ne,J,ce,de,ke=Math.floor(M);for(X=w>.3?[1,2,4]:w>.15?[1,2,4,6,8]:[1,2,3,4,5,6,7,8,9],Z=ke;Z<T+1&&!de;Z++)for(te=0,ne=X.length;te<ne&&!de;te++)(J=this.log2lin(this.lin2log(Z)*X[te]))>M&&(!S||ce<=T)&&ce!==void 0&&U.push(ce),ce>T&&(de=!0),ce=J}else{let X=this.lin2log(M),Z=this.lin2log(T),te=S?O.getMinorTickInterval():N.tickInterval,ne=N.tickPixelInterval/(S?5:1),J=S?B/O.tickPositions.length:B;w=bc(w=ef(te==="auto"?null:te,this.minorAutoInterval,(Z-X)*ne/(J||1))),U=O.getLinearTickPositions(w,X,Z).map(this.log2lin),S||(this.minorAutoInterval=w/5)}return S||(O.tickInterval=w),U}lin2log(w){return Math.pow(10,w)}log2lin(w){return Math.log(w)/Math.LN10}}P.Additions=y})(j||(j={}));let ry=j,{erase:Np,extend:xc,isNumber:Gd}=Zt;(function(P){let d;function p(O){return this.addPlotBandOrLine(O,"plotBands")}function y(O,B){let N=this.userOptions,U=new d(this,O);if(this.visible&&(U=U.render()),U){if(this._addedPlotLB||(this._addedPlotLB=!0,(N.plotLines||[]).concat(N.plotBands||[]).forEach(X=>{this.addPlotBandOrLine(X)})),B){let X=N[B]||[];X.push(O),N[B]=X}this.plotLinesAndBands.push(U)}return U}function b(O){return this.addPlotBandOrLine(O,"plotLines")}function w(O,B,N){N=N||this.options;let U=this.getPlotLinePath({value:B,force:!0,acrossPanes:N.acrossPanes}),X=[],Z=this.horiz,te=!Gd(this.min)||!Gd(this.max)||O<this.min&&B<this.min||O>this.max&&B>this.max,ne=this.getPlotLinePath({value:O,force:!0,acrossPanes:N.acrossPanes}),J,ce=1,de;if(ne&&U)for(te&&(de=ne.toString()===U.toString(),ce=0),J=0;J<ne.length;J+=2){let ke=ne[J],Ue=ne[J+1],Le=U[J],Se=U[J+1];(ke[0]==="M"||ke[0]==="L")&&(Ue[0]==="M"||Ue[0]==="L")&&(Le[0]==="M"||Le[0]==="L")&&(Se[0]==="M"||Se[0]==="L")&&(Z&&Le[1]===ke[1]?(Le[1]+=ce,Se[1]+=ce):Z||Le[2]!==ke[2]||(Le[2]+=ce,Se[2]+=ce),X.push(["M",ke[1],ke[2]],["L",Ue[1],Ue[2]],["L",Se[1],Se[2]],["L",Le[1],Le[2]],["Z"])),X.isFlat=de}return X}function M(O){this.removePlotBandOrLine(O)}function T(O){let B=this.plotLinesAndBands,N=this.options,U=this.userOptions;if(B){let X=B.length;for(;X--;)B[X].id===O&&B[X].destroy();[N.plotLines||[],U.plotLines||[],N.plotBands||[],U.plotBands||[]].forEach(function(Z){for(X=Z.length;X--;)(Z[X]||{}).id===O&&Np(Z,Z[X])})}}function S(O){this.removePlotBandOrLine(O)}P.compose=function(O,B){let N=B.prototype;return N.addPlotBand||(d=O,xc(N,{addPlotBand:p,addPlotLine:b,addPlotBandOrLine:y,getPlotBandPath:w,removePlotBand:M,removePlotLine:S,removePlotBandOrLine:T})),B}})(Y||(Y={}));let tf=Y,{addEvent:nf,arrayMax:Su,arrayMin:wc,defined:ho,destroyObjectProperties:rf,erase:zp,fireEvent:of,merge:sf,objectEach:Fa,pick:Bp}=Zt;class Au{static compose(d,p){return nf(d,"afterInit",function(){this.labelCollectors.push(()=>{let y=[];for(let b of this.axes)for(let{label:w,options:M}of b.plotLinesAndBands)w&&!M?.label?.allowOverlap&&y.push(w);return y})}),tf.compose(Au,p)}constructor(d,p){this.axis=d,this.options=p,this.id=p.id}render(){of(this,"render");let{axis:d,options:p}=this,{horiz:y,logarithmic:b}=d,{color:w,events:M,zIndex:T=0}=p,{renderer:S,time:O}=d.chart,B={},N=O.parse(p.to),U=O.parse(p.from),X=O.parse(p.value),Z=p.borderWidth,te=p.label,{label:ne,svgElem:J}=this,ce=[],de,ke=ho(U)&&ho(N),Ue=ho(X),Le=!J,Se={class:"highcharts-plot-"+(ke?"band ":"line ")+(p.className||"")},ze=ke?"bands":"lines";if(!d.chart.styledMode&&(Ue?(Se.stroke=w||"#999999",Se["stroke-width"]=Bp(p.width,1),p.dashStyle&&(Se.dashstyle=p.dashStyle)):ke&&(Se.fill=w||"#e6e9ff",Z&&(Se.stroke=p.borderColor,Se["stroke-width"]=Z))),B.zIndex=T,ze+="-"+T,(de=d.plotLinesAndBandsGroups[ze])||(d.plotLinesAndBandsGroups[ze]=de=S.g("plot-"+ze).attr(B).add()),J||(this.svgElem=J=S.path().attr(Se).add(de)),ho(X))ce=d.getPlotLinePath({value:b?.log2lin(X)??X,lineWidth:J.strokeWidth(),acrossPanes:p.acrossPanes});else{if(!(ho(U)&&ho(N)))return;ce=d.getPlotBandPath(b?.log2lin(U)??U,b?.log2lin(N)??N,p)}return!this.eventsAdded&&M&&(Fa(M,(nt,rt)=>{J?.on(rt,pt=>{M[rt].apply(this,[pt])})}),this.eventsAdded=!0),(Le||!J.d)&&ce?.length?J.attr({d:ce}):J&&(ce?(J.show(),J.animate({d:ce})):J.d&&(J.hide(),ne&&(this.label=ne=ne.destroy()))),te&&(ho(te.text)||ho(te.formatter))&&ce?.length&&d.width>0&&d.height>0&&!ce.isFlat?(te=sf(ut({align:y&&ke?"center":void 0,x:y?!ke&&4:10,verticalAlign:!y&&ke?"middle":void 0,y:y?ke?16:10:ke?6:-4,rotation:y&&!ke?90:0},ke?{inside:!0}:{}),te),this.renderLabel(te,ce,ke,T)):ne&&ne.hide(),this}renderLabel(d,p,y,b){let w=this.axis,M=w.chart.renderer,T=d.inside,S=this.label;S||(this.label=S=M.text(this.getLabelText(d),0,0,d.useHTML).attr({align:d.textAlign||d.align,rotation:d.rotation,class:"highcharts-plot-"+(y?"band":"line")+"-label "+(d.className||""),zIndex:b}),w.chart.styledMode||S.css(sf({fontSize:"0.8em",textOverflow:y&&!T?"":"ellipsis"},d.style)),S.add());let O=p.xBounds||[p[0][1],p[1][1],y?p[2][1]:p[0][1]],B=p.yBounds||[p[0][2],p[1][2],y?p[2][2]:p[0][2]],N=wc(O),U=wc(B),X=Su(O)-N;S.align(d,!1,{x:N,y:U,width:X,height:Su(B)-U}),(!S.alignValue||S.alignValue==="left"||ho(T))&&S.css({width:(d.style?.width||(y&&T?X:S.rotation===90?w.height-(S.alignAttr.y-w.top):(d.clip?w.width:w.chart.chartWidth)-(S.alignAttr.x-w.left)))+"px"}),S.show(!0)}getLabelText(d){return ho(d.formatter)?d.formatter.call(this):d.text}destroy(){zp(this.axis.plotLinesAndBands,this),delete this.axis,rf(this)}}let{animObject:oy}=Ln,{format:af}=Mt,{composed:lf,dateFormats:jp,doc:cf,isSafari:Zr}=lt,{distribute:sy}=Wr,{addEvent:Vp,clamp:Cc,css:Up,discardElement:No,extend:$p,fireEvent:Hp,isArray:ns,isNumber:Es,isObject:Al,isString:Ec,merge:Ot,pick:Na,pushUnique:uf,splat:za,syncTimeout:kl}=Zt;class At{constructor(d,p,y){this.allowShared=!0,this.crosshairs=[],this.distance=0,this.isHidden=!0,this.isSticky=!1,this.options={},this.outside=!1,this.chart=d,this.init(d,p),this.pointer=y}bodyFormatter(d){return d.map(p=>{let y=p.series.tooltipOptions,b=p.formatPrefix||"point";return(y[b+"Formatter"]||p.tooltipFormatter).call(p,y[b+"Format"]||"")})}cleanSplit(d){this.chart.series.forEach(function(p){let y=p&&p.tt;y&&(!y.isActive||d?p.tt=y.destroy():y.isActive=!1)})}defaultFormatter(d){let p,y=this.points||za(this);return(p=(p=[d.headerFooterFormatter(y[0])]).concat(d.bodyFormatter(y))).push(d.headerFooterFormatter(y[0],!0)),p}destroy(){this.label&&(this.label=this.label.destroy()),this.split&&(this.cleanSplit(!0),this.tt&&(this.tt=this.tt.destroy())),this.renderer&&(this.renderer=this.renderer.destroy(),No(this.container)),Zt.clearTimeout(this.hideTimer)}getAnchor(d,p){let y,{chart:b,pointer:w}=this,M=b.inverted,T=b.plotTop,S=b.plotLeft;if((d=za(d))[0].series&&d[0].series.yAxis&&!d[0].series.yAxis.options.reversedStacks&&(d=d.slice().reverse()),this.followPointer&&p)p.chartX===void 0&&(p=w.normalize(p)),y=[p.chartX-S,p.chartY-T];else if(d[0].tooltipPos)y=d[0].tooltipPos;else{let O=0,B=0;d.forEach(function(N){let U=N.pos(!0);U&&(O+=U[0],B+=U[1])}),O/=d.length,B/=d.length,this.shared&&d.length>1&&p&&(M?O=p.chartX:B=p.chartY),y=[O-S,B-T]}return y.map(Math.round)}getClassName(d,p,y){let b=this.options,w=d.series,M=w.options;return[b.className,"highcharts-label",y&&"highcharts-tooltip-header",p?"highcharts-tooltip-box":"highcharts-tooltip",!y&&"highcharts-color-"+Na(d.colorIndex,w.colorIndex),M&&M.className].filter(Ec).join(" ")}getLabel({anchorX:d,anchorY:p}={anchorX:0,anchorY:0}){let y=this,b=this.chart.styledMode,w=this.options,M=this.split&&this.allowShared,T=this.container,S=this.chart.renderer;if(this.label){let O=!this.label.hasClass("highcharts-label");(!M&&O||M&&!O)&&this.destroy()}if(!this.label){if(this.outside){let O=this.chart,B=O.options.chart.style,N=En.getRendererType();this.container=T=lt.doc.createElement("div"),T.className="highcharts-tooltip-container "+(O.renderTo.className.match(/(highcharts[a-zA-Z0-9-]+)\s?/gm)||""),Up(T,{position:"absolute",top:"1px",pointerEvents:"none",zIndex:Math.max(this.options.style.zIndex||0,(B&&B.zIndex||0)+3)}),this.renderer=S=new N(T,0,0,B,void 0,void 0,S.styledMode)}if(M?this.label=S.g("tooltip"):(this.label=S.label("",d,p,w.shape,void 0,void 0,w.useHTML,void 0,"tooltip").attr({padding:w.padding,r:w.borderRadius}),b||this.label.attr({fill:w.backgroundColor,"stroke-width":w.borderWidth||0}).css(w.style).css({pointerEvents:w.style.pointerEvents||(this.shouldStickOnContact()?"auto":"none")})),y.outside){let O=this.label;[O.xSetter,O.ySetter].forEach((B,N)=>{O[N?"ySetter":"xSetter"]=U=>{B.call(O,y.distance),O[N?"y":"x"]=U,T&&(T.style[N?"top":"left"]=`${U}px`)}})}this.label.attr({zIndex:8}).shadow(w.shadow).add()}return T&&!T.parentElement&&lt.doc.body.appendChild(T),this.label}getPlayingField(){let{body:d,documentElement:p}=cf,{chart:y,distance:b,outside:w}=this;return{width:w?Math.max(d.scrollWidth,p.scrollWidth,d.offsetWidth,p.offsetWidth,p.clientWidth)-2*b-2:y.chartWidth,height:w?Math.max(d.scrollHeight,p.scrollHeight,d.offsetHeight,p.offsetHeight,p.clientHeight):y.chartHeight}}getPosition(d,p,y){let{distance:b,chart:w,outside:M,pointer:T}=this,{inverted:S,plotLeft:O,plotTop:B,polar:N}=w,{plotX:U=0,plotY:X=0}=y,Z={},te=S&&y.h||0,{height:ne,width:J}=this.getPlayingField(),ce=T.getChartPosition(),de=Yt=>Yt*ce.scaleX,ke=Yt=>Yt*ce.scaleY,Ue=Yt=>{let zt=Yt==="x";return[Yt,zt?J:ne,zt?d:p].concat(M?[zt?de(d):ke(p),zt?ce.left-b+de(U+O):ce.top-b+ke(X+B),0,zt?J:ne]:[zt?d:p,zt?U+O:X+B,zt?O:B,zt?O+w.plotWidth:B+w.plotHeight])},Le=Ue("y"),Se=Ue("x"),ze,nt=!!y.negative;!N&&w.hoverSeries?.yAxis?.reversed&&(nt=!nt);let rt=!this.followPointer&&Na(y.ttBelow,!N&&!S===nt),pt=function(Yt,zt,Sn,hn,fn,qn,an){let br=M?Yt==="y"?ke(b):de(b):b,Ki=(Sn-hn)/2,ei=hn<fn-b,An=fn+b+hn<zt,wi=fn-br-Sn+Ki,ji=fn+br-Ki;if(rt&&An)Z[Yt]=ji;else if(!rt&&ei)Z[Yt]=wi;else if(ei)Z[Yt]=Math.min(an-hn,wi-te<0?wi:wi-te);else{if(!An)return!1;Z[Yt]=Math.max(qn,ji+te+Sn>zt?ji:ji+te)}},Bt=function(Yt,zt,Sn,hn,fn){if(fn<b||fn>zt-b)return!1;fn<Sn/2?Z[Yt]=1:fn>zt-hn/2?Z[Yt]=zt-hn-2:Z[Yt]=fn-Sn/2},Lt=function(Yt){[Le,Se]=[Se,Le],ze=Yt},jt=()=>{pt.apply(0,Le)!==!1?Bt.apply(0,Se)!==!1||ze||(Lt(!0),jt()):ze?Z.x=Z.y=0:(Lt(!0),jt())};return(S&&!N||this.len>1)&&Lt(),jt(),Z}hide(d){let p=this;Zt.clearTimeout(this.hideTimer),d=Na(d,this.options.hideDelay),this.isHidden||(this.hideTimer=kl(function(){let y=p.getLabel();p.getLabel().animate({opacity:0},{duration:d&&150,complete:()=>{y.hide(),p.container&&p.container.remove()}}),p.isHidden=!0},d))}init(d,p){this.chart=d,this.options=p,this.crosshairs=[],this.isHidden=!0,this.split=p.split&&!d.inverted&&!d.polar,this.shared=p.shared||this.split,this.outside=Na(p.outside,!!(d.scrollablePixelsX||d.scrollablePixelsY))}shouldStickOnContact(d){return!!(!this.followPointer&&this.options.stickOnContact&&(!d||this.pointer.inClass(d.target,"highcharts-tooltip")))}move(d,p,y,b){let w=this,M=oy(!w.isHidden&&w.options.animation),T=w.followPointer||(w.len||0)>1,S={x:d,y:p};T||(S.anchorX=y,S.anchorY=b),M.step=()=>w.drawTracker(),w.getLabel().animate(S,M)}refresh(d,p){let{chart:y,options:b,pointer:w,shared:M}=this,T=za(d),S=T[0],O=b.format,B=b.formatter||this.defaultFormatter,N=y.styledMode,U=this.allowShared;if(!b.enabled||!S.series)return;Zt.clearTimeout(this.hideTimer),this.allowShared=!(!ns(d)&&d.series&&d.series.noSharedTooltip),U=U&&!this.allowShared,this.followPointer=!this.split&&S.series.tooltipOptions.followPointer;let X=this.getAnchor(d,p),Z=X[0],te=X[1];M&&this.allowShared&&(w.applyInactiveState(T),T.forEach(ce=>ce.setState("hover")),S.points=T),this.len=T.length;let ne=Ec(O)?af(O,S,y):B.call(S,this);S.points=void 0;let J=S.series;if(this.distance=Na(J.tooltipOptions.distance,16),ne===!1)this.hide();else{if(this.split&&this.allowShared)this.renderSplit(ne,T);else{let ce=Z,de=te;if(p&&w.isDirectTouch&&(ce=p.chartX-y.plotLeft,de=p.chartY-y.plotTop),y.polar||J.options.clip===!1||T.some(ke=>w.isDirectTouch||ke.series.shouldShowTooltip(ce,de))){let ke=this.getLabel(U&&this.tt||{});(!b.style.width||N)&&ke.css({width:(this.outside?this.getPlayingField():y.spacingBox).width+"px"}),ke.attr({class:this.getClassName(S),text:ne&&ne.join?ne.join(""):ne}),this.outside&&ke.attr({x:Cc(ke.x||0,0,this.getPlayingField().width-(ke.width||0)-1)}),N||ke.attr({stroke:b.borderColor||S.color||J.color||"#666666"}),this.updatePosition({plotX:Z,plotY:te,negative:S.negative,ttBelow:S.ttBelow,h:X[2]||0})}else{this.hide();return}}this.isHidden&&this.label&&this.label.attr({opacity:1}).show(),this.isHidden=!1}Hp(this,"refresh")}renderSplit(d,p){let y=this,{chart:b,chart:{chartWidth:w,chartHeight:M,plotHeight:T,plotLeft:S,plotTop:O,scrollablePixelsY:B=0,scrollablePixelsX:N,styledMode:U},distance:X,options:Z,options:{positioner:te},pointer:ne}=y,{scrollLeft:J=0,scrollTop:ce=0}=b.scrollablePlotArea?.scrollingContainer||{},de=y.outside&&typeof N!="number"?cf.documentElement.getBoundingClientRect():{left:J,right:J+w,top:ce,bottom:ce+M},ke=y.getLabel(),Ue=this.renderer||b.renderer,Le=!!(b.xAxis[0]&&b.xAxis[0].opposite),{left:Se,top:ze}=ne.getChartPosition(),nt=O+ce,rt=0,pt=T-B;function Bt(hn,fn,qn,an,br=!0){let Ki,ei;return qn?(Ki=Le?0:pt,ei=Cc(hn-an/2,de.left,de.right-an-(y.outside?Se:0))):(Ki=fn-nt,ei=Cc(ei=br?hn-an-X:hn+X,br?ei:de.left,de.right)),{x:ei,y:Ki}}Ec(d)&&(d=[!1,d]);let Lt=d.slice(0,p.length+1).reduce(function(hn,fn,qn){if(fn!==!1&&fn!==""){let an=p[qn-1]||{isHeader:!0,plotX:p[0].plotX,plotY:T,series:{}},br=an.isHeader,Ki=br?y:an.series,ei=Ki.tt=function(Qi,So,$a){let ks=Qi,{isHeader:zf,series:Dm}=So;if(!ks){let Wu={padding:Z.padding,r:Z.borderRadius};U||(Wu.fill=Z.backgroundColor,Wu["stroke-width"]=Z.borderWidth??1),ks=Ue.label("",0,0,Z[zf?"headerShape":"shape"],void 0,void 0,Z.useHTML).addClass(y.getClassName(So,!0,zf)).attr(Wu).add(ke)}return ks.isActive=!0,ks.attr({text:$a}),U||ks.css(Z.style).attr({stroke:Z.borderColor||So.color||Dm.color||"#333333"}),ks}(Ki.tt,an,fn.toString()),An=ei.getBBox(),wi=An.width+ei.strokeWidth();br&&(rt=An.height,pt+=rt,Le&&(nt-=rt));let{anchorX:ji,anchorY:Pr}=function(Qi){let So,$a,{isHeader:ks,plotX:zf=0,plotY:Dm=0,series:Wu}=Qi;if(ks)So=Math.max(S+zf,S),$a=O+T/2;else{let{xAxis:Uy,yAxis:$y}=Wu;So=Uy.pos+Cc(zf,-X,Uy.len+X),Wu.shouldShowTooltip(0,$y.pos-O+Dm,{ignoreX:!0})&&($a=$y.pos+Dm)}return{anchorX:So=Cc(So,de.left-X,de.right+X),anchorY:$a}}(an);if(typeof Pr=="number"){let Qi=An.height+1,So=te?te.call(y,wi,Qi,an):Bt(ji,Pr,br,wi);hn.push({align:te?0:void 0,anchorX:ji,anchorY:Pr,boxWidth:wi,point:an,rank:Na(So.rank,br?1:0),size:Qi,target:So.y,tt:ei,x:So.x})}else ei.isActive=!1}return hn},[]);!te&&Lt.some(hn=>{let{outside:fn}=y,qn=(fn?Se:0)+hn.anchorX;return qn<de.left&&qn+hn.boxWidth<de.right||qn<Se-de.left+hn.boxWidth&&de.right-qn>qn})&&(Lt=Lt.map(hn=>{let{x:fn,y:qn}=Bt(hn.anchorX,hn.anchorY,hn.point.isHeader,hn.boxWidth,!1);return $p(hn,{target:qn,x:fn})})),y.cleanSplit(),sy(Lt,pt);let jt={left:Se,right:Se};Lt.forEach(function(hn){let{x:fn,boxWidth:qn,isHeader:an}=hn;!an&&(y.outside&&Se+fn<jt.left&&(jt.left=Se+fn),!an&&y.outside&&jt.left+qn>jt.right&&(jt.right=Se+fn))}),Lt.forEach(function(hn){let{x:fn,anchorX:qn,anchorY:an,pos:br,point:{isHeader:Ki}}=hn,ei={visibility:br===void 0?"hidden":"inherit",x:fn,y:(br||0)+nt,anchorX:qn,anchorY:an};if(y.outside&&fn<qn){let An=Se-jt.left;An>0&&(Ki||(ei.x=fn+An,ei.anchorX=qn+An),Ki&&(ei.x=(jt.right-jt.left)/2,ei.anchorX=qn+An))}hn.tt.attr(ei)});let{container:Yt,outside:zt,renderer:Sn}=y;if(zt&&Yt&&Sn){let{width:hn,height:fn,x:qn,y:an}=ke.getBBox();Sn.setSize(hn+qn,fn+an,!1),Yt.style.left=jt.left+"px",Yt.style.top=ze+"px"}Zr&&ke.attr({opacity:ke.opacity===1?.999:1})}drawTracker(){if(!this.shouldStickOnContact()){this.tracker&&(this.tracker=this.tracker.destroy());return}let d=this.chart,p=this.label,y=this.shared?d.hoverPoints:d.hoverPoint;if(!p||!y)return;let b={x:0,y:0,width:0,height:0},w=this.getAnchor(y),M=p.getBBox();w[0]+=d.plotLeft-(p.translateX||0),w[1]+=d.plotTop-(p.translateY||0),b.x=Math.min(0,w[0]),b.y=Math.min(0,w[1]),b.width=w[0]<0?Math.max(Math.abs(w[0]),M.width-w[0]):Math.max(Math.abs(w[0]),M.width),b.height=w[1]<0?Math.max(Math.abs(w[1]),M.height-Math.abs(w[1])):Math.max(Math.abs(w[1]),M.height),this.tracker?this.tracker.attr(b):(this.tracker=p.renderer.rect(b).addClass("highcharts-tracker").add(p),d.styledMode||this.tracker.attr({fill:"rgba(0,0,0,0)"}))}styledModeFormat(d){return d.replace('style="font-size: 0.8em"','class="highcharts-header"').replace(/style="color:{(point|series)\.color}"/g,'class="highcharts-color-{$1.colorIndex} {series.options.className} {point.options.className}"')}headerFooterFormatter(d,p){let y=d.series,b=y.tooltipOptions,w=y.xAxis,M=w&&w.dateTime,T={isFooter:p,point:d},S=b.xDateFormat||"",O=b[p?"footerFormat":"headerFormat"];return Hp(this,"headerFormatter",T,function(B){if(M&&!S&&Es(d.key)&&(S=M.getXDateFormat(d.key,b.dateTimeLabelFormats)),M&&S){if(Al(S)){let N=S;jp[0]=U=>y.chart.time.dateFormat(N,U),S="%0"}(d.tooltipDateKeys||["key"]).forEach(N=>{O=O.replace(RegExp("point\\."+N+"([ \\)}])",""),`(point.${N}:${S})$1`)})}y.chart.styledMode&&(O=this.styledModeFormat(O)),B.text=af(O,d,this.chart)}),T.text||""}update(d){this.destroy(),this.init(this.chart,Ot(!0,this.options,d))}updatePosition(d){let{chart:p,container:y,distance:b,options:w,pointer:M,renderer:T}=this,{height:S=0,width:O=0}=this.getLabel(),{left:B,top:N,scaleX:U,scaleY:X}=M.getChartPosition(),Z=(w.positioner||this.getPosition).call(this,O,S,d),te=lt.doc,ne=(d.plotX||0)+p.plotLeft,J=(d.plotY||0)+p.plotTop,ce;T&&y&&(w.positioner&&(Z.x+=B-b,Z.y+=N-b),ce=(w.borderWidth||0)+2*b+2,T.setSize(Cc(O+ce,0,te.documentElement.clientWidth)-1,S+ce,!1),(U!==1||X!==1)&&(Up(y,{transform:`scale(${U}, ${X})`}),ne*=U,J*=X),ne+=B-Z.x,J+=N-Z.y),this.move(Math.round(Z.x),Math.round(Z.y||0),ne,J)}}(function(P){P.compose=function(d){uf(lf,"Core.Tooltip")&&Vp(d,"afterInit",function(){let p=this.chart;p.options.tooltip&&(p.tooltip=new P(p,p.options.tooltip,this))})}})(At||(At={}));let Wd=At,{animObject:ay}=Ln,{defaultOptions:Gp}=Sr,{format:df}=Mt,{addEvent:Wp,crisp:qp,erase:ly,extend:qd,fireEvent:ku,getNestedProperty:hf,isArray:ff,isFunction:Dc,isNumber:m,isObject:l,merge:h,pick:_,syncTimeout:x,removeEvent:D,uniqueKey:k}=Zt;class R{animateBeforeDestroy(){let d=this,p={x:d.startXPos,opacity:0},y=d.getGraphicalProps();y.singular.forEach(function(b){d[b]=d[b].animate(b==="dataLabel"?{x:d[b].startXPos,y:d[b].startYPos,opacity:0}:p)}),y.plural.forEach(function(b){d[b].forEach(function(w){w.element&&w.animate(qd({x:d.startXPos},w.startYPos?{x:w.startXPos,y:w.startYPos}:{}))})})}applyOptions(d,p){let y=this.series,b=y.options.pointValKey||y.pointValKey;return qd(this,d=R.prototype.optionsToObject.call(this,d)),this.options=this.options?qd(this.options,d):d,d.group&&delete this.group,d.dataLabels&&delete this.dataLabels,b&&(this.y=R.prototype.getNestedProperty.call(this,b)),this.selected&&(this.state="select"),"name"in this&&p===void 0&&y.xAxis&&y.xAxis.hasNames&&(this.x=y.xAxis.nameToX(this)),this.x===void 0&&y?this.x=p??y.autoIncrement():m(d.x)&&y.options.relativeXValue?this.x=y.autoIncrement(d.x):typeof this.x=="string"&&(p??(p=y.chart.time.parse(this.x)),m(p)&&(this.x=p)),this.isNull=this.isValid&&!this.isValid(),this.formatPrefix=this.isNull?"null":"point",this}destroy(){if(!this.destroyed){let d=this,p=d.series,y=p.chart,b=p.options.dataSorting,w=y.hoverPoints,M=ay(d.series.chart.renderer.globalAnimation),T=()=>{for(let S in(d.graphic||d.graphics||d.dataLabel||d.dataLabels)&&(D(d),d.destroyElements()),d)delete d[S]};d.legendItem&&y.legend.destroyItem(d),w&&(d.setState(),ly(w,d),w.length||(y.hoverPoints=null)),d===y.hoverPoint&&d.onMouseOut(),b&&b.enabled?(this.animateBeforeDestroy(),x(T,M.duration)):T(),y.pointCount--}this.destroyed=!0}destroyElements(d){let p=this,y=p.getGraphicalProps(d);y.singular.forEach(function(b){p[b]=p[b].destroy()}),y.plural.forEach(function(b){p[b].forEach(function(w){w&&w.element&&w.destroy()}),delete p[b]})}firePointEvent(d,p,y){let b=this,w=this.series.options;b.manageEvent(d),d==="click"&&w.allowPointSelect&&(y=function(M){!b.destroyed&&b.select&&b.select(null,M.ctrlKey||M.metaKey||M.shiftKey)}),ku(b,d,p,y)}getClassName(){return"highcharts-point"+(this.selected?" highcharts-point-select":"")+(this.negative?" highcharts-negative":"")+(this.isNull?" highcharts-null-point":"")+(this.colorIndex!==void 0?" highcharts-color-"+this.colorIndex:"")+(this.options.className?" "+this.options.className:"")+(this.zone&&this.zone.className?" "+this.zone.className.replace("highcharts-negative",""):"")}getGraphicalProps(d){let p,y,b=this,w=[],M={singular:[],plural:[]};for((d=d||{graphic:1,dataLabel:1}).graphic&&w.push("graphic","connector"),d.dataLabel&&w.push("dataLabel","dataLabelPath","dataLabelUpper"),y=w.length;y--;)b[p=w[y]]&&M.singular.push(p);return["graphic","dataLabel"].forEach(function(T){let S=T+"s";d[T]&&b[S]&&M.plural.push(S)}),M}getNestedProperty(d){return d?d.indexOf("custom.")===0?hf(d,this.options):this[d]:void 0}getZone(){let d=this.series,p=d.zones,y=d.zoneAxis||"y",b,w=0;for(b=p[0];this[y]>=b.value;)b=p[++w];return this.nonZonedColor||(this.nonZonedColor=this.color),b&&b.color&&!this.options.color?this.color=b.color:this.color=this.nonZonedColor,b}hasNewShapeType(){return(this.graphic&&(this.graphic.symbolName||this.graphic.element.nodeName))!==this.shapeType}constructor(d,p,y){this.formatPrefix="point",this.visible=!0,this.point=this,this.series=d,this.applyOptions(p,y),this.id??(this.id=k()),this.resolveColor(),d.chart.pointCount++,ku(this,"afterInit")}isValid(){return(m(this.x)||this.x instanceof Date)&&m(this.y)}optionsToObject(d){let p=this.series,y=p.options.keys,b=y||p.pointArrayMap||["y"],w=b.length,M={},T,S=0,O=0;if(m(d)||d===null)M[b[0]]=d;else if(ff(d))for(!y&&d.length>w&&((T=typeof d[0])=="string"?p.xAxis?.dateTime?M.x=p.chart.time.parse(d[0]):M.name=d[0]:T==="number"&&(M.x=d[0]),S++);O<w;)y&&d[S]===void 0||(b[O].indexOf(".")>0?R.prototype.setNestedProperty(M,d[S],b[O]):M[b[O]]=d[S]),S++,O++;else typeof d=="object"&&(M=d,d.dataLabels&&(p.hasDataLabels=()=>!0),d.marker&&(p._hasPointMarkers=!0));return M}pos(d,p=this.plotY){if(!this.destroyed){let{plotX:y,series:b}=this,{chart:w,xAxis:M,yAxis:T}=b,S=0,O=0;if(m(y)&&m(p))return d&&(S=M?M.pos:w.plotLeft,O=T?T.pos:w.plotTop),w.inverted&&M&&T?[T.len-p+O,M.len-y+S]:[y+S,p+O]}}resolveColor(){let d=this.series,p=d.chart.options.chart,y=d.chart.styledMode,b,w,M=p.colorCount,T;delete this.nonZonedColor,d.options.colorByPoint?(y||(b=(w=d.options.colors||d.chart.options.colors)[d.colorCounter],M=w.length),T=d.colorCounter,d.colorCounter++,d.colorCounter===M&&(d.colorCounter=0)):(y||(b=d.color),T=d.colorIndex),this.colorIndex=_(this.options.colorIndex,T),this.color=_(this.options.color,b)}setNestedProperty(d,p,y){return y.split(".").reduce(function(b,w,M,T){let S=T.length-1===M;return b[w]=S?p:l(b[w],!0)?b[w]:{},b[w]},d),d}shouldDraw(){return!this.isNull}tooltipFormatter(d){let{chart:p,pointArrayMap:y=["y"],tooltipOptions:b}=this.series,{valueDecimals:w="",valuePrefix:M="",valueSuffix:T=""}=b;return p.styledMode&&(d=p.tooltip?.styledModeFormat(d)||d),y.forEach(S=>{S="{point."+S,(M||T)&&(d=d.replace(RegExp(S+"}","g"),M+S+"}"+T)),d=d.replace(RegExp(S+"}","g"),S+":,."+w+"f}")}),df(d,this,p)}update(d,p,y,b){let w,M=this,T=M.series,S=M.graphic,O=T.chart,B=T.options;function N(){M.applyOptions(d);let U=S&&M.hasMockGraphic,X=M.y===null?!U:U;S&&X&&(M.graphic=S.destroy(),delete M.hasMockGraphic),l(d,!0)&&(S&&S.element&&d&&d.marker&&d.marker.symbol!==void 0&&(M.graphic=S.destroy()),d?.dataLabels&&M.dataLabel&&(M.dataLabel=M.dataLabel.destroy())),w=M.index;let Z={};for(let te of T.dataColumnKeys())Z[te]=M[te];T.dataTable.setRow(Z,w),B.data[w]=l(B.data[w],!0)||l(d,!0)?M.options:_(d,B.data[w]),T.isDirty=T.isDirtyData=!0,!T.fixedBox&&T.hasCartesianSeries&&(O.isDirtyBox=!0),B.legendType==="point"&&(O.isDirtyLegend=!0),p&&O.redraw(y)}p=_(p,!0),b===!1?N():M.firePointEvent("update",{options:d},N)}remove(d,p){this.series.removePoint(this.series.data.indexOf(this),d,p)}select(d,p){let y=this,b=y.series,w=b.chart;d=_(d,!y.selected),this.selectedStaging=d,y.firePointEvent(d?"select":"unselect",{accumulate:p},function(){y.selected=y.options.selected=d,b.options.data[b.data.indexOf(y)]=y.options,y.setState(d&&"select"),p||w.getSelectedPoints().forEach(function(M){let T=M.series;M.selected&&M!==y&&(M.selected=M.options.selected=!1,T.options.data[T.data.indexOf(M)]=M.options,M.setState(w.hoverPoints&&T.options.inactiveOtherPoints?"inactive":""),M.firePointEvent("unselect"))})}),delete this.selectedStaging}onMouseOver(d){let{inverted:p,pointer:y}=this.series.chart;y&&(d=d?y.normalize(d):y.getChartCoordinatesFromPoint(this,p),y.runPointActions(d,this))}onMouseOut(){let d=this.series.chart;this.firePointEvent("mouseOut"),this.series.options.inactiveOtherPoints||(d.hoverPoints||[]).forEach(function(p){p.setState()}),d.hoverPoints=d.hoverPoint=null}manageEvent(d){let p=h(this.series.options.point,this.options),y=p.events?.[d];Dc(y)&&(!this.hcEvents?.[d]||this.hcEvents?.[d]?.map(b=>b.fn).indexOf(y)===-1)?(this.importedUserEvent?.(),this.importedUserEvent=Wp(this,d,y),this.hcEvents&&(this.hcEvents[d].userEvent=!0)):this.importedUserEvent&&!y&&this.hcEvents?.[d]&&this.hcEvents?.[d].userEvent&&(D(this,d),delete this.hcEvents[d],Object.keys(this.hcEvents)||delete this.importedUserEvent)}setState(d,p){let y=this.series,b=this.state,w=y.options.states[d||"normal"]||{},M=Gp.plotOptions[y.type].marker&&y.options.marker,T=M&&M.enabled===!1,S=M&&M.states&&M.states[d||"normal"]||{},O=S.enabled===!1,B=this.marker||{},N=y.chart,U=M&&y.markerAttribs,X=y.halo,Z,te,ne,J=y.stateMarkerGraphic,ce;if((d=d||"")===this.state&&!p||this.selected&&d!=="select"||w.enabled===!1||d&&(O||T&&S.enabled===!1)||d&&B.states&&B.states[d]&&B.states[d].enabled===!1)return;if(this.state=d,U&&(Z=y.markerAttribs(this,d)),this.graphic&&!this.hasMockGraphic){if(b&&this.graphic.removeClass("highcharts-point-"+b),d&&this.graphic.addClass("highcharts-point-"+d),!N.styledMode){te=y.pointAttribs(this,d),ne=_(N.options.chart.animation,w.animation);let Le=te.opacity;y.options.inactiveOtherPoints&&m(Le)&&(this.dataLabels||[]).forEach(function(Se){Se&&!Se.hasClass("highcharts-data-label-hidden")&&(Se.animate({opacity:Le},ne),Se.connector&&Se.connector.animate({opacity:Le},ne))}),this.graphic.animate(te,ne)}Z&&this.graphic.animate(Z,_(N.options.chart.animation,S.animation,M.animation)),J&&J.hide()}else d&&S&&(ce=B.symbol||y.symbol,J&&J.currentSymbol!==ce&&(J=J.destroy()),Z&&(J?J[p?"animate":"attr"]({x:Z.x,y:Z.y}):ce&&(y.stateMarkerGraphic=J=N.renderer.symbol(ce,Z.x,Z.y,Z.width,Z.height,h(M,S)).add(y.markerGroup),J.currentSymbol=ce)),!N.styledMode&&J&&this.state!=="inactive"&&J.attr(y.pointAttribs(this,d))),J&&(J[d&&this.isInside?"show":"hide"](),J.element.point=this,J.addClass(this.getClassName(),!0));let de=w.halo,ke=this.graphic||J,Ue=ke&&ke.visibility||"inherit";de&&de.size&&ke&&Ue!=="hidden"&&!this.isCluster?(X||(y.halo=X=N.renderer.path().add(ke.parentGroup)),X.show()[p?"animate":"attr"]({d:this.haloPath(de.size)}),X.attr({class:"highcharts-halo highcharts-color-"+_(this.colorIndex,y.colorIndex)+(this.className?" "+this.className:""),visibility:Ue,zIndex:-1}),X.point=this,N.styledMode||X.attr(qd({fill:this.color||y.color,"fill-opacity":de.opacity},bi.filterUserAttributes(de.attributes||{})))):X?.point?.haloPath&&!X.point.destroyed&&X.animate({d:X.point.haloPath(0)},null,X.hide),ku(this,"afterSetState",{state:d})}haloPath(d){let p=this.pos();return p?this.series.chart.renderer.symbols.circle(qp(p[0],1)-d,p[1]-d,2*d,2*d):[]}}let z=R,{parse:G}=re,{charts:H,composed:K,isTouchDevice:se}=lt,{addEvent:le,attr:fe,css:he,extend:pe,find:Q,fireEvent:ue,isNumber:ye,isObject:_e,objectEach:Ae,offset:Re,pick:Me,pushUnique:Be,splat:Fe}=Zt;class je{applyInactiveState(d){let p=[],y;(d||[]).forEach(function(b){y=b.series,p.push(y),y.linkedParent&&p.push(y.linkedParent),y.linkedSeries&&(p=p.concat(y.linkedSeries)),y.navigatorSeries&&p.push(y.navigatorSeries)}),this.chart.series.forEach(function(b){p.indexOf(b)===-1?b.setState("inactive",!0):b.options.inactiveOtherPoints&&b.setAllPointsToState("inactive")})}destroy(){let d=this;this.eventsToUnbind.forEach(p=>p()),this.eventsToUnbind=[],!lt.chartCount&&(je.unbindDocumentMouseUp.forEach(p=>p.unbind()),je.unbindDocumentMouseUp.length=0,je.unbindDocumentTouchEnd&&(je.unbindDocumentTouchEnd=je.unbindDocumentTouchEnd())),clearInterval(d.tooltipTimeout),Ae(d,function(p,y){d[y]=void 0})}getSelectionMarkerAttrs(d,p){let y={args:{chartX:d,chartY:p},attrs:{},shapeType:"rect"};return ue(this,"getSelectionMarkerAttrs",y,b=>{let w,{chart:M,zoomHor:T,zoomVert:S}=this,{mouseDownX:O=0,mouseDownY:B=0}=M,N=b.attrs;N.x=M.plotLeft,N.y=M.plotTop,N.width=T?1:M.plotWidth,N.height=S?1:M.plotHeight,T&&(w=d-O,N.width=Math.max(1,Math.abs(w)),N.x=(w>0?0:w)+O),S&&(w=p-B,N.height=Math.max(1,Math.abs(w)),N.y=(w>0?0:w)+B)}),y}drag(d){let{chart:p}=this,{mouseDownX:y=0,mouseDownY:b=0}=p,{panning:w,panKey:M,selectionMarkerFill:T}=p.options.chart,S=p.plotLeft,O=p.plotTop,B=p.plotWidth,N=p.plotHeight,U=_e(w)?w.enabled:w,X=M&&d[`${M}Key`],Z=d.chartX,te=d.chartY,ne,J=this.selectionMarker;if((!J||!J.touch)&&(Z<S?Z=S:Z>S+B&&(Z=S+B),te<O?te=O:te>O+N&&(te=O+N),this.hasDragged=Math.sqrt(Math.pow(y-Z,2)+Math.pow(b-te,2)),this.hasDragged>10)){ne=p.isInsidePlot(y-S,b-O,{visiblePlotOnly:!0});let{shapeType:ce,attrs:de}=this.getSelectionMarkerAttrs(Z,te);(p.hasCartesianSeries||p.mapView)&&this.hasZoom&&ne&&!X&&!J&&(this.selectionMarker=J=p.renderer[ce](),J.attr({class:"highcharts-selection-marker",zIndex:7}).add(),p.styledMode||J.attr({fill:T||G("#334eff").setOpacity(.25).get()})),J&&J.attr(de),ne&&!J&&U&&p.pan(d,w)}}dragStart(d){let p=this.chart;p.mouseIsDown=d.type,p.cancelClick=!1,p.mouseDownX=d.chartX,p.mouseDownY=d.chartY}getSelectionBox(d){let p={args:{marker:d},result:d.getBBox()};return ue(this,"getSelectionBox",p),p.result}drop(d){let p,{chart:y,selectionMarker:b}=this;for(let w of y.axes)w.isPanning&&(w.isPanning=!1,(w.options.startOnTick||w.options.endOnTick||w.series.some(M=>M.boosted))&&(w.forceRedraw=!0,w.setExtremes(w.userMin,w.userMax,!1),p=!0));if(p&&y.redraw(),b&&d){if(this.hasDragged){let w=this.getSelectionBox(b);y.transform({axes:y.axes.filter(M=>M.zoomEnabled&&(M.coll==="xAxis"&&this.zoomX||M.coll==="yAxis"&&this.zoomY)),selection:ut({originalEvent:d,xAxis:[],yAxis:[]},w),from:w})}ye(y.index)&&(this.selectionMarker=b.destroy())}y&&ye(y.index)&&(he(y.container,{cursor:y._cursor}),y.cancelClick=this.hasDragged>10,y.mouseIsDown=!1,this.hasDragged=0,this.pinchDown=[])}findNearestKDPoint(d,p,y){let b;return d.forEach(function(w){let M=!(w.noSharedTooltip&&p)&&0>w.options.findNearestPointBy.indexOf("y"),T=w.searchPoint(y,M);_e(T,!0)&&T.series&&(!_e(b,!0)||function(S,O){let B=S.distX-O.distX,N=S.dist-O.dist,U=O.series.group?.zIndex-S.series.group?.zIndex;return B!==0&&p?B:N!==0?N:U!==0?U:S.series.index>O.series.index?-1:1}(b,T)>0)&&(b=T)}),b}getChartCoordinatesFromPoint(d,p){let{xAxis:y,yAxis:b}=d.series,w=d.shapeArgs;if(y&&b){let M=d.clientX??d.plotX??0,T=d.plotY||0;return d.isNode&&w&&ye(w.x)&&ye(w.y)&&(M=w.x,T=w.y),p?{chartX:b.len+b.pos-T,chartY:y.len+y.pos-M}:{chartX:M+y.pos,chartY:T+b.pos}}if(w&&w.x&&w.y)return{chartX:w.x,chartY:w.y}}getChartPosition(){if(this.chartPosition)return this.chartPosition;let{container:d}=this.chart,p=Re(d);this.chartPosition={left:p.left,top:p.top,scaleX:1,scaleY:1};let{offsetHeight:y,offsetWidth:b}=d;return b>2&&y>2&&(this.chartPosition.scaleX=p.width/b,this.chartPosition.scaleY=p.height/y),this.chartPosition}getCoordinates(d){let p={xAxis:[],yAxis:[]};for(let y of this.chart.axes)p[y.isXAxis?"xAxis":"yAxis"].push({axis:y,value:y.toValue(d[y.horiz?"chartX":"chartY"])});return p}getHoverData(d,p,y,b,w,M){let T=[],S=function(X){return X.visible&&!(!w&&X.directTouch)&&Me(X.options.enableMouseTracking,!0)},O=p,B,N={chartX:M?M.chartX:void 0,chartY:M?M.chartY:void 0,shared:w};ue(this,"beforeGetHoverData",N),B=O&&!O.stickyTracking?[O]:y.filter(X=>X.stickyTracking&&(N.filter||S)(X));let U=b&&d||!M?d:this.findNearestKDPoint(B,w,M);return O=U&&U.series,U&&(w&&!O.noSharedTooltip?(B=y.filter(function(X){return N.filter?N.filter(X):S(X)&&!X.noSharedTooltip})).forEach(function(X){let Z=Q(X.points,function(te){return te.x===U.x&&!te.isNull});_e(Z)&&(X.boosted&&X.boost&&(Z=X.boost.getPoint(Z)),T.push(Z))}):T.push(U)),ue(this,"afterGetHoverData",N={hoverPoint:U}),{hoverPoint:N.hoverPoint,hoverSeries:O,hoverPoints:T}}getPointFromEvent(d){let p=d.target,y;for(;p&&!y;)y=p.point,p=p.parentNode;return y}onTrackerMouseOut(d){let p=this.chart,y=d.relatedTarget,b=p.hoverSeries;this.isDirectTouch=!1,!b||!y||b.stickyTracking||this.inClass(y,"highcharts-tooltip")||this.inClass(y,"highcharts-series-"+b.index)&&this.inClass(y,"highcharts-tracker")||b.onMouseOut()}inClass(d,p){let y=d,b;for(;y;){if(b=fe(y,"class")){if(b.indexOf(p)!==-1)return!0;if(b.indexOf("highcharts-container")!==-1)return!1}y=y.parentElement}}constructor(d,p){this.hasDragged=0,this.pointerCaptureEventsToUnbind=[],this.eventsToUnbind=[],this.options=p,this.chart=d,this.runChartClick=!!p.chart.events?.click,this.pinchDown=[],this.setDOMEvents(),ue(this,"afterInit")}normalize(d,p){let y=d.touches,b=y?y.length?y.item(0):Me(y.changedTouches,d.changedTouches)[0]:d;p||(p=this.getChartPosition());let w=b.pageX-p.left,M=b.pageY-p.top;return pe(d,{chartX:Math.round(w/=p.scaleX),chartY:Math.round(M/=p.scaleY)})}onContainerClick(d){let p=this.chart,y=p.hoverPoint,b=this.normalize(d),w=p.plotLeft,M=p.plotTop;!p.cancelClick&&(y&&this.inClass(b.target,"highcharts-tracker")?(ue(y.series,"click",pe(b,{point:y})),p.hoverPoint&&y.firePointEvent("click",b)):(pe(b,this.getCoordinates(b)),p.isInsidePlot(b.chartX-w,b.chartY-M,{visiblePlotOnly:!0})&&ue(p,"click",b)))}onContainerMouseDown(d){let p=(1&(d.buttons||d.button))==1;d=this.normalize(d),lt.isFirefox&&d.button!==0&&this.onContainerMouseMove(d),(d.button===void 0||p)&&(this.zoomOption(d),p&&d.preventDefault?.(),this.dragStart(d))}onContainerMouseLeave(d){let{pointer:p}=H[Me(je.hoverChartIndex,-1)]||{};d=this.normalize(d),this.onContainerMouseMove(d),p&&!this.inClass(d.relatedTarget,"highcharts-tooltip")&&(p.reset(),p.chartPosition=void 0)}onContainerMouseEnter(){delete this.chartPosition}onContainerMouseMove(d){let p=this.chart,y=p.tooltip,b=this.normalize(d);this.setHoverChartIndex(d),(p.mouseIsDown==="mousedown"||this.touchSelect(b))&&this.drag(b),!p.openMenu&&(this.inClass(b.target,"highcharts-tracker")||p.isInsidePlot(b.chartX-p.plotLeft,b.chartY-p.plotTop,{visiblePlotOnly:!0}))&&!(y&&y.shouldStickOnContact(b))&&(this.inClass(b.target,"highcharts-no-tooltip")?this.reset(!1,0):this.runPointActions(b))}onDocumentTouchEnd(d){this.onDocumentMouseUp(d)}onContainerTouchMove(d){this.touchSelect(d)?this.onContainerMouseMove(d):this.touch(d)}onContainerTouchStart(d){this.touchSelect(d)?this.onContainerMouseDown(d):(this.zoomOption(d),this.touch(d,!0))}onDocumentMouseMove(d){let p=this.chart,y=p.tooltip,b=this.chartPosition,w=this.normalize(d,b);!b||p.isInsidePlot(w.chartX-p.plotLeft,w.chartY-p.plotTop,{visiblePlotOnly:!0})||y&&y.shouldStickOnContact(w)||w.target!==p.container.ownerDocument&&this.inClass(w.target,"highcharts-tracker")||this.reset()}onDocumentMouseUp(d){H[Me(je.hoverChartIndex,-1)]?.pointer?.drop(d)}pinch(d){let p=this,{chart:y,hasZoom:b,lastTouches:w}=p,M=[].map.call(d.touches||[],N=>p.normalize(N)),T=M.length,S=T===1&&(p.inClass(d.target,"highcharts-tracker")&&y.runTrackerClick||p.runChartClick),O=y.tooltip,B=T===1&&Me(O?.options.followTouchMove,!0);T>1?p.initiated=!0:B&&(p.initiated=!1),b&&p.initiated&&!S&&d.cancelable!==!1&&d.preventDefault(),d.type==="touchstart"?(p.pinchDown=M,p.res=!0,y.mouseDownX=d.chartX):B?this.runPointActions(p.normalize(d)):w&&(ue(y,"touchpan",{originalEvent:d,touches:M},()=>{let N=U=>{let X=U[0],Z=U[1]||X;return{x:X.chartX,y:X.chartY,width:Z.chartX-X.chartX,height:Z.chartY-X.chartY}};y.transform({axes:y.axes.filter(U=>U.zoomEnabled&&(this.zoomHor&&U.horiz||this.zoomVert&&!U.horiz)),to:N(M),from:N(w),trigger:d.type})}),p.res&&(p.res=!1,this.reset(!1,0))),p.lastTouches=M}reset(d,p){let y=this.chart,b=y.hoverSeries,w=y.hoverPoint,M=y.hoverPoints,T=y.tooltip,S=T&&T.shared?M:w;d&&S&&Fe(S).forEach(function(O){O.series.isCartesian&&O.plotX===void 0&&(d=!1)}),d?T&&S&&Fe(S).length&&(T.refresh(S),T.shared&&M?M.forEach(function(O){O.setState(O.state,!0),O.series.isCartesian&&(O.series.xAxis.crosshair&&O.series.xAxis.drawCrosshair(null,O),O.series.yAxis.crosshair&&O.series.yAxis.drawCrosshair(null,O))}):w&&(w.setState(w.state,!0),y.axes.forEach(function(O){O.crosshair&&w.series[O.coll]===O&&O.drawCrosshair(null,w)}))):(w&&w.onMouseOut(),M&&M.forEach(function(O){O.setState()}),b&&b.onMouseOut(),T&&T.hide(p),this.unDocMouseMove&&(this.unDocMouseMove=this.unDocMouseMove()),y.axes.forEach(function(O){O.hideCrosshair()}),y.hoverPoints=y.hoverPoint=void 0)}runPointActions(d,p,y){let b=this.chart,w=b.series,M=b.tooltip&&b.tooltip.options.enabled?b.tooltip:void 0,T=!!M&&M.shared,S=p||b.hoverPoint,O=S&&S.series||b.hoverSeries,B=(!d||d.type!=="touchmove")&&(!!p||O&&O.directTouch&&this.isDirectTouch),N=this.getHoverData(S,O,w,B,T,d);S=N.hoverPoint,O=N.hoverSeries;let U=N.hoverPoints,X=O&&O.tooltipOptions.followPointer&&!O.tooltipOptions.split,Z=T&&O&&!O.noSharedTooltip;if(S&&(y||S!==b.hoverPoint||M&&M.isHidden)){if((b.hoverPoints||[]).forEach(function(te){U.indexOf(te)===-1&&te.setState()}),b.hoverSeries!==O&&O.onMouseOver(),this.applyInactiveState(U),(U||[]).forEach(function(te){te.setState("hover")}),b.hoverPoint&&b.hoverPoint.firePointEvent("mouseOut"),!S.series)return;b.hoverPoints=U,b.hoverPoint=S,S.firePointEvent("mouseOver",void 0,()=>{M&&S&&M.refresh(Z?U:S,d)})}else if(X&&M&&!M.isHidden){let te=M.getAnchor([{}],d);b.isInsidePlot(te[0],te[1],{visiblePlotOnly:!0})&&M.updatePosition({plotX:te[0],plotY:te[1]})}this.unDocMouseMove||(this.unDocMouseMove=le(b.container.ownerDocument,"mousemove",te=>H[je.hoverChartIndex??-1]?.pointer?.onDocumentMouseMove(te)),this.eventsToUnbind.push(this.unDocMouseMove)),b.axes.forEach(function(te){let ne,J=Me((te.crosshair||{}).snap,!0);!J||(ne=b.hoverPoint)&&ne.series[te.coll]===te||(ne=Q(U,ce=>ce.series&&ce.series[te.coll]===te)),ne||!J?te.drawCrosshair(d,ne):te.hideCrosshair()})}setDOMEvents(){let d=this.chart.container,p=d.ownerDocument;d.onmousedown=this.onContainerMouseDown.bind(this),d.onmousemove=this.onContainerMouseMove.bind(this),d.onclick=this.onContainerClick.bind(this),this.eventsToUnbind.push(le(d,"mouseenter",this.onContainerMouseEnter.bind(this)),le(d,"mouseleave",this.onContainerMouseLeave.bind(this))),je.unbindDocumentMouseUp.some(b=>b.doc===p)||je.unbindDocumentMouseUp.push({doc:p,unbind:le(p,"mouseup",this.onDocumentMouseUp.bind(this))});let y=this.chart.renderTo.parentElement;for(;y&&y.tagName!=="BODY";)this.eventsToUnbind.push(le(y,"scroll",()=>{delete this.chartPosition})),y=y.parentElement;this.eventsToUnbind.push(le(d,"touchstart",this.onContainerTouchStart.bind(this),{passive:!1}),le(d,"touchmove",this.onContainerTouchMove.bind(this),{passive:!1})),je.unbindDocumentTouchEnd||(je.unbindDocumentTouchEnd=le(p,"touchend",this.onDocumentTouchEnd.bind(this),{passive:!1})),this.setPointerCapture(),le(this.chart,"redraw",this.setPointerCapture.bind(this))}setPointerCapture(){if(!se)return;let d=this.pointerCaptureEventsToUnbind,p=this.chart,y=p.container,b=Me(p.options.tooltip?.followTouchMove,!0)&&p.series.some(w=>w.options.findNearestPointBy.indexOf("y")>-1);!this.hasPointerCapture&&b?(d.push(le(y,"pointerdown",w=>{w.target?.hasPointerCapture(w.pointerId)&&w.target?.releasePointerCapture(w.pointerId)}),le(y,"pointermove",w=>{p.pointer?.getPointFromEvent(w)?.onMouseOver(w)})),p.styledMode||he(y,{"touch-action":"none"}),y.className+=" highcharts-no-touch-action",this.hasPointerCapture=!0):this.hasPointerCapture&&!b&&(d.forEach(w=>w()),d.length=0,p.styledMode||he(y,{"touch-action":Me(p.options.chart.style?.["touch-action"],"manipulation")}),y.className=y.className.replace(" highcharts-no-touch-action",""),this.hasPointerCapture=!1)}setHoverChartIndex(d){let p=this.chart,y=lt.charts[Me(je.hoverChartIndex,-1)];if(y&&y!==p){let b={relatedTarget:p.container};d&&!d?.relatedTarget&&Object.assign({},d,b),y.pointer?.onContainerMouseLeave(d||b)}y&&y.mouseIsDown||(je.hoverChartIndex=p.index)}touch(d,p){let y,{chart:b,pinchDown:w=[]}=this;this.setHoverChartIndex(),(d=this.normalize(d)).touches.length===1?b.isInsidePlot(d.chartX-b.plotLeft,d.chartY-b.plotTop,{visiblePlotOnly:!0})&&!b.openMenu?(p&&this.runPointActions(d),d.type==="touchmove"&&(y=!!w[0]&&Math.pow(w[0].chartX-d.chartX,2)+Math.pow(w[0].chartY-d.chartY,2)>=16),Me(y,!0)&&this.pinch(d)):p&&this.reset():d.touches.length===2&&this.pinch(d)}touchSelect(d){return!!(this.chart.zooming.singleTouch&&d.touches&&d.touches.length===1)}zoomOption(d){let p=this.chart,y=p.inverted,b=p.zooming.type||"",w,M;/touch/.test(d.type)&&(b=Me(p.zooming.pinchType,b)),this.zoomX=w=/x/.test(b),this.zoomY=M=/y/.test(b),this.zoomHor=w&&!y||M&&y,this.zoomVert=M&&!y||w&&y,this.hasZoom=w||M}}je.unbindDocumentMouseUp=[],function(P){P.compose=function(d){Be(K,"Core.Pointer")&&le(d,"beforeRender",function(){this.pointer=new P(this,this.options)})}}(je||(je={}));let mt=je,{fireEvent:He,isArray:it,objectEach:Ze,uniqueKey:ht}=Zt,Ge=class{constructor(P={}){this.autoId=!P.id,this.columns={},this.id=P.id||ht(),this.modified=this,this.rowCount=0,this.versionTag=ht();let d=0;Ze(P.columns||{},(p,y)=>{this.columns[y]=p.slice(),d=Math.max(d,p.length)}),this.applyRowCount(d)}applyRowCount(P){this.rowCount=P,Ze(this.columns,d=>{it(d)&&(d.length=P)})}getColumn(P,d){return this.columns[P]}getColumns(P,d){return(P||Object.keys(this.columns)).reduce((p,y)=>(p[y]=this.columns[y],p),{})}getRow(P,d){return(d||Object.keys(this.columns)).map(p=>this.columns[p]?.[P])}setColumn(P,d=[],p=0,y){this.setColumns({[P]:d},p,y)}setColumns(P,d,p){let y=this.rowCount;Ze(P,(b,w)=>{this.columns[w]=b.slice(),y=b.length}),this.applyRowCount(y),p?.silent||(He(this,"afterSetColumns"),this.versionTag=ht())}setRow(P,d=this.rowCount,p,y){let{columns:b}=this,w=p?this.rowCount+1:d+1;Ze(P,(M,T)=>{let S=b[T]||y?.addColumns!==!1&&Array(w);S&&(p?S.splice(d,0,M):S[d]=M,b[T]=S)}),w>this.rowCount&&this.applyRowCount(w),y?.silent||(He(this,"afterSetRows"),this.versionTag=ht())}},{extend:tt,merge:gt,pick:at}=Zt;(function(P){function d(p,y,b){let w=this.legendItem=this.legendItem||{},{chart:M,options:T}=this,{baseline:S=0,symbolWidth:O,symbolHeight:B}=p,N=this.symbol||"circle",U=B/2,X=M.renderer,Z=w.group,te=S-Math.round((p.fontMetrics?.b||B)*(b?.4:.3)),ne={},J,ce=T.marker,de=0;if(M.styledMode||(ne["stroke-width"]=Math.min(T.lineWidth||0,24),T.dashStyle?ne.dashstyle=T.dashStyle:T.linecap==="square"||(ne["stroke-linecap"]="round")),w.line=X.path().addClass("highcharts-graph").attr(ne).add(Z),b&&(w.area=X.path().addClass("highcharts-area").add(Z)),ne["stroke-linecap"]&&(de=Math.min(w.line.strokeWidth(),O)/2),O){let ke=[["M",de,te],["L",O-de,te]];w.line.attr({d:ke}),w.area?.attr({d:[...ke,["L",O-de,S],["L",de,S]]})}if(ce&&ce.enabled!==!1&&O){let ke=Math.min(at(ce.radius,U),U);N.indexOf("url")===0&&(ce=gt(ce,{width:B,height:B}),ke=0),w.symbol=J=X.symbol(N,O/2-ke,te-ke,2*ke,2*ke,tt({context:"legend"},ce)).addClass("highcharts-point").add(Z),J.isMarker=!0}}P.areaMarker=function(p,y){d.call(this,p,y,!0)},P.lineMarker=d,P.rectangle=function(p,y){let b=y.legendItem||{},w=p.options,M=p.symbolHeight,T=w.squareSymbol,S=T?M:p.symbolWidth;b.symbol=this.chart.renderer.rect(T?(p.symbolWidth-M)/2:0,p.baseline-M+1,S,M,at(p.options.symbolRadius,M/2)).addClass("highcharts-point").attr({zIndex:3}).add(b.group)}})(oe||(oe={}));let _t=oe,{defaultOptions:$t}=Sr,{extend:sn,extendClass:Ft,merge:Xt}=Zt;(function(P){function d(p,y){let b=$t.plotOptions||{},w=y.defaultOptions,M=y.prototype;return M.type=p,M.pointClass||(M.pointClass=z),!P.seriesTypes[p]&&(w&&(b[p]=w),P.seriesTypes[p]=y,!0)}P.seriesTypes=lt.seriesTypes,P.registerSeriesType=d,P.seriesType=function(p,y,b,w,M){let T=$t.plotOptions||{};if(y=y||"",T[p]=Xt(T[y],b),delete P.seriesTypes[p],d(p,Ft(P.seriesTypes[y]||function(){},w)),P.seriesTypes[p].prototype.type=p,M){class S extends z{}sn(S.prototype,M),P.seriesTypes[p].prototype.pointClass=S}return P.seriesTypes[p]}})(Ee||(Ee={}));let Gt=Ee,{animObject:Mn,setAnimation:Vt}=Ln,{defaultOptions:Qn}=Sr,{registerEventOptions:ui}=wl,{svg:di,win:hi}=lt,{seriesTypes:dr}=Gt,{arrayMax:vr,arrayMin:To,clamp:is,correctFloat:Si,crisp:fi,defined:rn,destroyObjectProperties:hr,diffObjects:ro,erase:xi,error:Nr,extend:la,find:Rl,fireEvent:mi,getClosestDistance:ca,getNestedProperty:ua,insertItem:Ba,isArray:Ru,isNumber:rr,isString:pf,merge:Pu,objectEach:Zp,pick:Zi,removeEvent:cy,syncTimeout:mf}=Zt;class Ou{constructor(){this.zoneAxis="y"}init(d,p){let y;mi(this,"init",{options:p}),this.dataTable??(this.dataTable=new Ge);let b=d.series;this.eventsToUnbind=[],this.chart=d,this.options=this.setOptions(p);let w=this.options,M=w.visible!==!1;this.linkedSeries=[],this.bindAxes(),la(this,{name:w.name,state:"",visible:M,selected:w.selected===!0}),ui(this,w);let T=w.events;(T&&T.click||w.point&&w.point.events&&w.point.events.click||w.allowPointSelect)&&(d.runTrackerClick=!0),this.getColor(),this.getSymbol(),this.isCartesian&&(d.hasCartesianSeries=!0),b.length&&(y=b[b.length-1]),this._i=Zi(y&&y._i,-1)+1,this.opacity=this.options.opacity,d.orderItems("series",Ba(this,b)),w.dataSorting&&w.dataSorting.enabled?this.setDataSortingOptions():this.points||this.data||this.setData(w.data,!1),mi(this,"afterInit")}is(d){return dr[d]&&this instanceof dr[d]}bindAxes(){let d,p=this,y=p.options,b=p.chart;mi(this,"bindAxes",null,function(){(p.axisTypes||[]).forEach(function(w){(b[w]||[]).forEach(function(M){d=M.options,(Zi(y[w],0)===M.index||y[w]!==void 0&&y[w]===d.id)&&(Ba(p,M.series),p[w]=M,M.isDirty=!0)}),p[w]||p.optionalAxis===w||Nr(18,!0,b)})}),mi(this,"afterBindAxes")}hasData(){return this.visible&&this.dataMax!==void 0&&this.dataMin!==void 0||this.visible&&this.dataTable.rowCount>0}hasMarkerChanged(d,p){let y=d.marker,b=p.marker||{};return y&&(b.enabled&&!y.enabled||b.symbol!==y.symbol||b.height!==y.height||b.width!==y.width)}autoIncrement(d){let p,y=this.options,{pointIntervalUnit:b,relativeXValue:w}=this.options,M=this.chart.time,T=this.xIncrement??M.parse(y.pointStart)??0;if(this.pointInterval=p=Zi(this.pointInterval,y.pointInterval,1),w&&rr(d)&&(p*=d),b){let S=M.toParts(T);b==="day"?S[2]+=p:b==="month"?S[1]+=p:b==="year"&&(S[0]+=p),p=M.makeTime.apply(M,S)-T}return w&&rr(d)?T+p:(this.xIncrement=T+p,T)}setDataSortingOptions(){let d=this.options;la(this,{requireSorting:!1,sorted:!1,enabledDataSorting:!0,allowDG:!1}),rn(d.pointRange)||(d.pointRange=1)}setOptions(d){let p,y=this.chart,b=y.options.plotOptions,w=y.userOptions||{},M=Pu(d),T=y.styledMode,S={plotOptions:b,userOptions:M};mi(this,"setOptions",S);let O=S.plotOptions[this.type],B=w.plotOptions||{},N=B.series||{},U=Qn.plotOptions[this.type]||{},X=B[this.type]||{};this.userOptions=S.userOptions;let Z=Pu(O,b.series,X,M);this.tooltipOptions=Pu(Qn.tooltip,Qn.plotOptions.series?.tooltip,U?.tooltip,y.userOptions.tooltip,B.series?.tooltip,X.tooltip,M.tooltip),this.stickyTracking=Zi(M.stickyTracking,X.stickyTracking,N.stickyTracking,!!this.tooltipOptions.shared&&!this.noSharedTooltip||Z.stickyTracking),O.marker===null&&delete Z.marker,this.zoneAxis=Z.zoneAxis||"y";let te=this.zones=(Z.zones||[]).map(ne=>ut({},ne));return(Z.negativeColor||Z.negativeFillColor)&&!Z.zones&&(p={value:Z[this.zoneAxis+"Threshold"]||Z.threshold||0,className:"highcharts-negative"},T||(p.color=Z.negativeColor,p.fillColor=Z.negativeFillColor),te.push(p)),te.length&&rn(te[te.length-1].value)&&te.push(T?{}:{color:this.color,fillColor:this.fillColor}),mi(this,"afterSetOptions",{options:Z}),Z}getName(){return Zi(this.options.name,"Series "+(this.index+1))}getCyclic(d,p,y){let b,w,M=this.chart,T=`${d}Index`,S=`${d}Counter`,O=y?.length||M.options.chart.colorCount;!p&&(rn(w=Zi(d==="color"?this.options.colorIndex:void 0,this[T]))?b=w:(M.series.length||(M[S]=0),b=M[S]%O,M[S]+=1),y&&(p=y[b])),b!==void 0&&(this[T]=b),this[d]=p}getColor(){this.chart.styledMode?this.getCyclic("color"):this.options.colorByPoint?this.color="#cccccc":this.getCyclic("color",this.options.color||Qn.plotOptions[this.type].color,this.chart.options.colors)}getPointsCollection(){return(this.hasGroupedData?this.points:this.data)||[]}getSymbol(){let d=this.options.marker;this.getCyclic("symbol",d.symbol,this.chart.options.symbols)}getColumn(d,p){return(p?this.dataTable.modified:this.dataTable).getColumn(d,!0)||[]}findPointIndex(d,p){let y,b,w,M=d.id,T=d.x,S=this.points,O=this.options.dataSorting;if(M){let B=this.chart.get(M);B instanceof z&&(y=B)}else if(this.linkedParent||this.enabledDataSorting||this.options.relativeXValue){let B=N=>!N.touched&&N.index===d.index;if(O&&O.matchByName?B=N=>!N.touched&&N.name===d.name:this.options.relativeXValue&&(B=N=>!N.touched&&N.options.x===d.x),!(y=Rl(S,B)))return}return y&&(w=y&&y.index)!==void 0&&(b=!0),w===void 0&&rr(T)&&(w=this.getColumn("x").indexOf(T,p)),w!==-1&&w!==void 0&&this.cropped&&(w=w>=this.cropStart?w-this.cropStart:w),!b&&rr(w)&&S[w]&&S[w].touched&&(w=void 0),w}updateData(d,p){let y=this.options,b=y.dataSorting,w=this.points,M=[],T=this.requireSorting,S=d.length===w.length,O,B,N,U,X=!0;if(this.xIncrement=null,d.forEach(function(te,ne){let J,ce=rn(te)&&this.pointClass.prototype.optionsToObject.call({series:this},te)||{},de=ce.x;ce.id||rr(de)?((J=this.findPointIndex(ce,U))===-1||J===void 0?M.push(te):w[J]&&te!==y.data[J]?(w[J].update(te,!1,null,!1),w[J].touched=!0,T&&(U=J+1)):w[J]&&(w[J].touched=!0),(!S||ne!==J||b&&b.enabled||this.hasDerivedData)&&(O=!0)):M.push(te)},this),O)for(B=w.length;B--;)(N=w[B])&&!N.touched&&N.remove&&N.remove(!1,p);else!S||b&&b.enabled?X=!1:(d.forEach(function(te,ne){te===w[ne].y||w[ne].destroyed||w[ne].update(te,!1,null,!1)}),M.length=0);if(w.forEach(function(te){te&&(te.touched=!1)}),!X)return!1;M.forEach(function(te){this.addPoint(te,!1,null,null,!1)},this);let Z=this.getColumn("x");return this.xIncrement===null&&Z.length&&(this.xIncrement=vr(Z),this.autoIncrement()),!0}dataColumnKeys(){return["x",...this.pointArrayMap||["y"]]}setData(d,p=!0,y,b){let w=this.points,M=w&&w.length||0,T=this.options,S=this.chart,O=T.dataSorting,B=this.xAxis,N=T.turboThreshold,U=this.dataTable,X=this.dataColumnKeys(),Z=this.pointValKey||"y",te=(this.pointArrayMap||[]).length,ne=T.keys,J,ce,de=0,ke=1,Ue;S.options.chart.allowMutatingData||(T.data&&delete this.options.data,this.userOptions.data&&delete this.userOptions.data,Ue=Pu(!0,d));let Le=(d=Ue||d||[]).length;if(O&&O.enabled&&(d=this.sortData(d)),S.options.chart.allowMutatingData&&b!==!1&&Le&&M&&!this.cropped&&!this.hasGroupedData&&this.visible&&!this.boosted&&(ce=this.updateData(d,y)),!ce){this.xIncrement=null,this.colorCounter=0;let Se=N&&Le>N;if(Se){let ze=this.getFirstValidPoint(d),nt=this.getFirstValidPoint(d,Le-1,-1),rt=pt=>!!(Ru(pt)&&(ne||rr(pt[0])));if(rr(ze)&&rr(nt)){let pt=[],Bt=[];for(let Lt of d)pt.push(this.autoIncrement()),Bt.push(Lt);U.setColumns({x:pt,[Z]:Bt})}else if(rt(ze)&&rt(nt))if(te){let pt=ze.length===te?1:0,Bt=Array(X.length).fill(0).map(()=>[]);for(let Lt of d){pt&&Bt[0].push(this.autoIncrement());for(let jt=pt;jt<=te;jt++)Bt[jt]?.push(Lt[jt-pt])}U.setColumns(X.reduce((Lt,jt,Yt)=>(Lt[jt]=Bt[Yt],Lt),{}))}else{ne&&(de=ne.indexOf("x"),ke=ne.indexOf("y"),de=de>=0?de:0,ke=ke>=0?ke:1),ze.length===1&&(ke=0);let pt=[],Bt=[];if(de===ke)for(let Lt of d)pt.push(this.autoIncrement()),Bt.push(Lt[ke]);else for(let Lt of d)pt.push(Lt[de]),Bt.push(Lt[ke]);U.setColumns({x:pt,[Z]:Bt})}else Se=!1}if(!Se){let ze=X.reduce((nt,rt)=>(nt[rt]=[],nt),{});for(J=0;J<Le;J++){let nt=this.pointClass.prototype.applyOptions.apply({series:this},[d[J]]);for(let rt of X)ze[rt][J]=nt[rt]}U.setColumns(ze)}for(pf(this.getColumn("y")[0])&&Nr(14,!0,S),this.data=[],this.options.data=this.userOptions.data=d,J=M;J--;)w[J]?.destroy();B&&(B.minRange=B.userMinRange),this.isDirty=S.isDirtyBox=!0,this.isDirtyData=!!w,y=!1}T.legendType==="point"&&(this.processData(),this.generatePoints()),p&&S.redraw(y)}sortData(d){let p=this,y=p.options.dataSorting.sortKey||"y",b=function(w,M){return rn(M)&&w.pointClass.prototype.optionsToObject.call({series:w},M)||{}};return d.forEach(function(w,M){d[M]=b(p,w),d[M].index=M},this),d.concat().sort((w,M)=>{let T=ua(y,w),S=ua(y,M);return S<T?-1:S>T?1:0}).forEach(function(w,M){w.x=M},this),p.linkedSeries&&p.linkedSeries.forEach(function(w){let M=w.options,T=M.data;M.dataSorting&&M.dataSorting.enabled||!T||(T.forEach(function(S,O){T[O]=b(w,S),d[O]&&(T[O].x=d[O].x,T[O].index=O)}),w.setData(T,!1))}),d}getProcessedData(d){let p=this,{dataTable:y,isCartesian:b,options:w,xAxis:M}=p,T=w.cropThreshold,S=d||p.getExtremesFromAll,O=M?.logarithmic,B=y.rowCount,N,U,X=0,Z,te,ne,J=p.getColumn("x"),ce=y,de=!1;return M&&(te=(Z=M.getExtremes()).min,ne=Z.max,de=!!(M.categories&&!M.names.length),b&&p.sorted&&!S&&(!T||B>T||p.forceCrop)&&(J[B-1]<te||J[0]>ne?ce=new Ge:p.getColumn(p.pointValKey||"y").length&&(J[0]<te||J[B-1]>ne)&&(ce=(N=this.cropData(y,te,ne)).modified,X=N.start,U=!0))),J=ce.getColumn("x")||[],{modified:ce,cropped:U,cropStart:X,closestPointRange:ca([O?J.map(O.log2lin):J],()=>p.requireSorting&&!de&&Nr(15,!1,p.chart))}}processData(d){let p=this.xAxis,y=this.dataTable;if(this.isCartesian&&!this.isDirty&&!p.isDirty&&!this.yAxis.isDirty&&!d)return!1;let b=this.getProcessedData();y.modified=b.modified,this.cropped=b.cropped,this.cropStart=b.cropStart,this.closestPointRange=this.basePointRange=b.closestPointRange,mi(this,"afterProcessData")}cropData(d,p,y){let b=d.getColumn("x",!0)||[],w=b.length,M={},T,S,O=0,B=w;for(T=0;T<w;T++)if(b[T]>=p){O=Math.max(0,T-1);break}for(S=T;S<w;S++)if(b[S]>y){B=S+1;break}for(let N of this.dataColumnKeys()){let U=d.getColumn(N,!0);U&&(M[N]=U.slice(O,B))}return{modified:new Ge({columns:M}),start:O,end:B}}generatePoints(){let d=this.options,p=this.processedData||d.data,y=this.dataTable.modified,b=this.getColumn("x",!0),w=this.pointClass,M=y.rowCount,T=this.cropStart||0,S=this.hasGroupedData,O=d.keys,B=[],N=d.dataGrouping&&d.dataGrouping.groupAll?T:0,U=this.xAxis?.categories,X=this.pointArrayMap||["y"],Z=this.dataColumnKeys(),te,ne,J,ce,de=this.data,ke;if(!de&&!S){let Ue=[];Ue.length=p?.length||0,de=this.data=Ue}for(O&&S&&(this.options.keys=!1),ce=0;ce<M;ce++)ne=T+ce,S?((J=new w(this,y.getRow(ce,Z)||[])).dataGroup=this.groupMap[N+ce],J.dataGroup?.options&&(J.options=J.dataGroup.options,la(J,J.dataGroup.options),delete J.dataLabels)):(J=de[ne],ke=p?p[ne]:y.getRow(ce,X),J||ke===void 0||(de[ne]=J=new w(this,ke,b[ce]))),J&&(J.index=S?N+ce:ne,B[ce]=J,J.category=U?.[J.x]??J.x,J.key=J.name??J.category);if(this.options.keys=O,de&&(M!==(te=de.length)||S))for(ce=0;ce<te;ce++)ce!==T||S||(ce+=M),de[ce]&&(de[ce].destroyElements(),de[ce].plotX=void 0);this.data=de,this.points=B,mi(this,"afterGeneratePoints")}getXExtremes(d){return{min:To(d),max:vr(d)}}getExtremes(d,p){let{xAxis:y,yAxis:b}=this,w=p||this.getExtremesFromAll||this.options.getExtremesFromAll,M=w&&this.cropped?this.dataTable:this.dataTable.modified,T=M.rowCount,S=d||this.stackedYData,O=S?[S]:(this.keysAffectYAxis||this.pointArrayMap||["y"])?.map(Ue=>M.getColumn(Ue,!0)||[])||[],B=this.getColumn("x",!0),N=[],U=this.requireSorting&&!this.is("column")?1:0,X=!!b&&b.positiveValuesOnly,Z=w||this.cropped||!y,te,ne,J,ce=0,de=0;for(y&&(ce=(te=y.getExtremes()).min,de=te.max),J=0;J<T;J++)if(ne=B[J],Z||(B[J+U]||ne)>=ce&&(B[J-U]||ne)<=de)for(let Ue of O){let Le=Ue[J];rr(Le)&&(Le>0||!X)&&N.push(Le)}let ke={activeYData:N,dataMin:To(N),dataMax:vr(N)};return mi(this,"afterGetExtremes",{dataExtremes:ke}),ke}applyExtremes(){let d=this.getExtremes();return this.dataMin=d.dataMin,this.dataMax=d.dataMax,d}getFirstValidPoint(d,p=0,y=1){let b=d.length,w=p;for(;w>=0&&w<b;){if(rn(d[w]))return d[w];w+=y}}translate(){this.generatePoints();let d=this.options,p=d.stacking,y=this.xAxis,b=this.enabledDataSorting,w=this.yAxis,M=this.points,T=M.length,S=this.pointPlacementToXValue(),O=!!S,B=d.threshold,N=d.startFromThreshold?B:0,U,X,Z,te,ne=Number.MAX_VALUE;function J(ce){return is(ce,-1e9,1e9)}for(U=0;U<T;U++){let ce,de=M[U],ke=de.x,Ue,Le,Se=de.y,ze=de.low,nt=p&&w.stacking?.stacks[(this.negStacks&&Se<(N?0:B)?"-":"")+this.stackKey];X=y.translate(ke,!1,!1,!1,!0,S),de.plotX=rr(X)?Si(J(X)):void 0,p&&this.visible&&nt&&nt[ke]&&(te=this.getStackIndicator(te,ke,this.index),!de.isNull&&te.key&&(Le=(Ue=nt[ke]).points[te.key]),Ue&&Ru(Le)&&(ze=Le[0],Se=Le[1],ze===N&&te.key===nt[ke].base&&(ze=Zi(rr(B)?B:w.min)),w.positiveValuesOnly&&rn(ze)&&ze<=0&&(ze=void 0),de.total=de.stackTotal=Zi(Ue.total),de.percentage=rn(de.y)&&Ue.total?de.y/Ue.total*100:void 0,de.stackY=Se,this.irregularWidths||Ue.setOffset(this.pointXOffset||0,this.barW||0,void 0,void 0,void 0,this.xAxis))),de.yBottom=rn(ze)?J(w.translate(ze,!1,!0,!1,!0)):void 0,this.dataModify&&(Se=this.dataModify.modifyValue(Se,U)),rr(Se)&&de.plotX!==void 0&&(ce=rr(ce=w.translate(Se,!1,!0,!1,!0))?J(ce):void 0),de.plotY=ce,de.isInside=this.isPointInside(de),de.clientX=O?Si(y.translate(ke,!1,!1,!1,!0,S)):X,de.negative=(de.y||0)<(B||0),de.isNull||de.visible===!1||(Z!==void 0&&(ne=Math.min(ne,Math.abs(X-Z))),Z=X),de.zone=this.zones.length?de.getZone():void 0,!de.graphic&&this.group&&b&&(de.isNew=!0)}this.closestPointRangePx=ne,mi(this,"afterTranslate")}getValidPoints(d,p,y){let b=this.chart;return(d||this.points||[]).filter(function(w){let{plotX:M,plotY:T}=w;return!!((y||!w.isNull&&rr(T))&&(!p||b.isInsidePlot(M,T,{inverted:b.inverted})))&&w.visible!==!1})}getClipBox(){let{chart:d,xAxis:p,yAxis:y}=this,{x:b,y:w,width:M,height:T}=Pu(d.clipBox);return p&&p.len!==d.plotSizeX&&(M=p.len),y&&y.len!==d.plotSizeY&&(T=y.len),d.inverted&&!this.invertible&&([M,T]=[T,M]),{x:b,y:w,width:M,height:T}}getSharedClipKey(){return this.sharedClipKey=(this.options.xAxis||0)+","+(this.options.yAxis||0),this.sharedClipKey}setClip(){let{chart:d,group:p,markerGroup:y}=this,b=d.sharedClips,w=d.renderer,M=this.getClipBox(),T=this.getSharedClipKey(),S=b[T];S?S.animate(M):b[T]=S=w.clipRect(M),p&&p.clip(this.options.clip===!1?void 0:S),y&&y.clip()}animate(d){let{chart:p,group:y,markerGroup:b}=this,w=p.inverted,M=Mn(this.options.animation),T=[this.getSharedClipKey(),M.duration,M.easing,M.defer].join(","),S=p.sharedClips[T],O=p.sharedClips[T+"m"];if(d&&y){let B=this.getClipBox();if(S)S.attr("height",B.height);else{B.width=0,w&&(B.x=p.plotHeight),S=p.renderer.clipRect(B),p.sharedClips[T]=S;let N={x:-99,y:-99,width:w?p.plotWidth+199:99,height:w?99:p.plotHeight+199};O=p.renderer.clipRect(N),p.sharedClips[T+"m"]=O}y.clip(S),b?.clip(O)}else if(S&&!S.hasClass("highcharts-animating")){let B=this.getClipBox(),N=M.step;(b?.element.childNodes.length||p.series.length>1)&&(M.step=function(U,X){N&&N.apply(X,arguments),X.prop==="width"&&O?.element&&O.attr(w?"height":"width",U+99)}),S.addClass("highcharts-animating").animate(B,M)}}afterAnimate(){this.setClip(),Zp(this.chart.sharedClips,(d,p,y)=>{d&&!this.chart.container.querySelector(`[clip-path="url(#${d.id})"]`)&&(d.destroy(),delete y[p])}),this.finishedAnimating=!0,mi(this,"afterAnimate")}drawPoints(d=this.points){let p,y,b,w,M,T,S,O=this.chart,B=O.styledMode,{colorAxis:N,options:U}=this,X=U.marker,Z=this[this.specialGroup||"markerGroup"],te=this.xAxis,ne=Zi(X.enabled,!te||!!te.isRadial||null,this.closestPointRangePx>=X.enabledThreshold*X.radius);if(X.enabled!==!1||this._hasPointMarkers)for(p=0;p<d.length;p++)if(w=(b=(y=d[p]).graphic)?"animate":"attr",M=y.marker||{},T=!!y.marker,(ne&&M.enabled===void 0||M.enabled)&&!y.isNull&&y.visible!==!1){let J=Zi(M.symbol,this.symbol,"rect");S=this.markerAttribs(y,y.selected&&"select"),this.enabledDataSorting&&(y.startXPos=te.reversed?-(S.width||0):te.width);let ce=y.isInside!==!1;if(!b&&ce&&((S.width||0)>0||y.hasImage)&&(y.graphic=b=O.renderer.symbol(J,S.x,S.y,S.width,S.height,T?M:X).add(Z),this.enabledDataSorting&&O.hasRendered&&(b.attr({x:y.startXPos}),w="animate")),b&&w==="animate"&&b[ce?"show":"hide"](ce).animate(S),b){let de=this.pointAttribs(y,B||!y.selected?void 0:"select");B?N&&b.css({fill:de.fill}):b[w](de)}b&&b.addClass(y.getClassName(),!0)}else b&&(y.graphic=b.destroy())}markerAttribs(d,p){let y=this.options,b=y.marker,w=d.marker||{},M=w.symbol||b.symbol,T={},S,O,B=Zi(w.radius,b&&b.radius);p&&(S=b.states[p],B=Zi((O=w.states&&w.states[p])&&O.radius,S&&S.radius,B&&B+(S&&S.radiusPlus||0))),d.hasImage=M&&M.indexOf("url")===0,d.hasImage&&(B=0);let N=d.pos();return rr(B)&&N&&(y.crisp&&(N[0]=fi(N[0],d.hasImage?0:M==="rect"?b?.lineWidth||0:1)),T.x=N[0]-B,T.y=N[1]-B),B&&(T.width=T.height=2*B),T}pointAttribs(d,p){let y=this.options.marker,b=d&&d.options,w=b&&b.marker||{},M=b&&b.color,T=d&&d.color,S=d&&d.zone&&d.zone.color,O,B,N=this.color,U,X,Z=Zi(w.lineWidth,y.lineWidth),te=1;return N=M||S||T||N,U=w.fillColor||y.fillColor||N,X=w.lineColor||y.lineColor||N,p=p||"normal",O=y.states[p]||{},Z=Zi((B=w.states&&w.states[p]||{}).lineWidth,O.lineWidth,Z+Zi(B.lineWidthPlus,O.lineWidthPlus,0)),U=B.fillColor||O.fillColor||U,{stroke:X=B.lineColor||O.lineColor||X,"stroke-width":Z,fill:U,opacity:te=Zi(B.opacity,O.opacity,te)}}destroy(d){let p,y,b,w=this,M=w.chart,T=/AppleWebKit\/533/.test(hi.navigator.userAgent),S=w.data||[];for(mi(w,"destroy",{keepEventsForUpdate:d}),this.removeEvents(d),(w.axisTypes||[]).forEach(function(O){(b=w[O])&&b.series&&(xi(b.series,w),b.isDirty=b.forceRedraw=!0)}),w.legendItem&&w.chart.legend.destroyItem(w),p=S.length;p--;)(y=S[p])&&y.destroy&&y.destroy();for(let O of w.zones)hr(O,void 0,!0);Zt.clearTimeout(w.animationTimeout),Zp(w,function(O,B){O instanceof Lo&&!O.survive&&O[T&&B==="group"?"hide":"destroy"]()}),M.hoverSeries===w&&(M.hoverSeries=void 0),xi(M.series,w),M.orderItems("series"),Zp(w,function(O,B){d&&B==="hcEvents"||delete w[B]})}applyZones(){let{area:d,chart:p,graph:y,zones:b,points:w,xAxis:M,yAxis:T,zoneAxis:S}=this,{inverted:O,renderer:B}=p,N=this[`${S}Axis`],{isXAxis:U,len:X=0,minPointOffset:Z=0}=N||{},te=(y?.strokeWidth()||0)/2+1,ne=(J,ce=0,de=0)=>{O&&(de=X-de);let{translated:ke=0,lineClip:Ue}=J,Le=de-ke;Ue?.push(["L",ce,Math.abs(Le)<te?de-te*(Le<=0?-1:1):ke])};if(b.length&&(y||d)&&N&&rr(N.min)){let J=N.getExtremes().max+Z,ce=Ue=>{Ue.forEach((Le,Se)=>{(Le[0]==="M"||Le[0]==="L")&&(Ue[Se]=[Le[0],U?X-Le[1]:Le[1],U?Le[2]:X-Le[2]])})};if(b.forEach(Ue=>{Ue.lineClip=[],Ue.translated=is(N.toPixels(Zi(Ue.value,J),!0)||0,0,X)}),y&&!this.showLine&&y.hide(),d&&d.hide(),S==="y"&&w.length<M.len)for(let Ue of w){let{plotX:Le,plotY:Se,zone:ze}=Ue,nt=ze&&b[b.indexOf(ze)-1];ze&&ne(ze,Le,Se),nt&&ne(nt,Le,Se)}let de=[],ke=N.toPixels(N.getExtremes().min-Z,!0);b.forEach(Ue=>{let Le=Ue.lineClip||[],Se=Math.round(Ue.translated||0);M.reversed&&Le.reverse();let{clip:ze,simpleClip:nt}=Ue,rt=0,pt=0,Bt=M.len,Lt=T.len;U?(rt=Se,Bt=ke):(pt=Se,Lt=ke);let jt=[["M",rt,pt],["L",Bt,pt],["L",Bt,Lt],["L",rt,Lt],["Z"]],Yt=[jt[0],...Le,jt[1],jt[2],...de,jt[3],jt[4]];de=Le.reverse(),ke=Se,O&&(ce(Yt),d&&ce(jt)),ze?(ze.animate({d:Yt}),nt?.animate({d:jt})):(ze=Ue.clip=B.path(Yt),d&&(nt=Ue.simpleClip=B.path(jt))),y&&Ue.graph?.clip(ze),d&&Ue.area?.clip(nt)})}else this.visible&&(y&&y.show(),d&&d.show())}plotGroup(d,p,y,b,w){let M=this[d],T=!M,S={visibility:y,zIndex:b||.1};return rn(this.opacity)&&!this.chart.styledMode&&this.state!=="inactive"&&(S.opacity=this.opacity),M||(this[d]=M=this.chart.renderer.g().add(w)),M.addClass("highcharts-"+p+" highcharts-series-"+this.index+" highcharts-"+this.type+"-series "+(rn(this.colorIndex)?"highcharts-color-"+this.colorIndex+" ":"")+(this.options.className||"")+(M.hasClass("highcharts-tracker")?" highcharts-tracker":""),!0),M.attr(S)[T?"attr":"animate"](this.getPlotBox(p)),M}getPlotBox(d){let p=this.xAxis,y=this.yAxis,b=this.chart,w=b.inverted&&!b.polar&&p&&this.invertible&&d==="series";return b.inverted&&(p=y,y=this.xAxis),{translateX:p?p.left:b.plotLeft,translateY:y?y.top:b.plotTop,rotation:w?90:0,rotationOriginX:w?(p.len-y.len)/2:0,rotationOriginY:w?(p.len+y.len)/2:0,scaleX:w?-1:1,scaleY:1}}removeEvents(d){let{eventsToUnbind:p}=this;d||cy(this),p.length&&(p.forEach(y=>{y()}),p.length=0)}render(){let d=this,{chart:p,options:y,hasRendered:b}=d,w=Mn(y.animation),M=d.visible?"inherit":"hidden",T=y.zIndex,S=p.seriesGroup,O=d.finishedAnimating?0:w.duration;mi(this,"render"),d.plotGroup("group","series",M,T,S),d.markerGroup=d.plotGroup("markerGroup","markers",M,T,S),y.clip!==!1&&d.setClip(),O&&d.animate?.(!0),d.drawGraph&&(d.drawGraph(),d.applyZones()),d.visible&&d.drawPoints(),d.drawDataLabels?.(),d.redrawPoints?.(),y.enableMouseTracking&&d.drawTracker?.(),O&&d.animate?.(),b||(O&&w.defer&&(O+=w.defer),d.animationTimeout=mf(()=>{d.afterAnimate()},O||0)),d.isDirty=!1,d.hasRendered=!0,mi(d,"afterRender")}redraw(){let d=this.isDirty||this.isDirtyData;this.translate(),this.render(),d&&delete this.kdTree}reserveSpace(){return this.visible||!this.chart.options.chart.ignoreHiddenSeries}searchPoint(d,p){let{xAxis:y,yAxis:b}=this,w=this.chart.inverted;return this.searchKDTree({clientX:w?y.len-d.chartY+y.pos:d.chartX-y.pos,plotY:w?b.len-d.chartX+b.pos:d.chartY-b.pos},p,d)}buildKDTree(d){this.buildingKdTree=!0;let p=this,y=p.options.findNearestPointBy.indexOf("y")>-1?2:1;delete p.kdTree,mf(function(){p.kdTree=function b(w,M,T){let S,O,B=w?.length;if(B)return S=p.kdAxisArray[M%T],w.sort((N,U)=>(N[S]||0)-(U[S]||0)),{point:w[O=Math.floor(B/2)],left:b(w.slice(0,O),M+1,T),right:b(w.slice(O+1),M+1,T)}}(p.getValidPoints(void 0,!p.directTouch),y,y),p.buildingKdTree=!1},p.options.kdNow||d?.type==="touchstart"?0:1)}searchKDTree(d,p,y,b,w){let M=this,[T,S]=this.kdAxisArray,O=p?"distX":"dist",B=(M.options.findNearestPointBy||"").indexOf("y")>-1?2:1,N=!!M.isBubble,U=b||((Z,te,ne)=>[(Z[ne]||0)<(te[ne]||0)?Z:te,!1]),X=w||((Z,te)=>Z<te);if(this.kdTree||this.buildingKdTree||this.buildKDTree(y),this.kdTree)return function Z(te,ne,J,ce){let de=ne.point,ke=M.kdAxisArray[J%ce],Ue=de,Le=!1;(function(rt,pt){let Bt=rt[T],Lt=pt[T],jt=rn(Bt)&&rn(Lt)?Bt-Lt:null,Yt=rt[S],zt=pt[S],Sn=rn(Yt)&&rn(zt)?Yt-zt:0,hn=N&&pt.marker?.radius||0;pt.dist=Math.sqrt((jt&&jt*jt||0)+Sn*Sn)-hn,pt.distX=rn(jt)?Math.abs(jt)-hn:Number.MAX_VALUE})(te,de);let Se=(te[ke]||0)-(de[ke]||0)+(N&&de.marker?.radius||0),ze=Se<0?"left":"right",nt=Se<0?"right":"left";return ne[ze]&&([Ue,Le]=U(de,Z(te,ne[ze],J+1,ce),O)),ne[nt]&&X(Math.sqrt(Se*Se),Ue[O],Le)&&(Ue=U(Ue,Z(te,ne[nt],J+1,ce),O)[0]),Ue}(d,this.kdTree,B,B)}pointPlacementToXValue(){let{options:d,xAxis:p}=this,y=d.pointPlacement;return y==="between"&&(y=p.reversed?-.5:.5),rr(y)?y*(d.pointRange||p.pointRange):0}isPointInside(d){let{chart:p,xAxis:y,yAxis:b}=this,{plotX:w=-1,plotY:M=-1}=d;return M>=0&&M<=(b?b.len:p.plotHeight)&&w>=0&&w<=(y?y.len:p.plotWidth)}drawTracker(){let d=this,p=d.options,y=p.trackByArea,b=[].concat((y?d.areaPath:d.graphPath)||[]),w=d.chart,M=w.pointer,T=w.renderer,S=w.options.tooltip?.snap||0,O=()=>{p.enableMouseTracking&&w.hoverSeries!==d&&d.onMouseOver()},B="rgba(192,192,192,"+(di?1e-4:.002)+")",N=d.tracker;N?N.attr({d:b}):d.graph&&(d.tracker=N=T.path(b).attr({visibility:d.visible?"inherit":"hidden",zIndex:2}).addClass(y?"highcharts-tracker-area":"highcharts-tracker-line").add(d.group),w.styledMode||N.attr({"stroke-linecap":"round","stroke-linejoin":"round",stroke:B,fill:y?B:"none","stroke-width":d.graph.strokeWidth()+(y?0:2*S)}),[d.tracker,d.markerGroup,d.dataLabelsGroup].forEach(U=>{U&&(U.addClass("highcharts-tracker").on("mouseover",O).on("mouseout",X=>{M?.onTrackerMouseOut(X)}),p.cursor&&!w.styledMode&&U.css({cursor:p.cursor}),U.on("touchstart",O))})),mi(this,"afterDrawTracker")}addPoint(d,p,y,b,w){let M,T,S=this.options,{chart:O,data:B,dataTable:N,xAxis:U}=this,X=U&&U.hasNames&&U.names,Z=S.data,te=this.getColumn("x");p=Zi(p,!0);let ne={series:this};this.pointClass.prototype.applyOptions.apply(ne,[d]);let J=ne.x;if(T=te.length,this.requireSorting&&J<te[T-1])for(M=!0;T&&te[T-1]>J;)T--;N.setRow(ne,T,!0,{addColumns:!1}),X&&ne.name&&(X[J]=ne.name),Z?.splice(T,0,d),(M||this.processedData)&&(this.data.splice(T,0,null),this.processData()),S.legendType==="point"&&this.generatePoints(),y&&(B[0]&&B[0].remove?B[0].remove(!1):([B,Z,...Object.values(N.getColumns())].filter(rn).forEach(ce=>{ce.shift()}),N.rowCount-=1,mi(N,"afterDeleteRows"))),w!==!1&&mi(this,"addPoint",{point:ne}),this.isDirty=!0,this.isDirtyData=!0,p&&O.redraw(b)}removePoint(d,p,y){let b=this,{chart:w,data:M,points:T,dataTable:S}=b,O=M[d],B=function(){[T?.length===M.length?T:void 0,M,b.options.data,...Object.values(S.getColumns())].filter(rn).forEach(N=>{N.splice(d,1)}),S.rowCount-=1,mi(S,"afterDeleteRows"),O?.destroy(),b.isDirty=!0,b.isDirtyData=!0,p&&w.redraw()};Vt(y,w),p=Zi(p,!0),O?O.firePointEvent("remove",null,B):B()}remove(d,p,y,b){let w=this,M=w.chart;function T(){w.destroy(b),M.isDirtyLegend=M.isDirtyBox=!0,M.linkSeries(b),Zi(d,!0)&&M.redraw(p)}y!==!1?mi(w,"remove",null,T):T()}update(d,p){mi(this,"update",{options:d=ro(d,this.userOptions)});let y=this,b=y.chart,w=y.userOptions,M=y.initialType||y.type,T=b.options.plotOptions,S=dr[M].prototype,O=y.finishedAnimating&&{animation:!1},B={},N,U,X=["colorIndex","eventOptions","navigatorSeries","symbolIndex","baseSeries"],Z=d.type||w.type||b.options.chart.type,te=!(this.hasDerivedData||Z&&Z!==this.type||d.keys!==void 0||d.pointStart!==void 0||d.pointInterval!==void 0||d.relativeXValue!==void 0||d.joinBy||d.mapData||["dataGrouping","pointStart","pointInterval","pointIntervalUnit","keys"].some(J=>y.hasOptionChanged(J)));Z=Z||M,te?(X.push("data","isDirtyData","isDirtyCanvas","points","dataTable","processedData","xIncrement","cropped","_hasPointMarkers","hasDataLabels","nodes","layout","level","mapMap","mapData","minY","maxY","minX","maxX","transformGroups"),d.visible!==!1&&X.push("area","graph"),y.parallelArrays.forEach(function(J){X.push(J+"Data")}),d.data&&(d.dataSorting&&la(y.options.dataSorting,d.dataSorting),this.setData(d.data,!1))):this.dataTable.modified=this.dataTable,d=Pu(w,{index:w.index===void 0?y.index:w.index,pointStart:T?.series?.pointStart??w.pointStart??y.getColumn("x")[0]},!te&&{data:y.options.data},d,O),te&&d.data&&(d.data=y.options.data),(X=["group","markerGroup","dataLabelsGroup","transformGroup"].concat(X)).forEach(function(J){X[J]=y[J],delete y[J]});let ne=!1;if(dr[Z]){if(ne=Z!==y.type,y.remove(!1,!1,!1,!0),ne)if(b.propFromSeries(),Object.setPrototypeOf)Object.setPrototypeOf(y,dr[Z].prototype);else{let J=Object.hasOwnProperty.call(y,"hcEvents")&&y.hcEvents;for(U in S)y[U]=void 0;la(y,dr[Z].prototype),J?y.hcEvents=J:delete y.hcEvents}}else Nr(17,!0,b,{missingModuleFor:Z});if(X.forEach(function(J){y[J]=X[J]}),y.init(b,d),te&&this.points)for(let J of((N=y.options).visible===!1?(B.graphic=1,B.dataLabel=1):(this.hasMarkerChanged(N,w)&&(B.graphic=1),y.hasDataLabels?.()||(B.dataLabel=1)),this.points))J&&J.series&&(J.resolveColor(),Object.keys(B).length&&J.destroyElements(B),N.showInLegend===!1&&J.legendItem&&b.legend.destroyItem(J));y.initialType=M,b.linkSeries(),b.setSortedData(),ne&&y.linkedSeries.length&&(y.isDirtyData=!0),mi(this,"afterUpdate"),Zi(p,!0)&&b.redraw(!!te&&void 0)}setName(d){this.name=this.options.name=this.userOptions.name=d,this.chart.isDirtyLegend=!0}hasOptionChanged(d){let p=this.chart,y=this.options[d],b=p.options.plotOptions,w=this.userOptions[d],M=Zi(b?.[this.type]?.[d],b?.series?.[d]);return w&&!rn(M)?y!==w:y!==Zi(M,y)}onMouseOver(){let d=this.chart,p=d.hoverSeries;d.pointer?.setHoverChartIndex(),p&&p!==this&&p.onMouseOut(),this.options.events.mouseOver&&mi(this,"mouseOver"),this.setState("hover"),d.hoverSeries=this}onMouseOut(){let d=this.options,p=this.chart,y=p.tooltip,b=p.hoverPoint;p.hoverSeries=null,b&&b.onMouseOut(),this&&d.events.mouseOut&&mi(this,"mouseOut"),y&&!this.stickyTracking&&(!y.shared||this.noSharedTooltip)&&y.hide(),p.series.forEach(function(w){w.setState("",!0)})}setState(d,p){let y=this,b=y.options,w=y.graph,M=b.inactiveOtherPoints,T=b.states,S=Zi(T[d||"normal"]&&T[d||"normal"].animation,y.chart.options.chart.animation),O=b.lineWidth,B=b.opacity;if(d=d||"",y.state!==d&&([y.group,y.markerGroup,y.dataLabelsGroup].forEach(function(N){N&&(y.state&&N.removeClass("highcharts-series-"+y.state),d&&N.addClass("highcharts-series-"+d))}),y.state=d,!y.chart.styledMode)){if(T[d]&&T[d].enabled===!1)return;if(d&&(O=T[d].lineWidth||O+(T[d].lineWidthPlus||0),B=Zi(T[d].opacity,B)),w&&!w.dashstyle&&rr(O))for(let N of[w,...this.zones.map(U=>U.graph)])N?.animate({"stroke-width":O},S);M||[y.group,y.markerGroup,y.dataLabelsGroup,y.labelBySeries].forEach(function(N){N&&N.animate({opacity:B},S)})}p&&M&&y.points&&y.setAllPointsToState(d||void 0)}setAllPointsToState(d){this.points.forEach(function(p){p.setState&&p.setState(d)})}setVisible(d,p){let y=this,b=y.chart,w=b.options.chart.ignoreHiddenSeries,M=y.visible;y.visible=d=y.options.visible=y.userOptions.visible=d===void 0?!M:d;let T=d?"show":"hide";["group","dataLabelsGroup","markerGroup","tracker","tt"].forEach(S=>{y[S]?.[T]()}),(b.hoverSeries===y||b.hoverPoint?.series===y)&&y.onMouseOut(),y.legendItem&&b.legend.colorizeItem(y,d),y.isDirty=!0,y.options.stacking&&b.series.forEach(S=>{S.options.stacking&&S.visible&&(S.isDirty=!0)}),y.linkedSeries.forEach(S=>{S.setVisible(d,!1)}),w&&(b.isDirtyBox=!0),mi(y,T),p!==!1&&b.redraw()}show(){this.setVisible(!0)}hide(){this.setVisible(!1)}select(d){this.selected=d=this.options.selected=d===void 0?!this.selected:d,this.checkbox&&(this.checkbox.checked=d),mi(this,d?"select":"unselect")}shouldShowTooltip(d,p,y={}){return y.series=this,y.visiblePlotOnly=!0,this.chart.isInsidePlot(d,p,y)}drawLegendSymbol(d,p){_t[this.options.legendSymbol||"rectangle"]?.call(this,d,p)}}Ou.defaultOptions={lineWidth:2,allowPointSelect:!1,crisp:!0,showCheckbox:!1,animation:{duration:1e3},enableMouseTracking:!0,events:{},marker:{enabledThreshold:2,lineColor:"#ffffff",lineWidth:0,radius:4,states:{normal:{animation:!0},hover:{animation:{duration:150},enabled:!0,radiusPlus:2,lineWidthPlus:1},select:{fillColor:"#cccccc",lineColor:"#000000",lineWidth:2}}},point:{events:{}},dataLabels:{animation:{},align:"center",borderWidth:0,defer:!0,formatter:function(){let{numberFormatter:P}=this.series.chart;return typeof this.y!="number"?"":P(this.y,-1)},padding:5,style:{fontSize:"0.7em",fontWeight:"bold",color:"contrast",textOutline:"1px contrast"},verticalAlign:"bottom",x:0,y:0},cropThreshold:300,opacity:1,pointRange:0,softThreshold:!0,states:{normal:{animation:!0},hover:{animation:{duration:150},lineWidthPlus:1,marker:{},halo:{size:10,opacity:.25}},select:{animation:{duration:0}},inactive:{animation:{duration:150},opacity:.2}},stickyTracking:!0,turboThreshold:1e3,findNearestPointBy:"x"},Ou.types=Gt.seriesTypes,Ou.registerType=Gt.registerSeriesType,la(Ou.prototype,{axisTypes:["xAxis","yAxis"],coll:"series",colorCounter:0,directTouch:!1,invertible:!0,isCartesian:!0,kdAxisArray:["clientX","plotY"],parallelArrays:["x","y"],pointClass:z,requireSorting:!0,sorted:!0}),Gt.series=Ou;let Io=Ou,{animObject:Xp,setAnimation:Pl}=Ln,{registerEventOptions:gf}=wl,{composed:Iv,marginNames:uy}=lt,{distribute:kw}=Wr,{format:Rw}=Mt,{addEvent:Yp,createElement:dy,css:yf,defined:Mc,discardElement:Ol,find:da,fireEvent:fo,isNumber:Ll,merge:rs,pick:Ds,pushUnique:Pw,relativeLength:Ow,stableSort:Lw,syncTimeout:Sv}=Zt;class Kp{constructor(d,p){this.allItems=[],this.initialItemY=0,this.itemHeight=0,this.itemMarginBottom=0,this.itemMarginTop=0,this.itemX=0,this.itemY=0,this.lastItemY=0,this.lastLineHeight=0,this.legendHeight=0,this.legendWidth=0,this.maxItemWidth=0,this.maxLegendWidth=0,this.offsetWidth=0,this.padding=0,this.pages=[],this.symbolHeight=0,this.symbolWidth=0,this.titleHeight=0,this.totalItemWidth=0,this.widthOption=0,this.chart=d,this.setOptions(p),p.enabled&&(this.render(),gf(this,p),Yp(this.chart,"endResize",function(){this.legend.positionCheckboxes()})),Yp(this.chart,"render",()=>{this.options.enabled&&this.proximate&&(this.proximatePositions(),this.positionItems())})}setOptions(d){let p=Ds(d.padding,8);this.options=d,this.chart.styledMode||(this.itemStyle=d.itemStyle,this.itemHiddenStyle=rs(this.itemStyle,d.itemHiddenStyle)),this.itemMarginTop=d.itemMarginTop,this.itemMarginBottom=d.itemMarginBottom,this.padding=p,this.initialItemY=p-5,this.symbolWidth=Ds(d.symbolWidth,16),this.pages=[],this.proximate=d.layout==="proximate"&&!this.chart.inverted,this.baseline=void 0}update(d,p){let y=this.chart;this.setOptions(rs(!0,this.options,d)),"events"in this.options&&gf(this,this.options),this.destroy(),y.isDirtyLegend=y.isDirtyBox=!0,Ds(p,!0)&&y.redraw(),fo(this,"afterUpdate",{redraw:p})}colorizeItem(d,p){let y=d.color,{area:b,group:w,label:M,line:T,symbol:S}=d.legendItem||{};if((d instanceof Io||d instanceof z)&&(d.color=d.options?.legendSymbolColor||y),w?.[p?"removeClass":"addClass"]("highcharts-legend-item-hidden"),!this.chart.styledMode){let{itemHiddenStyle:O={}}=this,B=O.color,{fillColor:N,fillOpacity:U,lineColor:X,marker:Z}=d.options,te=ne=>(!p&&(ne.fill&&(ne.fill=B),ne.stroke&&(ne.stroke=B)),ne);M?.css(rs(p?this.itemStyle:O)),T?.attr(te({stroke:X||d.color})),S&&S.attr(te(Z&&S.isMarker?d.pointAttribs():{fill:d.color})),b?.attr(te({fill:N||d.color,"fill-opacity":N?1:U??.75}))}d.color=y,fo(this,"afterColorizeItem",{item:d,visible:p})}positionItems(){this.allItems.forEach(this.positionItem,this),this.chart.isResizing||this.positionCheckboxes()}positionItem(d){let{group:p,x:y=0,y:b=0}=d.legendItem||{},w=this.options,M=w.symbolPadding,T=!w.rtl,S=d.checkbox;if(p&&p.element){let O={translateX:T?y:this.legendWidth-y-2*M-4,translateY:b};p[Mc(p.translateY)?"animate":"attr"](O,void 0,()=>{fo(this,"afterPositionItem",{item:d})})}S&&(S.x=y,S.y=b)}destroyItem(d){let p=d.checkbox,y=d.legendItem||{};for(let b of["group","label","line","symbol"])y[b]&&(y[b]=y[b].destroy());p&&Ol(p),d.legendItem=void 0}destroy(){for(let d of this.getAllItems())this.destroyItem(d);for(let d of["clipRect","up","down","pager","nav","box","title","group"])this[d]&&(this[d]=this[d].destroy());this.display=null}positionCheckboxes(){let d,p=this.group&&this.group.alignAttr,y=this.clipHeight||this.legendHeight,b=this.titleHeight;p&&(d=p.translateY,this.allItems.forEach(function(w){let M,T=w.checkbox;T&&(M=d+b+T.y+(this.scrollOffset||0)+3,yf(T,{left:p.translateX+w.checkboxOffset+T.x-20+"px",top:M+"px",display:this.proximate||M>d-6&&M<d+y-6?"":"none"}))},this))}renderTitle(){let d=this.options,p=this.padding,y=d.title,b,w=0;y.text&&(this.title||(this.title=this.chart.renderer.label(y.text,p-3,p-4,void 0,void 0,void 0,d.useHTML,void 0,"legend-title").attr({zIndex:1}),this.chart.styledMode||this.title.css(y.style),this.title.add(this.group)),y.width||this.title.css({width:this.maxLegendWidth+"px"}),w=(b=this.title.getBBox()).height,this.offsetWidth=b.width,this.contentGroup.attr({translateY:w})),this.titleHeight=w}setText(d){let p=this.options;d.legendItem.label.attr({text:p.labelFormat?Rw(p.labelFormat,d,this.chart):p.labelFormatter.call(d)})}renderItem(d){let p=d.legendItem=d.legendItem||{},y=this.chart,b=y.renderer,w=this.options,M=w.layout==="horizontal",T=this.symbolWidth,S=w.symbolPadding||0,O=this.itemStyle,B=this.itemHiddenStyle,N=M?Ds(w.itemDistance,20):0,U=!w.rtl,X=!d.series,Z=!X&&d.series.drawLegendSymbol?d.series:d,te=Z.options,ne=!!this.createCheckboxForItem&&te&&te.showCheckbox,J=w.useHTML,ce=d.options.className,de=p.label,ke=T+S+N+(ne?20:0);!de&&(p.group=b.g("legend-item").addClass("highcharts-"+Z.type+"-series highcharts-color-"+d.colorIndex+(ce?" "+ce:"")+(X?" highcharts-series-"+d.index:"")).attr({zIndex:1}).add(this.scrollGroup),p.label=de=b.text("",U?T+S:-S,this.baseline||0,J),y.styledMode||de.css(rs(d.visible?O:B)),de.attr({align:U?"left":"right",zIndex:2}).add(p.group),!this.baseline&&(this.fontMetrics=b.fontMetrics(de),this.baseline=this.fontMetrics.f+3+this.itemMarginTop,de.attr("y",this.baseline),this.symbolHeight=Ds(w.symbolHeight,this.fontMetrics.f),w.squareSymbol&&(this.symbolWidth=Ds(w.symbolWidth,Math.max(this.symbolHeight,16)),ke=this.symbolWidth+S+N+(ne?20:0),U&&de.attr("x",this.symbolWidth+S))),Z.drawLegendSymbol(this,d),this.setItemEvents&&this.setItemEvents(d,de,J)),ne&&!d.checkbox&&this.createCheckboxForItem&&this.createCheckboxForItem(d),this.colorizeItem(d,d.visible),(y.styledMode||!O.width)&&de.css({width:(w.itemWidth||this.widthOption||y.spacingBox.width)-ke+"px"}),this.setText(d);let Ue=de.getBBox(),Le=this.fontMetrics&&this.fontMetrics.h||0;d.itemWidth=d.checkboxOffset=w.itemWidth||p.labelWidth||Ue.width+ke,this.maxItemWidth=Math.max(this.maxItemWidth,d.itemWidth),this.totalItemWidth+=d.itemWidth,this.itemHeight=d.itemHeight=Math.round(p.labelHeight||(Ue.height>1.5*Le?Ue.height:Le))}layoutItem(d){let p=this.options,y=this.padding,b=p.layout==="horizontal",w=d.itemHeight,M=this.itemMarginBottom,T=this.itemMarginTop,S=b?Ds(p.itemDistance,20):0,O=this.maxLegendWidth,B=p.alignColumns&&this.totalItemWidth>O?this.maxItemWidth:d.itemWidth,N=d.legendItem||{};b&&this.itemX-y+B>O&&(this.itemX=y,this.lastLineHeight&&(this.itemY+=T+this.lastLineHeight+M),this.lastLineHeight=0),this.lastItemY=T+this.itemY+M,this.lastLineHeight=Math.max(w,this.lastLineHeight),N.x=this.itemX,N.y=this.itemY,b?this.itemX+=B:(this.itemY+=T+w+M,this.lastLineHeight=w),this.offsetWidth=this.widthOption||Math.max((b?this.itemX-y-(d.checkbox?0:S):B)+y,this.offsetWidth)}getAllItems(){let d=[];return this.chart.series.forEach(function(p){let y=p&&p.options;p&&Ds(y.showInLegend,!Mc(y.linkedTo)&&void 0,!0)&&(d=d.concat((p.legendItem||{}).labels||(y.legendType==="point"?p.data:p)))}),fo(this,"afterGetAllItems",{allItems:d}),d}getAlignment(){let d=this.options;return this.proximate?d.align.charAt(0)+"tv":d.floating?"":d.align.charAt(0)+d.verticalAlign.charAt(0)+d.layout.charAt(0)}adjustMargins(d,p){let y=this.chart,b=this.options,w=this.getAlignment();w&&[/(lth|ct|rth)/,/(rtv|rm|rbv)/,/(rbh|cb|lbh)/,/(lbv|lm|ltv)/].forEach(function(M,T){M.test(w)&&!Mc(d[T])&&(y[uy[T]]=Math.max(y[uy[T]],y.legend[(T+1)%2?"legendHeight":"legendWidth"]+[1,-1,-1,1][T]*b[T%2?"x":"y"]+Ds(b.margin,12)+p[T]+(y.titleOffset[T]||0)))})}proximatePositions(){let d,p=this.chart,y=[],b=this.options.align==="left";for(let w of(this.allItems.forEach(function(M){let T,S,O=b,B,N;M.yAxis&&(M.xAxis.options.reversed&&(O=!O),M.points&&(T=da(O?M.points:M.points.slice(0).reverse(),function(U){return Ll(U.plotY)})),S=this.itemMarginTop+M.legendItem.label.getBBox().height+this.itemMarginBottom,N=M.yAxis.top-p.plotTop,B=M.visible?(T?T.plotY:M.yAxis.height)+(N-.3*S):N+M.yAxis.height,y.push({target:B,size:S,item:M}))},this),kw(y,p.plotHeight)))d=w.item.legendItem||{},Ll(w.pos)&&(d.y=p.plotTop-p.spacing[0]+w.pos)}render(){let d=this.chart,p=d.renderer,y=this.options,b=this.padding,w=this.getAllItems(),M,T,S,O=this.group,B,N=this.box;this.itemX=b,this.itemY=this.initialItemY,this.offsetWidth=0,this.lastItemY=0,this.widthOption=Ow(y.width,d.spacingBox.width-b),B=d.spacingBox.width-2*b-y.x,["rm","lm"].indexOf(this.getAlignment().substring(0,2))>-1&&(B/=2),this.maxLegendWidth=this.widthOption||B,O||(this.group=O=p.g("legend").addClass(y.className||"").attr({zIndex:7}).add(),this.contentGroup=p.g().attr({zIndex:1}).add(O),this.scrollGroup=p.g().add(this.contentGroup)),this.renderTitle(),Lw(w,(U,X)=>(U.options&&U.options.legendIndex||0)-(X.options&&X.options.legendIndex||0)),y.reversed&&w.reverse(),this.allItems=w,this.display=M=!!w.length,this.lastLineHeight=0,this.maxItemWidth=0,this.totalItemWidth=0,this.itemHeight=0,w.forEach(this.renderItem,this),w.forEach(this.layoutItem,this),T=(this.widthOption||this.offsetWidth)+b,S=this.lastItemY+this.lastLineHeight+this.titleHeight,S=this.handleOverflow(S)+b,N||(this.box=N=p.rect().addClass("highcharts-legend-box").attr({r:y.borderRadius}).add(O)),d.styledMode||N.attr({stroke:y.borderColor,"stroke-width":y.borderWidth||0,fill:y.backgroundColor||"none"}).shadow(y.shadow),T>0&&S>0&&N[N.placed?"animate":"attr"](N.crisp.call({},{x:0,y:0,width:T,height:S},N.strokeWidth())),O[M?"show":"hide"](),d.styledMode&&O.getStyle("display")==="none"&&(T=S=0),this.legendWidth=T,this.legendHeight=S,M&&this.align(),this.proximate||this.positionItems(),fo(this,"afterRender")}align(d=this.chart.spacingBox){let p=this.chart,y=this.options,b=d.y;/(lth|ct|rth)/.test(this.getAlignment())&&p.titleOffset[0]>0?b+=p.titleOffset[0]:/(lbh|cb|rbh)/.test(this.getAlignment())&&p.titleOffset[2]>0&&(b-=p.titleOffset[2]),b!==d.y&&(d=rs(d,{y:b})),p.hasRendered||(this.group.placed=!1),this.group.align(rs(y,{width:this.legendWidth,height:this.legendHeight,verticalAlign:this.proximate?"top":y.verticalAlign}),!0,d)}handleOverflow(d){let p=this,y=this.chart,b=y.renderer,w=this.options,M=w.y,T=w.verticalAlign==="top",S=this.padding,O=w.maxHeight,B=w.navigation,N=Ds(B.animation,!0),U=B.arrowSize||12,X=this.pages,Z=this.allItems,te=function(Se){typeof Se=="number"?Le.attr({height:Se}):Le&&(p.clipRect=Le.destroy(),p.contentGroup.clip()),p.contentGroup.div&&(p.contentGroup.div.style.clip=Se?"rect("+S+"px,9999px,"+(S+Se)+"px,0)":"auto")},ne=function(Se){return p[Se]=b.circle(0,0,1.3*U).translate(U/2,U/2).add(Ue),y.styledMode||p[Se].attr("fill","rgba(0,0,0,0.0001)"),p[Se]},J,ce,de,ke=y.spacingBox.height+(T?-M:M)-S,Ue=this.nav,Le=this.clipRect;return w.layout!=="horizontal"||w.verticalAlign==="middle"||w.floating||(ke/=2),O&&(ke=Math.min(ke,O)),X.length=0,d&&ke>0&&d>ke&&B.enabled!==!1?(this.clipHeight=J=Math.max(ke-20-this.titleHeight-S,0),this.currentPage=Ds(this.currentPage,1),this.fullHeight=d,Z.forEach((Se,ze)=>{let nt=(de=Se.legendItem||{}).y||0,rt=Math.round(de.label.getBBox().height),pt=X.length;(!pt||nt-X[pt-1]>J&&(ce||nt)!==X[pt-1])&&(X.push(ce||nt),pt++),de.pageIx=pt-1,ce&&((Z[ze-1].legendItem||{}).pageIx=pt-1),ze===Z.length-1&&nt+rt-X[pt-1]>J&&nt>X[pt-1]&&(X.push(nt),de.pageIx=pt),nt!==ce&&(ce=nt)}),Le||(Le=p.clipRect=b.clipRect(0,S-2,9999,0),p.contentGroup.clip(Le)),te(J),Ue||(this.nav=Ue=b.g().attr({zIndex:1}).add(this.group),this.up=b.symbol("triangle",0,0,U,U).add(Ue),ne("upTracker").on("click",function(){p.scroll(-1,N)}),this.pager=b.text("",15,10).addClass("highcharts-legend-navigation"),!y.styledMode&&B.style&&this.pager.css(B.style),this.pager.add(Ue),this.down=b.symbol("triangle-down",0,0,U,U).add(Ue),ne("downTracker").on("click",function(){p.scroll(1,N)})),p.scroll(0),d=ke):Ue&&(te(),this.nav=Ue.destroy(),this.scrollGroup.attr({translateY:1}),this.clipHeight=0),d}scroll(d,p){let y=this.chart,b=this.pages,w=b.length,M=this.clipHeight,T=this.options.navigation,S=this.pager,O=this.padding,B=this.currentPage+d;B>w&&(B=w),B>0&&(p!==void 0&&Pl(p,y),this.nav.attr({translateX:O,translateY:M+this.padding+7+this.titleHeight,visibility:"inherit"}),[this.up,this.upTracker].forEach(function(N){N.attr({class:B===1?"highcharts-legend-nav-inactive":"highcharts-legend-nav-active"})}),S.attr({text:B+"/"+w}),[this.down,this.downTracker].forEach(function(N){N.attr({x:18+this.pager.getBBox().width,class:B===w?"highcharts-legend-nav-inactive":"highcharts-legend-nav-active"})},this),y.styledMode||(this.up.attr({fill:B===1?T.inactiveColor:T.activeColor}),this.upTracker.css({cursor:B===1?"default":"pointer"}),this.down.attr({fill:B===w?T.inactiveColor:T.activeColor}),this.downTracker.css({cursor:B===w?"default":"pointer"})),this.scrollOffset=-b[B-1]+this.initialItemY,this.scrollGroup.animate({translateY:this.scrollOffset}),this.currentPage=B,this.positionCheckboxes(),Sv(()=>{fo(this,"afterScroll",{currentPage:B})},Xp(Ds(p,y.renderer.globalAnimation,!0)).duration))}setItemEvents(d,p,y){let b=this,w=d.legendItem||{},M=b.chart.renderer.boxWrapper,T=d instanceof z,S=d instanceof Io,O="highcharts-legend-"+(T?"point":"series")+"-active",B=b.chart.styledMode,N=y?[p,w.symbol]:[w.group],U=X=>{b.allItems.forEach(Z=>{d!==Z&&[Z].concat(Z.linkedSeries||[]).forEach(te=>{te.setState(X,!T)})})};for(let X of N)X&&X.on("mouseover",function(){d.visible&&U("inactive"),d.setState("hover"),d.visible&&M.addClass(O),B||p.css(b.options.itemHoverStyle)}).on("mouseout",function(){b.chart.styledMode||p.css(rs(d.visible?b.itemStyle:b.itemHiddenStyle)),U(""),M.removeClass(O),d.setState()}).on("click",function(Z){let te=function(){d.setVisible&&d.setVisible(),U(d.visible?"inactive":"")};M.removeClass(O),fo(b,"itemClick",{browserEvent:Z,legendItem:d},te),T?d.firePointEvent("legendItemClick",{browserEvent:Z}):S&&fo(d,"legendItemClick",{browserEvent:Z})})}createCheckboxForItem(d){d.checkbox=dy("input",{type:"checkbox",className:"highcharts-legend-checkbox",checked:d.selected,defaultChecked:d.selected},this.options.itemCheckboxStyle,this.chart.container),Yp(d.checkbox,"click",function(p){let y=p.target;fo(d.series||d,"checkboxClick",{checked:y.checked,item:d},function(){d.select()})})}}(function(P){P.compose=function(d){Pw(Iv,"Core.Legend")&&Yp(d,"beforeMargins",function(){this.legend=new P(this,this.options.legend)})}})(Kp||(Kp={}));let Ms=Kp,{animate:hy,animObject:Fw,setAnimation:Xi}=Ln,{defaultOptions:Wt}=Sr,{numberFormat:Tc}=Mt,{registerEventOptions:_f}=wl,{charts:Rr,doc:Zd,marginNames:fy,svg:ha,win:Qp}=lt,{seriesTypes:Fl}=Gt,{addEvent:Lu,attr:Ic,createElement:vf,css:zo,defined:Nl,diffObjects:py,discardElement:Nw,erase:my,error:Jp,extend:Ts,find:Sc,fireEvent:Nn,getAlignFactor:gy,getStyle:em,isArray:bf,isNumber:ja,isObject:os,isString:Ac,merge:or,objectEach:Bo,pick:zr,pInt:sr,relativeLength:yy,removeEvent:Xd,splat:jo,syncTimeout:zw,uniqueKey:Bw}=Zt;class zl{static chart(d,p,y){return new zl(d,p,y)}constructor(d,p,y){this.sharedClips={};let b=[...arguments];(Ac(d)||d.nodeName)&&(this.renderTo=b.shift()),this.init(b[0],b[1])}setZoomOptions(){let d=this.options.chart,p=d.zooming;this.zooming=Cn(ut({},p),{type:zr(d.zoomType,p.type),key:zr(d.zoomKey,p.key),pinchType:zr(d.pinchType,p.pinchType),singleTouch:zr(d.zoomBySingleTouch,p.singleTouch,!1),resetButton:or(p.resetButton,d.resetZoomButton)})}init(d,p){Nn(this,"init",{args:arguments},function(){let y=or(Wt,d),b=y.chart,w=this.renderTo||b.renderTo;this.userOptions=Ts({},d),(this.renderTo=Ac(w)?Zd.getElementById(w):w)||Jp(13,!0,this),this.margin=[],this.spacing=[],this.labelCollectors=[],this.callback=p,this.isResizing=0,this.options=y,this.axes=[],this.series=[],this.locale=y.lang.locale??this.renderTo.closest("[lang]")?.lang,this.time=new Qs(Ts(y.time||{},{locale:this.locale})),y.time=this.time.options,this.numberFormatter=(b.numberFormatter||Tc).bind(this),this.styledMode=b.styledMode,this.hasCartesianSeries=b.showAxes,this.index=Rr.length,Rr.push(this),lt.chartCount++,_f(this,b),this.xAxis=[],this.yAxis=[],this.pointCount=this.colorCounter=this.symbolCounter=0,this.setZoomOptions(),Nn(this,"afterInit"),this.firstRender()})}initSeries(d){let p=this.options.chart,y=d.type||p.type,b=Fl[y];b||Jp(17,!0,this,{missingModuleFor:y});let w=new b;return typeof w.init=="function"&&w.init(this,d),w}setSortedData(){this.getSeriesOrderByLinks().forEach(function(d){d.points||d.data||!d.enabledDataSorting||d.setData(d.options.data,!1)})}getSeriesOrderByLinks(){return this.series.concat().sort(function(d,p){return d.linkedSeries.length||p.linkedSeries.length?p.linkedSeries.length-d.linkedSeries.length:0})}orderItems(d,p=0){let y=this[d],b=this.options[d]=jo(this.options[d]).slice(),w=this.userOptions[d]=this.userOptions[d]?jo(this.userOptions[d]).slice():[];if(this.hasRendered&&(b.splice(p),w.splice(p)),y)for(let M=p,T=y.length;M<T;++M){let S=y[M];S&&(S.index=M,S instanceof Io&&(S.name=S.getName()),S.options.isInternal||(b[M]=S.options,w[M]=S.userOptions))}}isInsidePlot(d,p,y={}){let{inverted:b,plotBox:w,plotLeft:M,plotTop:T,scrollablePlotBox:S}=this,{scrollLeft:O=0,scrollTop:B=0}=y.visiblePlotOnly&&this.scrollablePlotArea?.scrollingContainer||{},N=y.series,U=y.visiblePlotOnly&&S||w,X=y.inverted?p:d,Z=y.inverted?d:p,te={x:X,y:Z,isInsidePlot:!0,options:y};if(!y.ignoreX){let ne=N&&(b&&!this.polar?N.yAxis:N.xAxis)||{pos:M,len:1/0},J=y.paneCoordinates?ne.pos+X:M+X;J>=Math.max(O+M,ne.pos)&&J<=Math.min(O+M+U.width,ne.pos+ne.len)||(te.isInsidePlot=!1)}if(!y.ignoreY&&te.isInsidePlot){let ne=!b&&y.axis&&!y.axis.isXAxis&&y.axis||N&&(b?N.xAxis:N.yAxis)||{pos:T,len:1/0},J=y.paneCoordinates?ne.pos+Z:T+Z;J>=Math.max(B+T,ne.pos)&&J<=Math.min(B+T+U.height,ne.pos+ne.len)||(te.isInsidePlot=!1)}return Nn(this,"afterIsInsidePlot",te),te.isInsidePlot}redraw(d){Nn(this,"beforeRedraw");let p=this.hasCartesianSeries?this.axes:this.colorAxis||[],y=this.series,b=this.pointer,w=this.legend,M=this.userOptions.legend,T=this.renderer,S=T.isHidden(),O=[],B,N,U,X=this.isDirtyBox,Z=this.isDirtyLegend,te;for(T.rootFontSize=T.boxWrapper.getStyle("font-size"),this.setResponsive&&this.setResponsive(!1),Xi(!!this.hasRendered&&d,this),S&&this.temporaryDisplay(),this.layOutTitles(!1),U=y.length;U--;)if(((te=y[U]).options.stacking||te.options.centerInCategory)&&(N=!0,te.isDirty)){B=!0;break}if(B)for(U=y.length;U--;)(te=y[U]).options.stacking&&(te.isDirty=!0);y.forEach(function(ne){ne.isDirty&&(ne.options.legendType==="point"?(typeof ne.updateTotals=="function"&&ne.updateTotals(),Z=!0):M&&(M.labelFormatter||M.labelFormat)&&(Z=!0)),ne.isDirtyData&&Nn(ne,"updatedData")}),Z&&w&&w.options.enabled&&(w.render(),this.isDirtyLegend=!1),N&&this.getStacks(),p.forEach(function(ne){ne.updateNames(),ne.setScale()}),this.getMargins(),p.forEach(function(ne){ne.isDirty&&(X=!0)}),p.forEach(function(ne){let J=ne.min+","+ne.max;ne.extKey!==J&&(ne.extKey=J,O.push(function(){Nn(ne,"afterSetExtremes",Ts(ne.eventArgs,ne.getExtremes())),delete ne.eventArgs})),(X||N)&&ne.redraw()}),X&&this.drawChartBox(),Nn(this,"predraw"),y.forEach(function(ne){(X||ne.isDirty)&&ne.visible&&ne.redraw(),ne.isDirtyData=!1}),b&&b.reset(!0),T.draw(),Nn(this,"redraw"),Nn(this,"render"),S&&this.temporaryDisplay(!0),O.forEach(function(ne){ne.call()})}get(d){let p=this.series;function y(w){return w.id===d||w.options&&w.options.id===d}let b=Sc(this.axes,y)||Sc(this.series,y);for(let w=0;!b&&w<p.length;w++)b=Sc(p[w].points||[],y);return b}createAxes(){let d=this.userOptions;for(let p of(Nn(this,"createAxes"),["xAxis","yAxis"]))for(let y of d[p]=jo(d[p]||{}))new _r(this,y,p);Nn(this,"afterCreateAxes")}getSelectedPoints(){return this.series.reduce((d,p)=>(p.getPointsCollection().forEach(y=>{zr(y.selectedStaging,y.selected)&&d.push(y)}),d),[])}getSelectedSeries(){return this.series.filter(d=>d.selected)}setTitle(d,p,y){this.applyDescription("title",d),this.applyDescription("subtitle",p),this.applyDescription("caption",void 0),this.layOutTitles(y)}applyDescription(d,p){let y=this,b=this.options[d]=or(this.options[d],p),w=this[d];w&&p&&(this[d]=w=w.destroy()),b&&!w&&((w=this.renderer.text(b.text,0,0,b.useHTML).attr({align:b.align,class:"highcharts-"+d,zIndex:b.zIndex||4}).css({textOverflow:"ellipsis",whiteSpace:"nowrap"}).add()).update=function(M,T){y.applyDescription(d,M),y.layOutTitles(T)},this.styledMode||w.css(Ts(d==="title"?{fontSize:this.options.isStock?"1em":"1.2em"}:{},b.style)),w.textPxLength=w.getBBox().width,w.css({whiteSpace:b.style?.whiteSpace}),this[d]=w)}layOutTitles(d=!0){let p=[0,0,0],{options:y,renderer:b,spacingBox:w}=this;["title","subtitle","caption"].forEach(T=>{let S=this[T],O=this.options[T],B=or(w),N=S?.textPxLength||0;if(S&&O){Nn(this,"layOutTitle",{alignTo:B,key:T,textPxLength:N});let U=b.fontMetrics(S),X=U.b,Z=U.h,te=O.verticalAlign||"top",ne=te==="top",J=ne&&O.minScale||1,ce=T==="title"?ne?-3:0:ne?p[0]+2:0,de=Math.min(B.width/N,1),ke=Math.max(J,de),Ue=or({y:te==="bottom"?X:ce+X},{align:T==="title"?de<J?"left":"center":this.title?.alignValue},O),Le=O.width||(de>J?this.chartWidth:B.width)/ke;S.alignValue!==Ue.align&&(S.placed=!1);let Se=Math.round(S.css({width:`${Le}px`}).getBBox(O.useHTML).height);if(Ue.height=Se,S.align(Ue,!1,B).attr({align:Ue.align,scaleX:ke,scaleY:ke,"transform-origin":`${B.x+N*ke*gy(Ue.align)} ${Z}`}),!O.floating){let ze=Se*(Se<1.2*Z?1:ke);te==="top"?p[0]=Math.ceil(p[0]+ze):te==="bottom"&&(p[2]=Math.ceil(p[2]+ze))}}},this),p[0]&&(y.title?.verticalAlign||"top")==="top"&&(p[0]+=y.title?.margin||0),p[2]&&y.caption?.verticalAlign==="bottom"&&(p[2]+=y.caption?.margin||0);let M=!this.titleOffset||this.titleOffset.join(",")!==p.join(",");this.titleOffset=p,Nn(this,"afterLayOutTitles"),!this.isDirtyBox&&M&&(this.isDirtyBox=this.isDirtyLegend=M,this.hasRendered&&d&&this.isDirtyBox&&this.redraw())}getContainerBox(){let d=[].map.call(this.renderTo.children,y=>{if(y!==this.container){let b=y.style.display;return y.style.display="none",[y,b]}}),p={width:em(this.renderTo,"width",!0)||0,height:em(this.renderTo,"height",!0)||0};return d.filter(Boolean).forEach(([y,b])=>{y.style.display=b}),p}getChartSize(){let d=this.options.chart,p=d.width,y=d.height,b=this.getContainerBox(),w=b.height<=1||!this.renderTo.parentElement?.style.height&&this.renderTo.style.height==="100%";this.chartWidth=Math.max(0,p||b.width||600),this.chartHeight=Math.max(0,yy(y,this.chartWidth)||(w?400:b.height)),this.containerBox=b}temporaryDisplay(d){let p=this.renderTo,y;if(d)for(;p&&p.style;)p.hcOrigStyle&&(zo(p,p.hcOrigStyle),delete p.hcOrigStyle),p.hcOrigDetached&&(Zd.body.removeChild(p),p.hcOrigDetached=!1),p=p.parentNode;else for(;p&&p.style&&(Zd.body.contains(p)||p.parentNode||(p.hcOrigDetached=!0,Zd.body.appendChild(p)),(em(p,"display",!1)==="none"||p.hcOricDetached)&&(p.hcOrigStyle={display:p.style.display,height:p.style.height,overflow:p.style.overflow},y={display:"block",overflow:"hidden"},p!==this.renderTo&&(y.height=0),zo(p,y),p.offsetWidth||p.style.setProperty("display","block","important")),(p=p.parentNode)!==Zd.body););}setClassName(d){this.container.className="highcharts-container "+(d||"")}getContainer(){let d,p=this.options,y=p.chart,b="data-highcharts-chart",w=Bw(),M=this.renderTo,T=sr(Ic(M,b));ja(T)&&Rr[T]&&Rr[T].hasRendered&&Rr[T].destroy(),Ic(M,b,this.index),M.innerHTML=bi.emptyHTML,y.skipClone||M.offsetWidth||this.temporaryDisplay(),this.getChartSize();let S=this.chartHeight,O=this.chartWidth;zo(M,{overflow:"hidden"}),this.styledMode||(d=Ts({position:"relative",overflow:"hidden",width:O+"px",height:S+"px",textAlign:"left",lineHeight:"normal",zIndex:0,"-webkit-tap-highlight-color":"rgba(0,0,0,0)",userSelect:"none","touch-action":"manipulation",outline:"none",padding:"0px"},y.style||{}));let B=vf("div",{id:w},d,M);this.container=B,this.getChartSize(),O===this.chartWidth||(O=this.chartWidth,this.styledMode||zo(B,{width:zr(y.style?.width,O+"px")})),this.containerBox=this.getContainerBox(),this._cursor=B.style.cursor;let N=y.renderer||!ha?En.getRendererType(y.renderer):pc;if(this.renderer=new N(B,O,S,void 0,y.forExport,p.exporting&&p.exporting.allowHTML,this.styledMode),Xi(void 0,this),this.setClassName(y.className),this.styledMode)for(let U in p.defs)this.renderer.definition(p.defs[U]);else this.renderer.setStyle(y.style);this.renderer.chartIndex=this.index,Nn(this,"afterGetContainer")}getMargins(d){let{spacing:p,margin:y,titleOffset:b}=this;this.resetMargins(),b[0]&&!Nl(y[0])&&(this.plotTop=Math.max(this.plotTop,b[0]+p[0])),b[2]&&!Nl(y[2])&&(this.marginBottom=Math.max(this.marginBottom,b[2]+p[2])),this.legend&&this.legend.display&&this.legend.adjustMargins(y,p),Nn(this,"getMargins"),d||this.getAxisMargins()}getAxisMargins(){let d=this,p=d.axisOffset=[0,0,0,0],y=d.colorAxis,b=d.margin,w=function(M){M.forEach(function(T){T.visible&&T.getOffset()})};d.hasCartesianSeries?w(d.axes):y&&y.length&&w(y),fy.forEach(function(M,T){Nl(b[T])||(d[M]+=p[T])}),d.setChartSize()}getOptions(){return py(this.userOptions,Wt)}reflow(d){let p=this,y=p.containerBox,b=p.getContainerBox();delete p.pointer?.chartPosition,!p.isPrinting&&!p.isResizing&&y&&b.width&&((b.width!==y.width||b.height!==y.height)&&(Zt.clearTimeout(p.reflowTimeout),p.reflowTimeout=zw(function(){p.container&&p.setSize(void 0,void 0,!1)},d?100:0)),p.containerBox=b)}setReflow(){let d=this,p=y=>{d.options?.chart.reflow&&d.hasLoaded&&d.reflow(y)};if(typeof ResizeObserver=="function")new ResizeObserver(p).observe(d.renderTo);else{let y=Lu(Qp,"resize",p);Lu(this,"destroy",y)}}setSize(d,p,y){let b=this,w=b.renderer;b.isResizing+=1,Xi(y,b);let M=w.globalAnimation;b.oldChartHeight=b.chartHeight,b.oldChartWidth=b.chartWidth,d!==void 0&&(b.options.chart.width=d),p!==void 0&&(b.options.chart.height=p),b.getChartSize();let{chartWidth:T,chartHeight:S,scrollablePixelsX:O=0,scrollablePixelsY:B=0}=b;(b.isDirtyBox||T!==b.oldChartWidth||S!==b.oldChartHeight)&&(b.styledMode||(M?hy:zo)(b.container,{width:`${T+O}px`,height:`${S+B}px`},M),b.setChartSize(!0),w.setSize(T,S,M),b.axes.forEach(function(N){N.isDirty=!0,N.setScale()}),b.isDirtyLegend=!0,b.isDirtyBox=!0,b.layOutTitles(),b.getMargins(),b.redraw(M),b.oldChartHeight=void 0,Nn(b,"resize"),setTimeout(()=>{b&&Nn(b,"endResize")},Fw(M).duration)),b.isResizing-=1}setChartSize(d){let p,y,b,w,{chartHeight:M,chartWidth:T,inverted:S,spacing:O,renderer:B}=this,N=this.clipOffset,U=Math[S?"floor":"round"];this.plotLeft=p=Math.round(this.plotLeft),this.plotTop=y=Math.round(this.plotTop),this.plotWidth=b=Math.max(0,Math.round(T-p-this.marginRight)),this.plotHeight=w=Math.max(0,Math.round(M-y-this.marginBottom)),this.plotSizeX=S?w:b,this.plotSizeY=S?b:w,this.spacingBox=B.spacingBox={x:O[3],y:O[0],width:T-O[3]-O[1],height:M-O[0]-O[2]},this.plotBox=B.plotBox={x:p,y,width:b,height:w},N&&(this.clipBox={x:U(N[3]),y:U(N[0]),width:U(this.plotSizeX-N[1]-N[3]),height:U(this.plotSizeY-N[0]-N[2])}),d||(this.axes.forEach(function(X){X.setAxisSize(),X.setAxisTranslation()}),B.alignElements()),Nn(this,"afterSetChartSize",{skipAxes:d})}resetMargins(){Nn(this,"resetMargins");let d=this,p=d.options.chart,y=p.plotBorderWidth||0,b=y/2;["margin","spacing"].forEach(function(w){let M=p[w],T=os(M)?M:[M,M,M,M];["Top","Right","Bottom","Left"].forEach(function(S,O){d[w][O]=zr(p[w+S],T[O])})}),fy.forEach(function(w,M){d[w]=zr(d.margin[M],d.spacing[M])}),d.axisOffset=[0,0,0,0],d.clipOffset=[b,b,b,b],d.plotBorderWidth=y}drawChartBox(){let d=this.options.chart,p=this.renderer,y=this.chartWidth,b=this.chartHeight,w=this.styledMode,M=this.plotBGImage,T=d.backgroundColor,S=d.plotBackgroundColor,O=d.plotBackgroundImage,B=this.plotLeft,N=this.plotTop,U=this.plotWidth,X=this.plotHeight,Z=this.plotBox,te=this.clipRect,ne=this.clipBox,J=this.chartBackground,ce=this.plotBackground,de=this.plotBorder,ke,Ue,Le,Se="animate";J||(this.chartBackground=J=p.rect().addClass("highcharts-background").add(),Se="attr"),w?ke=Ue=J.strokeWidth():(Ue=(ke=d.borderWidth||0)+(d.shadow?8:0),Le={fill:T||"none"},(ke||J["stroke-width"])&&(Le.stroke=d.borderColor,Le["stroke-width"]=ke),J.attr(Le).shadow(d.shadow)),J[Se]({x:Ue/2,y:Ue/2,width:y-Ue-ke%2,height:b-Ue-ke%2,r:d.borderRadius}),Se="animate",ce||(Se="attr",this.plotBackground=ce=p.rect().addClass("highcharts-plot-background").add()),ce[Se](Z),!w&&(ce.attr({fill:S||"none"}).shadow(d.plotShadow),O&&(M?(O!==M.attr("href")&&M.attr("href",O),M.animate(Z)):this.plotBGImage=p.image(O,B,N,U,X).add())),te?te.animate({width:ne.width,height:ne.height}):this.clipRect=p.clipRect(ne),Se="animate",de||(Se="attr",this.plotBorder=de=p.rect().addClass("highcharts-plot-border").attr({zIndex:1}).add()),w||de.attr({stroke:d.plotBorderColor,"stroke-width":d.plotBorderWidth||0,fill:"none"}),de[Se](de.crisp({x:B,y:N,width:U,height:X},-de.strokeWidth())),this.isDirtyBox=!1,Nn(this,"afterDrawChartBox")}propFromSeries(){let d,p,y,b=this,w=b.options.chart,M=b.options.series;["inverted","angular","polar"].forEach(function(T){for(p=Fl[w.type],y=w[T]||p&&p.prototype[T],d=M&&M.length;!y&&d--;)(p=Fl[M[d].type])&&p.prototype[T]&&(y=!0);b[T]=y})}linkSeries(d){let p=this,y=p.series;y.forEach(function(b){b.linkedSeries.length=0}),y.forEach(function(b){let{linkedTo:w}=b.options;if(Ac(w)){let M;(M=w===":previous"?p.series[b.index-1]:p.get(w))&&M.linkedParent!==b&&(M.linkedSeries.push(b),b.linkedParent=M,M.enabledDataSorting&&b.setDataSortingOptions(),b.visible=zr(b.options.visible,M.options.visible,b.visible))}}),Nn(this,"afterLinkSeries",{isUpdating:d})}renderSeries(){this.series.forEach(function(d){d.translate(),d.render()})}render(){let d=this.axes,p=this.colorAxis,y=this.renderer,b=this.options.chart.axisLayoutRuns||2,w=B=>{B.forEach(N=>{N.visible&&N.render()})},M=0,T=!0,S,O=0;for(let B of(this.setTitle(),Nn(this,"beforeMargins"),this.getStacks?.(),this.getMargins(!0),this.setChartSize(),d)){let{options:N}=B,{labels:U}=N;if(this.hasCartesianSeries&&B.horiz&&B.visible&&U.enabled&&B.series.length&&B.coll!=="colorAxis"&&!this.polar){M=N.tickLength,B.createGroups();let X=new uo(B,0,"",!0),Z=X.createLabel("x",U);if(X.destroy(),Z&&zr(U.reserveSpace,!ja(N.crossing))&&(M=Z.getBBox().height+U.distance+Math.max(N.offset||0,0)),M){Z?.destroy();break}}}for(this.plotHeight=Math.max(this.plotHeight-M,0);(T||S||b>1)&&O<b;){let B=this.plotWidth,N=this.plotHeight;for(let U of d)O===0?U.setScale():(U.horiz&&T||!U.horiz&&S)&&U.setTickInterval(!0);O===0?this.getAxisMargins():this.getMargins(),T=B/this.plotWidth>(O?1:1.1),S=N/this.plotHeight>(O?1:1.05),O++}this.drawChartBox(),this.hasCartesianSeries?w(d):p&&p.length&&w(p),this.seriesGroup||(this.seriesGroup=y.g("series-group").attr({zIndex:3}).shadow(this.options.chart.seriesGroupShadow).add()),this.renderSeries(),this.addCredits(),this.setResponsive&&this.setResponsive(),this.hasRendered=!0}addCredits(d){let p=this,y=or(!0,this.options.credits,d);y.enabled&&!this.credits&&(this.credits=this.renderer.text(y.text+(this.mapCredits||""),0,0).addClass("highcharts-credits").on("click",function(){y.href&&(Qp.location.href=y.href)}).attr({align:y.position.align,zIndex:8}),p.styledMode||this.credits.css(y.style),this.credits.add().align(y.position),this.credits.update=function(b){p.credits=p.credits.destroy(),p.addCredits(b)})}destroy(){let d,p=this,y=p.axes,b=p.series,w=p.container,M=w&&w.parentNode;for(Nn(p,"destroy"),p.renderer.forExport?my(Rr,p):Rr[p.index]=void 0,lt.chartCount--,p.renderTo.removeAttribute("data-highcharts-chart"),Xd(p),d=y.length;d--;)y[d]=y[d].destroy();for(this.scroller&&this.scroller.destroy&&this.scroller.destroy(),d=b.length;d--;)b[d]=b[d].destroy();["title","subtitle","chartBackground","plotBackground","plotBGImage","plotBorder","seriesGroup","clipRect","credits","pointer","rangeSelector","legend","resetZoomButton","tooltip","renderer"].forEach(function(T){let S=p[T];S&&S.destroy&&(p[T]=S.destroy())}),w&&(w.innerHTML=bi.emptyHTML,Xd(w),M&&Nw(w)),Bo(p,function(T,S){delete p[S]})}firstRender(){let d=this,p=d.options;d.getContainer(),d.resetMargins(),d.setChartSize(),d.propFromSeries(),d.createAxes();let y=bf(p.series)?p.series:[];p.series=[],y.forEach(function(b){d.initSeries(b)}),d.linkSeries(),d.setSortedData(),Nn(d,"beforeRender"),d.render(),d.pointer?.getChartPosition(),d.renderer.imgCount||d.hasLoaded||d.onload(),d.temporaryDisplay(!0)}onload(){this.callbacks.concat([this.callback]).forEach(function(d){d&&this.index!==void 0&&d.apply(this,[this])},this),Nn(this,"load"),Nn(this,"render"),Nl(this.index)&&this.setReflow(),this.warnIfA11yModuleNotLoaded(),this.hasLoaded=!0}warnIfA11yModuleNotLoaded(){let{options:d,title:p}=this;!d||this.accessibility||(this.renderer.boxWrapper.attr({role:"img","aria-label":(p&&p.element.textContent||"").replace(/</g,"&lt;")}),d.accessibility&&d.accessibility.enabled===!1||Jp('Highcharts warning: Consider including the "accessibility.js" module to make your chart more usable for people with disabilities. Set the "accessibility.enabled" option to false to remove this warning. See https://www.highcharts.com/docs/accessibility/accessibility-module.',!1,this))}addSeries(d,p,y){let b,w=this;return d&&(p=zr(p,!0),Nn(w,"addSeries",{options:d},function(){b=w.initSeries(d),w.isDirtyLegend=!0,w.linkSeries(),b.enabledDataSorting&&b.setData(d.data,!1),Nn(w,"afterAddSeries",{series:b}),p&&w.redraw(y)})),b}addAxis(d,p,y,b){return this.createAxis(p?"xAxis":"yAxis",{axis:d,redraw:y,animation:b})}addColorAxis(d,p,y){return this.createAxis("colorAxis",{axis:d,redraw:p,animation:y})}createAxis(d,p){let y=new _r(this,p.axis,d);return zr(p.redraw,!0)&&this.redraw(p.animation),y}showLoading(d){let p=this,y=p.options,b=y.loading,w=function(){M&&zo(M,{left:p.plotLeft+"px",top:p.plotTop+"px",width:p.plotWidth+"px",height:p.plotHeight+"px"})},M=p.loadingDiv,T=p.loadingSpan;M||(p.loadingDiv=M=vf("div",{className:"highcharts-loading highcharts-loading-hidden"},null,p.container)),T||(p.loadingSpan=T=vf("span",{className:"highcharts-loading-inner"},null,M),Lu(p,"redraw",w)),M.className="highcharts-loading",bi.setElementHTML(T,zr(d,y.lang.loading,"")),p.styledMode||(zo(M,Ts(b.style,{zIndex:10})),zo(T,b.labelStyle),p.loadingShown||(zo(M,{opacity:0,display:""}),hy(M,{opacity:b.style.opacity||.5},{duration:b.showDuration||0}))),p.loadingShown=!0,w()}hideLoading(){let d=this.options,p=this.loadingDiv;p&&(p.className="highcharts-loading highcharts-loading-hidden",this.styledMode||hy(p,{opacity:0},{duration:d.loading.hideDuration||100,complete:function(){zo(p,{display:"none"})}})),this.loadingShown=!1}update(d,p,y,b){let w,M,T,S=this,O={credits:"addCredits",title:"setTitle",subtitle:"setSubtitle",caption:"setCaption"},B=d.isResponsiveOptions,N=[];Nn(S,"update",{options:d}),B||S.setResponsive(!1,!0),d=py(d,S.options),S.userOptions=or(S.userOptions,d);let U=d.chart;U&&(or(!0,S.options.chart,U),this.setZoomOptions(),"className"in U&&S.setClassName(U.className),("inverted"in U||"polar"in U||"type"in U)&&(S.propFromSeries(),w=!0),"alignTicks"in U&&(w=!0),"events"in U&&_f(this,U),Bo(U,function(te,ne){S.propsRequireUpdateSeries.indexOf("chart."+ne)!==-1&&(M=!0),S.propsRequireDirtyBox.indexOf(ne)!==-1&&(S.isDirtyBox=!0),S.propsRequireReflow.indexOf(ne)===-1||(S.isDirtyBox=!0,B||(T=!0))}),!S.styledMode&&U.style&&S.renderer.setStyle(S.options.chart.style||{})),!S.styledMode&&d.colors&&(this.options.colors=d.colors),Bo(d,function(te,ne){S[ne]&&typeof S[ne].update=="function"?S[ne].update(te,!1):typeof S[O[ne]]=="function"?S[O[ne]](te):ne!=="colors"&&S.collectionsWithUpdate.indexOf(ne)===-1&&or(!0,S.options[ne],d[ne]),ne!=="chart"&&S.propsRequireUpdateSeries.indexOf(ne)!==-1&&(M=!0)}),this.collectionsWithUpdate.forEach(function(te){d[te]&&(jo(d[te]).forEach(function(ne,J){let ce,de=Nl(ne.id);de&&(ce=S.get(ne.id)),!ce&&S[te]&&(ce=S[te][zr(ne.index,J)])&&(de&&Nl(ce.options.id)||ce.options.isInternal)&&(ce=void 0),ce&&ce.coll===te&&(ce.update(ne,!1),y&&(ce.touched=!0)),!ce&&y&&S.collectionsWithInit[te]&&(S.collectionsWithInit[te][0].apply(S,[ne].concat(S.collectionsWithInit[te][1]||[]).concat([!1])).touched=!0)}),y&&S[te].forEach(function(ne){ne.touched||ne.options.isInternal?delete ne.touched:N.push(ne)}))}),N.forEach(function(te){te.chart&&te.remove&&te.remove(!1)}),w&&S.axes.forEach(function(te){te.update({},!1)}),M&&S.getSeriesOrderByLinks().forEach(function(te){te.chart&&te.update({},!1)},this);let X=U&&U.width,Z=U&&(Ac(U.height)?yy(U.height,X||S.chartWidth):U.height);T||ja(X)&&X!==S.chartWidth||ja(Z)&&Z!==S.chartHeight?S.setSize(X,Z,b):zr(p,!0)&&S.redraw(b),Nn(S,"afterUpdate",{options:d,redraw:p,animation:b})}setSubtitle(d,p){this.applyDescription("subtitle",d),this.layOutTitles(p)}setCaption(d,p){this.applyDescription("caption",d),this.layOutTitles(p)}showResetZoom(){let d=this,p=Wt.lang,y=d.zooming.resetButton,b=y.theme,w=y.relativeTo==="chart"||y.relativeTo==="spacingBox"?null:"plotBox";function M(){d.zoomOut()}Nn(this,"beforeShowResetZoom",null,function(){d.resetZoomButton=d.renderer.button(p.resetZoom,null,null,M,b).attr({align:y.position.align,title:p.resetZoomTitle}).addClass("highcharts-reset-zoom").add().align(y.position,!1,w)}),Nn(this,"afterShowResetZoom")}zoomOut(){Nn(this,"selection",{resetSelection:!0},()=>this.transform({reset:!0,trigger:"zoom"}))}pan(d,p){let y=this,b=typeof p=="object"?p:{enabled:p,type:"x"},w=b.type,M=w&&y[{x:"xAxis",xy:"axes",y:"yAxis"}[w]].filter(S=>S.options.panningEnabled&&!S.options.isInternal),T=y.options.chart;T?.panning&&(T.panning=b),Nn(this,"pan",{originalEvent:d},()=>{y.transform({axes:M,event:d,to:{x:d.chartX-(y.mouseDownX||0),y:d.chartY-(y.mouseDownY||0)},trigger:"pan"}),zo(y.container,{cursor:"move"})})}transform(d){let{axes:p=this.axes,event:y,from:b={},reset:w,selection:M,to:T={},trigger:S}=d,{inverted:O,time:B}=this,N=!1,U,X;for(let Z of(this.hoverPoints?.forEach(te=>te.setState()),p)){let{horiz:te,len:ne,minPointOffset:J=0,options:ce,reversed:de}=Z,ke=te?"width":"height",Ue=te?"x":"y",Le=zr(T[ke],Z.len),Se=zr(b[ke],Z.len),ze=10>Math.abs(Le)?1:Le/Se,nt=(b[Ue]||0)+Se/2-Z.pos,rt=nt-((T[Ue]??Z.pos)+Le/2-Z.pos)/ze,pt=de&&!O||!de&&O?-1:1;if(!w&&(nt<0||nt>Z.len))continue;let Bt=Z.toValue(rt,!0)+(M||Z.isOrdinal?0:J*pt),Lt=Z.toValue(rt+ne/ze,!0)-(M||Z.isOrdinal?0:J*pt||0),jt=Z.allExtremes;if(Bt>Lt&&([Bt,Lt]=[Lt,Bt]),ze===1&&!w&&Z.coll==="yAxis"&&!jt){for(let So of Z.series){let $a=So.getExtremes(So.getProcessedData(!0).modified.getColumn("y")||[],!0);jt??(jt={dataMin:Number.MAX_VALUE,dataMax:-Number.MAX_VALUE}),ja($a.dataMin)&&ja($a.dataMax)&&(jt.dataMin=Math.min($a.dataMin,jt.dataMin),jt.dataMax=Math.max($a.dataMax,jt.dataMax))}Z.allExtremes=jt}let{dataMin:Yt,dataMax:zt,min:Sn,max:hn}=Ts(Z.getExtremes(),jt||{}),fn=B.parse(ce.min),qn=B.parse(ce.max),an=Yt??fn,br=zt??qn,Ki=Lt-Bt,ei=Z.categories?0:Math.min(Ki,br-an),An=an-ei*(Nl(fn)?0:ce.minPadding),wi=br+ei*(Nl(qn)?0:ce.maxPadding),ji=Z.allowZoomOutside||ze===1||S!=="zoom"&&ze>1,Pr=Math.min(fn??An,An,ji?Sn:An),Qi=Math.max(qn??wi,wi,ji?hn:wi);(!Z.isOrdinal||Z.options.overscroll||ze!==1||w)&&(Bt<Pr&&(Bt=Pr,ze>=1&&(Lt=Bt+Ki)),Lt>Qi&&(Lt=Qi,ze>=1&&(Bt=Lt-Ki)),(w||Z.series.length&&(Bt!==Sn||Lt!==hn)&&Bt>=Pr&&Lt<=Qi)&&(M?M[Z.coll].push({axis:Z,min:Bt,max:Lt}):(Z.isPanning=S!=="zoom",Z.isPanning&&(X=!0),Z.setExtremes(w?void 0:Bt,w?void 0:Lt,!1,!1,{move:rt,trigger:S,scale:ze}),!w&&(Bt>Pr||Lt<Qi)&&S!=="mousewheel"&&(U=!0)),N=!0),y&&(this[te?"mouseDownX":"mouseDownY"]=y[te?"chartX":"chartY"]))}return N&&(M?Nn(this,"selection",M,()=>{delete d.selection,d.trigger="zoom",this.transform(d)}):(!U||X||this.resetZoomButton?!U&&this.resetZoomButton&&(this.resetZoomButton=this.resetZoomButton.destroy()):this.showResetZoom(),this.redraw(S==="zoom"&&(this.options.chart.animation??this.pointCount<100)))),N}}Ts(zl.prototype,{callbacks:[],collectionsWithInit:{xAxis:[zl.prototype.addAxis,[!0]],yAxis:[zl.prototype.addAxis,[!1]],series:[zl.prototype.addSeries]},collectionsWithUpdate:["xAxis","yAxis","series"],propsRequireDirtyBox:["backgroundColor","borderColor","borderWidth","borderRadius","plotBackgroundColor","plotBackgroundImage","plotBorderColor","plotBorderWidth","plotShadow","shadow"],propsRequireReflow:["margin","marginTop","marginRight","marginBottom","marginLeft","spacing","spacingTop","spacingRight","spacingBottom","spacingLeft"],propsRequireUpdateSeries:["chart.inverted","chart.polar","chart.ignoreHiddenSeries","chart.type","colors","plotOptions","time","tooltip"]});let{stop:Av}=Ln,{composed:Fu}=lt,{addEvent:Bl,createElement:xf,css:tm,defined:nm,erase:jw,merge:kv,pushUnique:_y}=Zt;function Rv(){let P=this.scrollablePlotArea;(this.scrollablePixelsX||this.scrollablePixelsY)&&!P&&(this.scrollablePlotArea=P=new im(this)),P?.applyFixed()}function Yd(){this.chart.scrollablePlotArea&&(this.chart.scrollablePlotArea.isDirty=!0)}let im=(()=>{class P{static compose(p,y,b){_y(Fu,this.compose)&&(Bl(p,"afterInit",Yd),Bl(y,"afterSetChartSize",w=>this.afterSetSize(w.target,w)),Bl(y,"render",Rv),Bl(b,"show",Yd))}static afterSetSize(p,y){let b,w,M,{minWidth:T,minHeight:S}=p.options.chart.scrollablePlotArea||{},{clipBox:O,plotBox:B,inverted:N,renderer:U}=p;if(!U.forExport&&(T?(p.scrollablePixelsX=b=Math.max(0,T-p.chartWidth),b&&(p.scrollablePlotBox=kv(p.plotBox),B.width=p.plotWidth+=b,O[N?"height":"width"]+=b,M=!0)):S&&(p.scrollablePixelsY=w=Math.max(0,S-p.chartHeight),nm(w)&&(p.scrollablePlotBox=kv(p.plotBox),B.height=p.plotHeight+=w,O[N?"width":"height"]+=w,M=!1)),nm(M)&&!y.skipAxes))for(let X of p.axes)(X.horiz===M||p.hasParallelCoordinates&&X.coll==="yAxis")&&(X.setAxisSize(),X.setAxisTranslation())}constructor(p){let y,b=p.options.chart,w=En.getRendererType(),M=b.scrollablePlotArea||{},T=this.moveFixedElements.bind(this),S={WebkitOverflowScrolling:"touch",overflowX:"hidden",overflowY:"hidden"};p.scrollablePixelsX&&(S.overflowX="auto"),p.scrollablePixelsY&&(S.overflowY="auto"),this.chart=p;let O=this.parentDiv=xf("div",{className:"highcharts-scrolling-parent"},{position:"relative"},p.renderTo),B=this.scrollingContainer=xf("div",{className:"highcharts-scrolling"},S,O),N=this.innerContainer=xf("div",{className:"highcharts-inner-container"},void 0,B),U=this.fixedDiv=xf("div",{className:"highcharts-fixed"},{position:"absolute",overflow:"hidden",pointerEvents:"none",zIndex:(b.style?.zIndex||0)+2,top:0},void 0,!0),X=this.fixedRenderer=new w(U,p.chartWidth,p.chartHeight,b.style);this.mask=X.path().attr({fill:b.backgroundColor||"#fff","fill-opacity":M.opacity??.85,zIndex:-1}).addClass("highcharts-scrollable-mask").add(),B.parentNode.insertBefore(U,B),tm(p.renderTo,{overflow:"visible"}),Bl(p,"afterShowResetZoom",T),Bl(p,"afterApplyDrilldown",T),Bl(p,"afterLayOutTitles",T),Bl(B,"scroll",()=>{let{pointer:Z,hoverPoint:te}=p;Z&&(delete Z.chartPosition,te&&(y=te),Z.runPointActions(void 0,y,!0))}),N.appendChild(p.container)}applyFixed(){let{chart:p,fixedRenderer:y,isDirty:b,scrollingContainer:w}=this,{axisOffset:M,chartWidth:T,chartHeight:S,container:O,plotHeight:B,plotLeft:N,plotTop:U,plotWidth:X,scrollablePixelsX:Z=0,scrollablePixelsY:te=0}=p,{scrollPositionX:ne=0,scrollPositionY:J=0}=p.options.chart.scrollablePlotArea||{},ce=T+Z,de=S+te;y.setSize(T,S),(b??!0)&&(this.isDirty=!1,this.moveFixedElements()),Av(p.container),tm(O,{width:`${ce}px`,height:`${de}px`}),p.renderer.boxWrapper.attr({width:ce,height:de,viewBox:[0,0,ce,de].join(" ")}),p.chartBackground?.attr({width:ce,height:de}),tm(w,{width:`${T}px`,height:`${S}px`}),nm(b)||(w.scrollLeft=Z*ne,w.scrollTop=te*J);let ke=U-M[0]-1,Ue=N-M[3]-1,Le=U+B+M[2]+1,Se=N+X+M[1]+1,ze=N+X-Z,nt=U+B-te,rt=[["M",0,0]];Z?rt=[["M",0,ke],["L",N-1,ke],["L",N-1,Le],["L",0,Le],["Z"],["M",ze,ke],["L",T,ke],["L",T,Le],["L",ze,Le],["Z"]]:te&&(rt=[["M",Ue,0],["L",Ue,U-1],["L",Se,U-1],["L",Se,0],["Z"],["M",Ue,nt],["L",Ue,S],["L",Se,S],["L",Se,nt],["Z"]]),p.redrawTrigger!=="adjustHeight"&&this.mask.attr({d:rt})}moveFixedElements(){let p,{container:y,inverted:b,scrollablePixelsX:w,scrollablePixelsY:M}=this.chart,T=this.fixedRenderer,S=P.fixedSelectors;if(w&&!b?p=".highcharts-yaxis":w&&b||M&&!b?p=".highcharts-xaxis":M&&b&&(p=".highcharts-yaxis"),p&&!(this.chart.hasParallelCoordinates&&p===".highcharts-yaxis"))for(let O of[`${p}:not(.highcharts-radial-axis)`,`${p}-labels:not(.highcharts-radial-axis-labels)`])_y(S,O);else for(let O of[".highcharts-xaxis",".highcharts-yaxis"])for(let B of[`${O}:not(.highcharts-radial-axis)`,`${O}-labels:not(.highcharts-radial-axis-labels)`])jw(S,B);for(let O of S)[].forEach.call(y.querySelectorAll(O),B=>{(B.namespaceURI===T.SVG_NS?T.box:T.box.parentNode).appendChild(B),B.style.pointerEvents="auto"})}}return P.fixedSelectors=[".highcharts-breadcrumbs-group",".highcharts-contextbutton",".highcharts-caption",".highcharts-credits",".highcharts-drillup-button",".highcharts-legend",".highcharts-legend-checkbox",".highcharts-navigator-series",".highcharts-navigator-xaxis",".highcharts-navigator-yaxis",".highcharts-navigator",".highcharts-range-selector-group",".highcharts-reset-zoom",".highcharts-scrollbar",".highcharts-subtitle",".highcharts-title"],P})(),{format:vy}=Mt,{series:by}=Gt,{destroyObjectProperties:po,fireEvent:rm,getAlignFactor:om,isNumber:Is,pick:wf}=Zt,kc=class{constructor(P,d,p,y,b){let w=P.chart.inverted,M=P.reversed;this.axis=P;let T=this.isNegative=!!p!=!!M;this.options=d=d||{},this.x=y,this.total=null,this.cumulative=null,this.points={},this.hasValidPoints=!1,this.stack=b,this.leftCliff=0,this.rightCliff=0,this.alignOptions={align:d.align||(w?T?"left":"right":"center"),verticalAlign:d.verticalAlign||(w?"middle":T?"bottom":"top"),y:d.y,x:d.x},this.textAlign=d.textAlign||(w?T?"right":"left":"center")}destroy(){po(this,this.axis)}render(P){let d=this.axis.chart,p=this.options,y=p.format,b=y?vy(y,this,d):p.formatter.call(this);if(this.label)this.label.attr({text:b,visibility:"hidden"});else{this.label=d.renderer.label(b,null,void 0,p.shape,void 0,void 0,p.useHTML,!1,"stack-labels");let w={r:p.borderRadius||0,text:b,padding:wf(p.padding,5),visibility:"hidden"};d.styledMode||(w.fill=p.backgroundColor,w.stroke=p.borderColor,w["stroke-width"]=p.borderWidth,this.label.css(p.style||{})),this.label.attr(w),this.label.added||this.label.add(P)}this.label.labelrank=d.plotSizeY,rm(this,"afterRender")}setOffset(P,d,p,y,b,w){let{alignOptions:M,axis:T,label:S,options:O,textAlign:B}=this,N=T.chart,U=this.getStackBox({xOffset:P,width:d,boxBottom:p,boxTop:y,defaultX:b,xAxis:w}),{verticalAlign:X}=M;if(S&&U){let Z=S.getBBox(void 0,0),te=S.padding,ne=wf(O.overflow,"justify")==="justify",J;M.x=O.x||0,M.y=O.y||0;let{x:ce,y:de}=this.adjustStackPosition({labelBox:Z,verticalAlign:X,textAlign:B});U.x-=ce,U.y-=de,S.align(M,!1,U),(J=N.isInsidePlot(S.alignAttr.x+M.x+ce,S.alignAttr.y+M.y+de))||(ne=!1),ne&&by.prototype.justifyDataLabel.call(T,S,M,S.alignAttr,Z,U),S.attr({x:S.alignAttr.x,y:S.alignAttr.y,rotation:O.rotation,rotationOriginX:Z.width*om(O.textAlign||"center"),rotationOriginY:Z.height/2}),wf(!ne&&O.crop,!0)&&(J=Is(S.x)&&Is(S.y)&&N.isInsidePlot(S.x-te+(S.width||0),S.y)&&N.isInsidePlot(S.x+te,S.y)),S[J?"show":"hide"]()}rm(this,"afterSetOffset",{xOffset:P,width:d})}adjustStackPosition({labelBox:P,verticalAlign:d,textAlign:p}){return{x:P.width/2+P.width/2*(2*om(p)-1),y:P.height/2*2*(1-om(d))}}getStackBox(P){let d=this.axis,p=d.chart,{boxTop:y,defaultX:b,xOffset:w,width:M,boxBottom:T}=P,S=d.stacking.usePercentage?100:wf(y,this.total,0),O=d.toPixels(S),B=P.xAxis||p.xAxis[0],N=wf(b,B.translate(this.x))+w,U=Math.abs(O-d.toPixels(T||Is(d.min)&&d.logarithmic&&d.logarithmic.lin2log(d.min)||0)),X=p.inverted,Z=this.isNegative;return X?{x:(Z?O:O-U)-p.plotLeft,y:B.height-N-M+B.top-p.plotTop,width:U,height:M}:{x:N+B.transB-p.plotLeft,y:(Z?O-U:O)-p.plotTop,width:M,height:U}}},{getDeferredAnimation:Cf}=Ln,{series:{prototype:Ss}}=Gt,{addEvent:ss,correctFloat:Ef,defined:Df,destroyObjectProperties:Pv,fireEvent:Vw,isNumber:Mf,objectEach:mo,pick:jl}=Zt;function Ov(){let P=this.inverted;this.axes.forEach(d=>{d.stacking&&d.stacking.stacks&&d.hasVisibleSeries&&(d.stacking.oldStacks=d.stacking.stacks)}),this.series.forEach(d=>{let p=d.xAxis&&d.xAxis.options||{};d.options.stacking&&d.reserveSpace()&&(d.stackKey=[d.type,jl(d.options.stack,""),P?p.top:p.left,P?p.height:p.width].join(","))})}function Lv(){let P=this.stacking;if(P){let d=P.stacks;mo(d,(p,y)=>{Pv(p),delete d[y]}),P.stackTotalGroup?.destroy()}}function Uw(){this.stacking||(this.stacking=new am(this))}function sm(P,d,p,y){return!Df(P)||P.x!==d||y&&P.stackKey!==y?P={x:d,index:0,key:y,stackKey:y}:P.index++,P.key=[p,d,P.index].join(","),P}function xy(){let P,d=this,p=d.yAxis,y=d.stackKey||"",b=p.stacking.stacks,w=d.getColumn("x",!0),M=d.options.stacking,T=d[M+"Stacker"];T&&[y,"-"+y].forEach(S=>{let O=w.length,B,N,U;for(;O--;)B=w[O],P=d.getStackIndicator(P,B,d.index,S),N=b[S]?.[B],(U=N?.points[P.key||""])&&T.call(d,U,N,O)})}function Kd(P,d,p){let y=d.total?100/d.total:0;P[0]=Ef(P[0]*y),P[1]=Ef(P[1]*y),this.stackedYData[p]=P[1]}function Qd(P){(this.is("column")||this.is("columnrange"))&&(this.options.centerInCategory&&this.chart.series.length>1?Ss.setStackedPoints.call(this,P,"group"):P.stacking.resetStacks())}function Tf(P,d){let p,y,b,w,M,T,S,O=d||this.options.stacking;if(!O||!this.reserveSpace()||({group:"xAxis"}[O]||"yAxis")!==P.coll)return;let B=this.getColumn("x",!0),N=this.getColumn(this.pointValKey||"y",!0),U=[],X=N.length,Z=this.options,te=Z.threshold||0,ne=Z.startFromThreshold?te:0,J=Z.stack,ce=d?`${this.type},${O}`:this.stackKey||"",de="-"+ce,ke=this.negStacks,Ue=P.stacking,Le=Ue.stacks,Se=Ue.oldStacks;for(Ue.stacksTouched+=1,S=0;S<X;S++){let ze=B[S]||0,nt=N[S],rt=Mf(nt)&&nt||0;T=(p=this.getStackIndicator(p,ze,this.index)).key||"",Le[M=(y=ke&&rt<(ne?0:te))?de:ce]||(Le[M]={}),Le[M][ze]||(Se[M]?.[ze]?(Le[M][ze]=Se[M][ze],Le[M][ze].total=null):Le[M][ze]=new kc(P,P.options.stackLabels,!!y,ze,J)),b=Le[M][ze],nt!==null?(b.points[T]=b.points[this.index]=[jl(b.cumulative,ne)],Df(b.cumulative)||(b.base=T),b.touched=Ue.stacksTouched,p.index>0&&this.singleStacks===!1&&(b.points[T][0]=b.points[this.index+","+ze+",0"][0])):(delete b.points[T],delete b.points[this.index]);let pt=b.total||0;O==="percent"?(w=y?ce:de,pt=ke&&Le[w]?.[ze]?(w=Le[w][ze]).total=Math.max(w.total||0,pt)+Math.abs(rt):Ef(pt+Math.abs(rt))):O==="group"?Mf(nt)&&pt++:pt=Ef(pt+rt),O==="group"?b.cumulative=(pt||1)-1:b.cumulative=Ef(jl(b.cumulative,ne)+rt),b.total=pt,nt!==null&&(b.points[T].push(b.cumulative),U[S]=b.cumulative,b.hasValidPoints=!0)}O==="percent"&&(Ue.usePercentage=!0),O!=="group"&&(this.stackedYData=U),Ue.oldStacks={}}class am{constructor(d){this.oldStacks={},this.stacks={},this.stacksTouched=0,this.axis=d}buildStacks(){let d,p,y=this.axis,b=y.series,w=y.coll==="xAxis",M=y.options.reversedStacks,T=b.length;for(this.resetStacks(),this.usePercentage=!1,p=T;p--;)d=b[M?p:T-p-1],w&&d.setGroupedPoints(y),d.setStackedPoints(y);if(!w)for(p=0;p<T;p++)b[p].modifyStacks();Vw(y,"afterBuildStacks")}cleanStacks(){this.oldStacks&&(this.stacks=this.oldStacks,mo(this.stacks,d=>{mo(d,p=>{p.cumulative=p.total})}))}resetStacks(){mo(this.stacks,d=>{mo(d,(p,y)=>{Mf(p.touched)&&p.touched<this.stacksTouched?(p.destroy(),delete d[y]):(p.total=null,p.cumulative=null)})})}renderStackTotals(){let d=this.axis,p=d.chart,y=p.renderer,b=this.stacks,w=Cf(p,d.options.stackLabels?.animation||!1),M=this.stackTotalGroup=this.stackTotalGroup||y.g("stack-labels").attr({zIndex:6,opacity:0}).add();M.translate(p.plotLeft,p.plotTop),mo(b,T=>{mo(T,S=>{S.render(M)})}),M.animate({opacity:1},w)}}(Ye||(Ye={})).compose=function(P,d,p){let y=d.prototype,b=p.prototype;y.getStacks||(ss(P,"init",Uw),ss(P,"destroy",Lv),y.getStacks=Ov,b.getStackIndicator=sm,b.modifyStacks=xy,b.percentStacker=Kd,b.setGroupedPoints=Qd,b.setStackedPoints=Tf)};let Fv=Ye,{defined:If,merge:lm,isObject:Nv}=Zt;class Nu extends Io{drawGraph(){let d=this.options,p=(this.gappedPath||this.getGraphPath).call(this),y=this.chart.styledMode;[this,...this.zones].forEach((b,w)=>{let M,T=b.graph,S=T?"animate":"attr",O=b.dashStyle||d.dashStyle;T?(T.endX=this.preventGraphAnimation?null:p.xMap,T.animate({d:p})):p.length&&(b.graph=T=this.chart.renderer.path(p).addClass("highcharts-graph"+(w?` highcharts-zone-graph-${w-1} `:" ")+(w&&b.className||"")).attr({zIndex:1}).add(this.group)),T&&!y&&(M={stroke:!w&&d.lineColor||b.color||this.color||"#cccccc","stroke-width":d.lineWidth||0,fill:this.fillGraph&&this.color||"none"},O?M.dashstyle=O:d.linecap!=="square"&&(M["stroke-linecap"]=M["stroke-linejoin"]="round"),T[S](M).shadow(d.shadow&&lm({filterUnits:"userSpaceOnUse"},Nv(d.shadow)?d.shadow:{}))),T&&(T.startX=p.xMap,T.isArea=p.isArea)})}getGraphPath(d,p,y){let b=this,w=b.options,M=[],T=[],S,O=w.step,B=(d=d||b.points).reversed;return B&&d.reverse(),(O={right:1,center:2}[O]||O&&3)&&B&&(O=4-O),(d=this.getValidPoints(d,!1,!(w.connectNulls&&!p&&!y))).forEach(function(N,U){let X,Z=N.plotX,te=N.plotY,ne=d[U-1],J=N.isNull||typeof te!="number";(N.leftCliff||ne&&ne.rightCliff)&&!y&&(S=!0),J&&!If(p)&&U>0?S=!w.connectNulls:J&&!p?S=!0:(U===0||S?X=[["M",N.plotX,N.plotY]]:b.getPointSpline?X=[b.getPointSpline(d,N,U)]:O?(X=O===1?[["L",ne.plotX,te]]:O===2?[["L",(ne.plotX+Z)/2,ne.plotY],["L",(ne.plotX+Z)/2,te]]:[["L",Z,ne.plotY]]).push(["L",Z,te]):X=[["L",Z,te]],T.push(N.x),O&&(T.push(N.x),O===2&&T.push(N.x)),M.push.apply(M,X),S=!1)}),M.xMap=T,b.graphPath=M,M}}Nu.defaultOptions=lm(Io.defaultOptions,{legendSymbol:"lineMarker"}),Gt.registerSeriesType("line",Nu);let{seriesTypes:{line:cm}}=Gt,{extend:wy,merge:zv,objectEach:$w,pick:um}=Zt;class zu extends cm{drawGraph(){this.areaPath=[],super.drawGraph.apply(this);let{areaPath:d,options:p}=this;[this,...this.zones].forEach((y,b)=>{let w={},M=y.fillColor||p.fillColor,T=y.area,S=T?"animate":"attr";T?(T.endX=this.preventGraphAnimation?null:d.xMap,T.animate({d})):(w.zIndex=0,(T=y.area=this.chart.renderer.path(d).addClass("highcharts-area"+(b?` highcharts-zone-area-${b-1} `:" ")+(b&&y.className||"")).add(this.group)).isArea=!0),this.chart.styledMode||(w.fill=M||y.color||this.color,w["fill-opacity"]=M?1:p.fillOpacity??.75,T.css({pointerEvents:this.stickyTracking?"none":"auto"})),T[S](w),T.startX=d.xMap,T.shiftUnit=p.step?2:1})}getGraphPath(d){let p,y,b,w=cm.prototype.getGraphPath,M=this.options,T=M.stacking,S=this.yAxis,O=[],B=[],N=this.index,U=S.stacking.stacks[this.stackKey],X=M.threshold,Z=Math.round(S.getThreshold(M.threshold)),te=um(M.connectNulls,T==="percent"),ne=function(Le,Se,ze){let nt=d[Le],rt=T&&U[nt.x].points[N],pt=nt[ze+"Null"]||0,Bt=nt[ze+"Cliff"]||0,Lt,jt,Yt=!0;Bt||pt?(Lt=(pt?rt[0]:rt[1])+Bt,jt=rt[0]+Bt,Yt=!!pt):!T&&d[Se]&&d[Se].isNull&&(Lt=jt=X),Lt!==void 0&&(B.push({plotX:p,plotY:Lt===null?Z:S.getThreshold(Lt),isNull:Yt,isCliff:!0}),O.push({plotX:p,plotY:jt===null?Z:S.getThreshold(jt),doCurve:!1}))};d=d||this.points,T&&(d=this.getStackPoints(d));for(let Le=0,Se=d.length;Le<Se;++Le)T||(d[Le].leftCliff=d[Le].rightCliff=d[Le].leftNull=d[Le].rightNull=void 0),y=d[Le].isNull,p=um(d[Le].rectPlotX,d[Le].plotX),b=T?um(d[Le].yBottom,Z):Z,y&&!te||(te||ne(Le,Le-1,"left"),y&&!T&&te||(B.push(d[Le]),O.push({x:Le,plotX:p,plotY:b})),te||ne(Le,Le+1,"right"));let J=w.call(this,B,!0,!0);O.reversed=!0;let ce=w.call(this,O,!0,!0),de=ce[0];de&&de[0]==="M"&&(ce[0]=["L",de[1],de[2]]);let ke=J.concat(ce);ke.length&&ke.push(["Z"]);let Ue=w.call(this,B,!1,te);return this.chart.series.length>1&&T&&B.some(Le=>Le.isCliff)&&(ke.hasStackedCliffs=Ue.hasStackedCliffs=!0),ke.xMap=J.xMap,this.areaPath=ke,Ue}getStackPoints(d){let p=this,y=[],b=[],w=this.xAxis,M=this.yAxis,T=M.stacking.stacks[this.stackKey],S={},O=M.series,B=O.length,N=M.options.reversedStacks?1:-1,U=O.indexOf(p);if(d=d||this.points,this.options.stacking){for(let Z=0;Z<d.length;Z++)d[Z].leftNull=d[Z].rightNull=void 0,S[d[Z].x]=d[Z];$w(T,function(Z,te){Z.total!==null&&b.push(te)}),b.sort(function(Z,te){return Z-te});let X=O.map(Z=>Z.visible);b.forEach(function(Z,te){let ne=0,J,ce;if(S[Z]&&!S[Z].isNull)y.push(S[Z]),[-1,1].forEach(function(de){let ke=de===1?"rightNull":"leftNull",Ue=T[b[te+de]],Le=0;if(Ue){let Se=U;for(;Se>=0&&Se<B;){let ze=O[Se].index;!(J=Ue.points[ze])&&(ze===p.index?S[Z][ke]=!0:X[Se]&&(ce=T[Z].points[ze])&&(Le-=ce[1]-ce[0])),Se+=N}}S[Z][de===1?"rightCliff":"leftCliff"]=Le});else{let de=U;for(;de>=0&&de<B;){let ke=O[de].index;if(J=T[Z].points[ke]){ne=J[1];break}de+=N}ne=um(ne,0),ne=M.translate(ne,0,1,0,1),y.push({isNull:!0,plotX:w.translate(Z,0,0,0,1),x:Z,plotY:ne,yBottom:ne})}})}return y}}zu.defaultOptions=zv(cm.defaultOptions,{threshold:0,legendSymbol:"areaMarker"}),wy(zu.prototype,{singleStacks:!1}),Gt.registerSeriesType("area",zu);let{line:Cy}=Gt.seriesTypes,{merge:Rc,pick:ai}=Zt;class Sf extends Cy{getPointSpline(d,p,y){let b,w,M,T,S=p.plotX||0,O=p.plotY||0,B=d[y-1],N=d[y+1];function U(Z){return Z&&!Z.isNull&&Z.doCurve!==!1&&!p.isCliff}if(U(B)&&U(N)){let Z=B.plotX||0,te=B.plotY||0,ne=N.plotX||0,J=N.plotY||0,ce=0;b=(1.5*S+Z)/2.5,w=(1.5*O+te)/2.5,M=(1.5*S+ne)/2.5,T=(1.5*O+J)/2.5,M!==b&&(ce=(T-w)*(M-S)/(M-b)+O-T),w+=ce,T+=ce,w>te&&w>O?(w=Math.max(te,O),T=2*O-w):w<te&&w<O&&(w=Math.min(te,O),T=2*O-w),T>J&&T>O?(T=Math.max(J,O),w=2*O-T):T<J&&T<O&&(T=Math.min(J,O),w=2*O-T),p.rightContX=M,p.rightContY=T,p.controlPoints={low:[b,w],high:[M,T]}}let X=["C",ai(B.rightContX,B.plotX,0),ai(B.rightContY,B.plotY,0),ai(b,S,0),ai(w,O,0),S,O];return B.rightContX=B.rightContY=void 0,X}}Sf.defaultOptions=Rc(Cy.defaultOptions),Gt.registerSeriesType("spline",Sf);let fa=Sf,{area:Va,area:{prototype:as}}=Gt.seriesTypes,{extend:ls,merge:Xr}=Zt;class dm extends fa{}dm.defaultOptions=Xr(fa.defaultOptions,Va.defaultOptions),ls(dm.prototype,{getGraphPath:as.getGraphPath,getStackPoints:as.getStackPoints,drawGraph:as.drawGraph}),Gt.registerSeriesType("areaspline",dm);let{animObject:Yr}=Ln,{parse:Bv}=re,{noop:Jd}=lt,{clamp:eh,crisp:Af,defined:hm,extend:jv,fireEvent:fm,isArray:Ey,isNumber:pm,merge:pa,pick:As,objectEach:mm}=Zt;class Bu extends Io{animate(d){let p,y,b=this,w=this.yAxis,M=w.pos,T=w.reversed,S=b.options,{clipOffset:O,inverted:B}=this.chart,N={},U=B?"translateX":"translateY";d&&O?(N.scaleY=.001,y=eh(w.toPixels(S.threshold||0),M,M+w.len),B?(y+=T?-Math.floor(O[0]):Math.ceil(O[2]),N.translateX=y-w.len):(y+=T?Math.ceil(O[0]):-Math.floor(O[2]),N.translateY=y),b.clipBox&&b.setClip(),b.group.attr(N)):(p=Number(b.group.attr(U)),b.group.animate({scaleY:1},jv(Yr(b.options.animation),{step:function(X,Z){b.group&&(N[U]=p+Z.pos*(M-p),b.group.attr(N))}})))}init(d,p){super.init.apply(this,arguments);let y=this;(d=y.chart).hasRendered&&d.series.forEach(function(b){b.type===y.type&&(b.isDirty=!0)})}getColumnMetrics(){let d=this,p=d.options,y=d.xAxis,b=d.yAxis,w=y.options.reversedStacks,M=y.reversed&&!w||!y.reversed&&w,T={},S,O=0;p.grouping===!1?O=1:d.chart.series.forEach(function(te){let ne,J=te.yAxis,ce=te.options;te.type===d.type&&te.reserveSpace()&&b.len===J.len&&b.pos===J.pos&&(ce.stacking&&ce.stacking!=="group"?(T[S=te.stackKey]===void 0&&(T[S]=O++),ne=T[S]):ce.grouping!==!1&&(ne=O++),te.columnIndex=ne)});let B=Math.min(Math.abs(y.transA)*(!y.brokenAxis?.hasBreaks&&y.ordinal?.slope||p.pointRange||y.closestPointRange||y.tickInterval||1),y.len),N=B*p.groupPadding,U=(B-2*N)/(O||1),X=Math.min(p.maxPointWidth||y.len,As(p.pointWidth,U*(1-2*p.pointPadding))),Z=(d.columnIndex||0)+(M?1:0);return d.columnMetrics={width:X,offset:(U-X)/2+(N+Z*U-B/2)*(M?-1:1),paddedWidth:U,columnCount:O},d.columnMetrics}crispCol(d,p,y,b){let w=this.borderWidth,M=this.chart.inverted;return b=Af(p+b,w,M)-(p=Af(p,w,M)),this.options.crisp&&(y=Af(d+y,w)-(d=Af(d,w))),{x:d,y:p,width:y,height:b}}adjustForMissingColumns(d,p,y,b){if(!y.isNull&&b.columnCount>1){let w=this.xAxis.series.filter(O=>O.visible).map(O=>O.index),M=0,T=0;mm(this.xAxis.stacking?.stacks,O=>{let B=typeof y.x=="number"?O[y.x.toString()]?.points:void 0,N=B?.[this.index],U={};if(B&&Ey(N)){let X=this.index,Z=Object.keys(B).filter(te=>!te.match(",")&&B[te]&&B[te].length>1).map(parseFloat).filter(te=>w.indexOf(te)!==-1).filter(te=>{let ne=this.chart.series[te].options,J=ne.stacking&&ne.stack;if(hm(J)){if(pm(U[J]))return X===te&&(X=U[J]),!1;U[J]=te}return!0}).sort((te,ne)=>ne-te);M=Z.indexOf(X),T=Z.length}}),M=this.xAxis.reversed?T-1-M:M;let S=(T-1)*b.paddedWidth+p;d=(y.plotX||0)+S/2-p-M*b.paddedWidth}return d}translate(){let d=this,p=d.chart,y=d.options,b=d.dense=d.closestPointRange*d.xAxis.transA<2,w=d.borderWidth=As(y.borderWidth,b?0:1),M=d.xAxis,T=d.yAxis,S=y.threshold,O=As(y.minPointLength,5),B=d.getColumnMetrics(),N=B.width,U=d.pointXOffset=B.offset,X=d.dataMin,Z=d.dataMax,te=d.translatedThreshold=T.getThreshold(S),ne=d.barW=Math.max(N,1+2*w);y.pointPadding&&y.crisp&&(ne=Math.ceil(ne)),Io.prototype.translate.apply(d),d.points.forEach(function(J){let ce=As(J.yBottom,te),de=999+Math.abs(ce),ke=J.plotX||0,Ue=eh(J.plotY,-de,T.len+de),Le,Se=Math.min(Ue,ce),ze=Math.max(Ue,ce)-Se,nt=N,rt=ke+U,pt=ne;O&&Math.abs(ze)<O&&(ze=O,Le=!T.reversed&&!J.negative||T.reversed&&J.negative,pm(S)&&pm(Z)&&J.y===S&&Z<=S&&(T.min||0)<S&&(X!==Z||(T.max||0)<=S)&&(Le=!Le,J.negative=!J.negative),Se=Math.abs(Se-te)>O?ce-O:te-(Le?O:0)),hm(J.options.pointWidth)&&(rt-=Math.round(((nt=pt=Math.ceil(J.options.pointWidth))-N)/2)),y.centerInCategory&&(rt=d.adjustForMissingColumns(rt,nt,J,B)),J.barX=rt,J.pointWidth=nt,J.tooltipPos=p.inverted?[eh(T.len+T.pos-p.plotLeft-Ue,T.pos-p.plotLeft,T.len+T.pos-p.plotLeft),M.len+M.pos-p.plotTop-rt-pt/2,ze]:[M.left-p.plotLeft+rt+pt/2,eh(Ue+T.pos-p.plotTop,T.pos-p.plotTop,T.len+T.pos-p.plotTop),ze],J.shapeType=d.pointClass.prototype.shapeType||"roundedRect",J.shapeArgs=d.crispCol(rt,J.isNull?te:Se,pt,J.isNull?0:ze)}),fm(this,"afterColumnTranslate")}drawGraph(){this.group[this.dense?"addClass":"removeClass"]("highcharts-dense-data")}pointAttribs(d,p){let y=this.options,b=this.pointAttrToOptions||{},w=b.stroke||"borderColor",M=b["stroke-width"]||"borderWidth",T,S,O,B=d&&d.color||this.color,N=d&&d[w]||y[w]||B,U=d&&d.options.dashStyle||y.dashStyle,X=d&&d[M]||y[M]||this[M]||0,Z=As(d&&d.opacity,y.opacity,1);d&&this.zones.length&&(S=d.getZone(),B=d.options.color||S&&(S.color||d.nonZonedColor)||this.color,S&&(N=S.borderColor||N,U=S.dashStyle||U,X=S.borderWidth||X)),p&&d&&(O=(T=pa(y.states[p],d.options.states&&d.options.states[p]||{})).brightness,B=T.color||O!==void 0&&Bv(B).brighten(T.brightness).get()||B,N=T[w]||N,X=T[M]||X,U=T.dashStyle||U,Z=As(T.opacity,Z));let te={fill:B,stroke:N,"stroke-width":X,opacity:Z};return U&&(te.dashstyle=U),te}drawPoints(d=this.points){let p,y=this,b=this.chart,w=y.options,M=b.renderer,T=w.animationLimit||250;d.forEach(function(S){let O=S.plotY,B=S.graphic,N=!!B,U=B&&b.pointCount<T?"animate":"attr";pm(O)&&S.y!==null?(p=S.shapeArgs,B&&S.hasNewShapeType()&&(B=B.destroy()),y.enabledDataSorting&&(S.startXPos=y.xAxis.reversed?-(p&&p.width||0):y.xAxis.width),!B&&(S.graphic=B=M[S.shapeType](p).add(S.group||y.group),B&&y.enabledDataSorting&&b.hasRendered&&b.pointCount<T&&(B.attr({x:S.startXPos}),N=!0,U="animate")),B&&N&&B[U](pa(p)),b.styledMode||B[U](y.pointAttribs(S,S.selected&&"select")).shadow(S.allowShadow!==!1&&w.shadow),B&&(B.addClass(S.getClassName(),!0),B.attr({visibility:S.visible?"inherit":"hidden"}))):B&&(S.graphic=B.destroy())})}drawTracker(d=this.points){let p,y=this,b=y.chart,w=b.pointer,M=function(T){w?.normalize(T);let S=w?.getPointFromEvent(T),O=!b.scrollablePlotArea||b.isInsidePlot(T.chartX-b.plotLeft,T.chartY-b.plotTop,{visiblePlotOnly:!0});w&&S&&y.options.enableMouseTracking&&O&&(w.isDirectTouch=!0,S.onMouseOver(T))};d.forEach(function(T){p=Ey(T.dataLabels)?T.dataLabels:T.dataLabel?[T.dataLabel]:[],T.graphic&&(T.graphic.element.point=T),p.forEach(function(S){(S.div||S.element).point=T})}),y._hasTracking||(y.trackerGroups.forEach(function(T){y[T]&&(y[T].addClass("highcharts-tracker").on("mouseover",M).on("mouseout",function(S){w?.onTrackerMouseOut(S)}).on("touchstart",M),!b.styledMode&&y.options.cursor&&y[T].css({cursor:y.options.cursor}))}),y._hasTracking=!0),fm(this,"afterDrawTracker")}remove(){let d=this,p=d.chart;p.hasRendered&&p.series.forEach(function(y){y.type===d.type&&(y.isDirty=!0)}),Io.prototype.remove.apply(d,arguments)}}Bu.defaultOptions=pa(Io.defaultOptions,{borderRadius:3,centerInCategory:!1,groupPadding:.2,marker:null,pointPadding:.1,minPointLength:0,cropThreshold:50,pointRange:null,states:{hover:{halo:!1,brightness:.1},select:{color:"#cccccc",borderColor:"#000000"}},dataLabels:{align:void 0,verticalAlign:void 0,y:void 0},startFromThreshold:!0,stickyTracking:!1,tooltip:{distance:6},threshold:0,borderColor:"#ffffff"}),jv(Bu.prototype,{directTouch:!0,getSymbol:Jd,negStacks:!0,trackerGroups:["group","dataLabelsGroup"]}),Gt.registerSeriesType("column",Bu);let th=Bu,{getDeferredAnimation:Vv}=Ln,{format:Hw}=Mt,{defined:Pc,extend:Uv,fireEvent:kf,getAlignFactor:$v,isArray:Ua,isString:gm,merge:nh,objectEach:ju,pick:ih,pInt:Gw,splat:Vu}=Zt;(function(P){function d(){return S(this).some(B=>B?.enabled)}function p(B,N,U,X,Z){let{chart:te,enabledDataSorting:ne}=this,J=this.isCartesian&&te.inverted,ce=B.plotX,de=B.plotY,ke=U.rotation||0,Ue=Pc(ce)&&Pc(de)&&te.isInsidePlot(ce,Math.round(de),{inverted:J,paneCoordinates:!0,series:this}),Le=ke===0&&ih(U.overflow,ne?"none":"justify")==="justify",Se=this.visible&&B.visible!==!1&&Pc(ce)&&(B.series.forceDL||ne&&!Le||Ue||ih(U.inside,!!this.options.stacking)&&X&&te.isInsidePlot(ce,J?X.x+1:X.y+X.height-1,{inverted:J,paneCoordinates:!0,series:this})),ze=B.pos();if(Se&&ze){var nt;let rt=N.getBBox(),pt=N.getBBox(void 0,0);if(X=Uv({x:ze[0],y:Math.round(ze[1]),width:0,height:0},X||{}),U.alignTo==="plotEdges"&&this.isCartesian&&(X[J?"x":"y"]=0,X[J?"width":"height"]=this.yAxis?.len||0),Uv(U,{width:rt.width,height:rt.height}),nt=X,ne&&this.xAxis&&!Le&&this.setDataLabelStartPos(B,N,Z,Ue,nt),N.align(nh(U,{width:pt.width,height:pt.height}),!1,X,!1),N.alignAttr.x+=$v(U.align)*(pt.width-rt.width),N.alignAttr.y+=$v(U.verticalAlign)*(pt.height-rt.height),N[N.placed?"animate":"attr"]({"text-align":N.alignAttr["text-align"]||"center",x:N.alignAttr.x+(rt.width-pt.width)/2,y:N.alignAttr.y+(rt.height-pt.height)/2,rotationOriginX:(N.width||0)/2,rotationOriginY:(N.height||0)/2}),Le&&X.height>=0)this.justifyDataLabel(N,U,N.alignAttr,rt,X,Z);else if(ih(U.crop,!0)){let{x:Bt,y:Lt}=N.alignAttr;Se=te.isInsidePlot(Bt,Lt,{paneCoordinates:!0,series:this})&&te.isInsidePlot(Bt+rt.width-1,Lt+rt.height-1,{paneCoordinates:!0,series:this})}U.shape&&!ke&&N[Z?"attr":"animate"]({anchorX:ze[0],anchorY:ze[1]})}Z&&ne&&(N.placed=!1),Se||ne&&!Le?(N.show(),N.placed=!0):(N.hide(),N.placed=!1)}function y(){return this.plotGroup("dataLabelsGroup","data-labels",this.hasRendered?"inherit":"hidden",this.options.dataLabels.zIndex||6)}function b(B){let N=this.hasRendered||0,U=this.initDataLabelsGroup().attr({opacity:+N});return!N&&U&&(this.visible&&U.show(),this.options.animation?U.animate({opacity:1},B):U.attr({opacity:1})),U}function w(B){let N;B=B||this.points;let U=this,X=U.chart,Z=U.options,te=X.renderer,{backgroundColor:ne,plotBackgroundColor:J}=X.options.chart,ce=te.getContrast(gm(J)&&J||gm(ne)&&ne||"#000000"),de=S(U),{animation:ke,defer:Ue}=de[0],Le=Ue?Vv(X,ke,U):{defer:0,duration:0};kf(this,"drawDataLabels"),U.hasDataLabels?.()&&(N=this.initDataLabels(Le),B.forEach(Se=>{let ze=Se.dataLabels||[];Vu(T(de,Se.dlOptions||Se.options?.dataLabels)).forEach((rt,pt)=>{let Bt=rt.enabled&&(Se.visible||Se.dataLabelOnHidden)&&(!Se.isNull||Se.dataLabelOnNull)&&function(ei,An){let wi=An.filter;if(wi){let ji=wi.operator,Pr=ei[wi.property],Qi=wi.value;return ji===">"&&Pr>Qi||ji==="<"&&Pr<Qi||ji===">="&&Pr>=Qi||ji==="<="&&Pr<=Qi||ji==="=="&&Pr==Qi||ji==="==="&&Pr===Qi||ji==="!="&&Pr!=Qi||ji==="!=="&&Pr!==Qi}return!0}(Se,rt),{backgroundColor:Lt,borderColor:jt,distance:Yt,style:zt={}}=rt,Sn,hn,fn,qn={},an=ze[pt],br=!an,Ki;Bt&&(hn=Pc(Sn=ih(rt[Se.formatPrefix+"Format"],rt.format))?Hw(Sn,Se,X):(rt[Se.formatPrefix+"Formatter"]||rt.formatter).call(Se,rt),fn=rt.rotation,!X.styledMode&&(zt.color=ih(rt.color,zt.color,gm(U.color)?U.color:void 0,"#000000"),zt.color==="contrast"?(Lt!=="none"&&(Ki=Lt),Se.contrastColor=te.getContrast(Ki!=="auto"&&Ki||Se.color||U.color),zt.color=Ki||!Pc(Yt)&&rt.inside||0>Gw(Yt||0)||Z.stacking?Se.contrastColor:ce):delete Se.contrastColor,Z.cursor&&(zt.cursor=Z.cursor)),qn={r:rt.borderRadius||0,rotation:fn,padding:rt.padding,zIndex:1},X.styledMode||(qn.fill=Lt==="auto"?Se.color:Lt,qn.stroke=jt==="auto"?Se.color:jt,qn["stroke-width"]=rt.borderWidth),ju(qn,(ei,An)=>{ei===void 0&&delete qn[An]})),!an||Bt&&Pc(hn)&&!!an.div==!!rt.useHTML&&(an.rotation&&rt.rotation||an.rotation===rt.rotation)||(an=void 0,br=!0),Bt&&Pc(hn)&&(an?qn.text=hn:(an=te.label(hn,0,0,rt.shape,void 0,void 0,rt.useHTML,void 0,"data-label")).addClass(" highcharts-data-label-color-"+Se.colorIndex+" "+(rt.className||"")+(rt.useHTML?" highcharts-tracker":"")),an&&(an.options=rt,an.attr(qn),X.styledMode?zt.width&&an.css({width:zt.width,textOverflow:zt.textOverflow,whiteSpace:zt.whiteSpace}):an.css(zt).shadow(rt.shadow),kf(an,"beforeAddingDataLabel",{labelOptions:rt,point:Se}),an.added||an.add(N),U.alignDataLabel(Se,an,rt,void 0,br),an.isActive=!0,ze[pt]&&ze[pt]!==an&&ze[pt].destroy(),ze[pt]=an))});let nt=ze.length;for(;nt--;)ze[nt]&&ze[nt].isActive?ze[nt].isActive=!1:(ze[nt]?.destroy(),ze.splice(nt,1));Se.dataLabel=ze[0],Se.dataLabels=ze})),kf(this,"afterDrawDataLabels")}function M(B,N,U,X,Z,te){let ne=this.chart,J=N.align,ce=N.verticalAlign,de=B.box?0:B.padding||0,ke=ne.inverted?this.yAxis:this.xAxis,Ue=ke?ke.left-ne.plotLeft:0,Le=ne.inverted?this.xAxis:this.yAxis,Se=Le?Le.top-ne.plotTop:0,{x:ze=0,y:nt=0}=N,rt,pt;return(rt=(U.x||0)+de+Ue)<0&&(J==="right"&&ze>=0?(N.align="left",N.inside=!0):ze-=rt,pt=!0),(rt=(U.x||0)+X.width-de+Ue)>ne.plotWidth&&(J==="left"&&ze<=0?(N.align="right",N.inside=!0):ze+=ne.plotWidth-rt,pt=!0),(rt=U.y+de+Se)<0&&(ce==="bottom"&&nt>=0?(N.verticalAlign="top",N.inside=!0):nt-=rt,pt=!0),(rt=(U.y||0)+X.height-de+Se)>ne.plotHeight&&(ce==="top"&&nt<=0?(N.verticalAlign="bottom",N.inside=!0):nt+=ne.plotHeight-rt,pt=!0),pt&&(N.x=ze,N.y=nt,B.placed=!te,B.align(N,void 0,Z)),pt}function T(B,N){let U=[],X;if(Ua(B)&&!Ua(N))U=B.map(function(Z){return nh(Z,N)});else if(Ua(N)&&!Ua(B))U=N.map(function(Z){return nh(B,Z)});else if(Ua(B)||Ua(N)){if(Ua(B)&&Ua(N))for(X=Math.max(B.length,N.length);X--;)U[X]=nh(B[X],N[X])}else U=nh(B,N);return U}function S(B){let N=B.chart.options.plotOptions;return Vu(T(T(N?.series?.dataLabels,N?.[B.type]?.dataLabels),B.options.dataLabels))}function O(B,N,U,X,Z){let te=this.chart,ne=te.inverted,J=this.xAxis,ce=J.reversed,de=((ne?N.height:N.width)||0)/2,ke=B.pointWidth,Ue=ke?ke/2:0;N.startXPos=ne?Z.x:ce?-de-Ue:J.width-de+Ue,N.startYPos=ne?ce?this.yAxis.height-de+Ue:-de-Ue:Z.y,X?N.visibility==="hidden"&&(N.show(),N.attr({opacity:0}).animate({opacity:1})):N.attr({opacity:1}).animate({opacity:0},void 0,N.hide),te.hasRendered&&(U&&N.attr({x:N.startXPos,y:N.startYPos}),N.placed=!0)}P.compose=function(B){let N=B.prototype;N.initDataLabels||(N.initDataLabels=b,N.initDataLabelsGroup=y,N.alignDataLabel=p,N.drawDataLabels=w,N.justifyDataLabel=M,N.setDataLabelStartPos=O,N.hasDataLabels=d)}})(Ne||(Ne={}));let Uu=Ne,{composed:Hv}=lt,{series:Dy}=Gt,{merge:Ww,pick:Rf,pushUnique:Gv}=Zt;(function(P){function d(p,y,b,w,M){let T=this.chart.inverted,S=p.series,O=(S.xAxis?S.xAxis.len:this.chart.plotSizeX)||0,B=(S.yAxis?S.yAxis.len:this.chart.plotSizeY)||0,N=p.dlBox||p.shapeArgs,U=Rf(p.below,p.plotY>Rf(this.translatedThreshold,B)),X=Rf(b.inside,!!this.options.stacking);if(N){if(w=Ww(N),!(b.overflow==="allow"&&b.crop===!1)){w.y<0&&(w.height+=w.y,w.y=0);let Z=w.y+w.height-B;Z>0&&Z<w.height-1&&(w.height-=Z)}T&&(w={x:B-w.y-w.height,y:O-w.x-w.width,width:w.height,height:w.width}),X||(T?(w.x+=U?0:w.width,w.width=0):(w.y+=U?w.height:0,w.height=0))}b.align=Rf(b.align,!T||X?"center":U?"right":"left"),b.verticalAlign=Rf(b.verticalAlign,T||X?"middle":U?"top":"bottom"),Dy.prototype.alignDataLabel.call(this,p,y,b,w,M),b.inside&&p.contrastColor&&y.css({color:p.contrastColor})}P.compose=function(p){Uu.compose(Dy),Gv(Hv,"ColumnDataLabel")&&(p.prototype.alignDataLabel=d)}})(ct||(ct={}));let qw=ct,{extend:Wv,merge:Zw}=Zt;class My extends th{}My.defaultOptions=Zw(th.defaultOptions,{}),Wv(My.prototype,{inverted:!0}),Gt.registerSeriesType("bar",My);let{column:qv,line:Ty}=Gt.seriesTypes,{addEvent:Zv,extend:Iy,merge:Vl}=Zt;class oo extends Ty{applyJitter(){let d=this,p=this.options.jitter,y=this.points.length;p&&this.points.forEach(function(b,w){["x","y"].forEach(function(M,T){if(p[M]&&!b.isNull){let S=`plot${M.toUpperCase()}`,O=d[`${M}Axis`],B=p[M]*O.transA;if(O&&!O.logarithmic){let N=Math.max(0,(b[S]||0)-B),U=Math.min(O.len,(b[S]||0)+B);b[S]=N+(U-N)*function(X){let Z=1e4*Math.sin(X);return Z-Math.floor(Z)}(w+T*y),M==="x"&&(b.clientX=b.plotX)}}})})}drawGraph(){this.options.lineWidth?super.drawGraph():this.graph&&(this.graph=this.graph.destroy())}}oo.defaultOptions=Vl(Ty.defaultOptions,{lineWidth:0,findNearestPointBy:"xy",jitter:{x:0,y:0},marker:{enabled:!0},tooltip:{headerFormat:'<span style="color:{point.color}">\u25CF</span> <span style="font-size: 0.8em"> {series.name}</span><br/>',pointFormat:"x: <b>{point.x}</b><br/>y: <b>{point.y}</b><br/>"}}),Iy(oo.prototype,{drawTracker:qv.prototype.drawTracker,sorted:!1,requireSorting:!1,noSharedTooltip:!0,trackerGroups:["group","markerGroup","dataLabelsGroup"]}),Zv(oo,"afterTranslate",function(){this.applyJitter()}),Gt.registerSeriesType("scatter",oo);let{deg2rad:Xv}=lt,{fireEvent:Sy,isNumber:Ay,pick:ym,relativeLength:Xw}=Zt;(function(P){P.getCenter=function(){let d=this.options,p=this.chart,y=2*(d.slicedOffset||0),b=p.plotWidth-2*y,w=p.plotHeight-2*y,M=d.center,T=Math.min(b,w),S=d.thickness,O,B=d.size,N=d.innerSize||0,U,X;typeof B=="string"&&(B=parseFloat(B)),typeof N=="string"&&(N=parseFloat(N));let Z=[ym(M?.[0],"50%"),ym(M?.[1],"50%"),ym(B&&B<0?void 0:d.size,"100%"),ym(N&&N<0?void 0:d.innerSize||0,"0%")];for(!p.angular||this instanceof Io||(Z[3]=0),U=0;U<4;++U)X=Z[U],O=U<2||U===2&&/%$/.test(X),Z[U]=Xw(X,[b,w,T,Z[2]][U])+(O?y:0);return Z[3]>Z[2]&&(Z[3]=Z[2]),Ay(S)&&2*S<Z[2]&&S>0&&(Z[3]=Z[2]-2*S),Sy(this,"afterGetCenter",{positions:Z}),Z},P.getStartAndEndRadians=function(d,p){let y=Ay(d)?d:0,b=Ay(p)&&p>y&&p-y<360?p:y+360;return{start:Xv*(y+-90),end:Xv*(b+-90)}}})(bt||(bt={}));let _m=bt,{setAnimation:vm}=Ln,{addEvent:ky,defined:$u,extend:Pf,isNumber:Yw,pick:Kw,relativeLength:Qw}=Zt;class Yv extends z{getConnectorPath(d){let p=d.dataLabelPosition,y=d.options||{},b=y.connectorShape,w=this.connectorShapes[b]||b;return p&&w.call(this,Cn(ut({},p.computed),{alignment:p.alignment}),p.connectorPosition,y)||[]}getTranslate(){return this.sliced&&this.slicedTranslation||{translateX:0,translateY:0}}haloPath(d){let p=this.shapeArgs;return this.sliced||!this.visible?[]:this.series.chart.renderer.symbols.arc(p.x,p.y,p.r+d,p.r+d,{innerR:p.r-1,start:p.start,end:p.end,borderRadius:p.borderRadius})}constructor(d,p,y){super(d,p,y),this.half=0,this.name??(this.name="Slice");let b=w=>{this.slice(w.type==="select")};ky(this,"select",b),ky(this,"unselect",b)}isValid(){return Yw(this.y)&&this.y>=0}setVisible(d,p=!0){d!==this.visible&&this.update({visible:d??!this.visible},p,void 0,!1)}slice(d,p,y){let b=this.series;vm(y,b.chart),p=Kw(p,!0),this.sliced=this.options.sliced=d=$u(d)?d:!this.sliced,b.options.data[b.data.indexOf(this)]=this.options,this.graphic&&this.graphic.animate(this.getTranslate())}}Pf(Yv.prototype,{connectorShapes:{fixedOffset:function(P,d,p){let y=d.breakAt,b=d.touchingSliceAt,w=p.softConnector?["C",P.x+(P.alignment==="left"?-5:5),P.y,2*y.x-b.x,2*y.y-b.y,y.x,y.y]:["L",y.x,y.y];return[["M",P.x,P.y],w,["L",b.x,b.y]]},straight:function(P,d){let p=d.touchingSliceAt;return[["M",P.x,P.y],["L",p.x,p.y]]},crookedLine:function(P,d,p){let{angle:y=this.angle||0,breakAt:b,touchingSliceAt:w}=d,{series:M}=this,[T,S,O]=M.center,B=O/2,{plotLeft:N,plotWidth:U}=M.chart,X=P.alignment==="left",{x:Z,y:te}=P,ne=b.x;if(p.crookDistance){let ce=Qw(p.crookDistance,1);ne=X?T+B+(U+N-T-B)*(1-ce):N+(T-B)*ce}else ne=T+(S-te)*Math.tan(y-Math.PI/2);let J=[["M",Z,te]];return(X?ne<=Z&&ne>=b.x:ne>=Z&&ne<=b.x)&&J.push(["L",ne,te]),J.push(["L",b.x,b.y],["L",w.x,w.y]),J}}});let{getStartAndEndRadians:Jw}=_m,{noop:Kv}=lt,{clamp:e1,extend:Ry,fireEvent:Qv,merge:Oc,pick:t1}=Zt;class Yi extends Io{animate(d){let p=this,y=p.points,b=p.startAngleRad;d||y.forEach(function(w){let M=w.graphic,T=w.shapeArgs;M&&T&&(M.attr({r:t1(w.startR,p.center&&p.center[3]/2),start:b,end:b}),M.animate({r:T.r,start:T.start,end:T.end},p.options.animation))})}drawEmpty(){let d,p,y=this.startAngleRad,b=this.endAngleRad,w=this.options;this.total===0&&this.center?(d=this.center[0],p=this.center[1],this.graph||(this.graph=this.chart.renderer.arc(d,p,this.center[1]/2,0,y,b).addClass("highcharts-empty-series").add(this.group)),this.graph.attr({d:ml.arc(d,p,this.center[2]/2,0,{start:y,end:b,innerR:this.center[3]/2})}),this.chart.styledMode||this.graph.attr({"stroke-width":w.borderWidth,fill:w.fillColor||"none",stroke:w.color||"#cccccc"})):this.graph&&(this.graph=this.graph.destroy())}drawPoints(){let d=this.chart.renderer;this.points.forEach(function(p){p.graphic&&p.hasNewShapeType()&&(p.graphic=p.graphic.destroy()),p.graphic||(p.graphic=d[p.shapeType](p.shapeArgs).add(p.series.group),p.delayedRendering=!0)})}generatePoints(){super.generatePoints(),this.updateTotals()}getX(d,p,y,b){let w=this.center,M=this.radii?this.radii[y.index]||0:w[2]/2,T=b.dataLabelPosition,S=T?.distance||0,O=Math.asin(e1((d-w[1])/(M+S),-1,1));return w[0]+Math.cos(O)*(M+S)*(p?-1:1)+(S>0?(p?-1:1)*(b.padding||0):0)}hasData(){return!!this.dataTable.rowCount}redrawPoints(){let d,p,y,b,w=this,M=w.chart;this.drawEmpty(),w.group&&!M.styledMode&&w.group.shadow(w.options.shadow),w.points.forEach(function(T){let S={};p=T.graphic,!T.isNull&&p?(b=T.shapeArgs,d=T.getTranslate(),M.styledMode||(y=w.pointAttribs(T,T.selected&&"select")),T.delayedRendering?(p.setRadialReference(w.center).attr(b).attr(d),M.styledMode||p.attr(y).attr({"stroke-linejoin":"round"}),T.delayedRendering=!1):(p.setRadialReference(w.center),M.styledMode||Oc(!0,S,y),Oc(!0,S,b,d),p.animate(S)),p.attr({visibility:T.visible?"inherit":"hidden"}),p.addClass(T.getClassName(),!0)):p&&(T.graphic=p.destroy())})}sortByAngle(d,p){d.sort(function(y,b){return y.angle!==void 0&&(b.angle-y.angle)*p})}translate(d){Qv(this,"translate"),this.generatePoints();let p=this.options,y=p.slicedOffset,b=Jw(p.startAngle,p.endAngle),w=this.startAngleRad=b.start,M=(this.endAngleRad=b.end)-w,T=this.points,S=p.ignoreHiddenPoint,O=T.length,B,N,U,X,Z,te,ne,J=0;for(d||(this.center=d=this.getCenter()),te=0;te<O;te++){ne=T[te],B=w+J*M,ne.isValid()&&(!S||ne.visible)&&(J+=ne.percentage/100),N=w+J*M;let ce={x:d[0],y:d[1],r:d[2]/2,innerR:d[3]/2,start:Math.round(1e3*B)/1e3,end:Math.round(1e3*N)/1e3};ne.shapeType="arc",ne.shapeArgs=ce,(U=(N+B)/2)>1.5*Math.PI?U-=2*Math.PI:U<-Math.PI/2&&(U+=2*Math.PI),ne.slicedTranslation={translateX:Math.round(Math.cos(U)*y),translateY:Math.round(Math.sin(U)*y)},X=Math.cos(U)*d[2]/2,Z=Math.sin(U)*d[2]/2,ne.tooltipPos=[d[0]+.7*X,d[1]+.7*Z],ne.half=U<-Math.PI/2||U>Math.PI/2?1:0,ne.angle=U}Qv(this,"afterTranslate")}updateTotals(){let d=this.points,p=d.length,y=this.options.ignoreHiddenPoint,b,w,M=0;for(b=0;b<p;b++)(w=d[b]).isValid()&&(!y||w.visible)&&(M+=w.y);for(b=0,this.total=M;b<p;b++)(w=d[b]).percentage=M>0&&(w.visible||!y)?w.y/M*100:0,w.total=M}}Yi.defaultOptions=Oc(Io.defaultOptions,{borderRadius:3,center:[null,null],clip:!1,colorByPoint:!0,dataLabels:{connectorPadding:5,connectorShape:"crookedLine",crookDistance:void 0,distance:30,enabled:!0,formatter:function(){return this.isNull?void 0:this.name},softConnector:!0,x:0},fillColor:void 0,ignoreHiddenPoint:!0,inactiveOtherPoints:!0,legendType:"point",marker:null,size:null,showInLegend:!1,slicedOffset:10,stickyTracking:!1,tooltip:{followPointer:!0},borderColor:"#ffffff",borderWidth:1,lineWidth:void 0,states:{hover:{brightness:.1}}}),Ry(Yi.prototype,{axisTypes:[],directTouch:!0,drawGraph:void 0,drawTracker:th.prototype.drawTracker,getCenter:_m.getCenter,getSymbol:Kv,invertible:!1,isCartesian:!1,noSharedTooltip:!0,pointAttribs:th.prototype.pointAttribs,pointClass:Yv,requireSorting:!1,searchPoint:Kv,trackerGroups:["group","dataLabelsGroup"]}),Gt.registerSeriesType("pie",Yi);let{composed:bm,noop:Jv}=lt,{distribute:xm}=Wr,{series:Of}=Gt,{arrayMax:Lf,clamp:Py,defined:Oy,pick:Ff,pushUnique:Ly,relativeLength:wm}=Zt;(function(P){let d={radialDistributionY:function(M,T){return(T.dataLabelPosition?.top||0)+M.distributeBox.pos},radialDistributionX:function(M,T,S,O,B){let N=B.dataLabelPosition;return M.getX(S<(N?.top||0)+2||S>(N?.bottom||0)-2?O:S,T.half,T,B)},justify:function(M,T,S,O){return O[0]+(M.half?-1:1)*(S+(T.dataLabelPosition?.distance||0))},alignToPlotEdges:function(M,T,S,O){let B=M.getBBox().width;return T?B+O:S-B-O},alignToConnectors:function(M,T,S,O){let B=0,N;return M.forEach(function(U){(N=U.dataLabel.getBBox().width)>B&&(B=N)}),T?B+O:S-B-O}};function p(M,T){let S=Math.PI/2,{start:O=0,end:B=0}=M.shapeArgs||{},N=M.angle||0;T>0&&O<S&&B>S&&N>S/2&&N<1.5*S&&(N=N<=S?Math.max(S/2,(O+S)/2):Math.min(1.5*S,(S+B)/2));let{center:U,options:X}=this,Z=U[2]/2,te=Math.cos(N),ne=Math.sin(N),J=U[0]+te*Z,ce=U[1]+ne*Z,de=Math.min((X.slicedOffset||0)+(X.borderWidth||0),T/5);return{natural:{x:J+te*T,y:ce+ne*T},computed:{},alignment:T<0?"center":M.half?"right":"left",connectorPosition:{angle:N,breakAt:{x:J+te*de,y:ce+ne*de},touchingSliceAt:{x:J,y:ce}},distance:T}}function y(){let M=this,T=M.points,S=M.chart,O=S.plotWidth,B=S.plotHeight,N=S.plotLeft,U=Math.round(S.chartWidth/3),X=M.center,Z=X[2]/2,te=X[1],ne=[[],[]],J=[0,0,0,0],ce=M.dataLabelPositioners,de,ke,Ue,Le=0;M.visible&&M.hasDataLabels?.()&&(T.forEach(Se=>{(Se.dataLabels||[]).forEach(ze=>{ze.shortened&&(ze.attr({width:"auto"}).css({width:"auto",textOverflow:"clip"}),ze.shortened=!1)})}),Of.prototype.drawDataLabels.apply(M),T.forEach(Se=>{(Se.dataLabels||[]).forEach((ze,nt)=>{let rt=X[2]/2,pt=ze.options,Bt=wm(pt?.distance||0,rt);nt===0&&ne[Se.half].push(Se),!Oy(pt?.style?.width)&&ze.getBBox().width>U&&(ze.css({width:Math.round(.7*U)+"px"}),ze.shortened=!0),ze.dataLabelPosition=this.getDataLabelPosition(Se,Bt),Le=Math.max(Le,Bt)})}),ne.forEach((Se,ze)=>{let nt=Se.length,rt=[],pt,Bt,Lt=0,jt;nt&&(M.sortByAngle(Se,ze-.5),Le>0&&(pt=Math.max(0,te-Z-Le),Bt=Math.min(te+Z+Le,S.plotHeight),Se.forEach(Yt=>{(Yt.dataLabels||[]).forEach(zt=>{let Sn=zt.dataLabelPosition;Sn&&Sn.distance>0&&(Sn.top=Math.max(0,te-Z-Sn.distance),Sn.bottom=Math.min(te+Z+Sn.distance,S.plotHeight),Lt=zt.getBBox().height||21,zt.lineHeight=S.renderer.fontMetrics(zt.text||zt).h+2*zt.padding,Yt.distributeBox={target:(zt.dataLabelPosition?.natural.y||0)-Sn.top+zt.lineHeight/2,size:Lt,rank:Yt.y},rt.push(Yt.distributeBox))})}),xm(rt,jt=Bt+Lt-pt,jt/5)),Se.forEach(Yt=>{(Yt.dataLabels||[]).forEach(zt=>{let Sn=zt.options||{},hn=Yt.distributeBox,fn=zt.dataLabelPosition,qn=fn?.natural.y||0,an=Sn.connectorPadding||0,br=zt.lineHeight||21,Ki=(br-zt.getBBox().height)/2,ei=0,An=qn,wi="inherit";if(fn){if(rt&&Oy(hn)&&fn.distance>0&&(hn.pos===void 0?wi="hidden":(Ue=hn.size,An=ce.radialDistributionY(Yt,zt))),Sn.justify)ei=ce.justify(Yt,zt,Z,X);else switch(Sn.alignTo){case"connectors":ei=ce.alignToConnectors(Se,ze,O,N);break;case"plotEdges":ei=ce.alignToPlotEdges(zt,ze,O,N);break;default:ei=ce.radialDistributionX(M,Yt,An-Ki,qn,zt)}if(fn.attribs={visibility:wi,align:fn.alignment},fn.posAttribs={x:ei+(Sn.x||0)+({left:an,right:-an}[fn.alignment]||0),y:An+(Sn.y||0)-br/2},fn.computed.x=ei,fn.computed.y=An-Ki,Ff(Sn.crop,!0)){let ji;ei-(ke=zt.getBBox().width)<an&&ze===1?(ji=Math.round(ke-ei+an),J[3]=Math.max(ji,J[3])):ei+ke>O-an&&ze===0&&(ji=Math.round(ei+ke-O+an),J[1]=Math.max(ji,J[1])),An-Ue/2<0?J[0]=Math.max(Math.round(-An+Ue/2),J[0]):An+Ue/2>B&&(J[2]=Math.max(Math.round(An+Ue/2-B),J[2])),fn.sideOverflow=ji}}})}))}),(Lf(J)===0||this.verifyDataLabelOverflow(J))&&(this.placeDataLabels(),this.points.forEach(Se=>{(Se.dataLabels||[]).forEach(ze=>{let{connectorColor:nt,connectorWidth:rt=1}=ze.options||{},pt=ze.dataLabelPosition;if(rt){let Bt;de=ze.connector,pt&&pt.distance>0?(Bt=!de,de||(ze.connector=de=S.renderer.path().addClass("highcharts-data-label-connector  highcharts-color-"+Se.colorIndex+(Se.className?" "+Se.className:"")).add(M.dataLabelsGroup)),S.styledMode||de.attr({"stroke-width":rt,stroke:nt||Se.color||"#666666"}),de[Bt?"attr":"animate"]({d:Se.getConnectorPath(ze)}),de.attr({visibility:pt.attribs?.visibility})):de&&(ze.connector=de.destroy())}})})))}function b(){this.points.forEach(M=>{(M.dataLabels||[]).forEach(T=>{let S=T.dataLabelPosition;S?(S.sideOverflow&&(T.css({width:Math.max(T.getBBox().width-S.sideOverflow,0)+"px",textOverflow:(T.options?.style||{}).textOverflow||"ellipsis"}),T.shortened=!0),T.attr(S.attribs),T[T.moved?"animate":"attr"](S.posAttribs),T.moved=!0):T&&T.attr({y:-9999})}),delete M.distributeBox},this)}function w(M){let T=this.center,S=this.options,O=S.center,B=S.minSize||80,N=B,U=S.size!==null;return!U&&(O[0]!==null?N=Math.max(T[2]-Math.max(M[1],M[3]),B):(N=Math.max(T[2]-M[1]-M[3],B),T[0]+=(M[3]-M[1])/2),O[1]!==null?N=Py(N,B,T[2]-Math.max(M[0],M[2])):(N=Py(N,B,T[2]-M[0]-M[2]),T[1]+=(M[0]-M[2])/2),N<T[2]?(T[2]=N,T[3]=Math.min(S.thickness?Math.max(0,N-2*S.thickness):Math.max(0,wm(S.innerSize||0,N)),N),this.translate(T),this.drawDataLabels&&this.drawDataLabels()):U=!0),U}P.compose=function(M){if(Uu.compose(Of),Ly(bm,"PieDataLabel")){let T=M.prototype;T.dataLabelPositioners=d,T.alignDataLabel=Jv,T.drawDataLabels=y,T.getDataLabelPosition=p,T.placeDataLabels=b,T.verifyDataLabelOverflow=w}}})(Ut||(Ut={}));let Fy=Ut;(function(P){P.getCenterOfPoints=function(d){let p=d.reduce((y,b)=>(y.x+=b.x,y.y+=b.y,y),{x:0,y:0});return{x:p.x/d.length,y:p.y/d.length}},P.getDistanceBetweenPoints=function(d,p){return Math.sqrt(Math.pow(p.x-d.x,2)+Math.pow(p.y-d.y,2))},P.getAngleBetweenPoints=function(d,p){return Math.atan2(p.x-d.x,p.y-d.y)},P.pointInPolygon=function({x:d,y:p},y){let b=y.length,w,M,T=!1;for(w=0,M=b-1;w<b;M=w++){let[S,O]=y[w],[B,N]=y[M];O>p!=N>p&&d<(B-S)*(p-O)/(N-O)+S&&(T=!T)}return T}})(Qt||(Qt={}));let{pointInPolygon:n1}=Qt,{addEvent:eb,fireEvent:rh,objectEach:tb,pick:Ny}=Zt;function i1(P){let d=P.length,p=(B,N)=>!(N.x>=B.x+B.width||N.x+N.width<=B.x||N.y>=B.y+B.height||N.y+N.height<=B.y),y=(B,N)=>{for(let U of B)if(n1({x:U[0],y:U[1]},N))return!0;return!1},b,w,M,T,S,O=!1;for(let B=0;B<d;B++)(b=P[B])&&(b.oldOpacity=b.opacity,b.newOpacity=1,b.absoluteBox=function(N){if(N&&(!N.alignAttr||N.placed)){let U=N.box?0:N.padding||0,X=N.alignAttr||{x:N.attr("x"),y:N.attr("y")},Z=N.getBBox();return N.width=Z.width,N.height=Z.height,{x:X.x+(N.parentGroup?.translateX||0)+U,y:X.y+(N.parentGroup?.translateY||0)+U,width:(N.width||0)-2*U,height:(N.height||0)-2*U,polygon:Z?.polygon}}}(b));P.sort((B,N)=>(N.labelrank||0)-(B.labelrank||0));for(let B=0;B<d;++B){T=(w=P[B])&&w.absoluteBox;let N=T?.polygon;for(let U=B+1;U<d;++U){S=(M=P[U])&&M.absoluteBox;let X=!1;if(T&&S&&w!==M&&w.newOpacity!==0&&M.newOpacity!==0&&w.visibility!=="hidden"&&M.visibility!=="hidden"){let Z=S.polygon;if(N&&Z&&N!==Z?y(N,Z)&&(X=!0):p(T,S)&&(X=!0),X){let te=w.labelrank<M.labelrank?w:M,ne=te.text;te.newOpacity=0,ne?.element.querySelector("textPath")&&ne.hide()}}}}for(let B of P)Cm(B,this)&&(O=!0);O&&rh(this,"afterHideAllOverlappingLabels")}function Cm(P,d){let p,y,b=!1;return P&&(y=P.newOpacity,P.oldOpacity!==y&&(P.hasClass("highcharts-data-label")?(P[y?"removeClass":"addClass"]("highcharts-data-label-hidden"),p=function(){d.styledMode||P.css({pointerEvents:y?"auto":"none"})},b=!0,P[P.isOld?"animate":"attr"]({opacity:y},void 0,p),rh(d,"afterHideOverlappingLabel")):P.attr({opacity:y})),P.isOld=!0),b}function zy(){let P=this,d=[];for(let p of P.labelCollectors||[])d=d.concat(p());for(let p of P.yAxis||[])p.stacking&&p.options.stackLabels&&!p.options.stackLabels.allowOverlap&&tb(p.stacking.stacks,y=>{tb(y,b=>{b.label&&d.push(b.label)})});for(let p of P.series||[])if(p.visible&&p.hasDataLabels?.()){let y=b=>{for(let w of b)w.visible&&(w.dataLabels||[]).forEach(M=>{let T=M.options||{};M.labelrank=Ny(T.labelrank,w.labelrank,w.shapeArgs?.height),T.allowOverlap??Number(T.distance)>0?(M.oldOpacity=M.opacity,M.newOpacity=1,Cm(M,P)):d.push(M)})};y(p.nodes||[]),y(p.points)}this.hideOverlappingLabels(d)}let Nf={compose:function(P){let d=P.prototype;d.hideOverlappingLabels||(d.hideOverlappingLabels=i1,eb(P,"render",zy))}},{defaultOptions:r1}=Sr,{noop:nb}=lt,{addEvent:ib,extend:o1,isObject:rb,merge:s1,relativeLength:oh}=Zt,a1={radius:0,scope:"stack",where:void 0},By=nb,Hu=nb;function l1(P,d,p,y,b={}){let w=By(P,d,p,y,b),{innerR:M=0,r:T=p,start:S=0,end:O=0}=b;if(b.open||!b.borderRadius)return w;let B=O-S,N=Math.sin(B/2),U=Math.max(Math.min(oh(b.borderRadius||0,T-M),(T-M)/2,T*N/(1+N)),0),X=Math.min(U,B/Math.PI*2*M),Z=w.length-1;for(;Z--;)(function(te,ne,J){let ce,de,ke,Ue=te[ne],Le=te[ne+1];if(Le[0]==="Z"&&(Le=te[0]),(Ue[0]==="M"||Ue[0]==="L")&&Le[0]==="A"?(ce=Ue,de=Le,ke=!0):Ue[0]==="A"&&(Le[0]==="M"||Le[0]==="L")&&(ce=Le,de=Ue),ce&&de&&de.params){let Se=de[1],ze=de[5],nt=de.params,{start:rt,end:pt,cx:Bt,cy:Lt}=nt,jt=ze?Se-J:Se+J,Yt=jt?Math.asin(J/jt):0,zt=ze?Yt:-Yt,Sn=Math.cos(Yt)*jt;ke?(nt.start=rt+zt,ce[1]=Bt+Sn*Math.cos(rt),ce[2]=Lt+Sn*Math.sin(rt),te.splice(ne+1,0,["A",J,J,0,0,1,Bt+Se*Math.cos(nt.start),Lt+Se*Math.sin(nt.start)])):(nt.end=pt-zt,de[6]=Bt+Se*Math.cos(nt.end),de[7]=Lt+Se*Math.sin(nt.end),te.splice(ne+1,0,["A",J,J,0,0,1,Bt+Sn*Math.cos(pt),Lt+Sn*Math.sin(pt)])),de[4]=Math.abs(nt.end-nt.start)<Math.PI?0:1}})(w,Z,Z>1?X:U);return w}function c1(){if(this.options.borderRadius&&!(this.chart.is3d&&this.chart.is3d())){let{options:P,yAxis:d}=this,p=P.stacking==="percent",y=r1.plotOptions?.[this.type]?.borderRadius,b=jy(P.borderRadius,rb(y)?y:{}),w=d.options.reversed;for(let M of this.points){let{shapeArgs:T}=M;if(M.shapeType==="roundedRect"&&T){let{width:S=0,height:O=0,y:B=0}=T,N=B,U=O;if(b.scope==="stack"&&M.stackTotal){let ne=d.translate(p?100:M.stackTotal,!1,!0,!1,!0),J=d.translate(P.threshold||0,!1,!0,!1,!0),ce=this.crispCol(0,Math.min(ne,J),0,Math.abs(ne-J));N=ce.y,U=ce.height}let X=(M.negative?-1:1)*(w?-1:1)==-1,Z=b.where;!Z&&this.is("waterfall")&&Math.abs((M.yBottom||0)-(this.translatedThreshold||0))>this.borderWidth&&(Z="all"),Z||(Z="end");let te=Math.min(oh(b.radius,S),S/2,Z==="all"?O/2:1/0)||0;Z==="end"&&(X&&(N-=te),U+=te),o1(T,{brBoxHeight:U,brBoxY:N,r:te})}}}}function jy(P,d){return rb(P)||(P={radius:P||0}),s1(a1,d,P)}function ob(){let P=jy(this.options.borderRadius);for(let d of this.points){let p=d.shapeArgs;p&&(p.borderRadius=oh(P.radius,(p.r||0)-(p.innerR||0)))}}function sb(P,d,p,y,b={}){let w=Hu(P,d,p,y,b),{r:M=0,brBoxHeight:T=y,brBoxY:S=d}=b,O=d-S,B=S+T-(d+y),N=O-M>-.1?0:M,U=B-M>-.1?0:M,X=Math.max(N&&O,0),Z=Math.max(U&&B,0),te=[P+N,d],ne=[P+p-N,d],J=[P+p,d+N],ce=[P+p,d+y-U],de=[P+p-U,d+y],ke=[P+U,d+y],Ue=[P,d+y-U],Le=[P,d+N],Se=(ze,nt)=>Math.sqrt(Math.pow(ze,2)-Math.pow(nt,2));if(X){let ze=Se(N,N-X);te[0]-=ze,ne[0]+=ze,J[1]=Le[1]=d+N-X}if(y<N-X){let ze=Se(N,N-X-y);J[0]=ce[0]=P+p-N+ze,de[0]=Math.min(J[0],de[0]),ke[0]=Math.max(ce[0],ke[0]),Ue[0]=Le[0]=P+N-ze,J[1]=Le[1]=d+y}if(Z){let ze=Se(U,U-Z);de[0]+=ze,ke[0]-=ze,ce[1]=Ue[1]=d+y-U+Z}if(y<U-Z){let ze=Se(U,U-Z-y);J[0]=ce[0]=P+p-U+ze,ne[0]=Math.min(J[0],ne[0]),te[0]=Math.max(ce[0],te[0]),Ue[0]=Le[0]=P+U-ze,ce[1]=Ue[1]=d}return w.length=0,w.push(["M",...te],["L",...ne],["A",N,N,0,0,1,...J],["L",...ce],["A",U,U,0,0,1,...de],["L",...ke],["A",U,U,0,0,1,...Ue],["L",...Le],["A",N,N,0,0,1,...te],["Z"]),w}let{diffObjects:u1,extend:d1,find:h1,merge:Vy,pick:Gu,uniqueKey:Em}=Zt;(function(P){function d(y,b){let w=y.condition;(w.callback||function(){return this.chartWidth<=Gu(w.maxWidth,Number.MAX_VALUE)&&this.chartHeight<=Gu(w.maxHeight,Number.MAX_VALUE)&&this.chartWidth>=Gu(w.minWidth,0)&&this.chartHeight>=Gu(w.minHeight,0)}).call(this)&&b.push(y._id)}function p(y,b){let w=this.options.responsive,M=this.currentResponsive,T=[],S;!b&&w&&w.rules&&w.rules.forEach(N=>{N._id===void 0&&(N._id=Em()),this.matchResponsiveRule(N,T)},this);let O=Vy(...T.map(N=>h1((w||{}).rules||[],U=>U._id===N)).map(N=>N&&N.chartOptions));O.isResponsiveOptions=!0,T=T.toString()||void 0;let B=M&&M.ruleIds;T===B||(M&&(this.currentResponsive=void 0,this.updatingResponsive=!0,this.update(M.undoOptions,y,!0),this.updatingResponsive=!1),T?((S=u1(O,this.options,!0,this.collectionsWithUpdate)).isResponsiveOptions=!0,this.currentResponsive={ruleIds:T,mergedOptions:O,undoOptions:S},this.updatingResponsive||this.update(O,y,!0)):this.currentResponsive=void 0)}P.compose=function(y){let b=y.prototype;return b.matchResponsiveRule||d1(b,{matchResponsiveRule:d,setResponsive:p}),y}})(_i||(_i={}));let f1=_i;lt.AST=bi,lt.Axis=_r,lt.Chart=zl,lt.Color=re,lt.DataLabel=Uu,lt.DataTableCore=Ge,lt.Fx=Ve,lt.HTMLElement=mc,lt.Legend=Ms,lt.LegendSymbol=_t,lt.OverlappingDataLabels=lt.OverlappingDataLabels||Nf,lt.PlotLineOrBand=Au,lt.Point=z,lt.Pointer=mt,lt.RendererRegistry=En,lt.Series=Io,lt.SeriesRegistry=Gt,lt.StackItem=kc,lt.SVGElement=Lo,lt.SVGRenderer=pc,lt.Templating=Mt,lt.Tick=uo,lt.Time=Qs,lt.Tooltip=Wd,lt.animate=Ln.animate,lt.animObject=Ln.animObject,lt.chart=zl.chart,lt.color=re.parse,lt.dateFormat=Mt.dateFormat,lt.defaultOptions=Sr.defaultOptions,lt.distribute=Wr.distribute,lt.format=Mt.format,lt.getDeferredAnimation=Ln.getDeferredAnimation,lt.getOptions=Sr.getOptions,lt.numberFormat=Mt.numberFormat,lt.seriesType=Gt.seriesType,lt.setAnimation=Ln.setAnimation,lt.setOptions=Sr.setOptions,lt.stop=Ln.stop,lt.time=Sr.defaultTime,lt.timers=Ve.timers,{compose:function(P,d,p){let y=P.types.pie;if(!d.symbolCustomAttribs.includes("borderRadius")){let b=p.prototype.symbols;ib(P,"afterColumnTranslate",c1,{order:9}),ib(y,"afterTranslate",ob),d.symbolCustomAttribs.push("borderRadius","brBoxHeight","brBoxY"),By=b.arc,Hu=b.roundedRect,b.arc=l1,b.roundedRect=sb}},optionsToObject:jy}.compose(lt.Series,lt.SVGElement,lt.SVGRenderer),qw.compose(lt.Series.types.column),Uu.compose(lt.Series),Fp.compose(lt.Axis),mc.compose(lt.SVGRenderer),Ms.compose(lt.Chart),ry.compose(lt.Axis),Nf.compose(lt.Chart),Fy.compose(lt.Series.types.pie),Au.compose(lt.Chart,lt.Axis),mt.compose(lt.Chart),f1.compose(lt.Chart),im.compose(lt.Axis,lt.Chart,lt.Series),Fv.compose(lt.Axis,lt.Chart,lt.Series),Wd.compose(lt.Pointer),Zt.extend(lt,Zt);let p1=lt;return Ro.default})())});function WI(n,r){return Object.is(n,r)}var ao=null,Cb=!1,q1=1,Ga=Symbol("SIGNAL");function si(n){let r=ao;return ao=n,r}function qI(){return ao}var Nm={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,kind:"unknown",producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function Db(n){if(Cb)throw new Error("");if(ao===null)return;ao.consumerOnSignalRead(n);let r=ao.nextProducerIndex++;if(Sb(ao),r<ao.producerNode.length&&ao.producerNode[r]!==n&&i_(ao)){let e=ao.producerNode[r];Ib(e,ao.producerIndexOfThis[r])}ao.producerNode[r]!==n&&(ao.producerNode[r]=n,ao.producerIndexOfThis[r]=i_(ao)?KI(n,ao,r):0),ao.producerLastReadVersion[r]=n.version}function rN(){q1++}function ZI(n){if(!(i_(n)&&!n.dirty)&&!(!n.dirty&&n.lastCleanEpoch===q1)){if(!n.producerMustRecompute(n)&&!Tb(n)){GI(n);return}n.producerRecomputeValue(n),GI(n)}}function XI(n){if(n.liveConsumerNode===void 0)return;let r=Cb;Cb=!0;try{for(let e of n.liveConsumerNode)e.dirty||oN(e)}finally{Cb=r}}function YI(){return ao?.consumerAllowSignalWrites!==!1}function oN(n){n.dirty=!0,XI(n),n.consumerMarkedDirty?.(n)}function GI(n){n.dirty=!1,n.lastCleanEpoch=q1}function r_(n){return n&&(n.nextProducerIndex=0),si(n)}function Mb(n,r){if(si(r),!(!n||n.producerNode===void 0||n.producerIndexOfThis===void 0||n.producerLastReadVersion===void 0)){if(i_(n))for(let e=n.nextProducerIndex;e<n.producerNode.length;e++)Ib(n.producerNode[e],n.producerIndexOfThis[e]);for(;n.producerNode.length>n.nextProducerIndex;)n.producerNode.pop(),n.producerLastReadVersion.pop(),n.producerIndexOfThis.pop()}}function Tb(n){Sb(n);for(let r=0;r<n.producerNode.length;r++){let e=n.producerNode[r],s=n.producerLastReadVersion[r];if(s!==e.version||(ZI(e),s!==e.version))return!0}return!1}function o_(n){if(Sb(n),i_(n))for(let r=0;r<n.producerNode.length;r++)Ib(n.producerNode[r],n.producerIndexOfThis[r]);n.producerNode.length=n.producerLastReadVersion.length=n.producerIndexOfThis.length=0,n.liveConsumerNode&&(n.liveConsumerNode.length=n.liveConsumerIndexOfThis.length=0)}function KI(n,r,e){if(QI(n),n.liveConsumerNode.length===0&&JI(n))for(let s=0;s<n.producerNode.length;s++)n.producerIndexOfThis[s]=KI(n.producerNode[s],n,s);return n.liveConsumerIndexOfThis.push(e),n.liveConsumerNode.push(r)-1}function Ib(n,r){if(QI(n),n.liveConsumerNode.length===1&&JI(n))for(let s=0;s<n.producerNode.length;s++)Ib(n.producerNode[s],n.producerIndexOfThis[s]);let e=n.liveConsumerNode.length-1;if(n.liveConsumerNode[r]=n.liveConsumerNode[e],n.liveConsumerIndexOfThis[r]=n.liveConsumerIndexOfThis[e],n.liveConsumerNode.length--,n.liveConsumerIndexOfThis.length--,r<n.liveConsumerNode.length){let s=n.liveConsumerIndexOfThis[r],u=n.liveConsumerNode[r];Sb(u),u.producerIndexOfThis[s]=r}}function i_(n){return n.consumerIsAlwaysLive||(n?.liveConsumerNode?.length??0)>0}function Sb(n){n.producerNode??=[],n.producerIndexOfThis??=[],n.producerLastReadVersion??=[]}function QI(n){n.liveConsumerNode??=[],n.liveConsumerIndexOfThis??=[]}function JI(n){return n.producerNode!==void 0}function eS(n){let r=Object.create(sN);r.computation=n;let e=()=>{if(ZI(r),Db(r),r.value===Eb)throw r.error;return r.value};return e[Ga]=r,e}var G1=Symbol("UNSET"),W1=Symbol("COMPUTING"),Eb=Symbol("ERRORED"),sN=Cn(ut({},Nm),{value:G1,dirty:!0,error:null,equal:WI,kind:"computed",producerMustRecompute(n){return n.value===G1||n.value===W1},producerRecomputeValue(n){if(n.value===W1)throw new Error("Detected cycle in computations.");let r=n.value;n.value=W1;let e=r_(n),s,u=!1;try{s=n.computation(),si(null),u=r!==G1&&r!==Eb&&s!==Eb&&n.equal(r,s)}catch(i){s=Eb,n.error=i}finally{Mb(n,e)}if(u){n.value=r;return}n.value=s,n.version++}});function aN(){throw new Error}var tS=aN;function nS(n){tS(n)}function iS(n){tS=n}var lN=null;function rS(n){let r=Object.create(Z1);r.value=n;let e=()=>(Db(r),r.value);return e[Ga]=r,e}function Ab(n,r){YI()||nS(n),n.equal(n.value,r)||(n.value=r,cN(n))}function oS(n,r){YI()||nS(n),Ab(n,r(n.value))}var Z1=Cn(ut({},Nm),{equal:WI,value:void 0,kind:"signal"});function cN(n){n.version++,rN(),XI(n),lN?.()}var X1;function s_(){return X1}function Xu(n){let r=X1;return X1=n,r}var Y1=Symbol("NotFound");function $n(n){return typeof n=="function"}function zm(n){let e=n(s=>{Error.call(s),s.stack=new Error().stack});return e.prototype=Object.create(Error.prototype),e.prototype.constructor=e,e}var kb=zm(n=>function(e){n(this),this.message=e?`${e.length} errors occurred during unsubscription:
${e.map((s,u)=>`${u+1}) ${s.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=e});function $f(n,r){if(n){let e=n.indexOf(r);0<=e&&n.splice(e,1)}}var Oi=class n{constructor(r){this.initialTeardown=r,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let r;if(!this.closed){this.closed=!0;let{_parentage:e}=this;if(e)if(this._parentage=null,Array.isArray(e))for(let i of e)i.remove(this);else e.remove(this);let{initialTeardown:s}=this;if($n(s))try{s()}catch(i){r=i instanceof kb?i.errors:[i]}let{_finalizers:u}=this;if(u){this._finalizers=null;for(let i of u)try{sS(i)}catch(E){r=r??[],E instanceof kb?r=[...r,...E.errors]:r.push(E)}}if(r)throw new kb(r)}}add(r){var e;if(r&&r!==this)if(this.closed)sS(r);else{if(r instanceof n){if(r.closed||r._hasParent(this))return;r._addParent(this)}(this._finalizers=(e=this._finalizers)!==null&&e!==void 0?e:[]).push(r)}}_hasParent(r){let{_parentage:e}=this;return e===r||Array.isArray(e)&&e.includes(r)}_addParent(r){let{_parentage:e}=this;this._parentage=Array.isArray(e)?(e.push(r),e):e?[e,r]:r}_removeParent(r){let{_parentage:e}=this;e===r?this._parentage=null:Array.isArray(e)&&$f(e,r)}remove(r){let{_finalizers:e}=this;e&&$f(e,r),r instanceof n&&r._removeParent(this)}};Oi.EMPTY=(()=>{let n=new Oi;return n.closed=!0,n})();var K1=Oi.EMPTY;function Rb(n){return n instanceof Oi||n&&"closed"in n&&$n(n.remove)&&$n(n.add)&&$n(n.unsubscribe)}function sS(n){$n(n)?n():n.unsubscribe()}var Gl={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var Bm={setTimeout(n,r,...e){let{delegate:s}=Bm;return s?.setTimeout?s.setTimeout(n,r,...e):setTimeout(n,r,...e)},clearTimeout(n){let{delegate:r}=Bm;return(r?.clearTimeout||clearTimeout)(n)},delegate:void 0};function Pb(n){Bm.setTimeout(()=>{let{onUnhandledError:r}=Gl;if(r)r(n);else throw n})}function Hf(){}var aS=Q1("C",void 0,void 0);function lS(n){return Q1("E",void 0,n)}function cS(n){return Q1("N",n,void 0)}function Q1(n,r,e){return{kind:n,value:r,error:e}}var Gf=null;function jm(n){if(Gl.useDeprecatedSynchronousErrorHandling){let r=!Gf;if(r&&(Gf={errorThrown:!1,error:null}),n(),r){let{errorThrown:e,error:s}=Gf;if(Gf=null,e)throw s}}else n()}function uS(n){Gl.useDeprecatedSynchronousErrorHandling&&Gf&&(Gf.errorThrown=!0,Gf.error=n)}var Wf=class extends Oi{constructor(r){super(),this.isStopped=!1,r?(this.destination=r,Rb(r)&&r.add(this)):this.destination=hN}static create(r,e,s){return new Yu(r,e,s)}next(r){this.isStopped?eC(cS(r),this):this._next(r)}error(r){this.isStopped?eC(lS(r),this):(this.isStopped=!0,this._error(r))}complete(){this.isStopped?eC(aS,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(r){this.destination.next(r)}_error(r){try{this.destination.error(r)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},uN=Function.prototype.bind;function J1(n,r){return uN.call(n,r)}var tC=class{constructor(r){this.partialObserver=r}next(r){let{partialObserver:e}=this;if(e.next)try{e.next(r)}catch(s){Ob(s)}}error(r){let{partialObserver:e}=this;if(e.error)try{e.error(r)}catch(s){Ob(s)}else Ob(r)}complete(){let{partialObserver:r}=this;if(r.complete)try{r.complete()}catch(e){Ob(e)}}},Yu=class extends Wf{constructor(r,e,s){super();let u;if($n(r)||!r)u={next:r??void 0,error:e??void 0,complete:s??void 0};else{let i;this&&Gl.useDeprecatedNextContext?(i=Object.create(r),i.unsubscribe=()=>this.unsubscribe(),u={next:r.next&&J1(r.next,i),error:r.error&&J1(r.error,i),complete:r.complete&&J1(r.complete,i)}):u=r}this.destination=new tC(u)}};function Ob(n){Gl.useDeprecatedSynchronousErrorHandling?uS(n):Pb(n)}function dN(n){throw n}function eC(n,r){let{onStoppedNotification:e}=Gl;e&&Bm.setTimeout(()=>e(n,r))}var hN={closed:!0,next:Hf,error:dN,complete:Hf};var Vm=typeof Symbol=="function"&&Symbol.observable||"@@observable";function Ao(n){return n}function nC(...n){return iC(n)}function iC(n){return n.length===0?Ao:n.length===1?n[0]:function(e){return n.reduce((s,u)=>u(s),e)}}var Hn=(()=>{class n{constructor(e){e&&(this._subscribe=e)}lift(e){let s=new n;return s.source=this,s.operator=e,s}subscribe(e,s,u){let i=pN(e)?e:new Yu(e,s,u);return jm(()=>{let{operator:E,source:L}=this;i.add(E?E.call(i,L):L?this._subscribe(i):this._trySubscribe(i))}),i}_trySubscribe(e){try{return this._subscribe(e)}catch(s){e.error(s)}}forEach(e,s){return s=dS(s),new s((u,i)=>{let E=new Yu({next:L=>{try{e(L)}catch(j){i(j),E.unsubscribe()}},error:i,complete:u});this.subscribe(E)})}_subscribe(e){var s;return(s=this.source)===null||s===void 0?void 0:s.subscribe(e)}[Vm](){return this}pipe(...e){return iC(e)(this)}toPromise(e){return e=dS(e),new e((s,u)=>{let i;this.subscribe(E=>i=E,E=>u(E),()=>s(i))})}}return n.create=r=>new n(r),n})();function dS(n){var r;return(r=n??Gl.Promise)!==null&&r!==void 0?r:Promise}function fN(n){return n&&$n(n.next)&&$n(n.error)&&$n(n.complete)}function pN(n){return n&&n instanceof Wf||fN(n)&&Rb(n)}function rC(n){return $n(n?.lift)}function Vn(n){return r=>{if(rC(r))return r.lift(function(e){try{return n(e,this)}catch(s){this.error(s)}});throw new TypeError("Unable to lift unknown Observable type")}}function Rn(n,r,e,s,u){return new oC(n,r,e,s,u)}var oC=class extends Wf{constructor(r,e,s,u,i,E){super(r),this.onFinalize=i,this.shouldUnsubscribe=E,this._next=e?function(L){try{e(L)}catch(j){r.error(j)}}:super._next,this._error=u?function(L){try{u(L)}catch(j){r.error(j)}finally{this.unsubscribe()}}:super._error,this._complete=s?function(){try{s()}catch(L){r.error(L)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var r;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:e}=this;super.unsubscribe(),!e&&((r=this.onFinalize)===null||r===void 0||r.call(this))}}};function Um(){return Vn((n,r)=>{let e=null;n._refCount++;let s=Rn(r,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount){e=null;return}let u=n._connection,i=e;e=null,u&&(!i||u===i)&&u.unsubscribe(),r.unsubscribe()});n.subscribe(s),s.closed||(e=n.connect())})}var $m=class extends Hn{constructor(r,e){super(),this.source=r,this.subjectFactory=e,this._subject=null,this._refCount=0,this._connection=null,rC(r)&&(this.lift=r.lift)}_subscribe(r){return this.getSubject().subscribe(r)}getSubject(){let r=this._subject;return(!r||r.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;let{_connection:r}=this;this._subject=this._connection=null,r?.unsubscribe()}connect(){let r=this._connection;if(!r){r=this._connection=new Oi;let e=this.getSubject();r.add(this.source.subscribe(Rn(e,void 0,()=>{this._teardown(),e.complete()},s=>{this._teardown(),e.error(s)},()=>this._teardown()))),r.closed&&(this._connection=null,r=Oi.EMPTY)}return r}refCount(){return Um()(this)}};var hS=zm(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var _n=(()=>{class n extends Hn{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(e){let s=new Lb(this,this);return s.operator=e,s}_throwIfClosed(){if(this.closed)throw new hS}next(e){jm(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let s of this.currentObservers)s.next(e)}})}error(e){jm(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=e;let{observers:s}=this;for(;s.length;)s.shift().error(e)}})}complete(){jm(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:e}=this;for(;e.length;)e.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var e;return((e=this.observers)===null||e===void 0?void 0:e.length)>0}_trySubscribe(e){return this._throwIfClosed(),super._trySubscribe(e)}_subscribe(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)}_innerSubscribe(e){let{hasError:s,isStopped:u,observers:i}=this;return s||u?K1:(this.currentObservers=null,i.push(e),new Oi(()=>{this.currentObservers=null,$f(i,e)}))}_checkFinalizedStatuses(e){let{hasError:s,thrownError:u,isStopped:i}=this;s?e.error(u):i&&e.complete()}asObservable(){let e=new Hn;return e.source=this,e}}return n.create=(r,e)=>new Lb(r,e),n})(),Lb=class extends _n{constructor(r,e){super(),this.destination=r,this.source=e}next(r){var e,s;(s=(e=this.destination)===null||e===void 0?void 0:e.next)===null||s===void 0||s.call(e,r)}error(r){var e,s;(s=(e=this.destination)===null||e===void 0?void 0:e.error)===null||s===void 0||s.call(e,r)}complete(){var r,e;(e=(r=this.destination)===null||r===void 0?void 0:r.complete)===null||e===void 0||e.call(r)}_subscribe(r){var e,s;return(s=(e=this.source)===null||e===void 0?void 0:e.subscribe(r))!==null&&s!==void 0?s:K1}};var Ir=class extends _n{constructor(r){super(),this._value=r}get value(){return this.getValue()}_subscribe(r){let e=super._subscribe(r);return!e.closed&&r.next(this._value),e}getValue(){let{hasError:r,thrownError:e,_value:s}=this;if(r)throw e;return this._throwIfClosed(),s}next(r){super.next(this._value=r)}};var sC={now(){return(sC.delegate||Date).now()},delegate:void 0};var Hm=class extends _n{constructor(){super(...arguments),this._value=null,this._hasValue=!1,this._isComplete=!1}_checkFinalizedStatuses(r){let{hasError:e,_hasValue:s,_value:u,thrownError:i,isStopped:E,_isComplete:L}=this;e?r.error(i):(E||L)&&(s&&r.next(u),r.complete())}next(r){this.isStopped||(this._value=r,this._hasValue=!0)}complete(){let{_hasValue:r,_value:e,_isComplete:s}=this;s||(this._isComplete=!0,r&&super.next(e),super.complete())}};var Fb=class extends Oi{constructor(r,e){super()}schedule(r,e=0){return this}};var a_={setInterval(n,r,...e){let{delegate:s}=a_;return s?.setInterval?s.setInterval(n,r,...e):setInterval(n,r,...e)},clearInterval(n){let{delegate:r}=a_;return(r?.clearInterval||clearInterval)(n)},delegate:void 0};var Gm=class extends Fb{constructor(r,e){super(r,e),this.scheduler=r,this.work=e,this.pending=!1}schedule(r,e=0){var s;if(this.closed)return this;this.state=r;let u=this.id,i=this.scheduler;return u!=null&&(this.id=this.recycleAsyncId(i,u,e)),this.pending=!0,this.delay=e,this.id=(s=this.id)!==null&&s!==void 0?s:this.requestAsyncId(i,this.id,e),this}requestAsyncId(r,e,s=0){return a_.setInterval(r.flush.bind(r,this),s)}recycleAsyncId(r,e,s=0){if(s!=null&&this.delay===s&&this.pending===!1)return e;e!=null&&a_.clearInterval(e)}execute(r,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;let s=this._execute(r,e);if(s)return s;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(r,e){let s=!1,u;try{this.work(r)}catch(i){s=!0,u=i||new Error("Scheduled action threw falsy error")}if(s)return this.unsubscribe(),u}unsubscribe(){if(!this.closed){let{id:r,scheduler:e}=this,{actions:s}=e;this.work=this.state=this.scheduler=null,this.pending=!1,$f(s,this),r!=null&&(this.id=this.recycleAsyncId(e,r,null)),this.delay=null,super.unsubscribe()}}};var Wm=class n{constructor(r,e=n.now){this.schedulerActionCtor=r,this.now=e}schedule(r,e=0,s){return new this.schedulerActionCtor(this,r).schedule(s,e)}};Wm.now=sC.now;var qm=class extends Wm{constructor(r,e=Wm.now){super(r,e),this.actions=[],this._active=!1}flush(r){let{actions:e}=this;if(this._active){e.push(r);return}let s;this._active=!0;do if(s=r.execute(r.state,r.delay))break;while(r=e.shift());if(this._active=!1,s){for(;r=e.shift();)r.unsubscribe();throw s}}};var l_=new qm(Gm),fS=l_;var Nb=class extends Gm{constructor(r,e){super(r,e),this.scheduler=r,this.work=e}schedule(r,e=0){return e>0?super.schedule(r,e):(this.delay=e,this.state=r,this.scheduler.flush(this),this)}execute(r,e){return e>0||this.closed?super.execute(r,e):this._execute(r,e)}requestAsyncId(r,e,s=0){return s!=null&&s>0||s==null&&this.delay>0?super.requestAsyncId(r,e,s):(r.flush(this),0)}};var zb=class extends qm{};var aC=new zb(Nb);var $o=new Hn(n=>n.complete());function Bb(n){return n&&$n(n.schedule)}function lC(n){return n[n.length-1]}function Zm(n){return $n(lC(n))?n.pop():void 0}function Bc(n){return Bb(lC(n))?n.pop():void 0}function pS(n,r){return typeof lC(n)=="number"?n.pop():r}function gS(n,r,e,s){function u(i){return i instanceof e?i:new e(function(E){E(i)})}return new(e||(e=Promise))(function(i,E){function L(oe){try{Y(s.next(oe))}catch(Ee){E(Ee)}}function j(oe){try{Y(s.throw(oe))}catch(Ee){E(Ee)}}function Y(oe){oe.done?i(oe.value):u(oe.value).then(L,j)}Y((s=s.apply(n,r||[])).next())})}function mS(n){var r=typeof Symbol=="function"&&Symbol.iterator,e=r&&n[r],s=0;if(e)return e.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&s>=n.length&&(n=void 0),{value:n&&n[s++],done:!n}}};throw new TypeError(r?"Object is not iterable.":"Symbol.iterator is not defined.")}function qf(n){return this instanceof qf?(this.v=n,this):new qf(n)}function yS(n,r,e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=e.apply(n,r||[]),u,i=[];return u=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),L("next"),L("throw"),L("return",E),u[Symbol.asyncIterator]=function(){return this},u;function E(Ne){return function(ct){return Promise.resolve(ct).then(Ne,Ee)}}function L(Ne,ct){s[Ne]&&(u[Ne]=function(bt){return new Promise(function(Ut,Qt){i.push([Ne,bt,Ut,Qt])>1||j(Ne,bt)})},ct&&(u[Ne]=ct(u[Ne])))}function j(Ne,ct){try{Y(s[Ne](ct))}catch(bt){Ye(i[0][3],bt)}}function Y(Ne){Ne.value instanceof qf?Promise.resolve(Ne.value.v).then(oe,Ee):Ye(i[0][2],Ne)}function oe(Ne){j("next",Ne)}function Ee(Ne){j("throw",Ne)}function Ye(Ne,ct){Ne(ct),i.shift(),i.length&&j(i[0][0],i[0][1])}}function _S(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n[Symbol.asyncIterator],e;return r?r.call(n):(n=typeof mS=="function"?mS(n):n[Symbol.iterator](),e={},s("next"),s("throw"),s("return"),e[Symbol.asyncIterator]=function(){return this},e);function s(i){e[i]=n[i]&&function(E){return new Promise(function(L,j){E=n[i](E),u(L,j,E.done,E.value)})}}function u(i,E,L,j){Promise.resolve(j).then(function(Y){i({value:Y,done:L})},E)}}var jb=n=>n&&typeof n.length=="number"&&typeof n!="function";function Vb(n){return $n(n?.then)}function Ub(n){return $n(n[Vm])}function $b(n){return Symbol.asyncIterator&&$n(n?.[Symbol.asyncIterator])}function Hb(n){return new TypeError(`You provided ${n!==null&&typeof n=="object"?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function mN(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var Gb=mN();function Wb(n){return $n(n?.[Gb])}function qb(n){return yS(this,arguments,function*(){let e=n.getReader();try{for(;;){let{value:s,done:u}=yield qf(e.read());if(u)return yield qf(void 0);yield yield qf(s)}}finally{e.releaseLock()}})}function Zb(n){return $n(n?.getReader)}function Vi(n){if(n instanceof Hn)return n;if(n!=null){if(Ub(n))return gN(n);if(jb(n))return yN(n);if(Vb(n))return _N(n);if($b(n))return vS(n);if(Wb(n))return vN(n);if(Zb(n))return bN(n)}throw Hb(n)}function gN(n){return new Hn(r=>{let e=n[Vm]();if($n(e.subscribe))return e.subscribe(r);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function yN(n){return new Hn(r=>{for(let e=0;e<n.length&&!r.closed;e++)r.next(n[e]);r.complete()})}function _N(n){return new Hn(r=>{n.then(e=>{r.closed||(r.next(e),r.complete())},e=>r.error(e)).then(null,Pb)})}function vN(n){return new Hn(r=>{for(let e of n)if(r.next(e),r.closed)return;r.complete()})}function vS(n){return new Hn(r=>{xN(n,r).catch(e=>r.error(e))})}function bN(n){return vS(qb(n))}function xN(n,r){var e,s,u,i;return gS(this,void 0,void 0,function*(){try{for(e=_S(n);s=yield e.next(),!s.done;){let E=s.value;if(r.next(E),r.closed)return}}catch(E){u={error:E}}finally{try{s&&!s.done&&(i=e.return)&&(yield i.call(e))}finally{if(u)throw u.error}}r.complete()})}function Os(n,r,e,s=0,u=!1){let i=r.schedule(function(){e(),u?n.add(this.schedule(null,s)):this.unsubscribe()},s);if(n.add(i),!u)return i}function Zf(n,r=0){return Vn((e,s)=>{e.subscribe(Rn(s,u=>Os(s,n,()=>s.next(u),r),()=>Os(s,n,()=>s.complete(),r),u=>Os(s,n,()=>s.error(u),r)))})}function Xb(n,r=0){return Vn((e,s)=>{s.add(n.schedule(()=>e.subscribe(s),r))})}function bS(n,r){return Vi(n).pipe(Xb(r),Zf(r))}function xS(n,r){return Vi(n).pipe(Xb(r),Zf(r))}function wS(n,r){return new Hn(e=>{let s=0;return r.schedule(function(){s===n.length?e.complete():(e.next(n[s++]),e.closed||this.schedule())})})}function CS(n,r){return new Hn(e=>{let s;return Os(e,r,()=>{s=n[Gb](),Os(e,r,()=>{let u,i;try{({value:u,done:i}=s.next())}catch(E){e.error(E);return}i?e.complete():e.next(u)},0,!0)}),()=>$n(s?.return)&&s.return()})}function Yb(n,r){if(!n)throw new Error("Iterable cannot be null");return new Hn(e=>{Os(e,r,()=>{let s=n[Symbol.asyncIterator]();Os(e,r,()=>{s.next().then(u=>{u.done?e.complete():e.next(u.value)})},0,!0)})})}function ES(n,r){return Yb(qb(n),r)}function DS(n,r){if(n!=null){if(Ub(n))return bS(n,r);if(jb(n))return wS(n,r);if(Vb(n))return xS(n,r);if($b(n))return Yb(n,r);if(Wb(n))return CS(n,r);if(Zb(n))return ES(n,r)}throw Hb(n)}function pr(n,r){return r?DS(n,r):Vi(n)}function nn(...n){let r=Bc(n);return pr(n,r)}function fh(n,r){let e=$n(n)?n:()=>n,s=u=>u.error(e());return new Hn(r?u=>r.schedule(s,0,u):s)}function c_(n){return!!n&&(n instanceof Hn||$n(n.lift)&&$n(n.subscribe))}var Wl=zm(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});function cC(n,r){let e=typeof r=="object";return new Promise((s,u)=>{let i=!1,E;n.subscribe({next:L=>{E=L,i=!0},error:u,complete:()=>{i?s(E):e?s(r.defaultValue):u(new Wl)}})})}function MS(n){return n instanceof Date&&!isNaN(n)}function un(n,r){return Vn((e,s)=>{let u=0;e.subscribe(Rn(s,i=>{s.next(n.call(r,i,u++))}))})}var{isArray:wN}=Array;function CN(n,r){return wN(r)?n(...r):n(r)}function Kb(n){return un(r=>CN(n,r))}var{isArray:EN}=Array,{getPrototypeOf:DN,prototype:MN,keys:TN}=Object;function Qb(n){if(n.length===1){let r=n[0];if(EN(r))return{args:r,keys:null};if(IN(r)){let e=TN(r);return{args:e.map(s=>r[s]),keys:e}}}return{args:n,keys:null}}function IN(n){return n&&typeof n=="object"&&DN(n)===MN}function Jb(n,r){return n.reduce((e,s,u)=>(e[s]=r[u],e),{})}function Xf(...n){let r=Bc(n),e=Zm(n),{args:s,keys:u}=Qb(n);if(s.length===0)return pr([],r);let i=new Hn(SN(s,r,u?E=>Jb(u,E):Ao));return e?i.pipe(Kb(e)):i}function SN(n,r,e=Ao){return s=>{TS(r,()=>{let{length:u}=n,i=new Array(u),E=u,L=u;for(let j=0;j<u;j++)TS(r,()=>{let Y=pr(n[j],r),oe=!1;Y.subscribe(Rn(s,Ee=>{i[j]=Ee,oe||(oe=!0,L--),L||s.next(e(i.slice()))},()=>{--E||s.complete()}))},s)},s)}}function TS(n,r,e){n?Os(e,n,r):r()}function IS(n,r,e,s,u,i,E,L){let j=[],Y=0,oe=0,Ee=!1,Ye=()=>{Ee&&!j.length&&!Y&&r.complete()},Ne=bt=>Y<s?ct(bt):j.push(bt),ct=bt=>{i&&r.next(bt),Y++;let Ut=!1;Vi(e(bt,oe++)).subscribe(Rn(r,Qt=>{u?.(Qt),i?Ne(Qt):r.next(Qt)},()=>{Ut=!0},void 0,()=>{if(Ut)try{for(Y--;j.length&&Y<s;){let Qt=j.shift();E?Os(r,E,()=>ct(Qt)):ct(Qt)}Ye()}catch(Qt){r.error(Qt)}}))};return n.subscribe(Rn(r,Ne,()=>{Ee=!0,Ye()})),()=>{L?.()}}function Jr(n,r,e=1/0){return $n(r)?Jr((s,u)=>un((i,E)=>r(s,i,u,E))(Vi(n(s,u))),e):(typeof r=="number"&&(e=r),Vn((s,u)=>IS(s,u,n,e)))}function ph(n=1/0){return Jr(Ao,n)}function SS(){return ph(1)}function mh(...n){return SS()(pr(n,Bc(n)))}function e0(n){return new Hn(r=>{Vi(n()).subscribe(r)})}function uC(...n){let r=Zm(n),{args:e,keys:s}=Qb(n),u=new Hn(i=>{let{length:E}=e;if(!E){i.complete();return}let L=new Array(E),j=E,Y=E;for(let oe=0;oe<E;oe++){let Ee=!1;Vi(e[oe]).subscribe(Rn(i,Ye=>{Ee||(Ee=!0,Y--),L[oe]=Ye},()=>j--,void 0,()=>{(!j||!Ee)&&(Y||i.next(s?Jb(s,L):L),i.complete())}))}});return r?u.pipe(Kb(r)):u}function AS(n=0,r,e=fS){let s=-1;return r!=null&&(Bb(r)?e=r:s=r),new Hn(u=>{let i=MS(n)?+n-e.now():n;i<0&&(i=0);let E=0;return e.schedule(function(){u.closed||(u.next(E++),0<=s?this.schedule(void 0,s):u.complete())},i)})}function t0(...n){let r=Bc(n),e=pS(n,1/0),s=n;return s.length?s.length===1?Vi(s[0]):ph(e)(pr(s,r)):$o}function Lr(n,r){return Vn((e,s)=>{let u=0;e.subscribe(Rn(s,i=>n.call(r,i,u++)&&s.next(i)))})}function kS(n){return Vn((r,e)=>{let s=!1,u=null,i=null,E=!1,L=()=>{if(i?.unsubscribe(),i=null,s){s=!1;let Y=u;u=null,e.next(Y)}E&&e.complete()},j=()=>{i=null,E&&e.complete()};r.subscribe(Rn(e,Y=>{s=!0,u=Y,i||Vi(n(Y)).subscribe(i=Rn(e,L,j))},()=>{E=!0,(!s||!i||i.closed)&&e.complete()}))})}function n0(n,r=l_){return kS(()=>AS(n,r))}function jc(n){return Vn((r,e)=>{let s=null,u=!1,i;s=r.subscribe(Rn(e,void 0,void 0,E=>{i=Vi(n(E,jc(n)(r))),s?(s.unsubscribe(),s=null,i.subscribe(e)):u=!0})),u&&(s.unsubscribe(),s=null,i.subscribe(e))})}function RS(n,r,e,s,u){return(i,E)=>{let L=e,j=r,Y=0;i.subscribe(Rn(E,oe=>{let Ee=Y++;j=L?n(j,oe,Ee):(L=!0,oe),s&&E.next(j)},u&&(()=>{L&&E.next(j),E.complete()})))}}function Ku(n,r){return $n(r)?Jr(n,r,1):Jr(n,1)}function u_(n,r=l_){return Vn((e,s)=>{let u=null,i=null,E=null,L=()=>{if(u){u.unsubscribe(),u=null;let Y=i;i=null,s.next(Y)}};function j(){let Y=E+n,oe=r.now();if(oe<Y){u=this.schedule(void 0,Y-oe),s.add(u);return}L()}e.subscribe(Rn(s,Y=>{i=Y,E=r.now(),u||(u=r.schedule(j,n),s.add(u))},()=>{L(),s.complete()},void 0,()=>{i=u=null}))})}function gh(n){return Vn((r,e)=>{let s=!1;r.subscribe(Rn(e,u=>{s=!0,e.next(u)},()=>{s||e.next(n),e.complete()}))})}function go(n){return n<=0?()=>$o:Vn((r,e)=>{let s=0;r.subscribe(Rn(e,u=>{++s<=n&&(e.next(u),n<=s&&e.complete())}))})}function Xm(n,r=Ao){return n=n??AN,Vn((e,s)=>{let u,i=!0;e.subscribe(Rn(s,E=>{let L=r(E);(i||!n(u,L))&&(i=!1,u=L,s.next(E))}))})}function AN(n,r){return n===r}function i0(n=kN){return Vn((r,e)=>{let s=!1;r.subscribe(Rn(e,u=>{s=!0,e.next(u)},()=>s?e.complete():e.error(n())))})}function kN(){return new Wl}function Vc(n){return Vn((r,e)=>{try{r.subscribe(e)}finally{e.add(n)}})}function ql(n,r){let e=arguments.length>=2;return s=>s.pipe(n?Lr((u,i)=>n(u,i,s)):Ao,go(1),e?gh(r):i0(()=>new Wl))}function Ym(n){return n<=0?()=>$o:Vn((r,e)=>{let s=[];r.subscribe(Rn(e,u=>{s.push(u),n<s.length&&s.shift()},()=>{for(let u of s)e.next(u);e.complete()},void 0,()=>{s=null}))})}function dC(n,r){let e=arguments.length>=2;return s=>s.pipe(n?Lr((u,i)=>n(u,i,s)):Ao,Ym(1),e?gh(r):i0(()=>new Wl))}function hC(...n){let r=n.length;if(r===0)throw new Error("list of properties cannot be empty.");return un(e=>{let s=e;for(let u=0;u<r;u++){let i=s?.[n[u]];if(typeof i<"u")s=i;else return}return s})}function d_(n,r){return Vn(RS(n,r,arguments.length>=2,!0))}function pC(n={}){let{connector:r=()=>new _n,resetOnError:e=!0,resetOnComplete:s=!0,resetOnRefCountZero:u=!0}=n;return i=>{let E,L,j,Y=0,oe=!1,Ee=!1,Ye=()=>{L?.unsubscribe(),L=void 0},Ne=()=>{Ye(),E=j=void 0,oe=Ee=!1},ct=()=>{let bt=E;Ne(),bt?.unsubscribe()};return Vn((bt,Ut)=>{Y++,!Ee&&!oe&&Ye();let Qt=j=j??r();Ut.add(()=>{Y--,Y===0&&!Ee&&!oe&&(L=fC(ct,u))}),Qt.subscribe(Ut),!E&&Y>0&&(E=new Yu({next:_i=>Qt.next(_i),error:_i=>{Ee=!0,Ye(),L=fC(Ne,e,_i),Qt.error(_i)},complete:()=>{oe=!0,Ye(),L=fC(Ne,s),Qt.complete()}}),Vi(bt).subscribe(E))})(i)}}function fC(n,r,...e){if(r===!0){n();return}if(r===!1)return;let s=new Yu({next:()=>{s.unsubscribe(),n()}});return Vi(r(...e)).subscribe(s)}function h_(n){return Lr((r,e)=>n<=e)}function Yf(...n){let r=Bc(n);return Vn((e,s)=>{(r?mh(n,e,r):mh(n,e)).subscribe(s)})}function Ho(n,r){return Vn((e,s)=>{let u=null,i=0,E=!1,L=()=>E&&!u&&s.complete();e.subscribe(Rn(s,j=>{u?.unsubscribe();let Y=0,oe=i++;Vi(n(j,oe)).subscribe(u=Rn(s,Ee=>s.next(r?r(j,Ee,oe,Y++):Ee),()=>{u=null,L()}))},()=>{E=!0,L()}))})}function Br(n){return Vn((r,e)=>{Vi(n).subscribe(Rn(e,()=>e.complete(),Hf)),!e.closed&&r.subscribe(e)})}function xr(n,r,e){let s=$n(n)||r||e?{next:n,error:r,complete:e}:n;return s?Vn((u,i)=>{var E;(E=s.subscribe)===null||E===void 0||E.call(s);let L=!0;u.subscribe(Rn(i,j=>{var Y;(Y=s.next)===null||Y===void 0||Y.call(s,j),i.next(j)},()=>{var j;L=!1,(j=s.complete)===null||j===void 0||j.call(s),i.complete()},j=>{var Y;L=!1,(Y=s.error)===null||Y===void 0||Y.call(s,j),i.error(j)},()=>{var j,Y;L&&((j=s.unsubscribe)===null||j===void 0||j.call(s)),(Y=s.finalize)===null||Y===void 0||Y.call(s)}))}):Ao}function mC(...n){let r=Zm(n);return Vn((e,s)=>{let u=n.length,i=new Array(u),E=n.map(()=>!1),L=!1;for(let j=0;j<u;j++)Vi(n[j]).subscribe(Rn(s,Y=>{i[j]=Y,!L&&!E[j]&&(E[j]=!0,(L=E.every(Ao))&&(E=null))},Hf));e.subscribe(Rn(s,j=>{if(L){let Y=[j,...i];s.next(r?r(...Y):Y)}}))})}var xA="https://angular.dev/best-practices/security#preventing-cross-site-scripting-xss",Ht=class extends Error{code;constructor(r,e){super(I_(r,e)),this.code=r}};function I_(n,r){return`${`NG0${Math.abs(n)}`}${r?": "+r:""}`}var wA=Symbol("InputSignalNode#UNSET"),RN=Cn(ut({},Z1),{transformFn:void 0,applyValueToInputSignal(n,r){Ab(n,r)}});function CA(n,r){let e=Object.create(RN);e.value=n,e.transformFn=r?.transform;function s(){if(Db(e),e.value===wA)throw new Ht(-950,!1);return e.value}return s[Ga]=e,s}function S_(n){return{toString:n}.toString()}var r0="__parameters__";function PN(n){return function(...e){if(n){let s=n(...e);for(let u in s)this[u]=s[u]}}}function ON(n,r,e){return S_(()=>{let s=PN(r);function u(...i){if(this instanceof u)return s.apply(this,i),this;let E=new u(...i);return L.annotation=E,L;function L(j,Y,oe){let Ee=j.hasOwnProperty(r0)?j[r0]:Object.defineProperty(j,r0,{value:[]})[r0];for(;Ee.length<=oe;)Ee.push(null);return(Ee[oe]=Ee[oe]||[]).push(E),j}}return u.prototype.ngMetadataName=n,u.annotationCls=u,u})}var Yl=globalThis;function er(n){for(let r in n)if(n[r]===er)return r;throw Error("Could not find renamed property on target object.")}function LN(n,r){for(let e in r)r.hasOwnProperty(e)&&!n.hasOwnProperty(e)&&(n[e]=r[e])}function Fs(n){if(typeof n=="string")return n;if(Array.isArray(n))return`[${n.map(Fs).join(", ")}]`;if(n==null)return""+n;let r=n.overriddenName||n.name;if(r)return`${r}`;let e=n.toString();if(e==null)return""+e;let s=e.indexOf(`
`);return s>=0?e.slice(0,s):e}function SC(n,r){return n?r?`${n} ${r}`:n:r||""}var FN=er({__forward_ref__:er});function up(n){return n.__forward_ref__=up,n.toString=function(){return Fs(this())},n}function us(n){return EA(n)?n():n}function EA(n){return typeof n=="function"&&n.hasOwnProperty(FN)&&n.__forward_ref__===up}function xt(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function Jt(n){return{providers:n.providers||[],imports:n.imports||[]}}function $0(n){return PS(n,MA)||PS(n,TA)}function DA(n){return $0(n)!==null}function PS(n,r){return n.hasOwnProperty(r)?n[r]:null}function NN(n){let r=n&&(n[MA]||n[TA]);return r||null}function OS(n){return n&&(n.hasOwnProperty(LS)||n.hasOwnProperty(zN))?n[LS]:null}var MA=er({\u0275prov:er}),LS=er({\u0275inj:er}),TA=er({ngInjectableDef:er}),zN=er({ngInjectorDef:er}),dt=class{_desc;ngMetadataName="InjectionToken";\u0275prov;constructor(r,e){this._desc=r,this.\u0275prov=void 0,typeof e=="number"?this.__NG_ELEMENT_ID__=e:e!==void 0&&(this.\u0275prov=xt({token:this,providedIn:e.providedIn||"root",factory:e.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};function IA(n){return n&&!!n.\u0275providers}var BN=er({\u0275cmp:er}),jN=er({\u0275dir:er}),VN=er({\u0275pipe:er}),UN=er({\u0275mod:er}),p0=er({\u0275fac:er}),g_=er({__NG_ELEMENT_ID__:er}),FS=er({__NG_ENV_ID__:er});function __(n){return typeof n=="string"?n:n==null?"":String(n)}function $N(n){return typeof n=="function"?n.name||n.toString():typeof n=="object"&&n!=null&&typeof n.type=="function"?n.type.name||n.type.toString():__(n)}function SA(n,r){throw new Ht(-200,n)}function DE(n,r){throw new Ht(-201,!1)}var ti=function(n){return n[n.Default=0]="Default",n[n.Host=1]="Host",n[n.Self=2]="Self",n[n.SkipSelf=4]="SkipSelf",n[n.Optional=8]="Optional",n}(ti||{}),AC;function AA(){return AC}function Wa(n){let r=AC;return AC=n,r}function kA(n,r,e){let s=$0(n);if(s&&s.providedIn=="root")return s.value===void 0?s.value=s.factory():s.value;if(e&ti.Optional)return null;if(r!==void 0)return r;DE(n,"Injector")}var HN={},Kf=HN,kC="__NG_DI_FLAG__",m0=class{injector;constructor(r){this.injector=r}retrieve(r,e){let s=e;return this.injector.get(r,s.optional?Y1:Kf,s)}},g0="ngTempTokenPath",GN="ngTokenPath",WN=/\n/gm,qN="\u0275",NS="__source";function ZN(n,r=ti.Default){if(s_()===void 0)throw new Ht(-203,!1);if(s_()===null)return kA(n,void 0,r);{let e=s_(),s;return e instanceof m0?s=e.injector:s=e,s.get(n,r&ti.Optional?null:void 0,r)}}function St(n,r=ti.Default){return(AA()||ZN)(us(n),r)}function we(n,r=ti.Default){return St(n,H0(r))}function H0(n){return typeof n>"u"||typeof n=="number"?n:0|(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function RC(n){let r=[];for(let e=0;e<n.length;e++){let s=us(n[e]);if(Array.isArray(s)){if(s.length===0)throw new Ht(900,!1);let u,i=ti.Default;for(let E=0;E<s.length;E++){let L=s[E],j=YN(L);typeof j=="number"?j===-1?u=L.token:i|=j:u=L}r.push(St(u,i))}else r.push(St(s))}return r}function XN(n,r){return n[kC]=r,n.prototype[kC]=r,n}function YN(n){return n[kC]}function KN(n,r,e,s){let u=n[g0];throw r[NS]&&u.unshift(r[NS]),n.message=QN(`
`+n.message,u,e,s),n[GN]=u,n[g0]=null,n}function QN(n,r,e,s=null){n=n&&n.charAt(0)===`
`&&n.charAt(1)==qN?n.slice(2):n;let u=Fs(r);if(Array.isArray(r))u=r.map(Fs).join(" -> ");else if(typeof r=="object"){let i=[];for(let E in r)if(r.hasOwnProperty(E)){let L=r[E];i.push(E+":"+(typeof L=="string"?JSON.stringify(L):Fs(L)))}u=`{${i.join(", ")}}`}return`${e}${s?"("+s+")":""}[${u}]: ${n.replace(WN,`
  `)}`}var G0=XN(ON("Inject",n=>({token:n})),-1);function ig(n,r){let e=n.hasOwnProperty(p0);return e?n[p0]:null}function JN(n,r,e){if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++){let u=n[s],i=r[s];if(e&&(u=e(u),i=e(i)),i!==u)return!1}return!0}function ez(n){return n.flat(Number.POSITIVE_INFINITY)}function ME(n,r){n.forEach(e=>Array.isArray(e)?ME(e,r):r(e))}function RA(n,r,e){r>=n.length?n.push(e):n.splice(r,0,e)}function y0(n,r){return r>=n.length-1?n.pop():n.splice(r,1)[0]}function tz(n,r){let e=[];for(let s=0;s<n;s++)e.push(r);return e}function nz(n,r,e,s){let u=n.length;if(u==r)n.push(e,s);else if(u===1)n.push(s,n[0]),n[0]=e;else{for(u--,n.push(n[u-1],n[u]);u>r;){let i=u-2;n[u]=n[i],u--}n[r]=e,n[r+1]=s}}function W0(n,r,e){let s=A_(n,r);return s>=0?n[s|1]=e:(s=~s,nz(n,s,r,e)),s}function gC(n,r){let e=A_(n,r);if(e>=0)return n[e|1]}function A_(n,r){return iz(n,r,1)}function iz(n,r,e){let s=0,u=n.length>>e;for(;u!==s;){let i=s+(u-s>>1),E=n[i<<e];if(r===E)return i<<e;E>r?u=i:s=i+1}return~(u<<e)}var Jf={},Ls=[],ep=new dt(""),PA=new dt("",-1),OA=new dt(""),_0=class{get(r,e=Kf){if(e===Kf){let s=new Error(`NullInjectorError: No provider for ${Fs(r)}!`);throw s.name="NullInjectorError",s}return e}};function LA(n,r){let e=n[UN]||null;if(!e&&r===!0)throw new Error(`Type ${Fs(n)} does not have '\u0275mod' property.`);return e}function vh(n){return n[BN]||null}function rz(n){return n[jN]||null}function oz(n){return n[VN]||null}function k_(n){return{\u0275providers:n}}function sz(...n){return{\u0275providers:FA(!0,n),\u0275fromNgModule:!0}}function FA(n,...r){let e=[],s=new Set,u,i=E=>{e.push(E)};return ME(r,E=>{let L=E;PC(L,i,[],s)&&(u||=[],u.push(L))}),u!==void 0&&NA(u,i),e}function NA(n,r){for(let e=0;e<n.length;e++){let{ngModule:s,providers:u}=n[e];TE(u,i=>{r(i,s)})}}function PC(n,r,e,s){if(n=us(n),!n)return!1;let u=null,i=OS(n),E=!i&&vh(n);if(!i&&!E){let j=n.ngModule;if(i=OS(j),i)u=j;else return!1}else{if(E&&!E.standalone)return!1;u=n}let L=s.has(u);if(E){if(L)return!1;if(s.add(u),E.dependencies){let j=typeof E.dependencies=="function"?E.dependencies():E.dependencies;for(let Y of j)PC(Y,r,e,s)}}else if(i){if(i.imports!=null&&!L){s.add(u);let Y;try{ME(i.imports,oe=>{PC(oe,r,e,s)&&(Y||=[],Y.push(oe))})}finally{}Y!==void 0&&NA(Y,r)}if(!L){let Y=ig(u)||(()=>new u);r({provide:u,useFactory:Y,deps:Ls},u),r({provide:OA,useValue:u,multi:!0},u),r({provide:ep,useValue:()=>St(u),multi:!0},u)}let j=i.providers;if(j!=null&&!L){let Y=n;TE(j,oe=>{r(oe,Y)})}}else return!1;return u!==n&&n.providers!==void 0}function TE(n,r){for(let e of n)IA(e)&&(e=e.\u0275providers),Array.isArray(e)?TE(e,r):r(e)}var az=er({provide:String,useValue:er});function zA(n){return n!==null&&typeof n=="object"&&az in n}function lz(n){return!!(n&&n.useExisting)}function cz(n){return!!(n&&n.useFactory)}function rg(n){return typeof n=="function"}function uz(n){return!!n.useClass}var q0=new dt(""),c0={},zS={},yC;function Z0(){return yC===void 0&&(yC=new _0),yC}var jr=class{},v_=class extends jr{parent;source;scopes;records=new Map;_ngOnDestroyHooks=new Set;_onDestroyHooks=[];get destroyed(){return this._destroyed}_destroyed=!1;injectorDefTypes;constructor(r,e,s,u){super(),this.parent=e,this.source=s,this.scopes=u,LC(r,E=>this.processProvider(E)),this.records.set(PA,Km(void 0,this)),u.has("environment")&&this.records.set(jr,Km(void 0,this));let i=this.records.get(q0);i!=null&&typeof i.value=="string"&&this.scopes.add(i.value),this.injectorDefTypes=new Set(this.get(OA,Ls,ti.Self))}retrieve(r,e){let s=e;return this.get(r,s.optional?Y1:Kf,s)}destroy(){p_(this),this._destroyed=!0;let r=si(null);try{for(let s of this._ngOnDestroyHooks)s.ngOnDestroy();let e=this._onDestroyHooks;this._onDestroyHooks=[];for(let s of e)s()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),si(r)}}onDestroy(r){return p_(this),this._onDestroyHooks.push(r),()=>this.removeOnDestroy(r)}runInContext(r){p_(this);let e=Xu(this),s=Wa(void 0),u;try{return r()}finally{Xu(e),Wa(s)}}get(r,e=Kf,s=ti.Default){if(p_(this),r.hasOwnProperty(FS))return r[FS](this);s=H0(s);let u,i=Xu(this),E=Wa(void 0);try{if(!(s&ti.SkipSelf)){let j=this.records.get(r);if(j===void 0){let Y=mz(r)&&$0(r);Y&&this.injectableDefInScope(Y)?j=Km(OC(r),c0):j=null,this.records.set(r,j)}if(j!=null)return this.hydrate(r,j)}let L=s&ti.Self?Z0():this.parent;return e=s&ti.Optional&&e===Kf?null:e,L.get(r,e)}catch(L){if(L.name==="NullInjectorError"){if((L[g0]=L[g0]||[]).unshift(Fs(r)),i)throw L;return KN(L,r,"R3InjectorError",this.source)}else throw L}finally{Wa(E),Xu(i)}}resolveInjectorInitializers(){let r=si(null),e=Xu(this),s=Wa(void 0),u;try{let i=this.get(ep,Ls,ti.Self);for(let E of i)E()}finally{Xu(e),Wa(s),si(r)}}toString(){let r=[],e=this.records;for(let s of e.keys())r.push(Fs(s));return`R3Injector[${r.join(", ")}]`}processProvider(r){r=us(r);let e=rg(r)?r:us(r&&r.provide),s=hz(r);if(!rg(r)&&r.multi===!0){let u=this.records.get(e);u||(u=Km(void 0,c0,!0),u.factory=()=>RC(u.multi),this.records.set(e,u)),e=r,u.multi.push(r)}this.records.set(e,s)}hydrate(r,e){let s=si(null);try{return e.value===zS?SA(Fs(r)):e.value===c0&&(e.value=zS,e.value=e.factory()),typeof e.value=="object"&&e.value&&pz(e.value)&&this._ngOnDestroyHooks.add(e.value),e.value}finally{si(s)}}injectableDefInScope(r){if(!r.providedIn)return!1;let e=us(r.providedIn);return typeof e=="string"?e==="any"||this.scopes.has(e):this.injectorDefTypes.has(e)}removeOnDestroy(r){let e=this._onDestroyHooks.indexOf(r);e!==-1&&this._onDestroyHooks.splice(e,1)}};function OC(n){let r=$0(n),e=r!==null?r.factory:ig(n);if(e!==null)return e;if(n instanceof dt)throw new Ht(204,!1);if(n instanceof Function)return dz(n);throw new Ht(204,!1)}function dz(n){if(n.length>0)throw new Ht(204,!1);let e=NN(n);return e!==null?()=>e.factory(n):()=>new n}function hz(n){if(zA(n))return Km(void 0,n.useValue);{let r=BA(n);return Km(r,c0)}}function BA(n,r,e){let s;if(rg(n)){let u=us(n);return ig(u)||OC(u)}else if(zA(n))s=()=>us(n.useValue);else if(cz(n))s=()=>n.useFactory(...RC(n.deps||[]));else if(lz(n))s=()=>St(us(n.useExisting));else{let u=us(n&&(n.useClass||n.provide));if(fz(n))s=()=>new u(...RC(n.deps));else return ig(u)||OC(u)}return s}function p_(n){if(n.destroyed)throw new Ht(205,!1)}function Km(n,r,e=!1){return{factory:n,value:r,multi:e?[]:void 0}}function fz(n){return!!n.deps}function pz(n){return n!==null&&typeof n=="object"&&typeof n.ngOnDestroy=="function"}function mz(n){return typeof n=="function"||typeof n=="object"&&n instanceof dt}function LC(n,r){for(let e of n)Array.isArray(e)?LC(e,r):e&&IA(e)?LC(e.\u0275providers,r):r(e)}function Vs(n,r){let e;n instanceof v_?(p_(n),e=n):e=new m0(n);let s,u=Xu(e),i=Wa(void 0);try{return r()}finally{Xu(u),Wa(i)}}function jA(){return AA()!==void 0||s_()!=null}function cg(n){if(!jA())throw new Ht(-203,!1)}function gz(n){let r=Yl.ng;if(r&&r.\u0275compilerFacade)return r.\u0275compilerFacade;throw new Error("JIT compiler unavailable")}function yz(n){return typeof n=="function"}var id=0,ni=1,zn=2,Go=3,Xl=4,Us=5,b_=6,v0=7,ds=8,x_=9,bh=10,eo=11,w_=12,BS=13,ug=14,Za=15,tp=16,Qm=17,Qu=18,X0=19,VA=20,yh=21,_C=22,np=23,qa=24,tg=25,zs=26,UA=1;var ip=7,b0=8,og=9,Ns=10;function _h(n){return Array.isArray(n)&&typeof n[UA]=="object"}function rd(n){return Array.isArray(n)&&n[UA]===!0}function $A(n){return(n.flags&4)!==0}function dg(n){return n.componentOffset>-1}function IE(n){return(n.flags&1)===1}function $c(n){return!!n.template}function x0(n){return(n[zn]&512)!==0}function R_(n){return(n[zn]&256)===256}var FC=class{previousValue;currentValue;firstChange;constructor(r,e,s){this.previousValue=r,this.currentValue=e,this.firstChange=s}isFirstChange(){return this.firstChange}};function HA(n,r,e,s){r!==null?r.applyValueToInputSignal(r,s):n[e]=s}var hs=(()=>{let n=()=>GA;return n.ngInherit=!0,n})();function GA(n){return n.type.prototype.ngOnChanges&&(n.setInput=vz),_z}function _z(){let n=qA(this),r=n?.current;if(r){let e=n.previous;if(e===Jf)n.previous=r;else for(let s in r)e[s]=r[s];n.current=null,this.ngOnChanges(r)}}function vz(n,r,e,s,u){let i=this.declaredInputs[s],E=qA(n)||bz(n,{previous:Jf,current:null}),L=E.current||(E.current={}),j=E.previous,Y=j[i];L[i]=new FC(Y&&Y.currentValue,e,j===Jf),HA(n,r,u,e)}var WA="__ngSimpleChanges__";function qA(n){return n[WA]||null}function bz(n,r){return n[WA]=r}var jS=null;var lr=function(n,r=null,e){jS?.(n,r,e)},ZA="svg",xz="math";function Hc(n){for(;Array.isArray(n);)n=n[id];return n}function XA(n,r){return Hc(r[n])}function qc(n,r){return Hc(r[n.index])}function SE(n,r){return n.data[r]}function wz(n,r){return n[r]}function Gc(n,r){let e=r[n];return _h(e)?e:e[id]}function Cz(n){return(n[zn]&4)===4}function AE(n){return(n[zn]&128)===128}function Ez(n){return rd(n[Go])}function w0(n,r){return r==null?null:n[r]}function YA(n){n[Qm]=0}function KA(n){n[zn]&1024||(n[zn]|=1024,AE(n)&&hg(n))}function Dz(n,r){for(;n>0;)r=r[ug],n--;return r}function Y0(n){return!!(n[zn]&9216||n[qa]?.dirty)}function NC(n){n[bh].changeDetectionScheduler?.notify(8),n[zn]&64&&(n[zn]|=1024),Y0(n)&&hg(n)}function hg(n){n[bh].changeDetectionScheduler?.notify(0);let r=rp(n);for(;r!==null&&!(r[zn]&8192||(r[zn]|=8192,!AE(r)));)r=rp(r)}function QA(n,r){if(R_(n))throw new Ht(911,!1);n[yh]===null&&(n[yh]=[]),n[yh].push(r)}function Mz(n,r){if(n[yh]===null)return;let e=n[yh].indexOf(r);e!==-1&&n[yh].splice(e,1)}function rp(n){let r=n[Go];return rd(r)?r[Go]:r}function JA(n){return n[v0]??=[]}function ek(n){return n.cleanup??=[]}function Tz(n,r,e,s){let u=JA(r);u.push(e),n.firstCreatePass&&ek(n).push(s,u.length-1)}var Zn={lFrame:dk(null),bindingsEnabled:!0,skipHydrationRootTNode:null};var zC=!1;function Iz(){return Zn.lFrame.elementDepthCount}function Sz(){Zn.lFrame.elementDepthCount++}function Az(){Zn.lFrame.elementDepthCount--}function tk(){return Zn.bindingsEnabled}function nk(){return Zn.skipHydrationRootTNode!==null}function kz(n){return Zn.skipHydrationRootTNode===n}function Rz(){Zn.skipHydrationRootTNode=null}function gi(){return Zn.lFrame.lView}function Wo(){return Zn.lFrame.tView}function wh(n){return Zn.lFrame.contextLView=n,n[ds]}function Ch(n){return Zn.lFrame.contextLView=null,n}function ga(){let n=ik();for(;n!==null&&n.type===64;)n=n.parent;return n}function ik(){return Zn.lFrame.currentTNode}function Pz(){let n=Zn.lFrame,r=n.currentTNode;return n.isParent?r:r.parent}function P_(n,r){let e=Zn.lFrame;e.currentTNode=n,e.isParent=r}function rk(){return Zn.lFrame.isParent}function ok(){Zn.lFrame.isParent=!1}function Oz(){return Zn.lFrame.contextLView}function sk(){return zC}function C0(n){let r=zC;return zC=n,r}function ak(){let n=Zn.lFrame,r=n.bindingRootIndex;return r===-1&&(r=n.bindingRootIndex=n.tView.bindingStartIndex),r}function Lz(){return Zn.lFrame.bindingIndex}function Fz(n){return Zn.lFrame.bindingIndex=n}function O_(){return Zn.lFrame.bindingIndex++}function kE(n){let r=Zn.lFrame,e=r.bindingIndex;return r.bindingIndex=r.bindingIndex+n,e}function Nz(){return Zn.lFrame.inI18n}function zz(n,r){let e=Zn.lFrame;e.bindingIndex=e.bindingRootIndex=n,BC(r)}function Bz(){return Zn.lFrame.currentDirectiveIndex}function BC(n){Zn.lFrame.currentDirectiveIndex=n}function jz(n){let r=Zn.lFrame.currentDirectiveIndex;return r===-1?null:n[r]}function lk(){return Zn.lFrame.currentQueryIndex}function RE(n){Zn.lFrame.currentQueryIndex=n}function Vz(n){let r=n[ni];return r.type===2?r.declTNode:r.type===1?n[Us]:null}function ck(n,r,e){if(e&ti.SkipSelf){let u=r,i=n;for(;u=u.parent,u===null&&!(e&ti.Host);)if(u=Vz(i),u===null||(i=i[ug],u.type&10))break;if(u===null)return!1;r=u,n=i}let s=Zn.lFrame=uk();return s.currentTNode=r,s.lView=n,!0}function PE(n){let r=uk(),e=n[ni];Zn.lFrame=r,r.currentTNode=e.firstChild,r.lView=n,r.tView=e,r.contextLView=n,r.bindingIndex=e.bindingStartIndex,r.inI18n=!1}function uk(){let n=Zn.lFrame,r=n===null?null:n.child;return r===null?dk(n):r}function dk(n){let r={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return n!==null&&(n.child=r),r}function hk(){let n=Zn.lFrame;return Zn.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}var fk=hk;function OE(){let n=hk();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function Uz(n){return(Zn.lFrame.contextLView=Dz(n,Zn.lFrame.contextLView))[ds]}function Eh(){return Zn.lFrame.selectedIndex}function op(n){Zn.lFrame.selectedIndex=n}function LE(){let n=Zn.lFrame;return SE(n.tView,n.selectedIndex)}function pk(){Zn.lFrame.currentNamespace=ZA}function $z(){return Zn.lFrame.currentNamespace}var mk=!0;function FE(){return mk}function NE(n){mk=n}function Hz(n,r,e){let{ngOnChanges:s,ngOnInit:u,ngDoCheck:i}=r.type.prototype;if(s){let E=GA(r);(e.preOrderHooks??=[]).push(n,E),(e.preOrderCheckHooks??=[]).push(n,E)}u&&(e.preOrderHooks??=[]).push(0-n,u),i&&((e.preOrderHooks??=[]).push(n,i),(e.preOrderCheckHooks??=[]).push(n,i))}function gk(n,r){for(let e=r.directiveStart,s=r.directiveEnd;e<s;e++){let i=n.data[e].type.prototype,{ngAfterContentInit:E,ngAfterContentChecked:L,ngAfterViewInit:j,ngAfterViewChecked:Y,ngOnDestroy:oe}=i;E&&(n.contentHooks??=[]).push(-e,E),L&&((n.contentHooks??=[]).push(e,L),(n.contentCheckHooks??=[]).push(e,L)),j&&(n.viewHooks??=[]).push(-e,j),Y&&((n.viewHooks??=[]).push(e,Y),(n.viewCheckHooks??=[]).push(e,Y)),oe!=null&&(n.destroyHooks??=[]).push(e,oe)}}function u0(n,r,e){yk(n,r,3,e)}function d0(n,r,e,s){(n[zn]&3)===e&&yk(n,r,e,s)}function vC(n,r){let e=n[zn];(e&3)===r&&(e&=16383,e+=1,n[zn]=e)}function yk(n,r,e,s){let u=s!==void 0?n[Qm]&65535:0,i=s??-1,E=r.length-1,L=0;for(let j=u;j<E;j++)if(typeof r[j+1]=="number"){if(L=r[j],s!=null&&L>=s)break}else r[j]<0&&(n[Qm]+=65536),(L<i||i==-1)&&(Gz(n,e,r,j),n[Qm]=(n[Qm]&4294901760)+j+2),j++}function VS(n,r){lr(4,n,r);let e=si(null);try{r.call(n)}finally{si(e),lr(5,n,r)}}function Gz(n,r,e,s){let u=e[s]<0,i=e[s+1],E=u?-e[s]:e[s],L=n[E];u?n[zn]>>14<n[Qm]>>16&&(n[zn]&3)===r&&(n[zn]+=16384,VS(L,i)):VS(L,i)}var ng=-1,sp=class{factory;injectImpl;resolving=!1;canSeeViewProviders;multi;componentProviders;index;providerFactory;constructor(r,e,s){this.factory=r,this.canSeeViewProviders=e,this.injectImpl=s}};function Wz(n){return(n.flags&8)!==0}function qz(n){return(n.flags&16)!==0}function Zz(n,r,e){let s=0;for(;s<e.length;){let u=e[s];if(typeof u=="number"){if(u!==0)break;s++;let i=e[s++],E=e[s++],L=e[s++];n.setAttribute(r,E,L,i)}else{let i=u,E=e[++s];Xz(i)?n.setProperty(r,i,E):n.setAttribute(r,i,E),s++}}return s}function _k(n){return n===3||n===4||n===6}function Xz(n){return n.charCodeAt(0)===64}function C_(n,r){if(!(r===null||r.length===0))if(n===null||n.length===0)n=r.slice();else{let e=-1;for(let s=0;s<r.length;s++){let u=r[s];typeof u=="number"?e=u:e===0||(e===-1||e===2?US(n,e,u,null,r[++s]):US(n,e,u,null,null))}}return n}function US(n,r,e,s,u){let i=0,E=n.length;if(r===-1)E=-1;else for(;i<n.length;){let L=n[i++];if(typeof L=="number"){if(L===r){E=-1;break}else if(L>r){E=i-1;break}}}for(;i<n.length;){let L=n[i];if(typeof L=="number")break;if(L===e){u!==null&&(n[i+1]=u);return}i++,u!==null&&i++}E!==-1&&(n.splice(E,0,r),i=E+1),n.splice(i++,0,e),u!==null&&n.splice(i++,0,u)}var bC={},jC=class{injector;parentInjector;constructor(r,e){this.injector=r,this.parentInjector=e}get(r,e,s){s=H0(s);let u=this.injector.get(r,bC,s);return u!==bC||e===bC?u:this.parentInjector.get(r,e,s)}};function vk(n){return n!==ng}function E0(n){return n&32767}function Yz(n){return n>>16}function D0(n,r){let e=Yz(n),s=r;for(;e>0;)s=s[ug],e--;return s}var VC=!0;function $S(n){let r=VC;return VC=n,r}var Kz=256,bk=Kz-1,xk=5,Qz=0,Uc={};function Jz(n,r,e){let s;typeof e=="string"?s=e.charCodeAt(0)||0:e.hasOwnProperty(g_)&&(s=e[g_]),s==null&&(s=e[g_]=Qz++);let u=s&bk,i=1<<u;r.data[n+(u>>xk)]|=i}function M0(n,r){let e=wk(n,r);if(e!==-1)return e;let s=r[ni];s.firstCreatePass&&(n.injectorIndex=r.length,xC(s.data,n),xC(r,null),xC(s.blueprint,null));let u=zE(n,r),i=n.injectorIndex;if(vk(u)){let E=E0(u),L=D0(u,r),j=L[ni].data;for(let Y=0;Y<8;Y++)r[i+Y]=L[E+Y]|j[E+Y]}return r[i+8]=u,i}function xC(n,r){n.push(0,0,0,0,0,0,0,0,r)}function wk(n,r){return n.injectorIndex===-1||n.parent&&n.parent.injectorIndex===n.injectorIndex||r[n.injectorIndex+8]===null?-1:n.injectorIndex}function zE(n,r){if(n.parent&&n.parent.injectorIndex!==-1)return n.parent.injectorIndex;let e=0,s=null,u=r;for(;u!==null;){if(s=Tk(u),s===null)return ng;if(e++,u=u[ug],s.injectorIndex!==-1)return s.injectorIndex|e<<16}return ng}function UC(n,r,e){Jz(n,r,e)}function eB(n,r){if(r==="class")return n.classes;if(r==="style")return n.styles;let e=n.attrs;if(e){let s=e.length,u=0;for(;u<s;){let i=e[u];if(_k(i))break;if(i===0)u=u+2;else if(typeof i=="number")for(u++;u<s&&typeof e[u]=="string";)u++;else{if(i===r)return e[u+1];u=u+2}}}return null}function Ck(n,r,e){if(e&ti.Optional||n!==void 0)return n;DE(r,"NodeInjector")}function Ek(n,r,e,s){if(e&ti.Optional&&s===void 0&&(s=null),(e&(ti.Self|ti.Host))===0){let u=n[x_],i=Wa(void 0);try{return u?u.get(r,s,e&ti.Optional):kA(r,s,e&ti.Optional)}finally{Wa(i)}}return Ck(s,r,e)}function Dk(n,r,e,s=ti.Default,u){if(n!==null){if(r[zn]&2048&&!(s&ti.Self)){let E=rB(n,r,e,s,Uc);if(E!==Uc)return E}let i=Mk(n,r,e,s,Uc);if(i!==Uc)return i}return Ek(r,e,s,u)}function Mk(n,r,e,s,u){let i=nB(e);if(typeof i=="function"){if(!ck(r,n,s))return s&ti.Host?Ck(u,e,s):Ek(r,e,s,u);try{let E;if(E=i(s),E==null&&!(s&ti.Optional))DE(e);else return E}finally{fk()}}else if(typeof i=="number"){let E=null,L=wk(n,r),j=ng,Y=s&ti.Host?r[Za][Us]:null;for((L===-1||s&ti.SkipSelf)&&(j=L===-1?zE(n,r):r[L+8],j===ng||!GS(s,!1)?L=-1:(E=r[ni],L=E0(j),r=D0(j,r)));L!==-1;){let oe=r[ni];if(HS(i,L,oe.data)){let Ee=tB(L,r,e,E,s,Y);if(Ee!==Uc)return Ee}j=r[L+8],j!==ng&&GS(s,r[ni].data[L+8]===Y)&&HS(i,L,r)?(E=oe,L=E0(j),r=D0(j,r)):L=-1}}return u}function tB(n,r,e,s,u,i){let E=r[ni],L=E.data[n+8],j=s==null?dg(L)&&VC:s!=E&&(L.type&3)!==0,Y=u&ti.Host&&i===L,oe=h0(L,E,e,j,Y);return oe!==null?E_(r,E,oe,L):Uc}function h0(n,r,e,s,u){let i=n.providerIndexes,E=r.data,L=i&1048575,j=n.directiveStart,Y=n.directiveEnd,oe=i>>20,Ee=s?L:L+oe,Ye=u?L+oe:Y;for(let Ne=Ee;Ne<Ye;Ne++){let ct=E[Ne];if(Ne<j&&e===ct||Ne>=j&&ct.type===e)return Ne}if(u){let Ne=E[j];if(Ne&&$c(Ne)&&Ne.type===e)return j}return null}function E_(n,r,e,s){let u=n[e],i=r.data;if(u instanceof sp){let E=u;E.resolving&&SA($N(i[e]));let L=$S(E.canSeeViewProviders);E.resolving=!0;let j,Y=E.injectImpl?Wa(E.injectImpl):null,oe=ck(n,s,ti.Default);try{u=n[e]=E.factory(void 0,i,n,s),r.firstCreatePass&&e>=s.directiveStart&&Hz(e,i[e],r)}finally{Y!==null&&Wa(Y),$S(L),E.resolving=!1,fk()}}return u}function nB(n){if(typeof n=="string")return n.charCodeAt(0)||0;let r=n.hasOwnProperty(g_)?n[g_]:void 0;return typeof r=="number"?r>=0?r&bk:iB:r}function HS(n,r,e){let s=1<<n;return!!(e[r+(n>>xk)]&s)}function GS(n,r){return!(n&ti.Self)&&!(n&ti.Host&&r)}var Qf=class{_tNode;_lView;constructor(r,e){this._tNode=r,this._lView=e}get(r,e,s){return Dk(this._tNode,this._lView,r,H0(s),e)}};function iB(){return new Qf(ga(),gi())}function ya(n){return S_(()=>{let r=n.prototype.constructor,e=r[p0]||$C(r),s=Object.prototype,u=Object.getPrototypeOf(n.prototype).constructor;for(;u&&u!==s;){let i=u[p0]||$C(u);if(i&&i!==e)return i;u=Object.getPrototypeOf(u)}return i=>new i})}function $C(n){return EA(n)?()=>{let r=$C(us(n));return r&&r()}:ig(n)}function rB(n,r,e,s,u){let i=n,E=r;for(;i!==null&&E!==null&&E[zn]&2048&&!x0(E);){let L=Mk(i,E,e,s|ti.Self,Uc);if(L!==Uc)return L;let j=i.parent;if(!j){let Y=E[VA];if(Y){let oe=Y.get(e,Uc,s);if(oe!==Uc)return oe}j=Tk(E),E=E[ug]}i=j}return u}function Tk(n){let r=n[ni],e=r.type;return e===2?r.declTNode:e===1?n[Us]:null}function BE(n){return eB(ga(),n)}function WS(n,r=null,e=null,s){let u=Ik(n,r,e,s);return u.resolveInjectorInitializers(),u}function Ik(n,r=null,e=null,s,u=new Set){let i=[e||Ls,sz(n)];return s=s||(typeof n=="object"?void 0:Fs(n)),new v_(i,r||Z0(),s||null,u)}var Jn=class n{static THROW_IF_NOT_FOUND=Kf;static NULL=new _0;static create(r,e){if(Array.isArray(r))return WS({name:""},e,r,"");{let s=r.name??"";return WS({name:s},r.parent,r.providers,s)}}static \u0275prov=xt({token:n,providedIn:"any",factory:()=>St(PA)});static __NG_ELEMENT_ID__=-1};var sg=class{attributeName;constructor(r){this.attributeName=r}__NG_ELEMENT_ID__=()=>BE(this.attributeName);toString(){return`HostAttributeToken ${this.attributeName}`}},oB=new dt("");oB.__NG_ELEMENT_ID__=n=>{let r=ga();if(r===null)throw new Ht(204,!1);if(r.type&2)return r.value;if(n&ti.Optional)return null;throw new Ht(204,!1)};var Sk=!1,Zc=(()=>{class n{static __NG_ELEMENT_ID__=sB;static __NG_ENV_ID__=e=>e}return n})(),T0=class extends Zc{_lView;constructor(r){super(),this._lView=r}onDestroy(r){return QA(this._lView,r),()=>Mz(this._lView,r)}};function sB(){return new T0(gi())}var ap=class{},jE=new dt("",{providedIn:"root",factory:()=>!1});var Ak=new dt(""),kk=new dt(""),od=(()=>{class n{taskId=0;pendingTasks=new Set;get _hasPendingTasks(){return this.hasPendingTasks.value}hasPendingTasks=new Ir(!1);add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);let e=this.taskId++;return this.pendingTasks.add(e),e}has(e){return this.pendingTasks.has(e)}remove(e){this.pendingTasks.delete(e),this.pendingTasks.size===0&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}static \u0275prov=xt({token:n,providedIn:"root",factory:()=>new n})}return n})();var HC=class extends _n{__isAsync;destroyRef=void 0;pendingTasks=void 0;constructor(r=!1){super(),this.__isAsync=r,jA()&&(this.destroyRef=we(Zc,{optional:!0})??void 0,this.pendingTasks=we(od,{optional:!0})??void 0)}emit(r){let e=si(null);try{super.next(r)}finally{si(e)}}subscribe(r,e,s){let u=r,i=e||(()=>null),E=s;if(r&&typeof r=="object"){let j=r;u=j.next?.bind(j),i=j.error?.bind(j),E=j.complete?.bind(j)}this.__isAsync&&(i=this.wrapInTimeout(i),u&&(u=this.wrapInTimeout(u)),E&&(E=this.wrapInTimeout(E)));let L=super.subscribe({next:u,error:i,complete:E});return r instanceof Oi&&r.add(L),L}wrapInTimeout(r){return e=>{let s=this.pendingTasks?.add();setTimeout(()=>{r(e),s!==void 0&&this.pendingTasks?.remove(s)})}}},Dt=HC;function D_(...n){}function Rk(n){let r,e;function s(){n=D_;try{e!==void 0&&typeof cancelAnimationFrame=="function"&&cancelAnimationFrame(e),r!==void 0&&clearTimeout(r)}catch{}}return r=setTimeout(()=>{n(),s()}),typeof requestAnimationFrame=="function"&&(e=requestAnimationFrame(()=>{n(),s()})),()=>s()}function qS(n){return queueMicrotask(()=>n()),()=>{n=D_}}var VE="isAngularZone",I0=VE+"_ID",aB=0,ln=class n{hasPendingMacrotasks=!1;hasPendingMicrotasks=!1;isStable=!0;onUnstable=new Dt(!1);onMicrotaskEmpty=new Dt(!1);onStable=new Dt(!1);onError=new Dt(!1);constructor(r){let{enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:s=!1,shouldCoalesceRunChangeDetection:u=!1,scheduleInRootZone:i=Sk}=r;if(typeof Zone>"u")throw new Ht(908,!1);Zone.assertZonePatched();let E=this;E._nesting=0,E._outer=E._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(E._inner=E._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(E._inner=E._inner.fork(Zone.longStackTraceZoneSpec)),E.shouldCoalesceEventChangeDetection=!u&&s,E.shouldCoalesceRunChangeDetection=u,E.callbackScheduled=!1,E.scheduleInRootZone=i,uB(E)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get(VE)===!0}static assertInAngularZone(){if(!n.isInAngularZone())throw new Ht(909,!1)}static assertNotInAngularZone(){if(n.isInAngularZone())throw new Ht(909,!1)}run(r,e,s){return this._inner.run(r,e,s)}runTask(r,e,s,u){let i=this._inner,E=i.scheduleEventTask("NgZoneEvent: "+u,r,lB,D_,D_);try{return i.runTask(E,e,s)}finally{i.cancelTask(E)}}runGuarded(r,e,s){return this._inner.runGuarded(r,e,s)}runOutsideAngular(r){return this._outer.run(r)}},lB={};function UE(n){if(n._nesting==0&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function cB(n){if(n.isCheckStableRunning||n.callbackScheduled)return;n.callbackScheduled=!0;function r(){Rk(()=>{n.callbackScheduled=!1,GC(n),n.isCheckStableRunning=!0,UE(n),n.isCheckStableRunning=!1})}n.scheduleInRootZone?Zone.root.run(()=>{r()}):n._outer.run(()=>{r()}),GC(n)}function uB(n){let r=()=>{cB(n)},e=aB++;n._inner=n._inner.fork({name:"angular",properties:{[VE]:!0,[I0]:e,[I0+e]:!0},onInvokeTask:(s,u,i,E,L,j)=>{if(dB(j))return s.invokeTask(i,E,L,j);try{return ZS(n),s.invokeTask(i,E,L,j)}finally{(n.shouldCoalesceEventChangeDetection&&E.type==="eventTask"||n.shouldCoalesceRunChangeDetection)&&r(),XS(n)}},onInvoke:(s,u,i,E,L,j,Y)=>{try{return ZS(n),s.invoke(i,E,L,j,Y)}finally{n.shouldCoalesceRunChangeDetection&&!n.callbackScheduled&&!hB(j)&&r(),XS(n)}},onHasTask:(s,u,i,E)=>{s.hasTask(i,E),u===i&&(E.change=="microTask"?(n._hasPendingMicrotasks=E.microTask,GC(n),UE(n)):E.change=="macroTask"&&(n.hasPendingMacrotasks=E.macroTask))},onHandleError:(s,u,i,E)=>(s.handleError(i,E),n.runOutsideAngular(()=>n.onError.emit(E)),!1)})}function GC(n){n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&n.callbackScheduled===!0?n.hasPendingMicrotasks=!0:n.hasPendingMicrotasks=!1}function ZS(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function XS(n){n._nesting--,UE(n)}var S0=class{hasPendingMicrotasks=!1;hasPendingMacrotasks=!1;isStable=!0;onUnstable=new Dt;onMicrotaskEmpty=new Dt;onStable=new Dt;onError=new Dt;run(r,e,s){return r.apply(e,s)}runGuarded(r,e,s){return r.apply(e,s)}runOutsideAngular(r){return r()}runTask(r,e,s,u){return r.apply(e,s)}};function dB(n){return Pk(n,"__ignore_ng_zone__")}function hB(n){return Pk(n,"__scheduler_tick__")}function Pk(n,r){return!Array.isArray(n)||n.length!==1?!1:n[0]?.data?.[r]===!0}function fB(n="zone.js",r){return n==="noop"?new S0:n==="zone.js"?new ln(r):n}var Bs=class{_console=console;handleError(r){this._console.error("ERROR",r)}},pB=new dt("",{providedIn:"root",factory:()=>{let n=we(ln),r=we(Bs);return e=>n.runOutsideAngular(()=>r.handleError(e))}}),WC=class{destroyed=!1;listeners=null;errorHandler=we(Bs,{optional:!0});destroyRef=we(Zc);constructor(){this.destroyRef.onDestroy(()=>{this.destroyed=!0,this.listeners=null})}subscribe(r){if(this.destroyed)throw new Ht(953,!1);return(this.listeners??=[]).push(r),{unsubscribe:()=>{let e=this.listeners?.indexOf(r);e!==void 0&&e!==-1&&this.listeners?.splice(e,1)}}}emit(r){if(this.destroyed){console.warn(I_(953,!1));return}if(this.listeners===null)return;let e=si(null);try{for(let s of this.listeners)try{s(r)}catch(u){this.errorHandler?.handleError(u)}}finally{si(e)}}};function K0(n){return new WC}function YS(n,r){return CA(n,r)}function mB(n){return CA(wA,n)}var L_=(YS.required=mB,YS);function gB(){return fg(ga(),gi())}function fg(n,r){return new yi(qc(n,r))}var yi=(()=>{class n{nativeElement;constructor(e){this.nativeElement=e}static __NG_ELEMENT_ID__=gB}return n})();function yB(n){return n instanceof yi?n.nativeElement:n}function fs(n,r){let e=rS(n),s=e[Ga];return r?.equal&&(s.equal=r.equal),e.set=u=>Ab(s,u),e.update=u=>oS(s,u),e.asReadonly=_B.bind(e),e}function _B(){let n=this[Ga];if(n.readonlyFn===void 0){let r=()=>this();r[Ga]=n,n.readonlyFn=r}return n.readonlyFn}function vB(){return this._results[Symbol.iterator]()}var A0=class{_emitDistinctChangesOnly;dirty=!0;_onDirty=void 0;_results=[];_changesDetected=!1;_changes=void 0;length=0;first=void 0;last=void 0;get changes(){return this._changes??=new _n}constructor(r=!1){this._emitDistinctChangesOnly=r}get(r){return this._results[r]}map(r){return this._results.map(r)}filter(r){return this._results.filter(r)}find(r){return this._results.find(r)}reduce(r,e){return this._results.reduce(r,e)}forEach(r){this._results.forEach(r)}some(r){return this._results.some(r)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(r,e){this.dirty=!1;let s=ez(r);(this._changesDetected=!JN(this._results,s,e))&&(this._results=s,this.length=s.length,this.last=s[this.length-1],this.first=s[0])}notifyOnChanges(){this._changes!==void 0&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.next(this)}onDirty(r){this._onDirty=r}setDirty(){this.dirty=!0,this._onDirty?.()}destroy(){this._changes!==void 0&&(this._changes.complete(),this._changes.unsubscribe())}[Symbol.iterator]=vB};function Ok(n){return(n.flags&128)===128}var Lk=function(n){return n[n.OnPush=0]="OnPush",n[n.Default=1]="Default",n}(Lk||{}),Fk=new Map,bB=0;function xB(){return bB++}function wB(n){Fk.set(n[X0],n)}function qC(n){Fk.delete(n[X0])}var KS="__ngContext__";function F_(n,r){_h(r)?(n[KS]=r[X0],wB(r)):n[KS]=r}function Nk(n){return Bk(n[w_])}function zk(n){return Bk(n[Xl])}function Bk(n){for(;n!==null&&!rd(n);)n=n[Xl];return n}var ZC;function jk(n){ZC=n}function CB(){if(ZC!==void 0)return ZC;if(typeof document<"u")return document;throw new Ht(210,!1)}var pg=new dt("",{providedIn:"root",factory:()=>EB}),EB="ng",$E=new dt(""),sd=new dt("",{providedIn:"platform",factory:()=>"unknown"});var _a=new dt(""),N_=new dt("",{providedIn:"root",factory:()=>CB().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});var DB="h",MB="b";var Vk=!1,TB=new dt("",{providedIn:"root",factory:()=>Vk});var HE=function(n){return n[n.CHANGE_DETECTION=0]="CHANGE_DETECTION",n[n.AFTER_NEXT_RENDER=1]="AFTER_NEXT_RENDER",n}(HE||{}),mg=new dt(""),QS=new Set;function gg(n){QS.has(n)||(QS.add(n),performance?.mark?.("mark_feature_usage",{detail:{feature:n}}))}var GE=(()=>{class n{view;node;constructor(e,s){this.view=e,this.node=s}static __NG_ELEMENT_ID__=IB}return n})();function IB(){return new GE(gi(),ga())}var Jm=function(n){return n[n.EarlyRead=0]="EarlyRead",n[n.Write=1]="Write",n[n.MixedReadWrite=2]="MixedReadWrite",n[n.Read=3]="Read",n}(Jm||{}),Uk=(()=>{class n{impl=null;execute(){this.impl?.execute()}static \u0275prov=xt({token:n,providedIn:"root",factory:()=>new n})}return n})(),SB=[Jm.EarlyRead,Jm.Write,Jm.MixedReadWrite,Jm.Read],AB=(()=>{class n{ngZone=we(ln);scheduler=we(ap);errorHandler=we(Bs,{optional:!0});sequences=new Set;deferredRegistrations=new Set;executing=!1;constructor(){we(mg,{optional:!0})}execute(){let e=this.sequences.size>0;e&&lr(16),this.executing=!0;for(let s of SB)for(let u of this.sequences)if(!(u.erroredOrDestroyed||!u.hooks[s]))try{u.pipelinedValue=this.ngZone.runOutsideAngular(()=>this.maybeTrace(()=>{let i=u.hooks[s];return i(u.pipelinedValue)},u.snapshot))}catch(i){u.erroredOrDestroyed=!0,this.errorHandler?.handleError(i)}this.executing=!1;for(let s of this.sequences)s.afterRun(),s.once&&(this.sequences.delete(s),s.destroy());for(let s of this.deferredRegistrations)this.sequences.add(s);this.deferredRegistrations.size>0&&this.scheduler.notify(7),this.deferredRegistrations.clear(),e&&lr(17)}register(e){let{view:s}=e;s!==void 0?((s[tg]??=[]).push(e),hg(s),s[zn]|=8192):this.executing?this.deferredRegistrations.add(e):this.addSequence(e)}addSequence(e){this.sequences.add(e),this.scheduler.notify(7)}unregister(e){this.executing&&this.sequences.has(e)?(e.erroredOrDestroyed=!0,e.pipelinedValue=void 0,e.once=!0):(this.sequences.delete(e),this.deferredRegistrations.delete(e))}maybeTrace(e,s){return s?s.run(HE.AFTER_NEXT_RENDER,e):e()}static \u0275prov=xt({token:n,providedIn:"root",factory:()=>new n})}return n})(),XC=class{impl;hooks;view;once;snapshot;erroredOrDestroyed=!1;pipelinedValue=void 0;unregisterOnDestroy;constructor(r,e,s,u,i,E=null){this.impl=r,this.hooks=e,this.view=s,this.once=u,this.snapshot=E,this.unregisterOnDestroy=i?.onDestroy(()=>this.destroy())}afterRun(){this.erroredOrDestroyed=!1,this.pipelinedValue=void 0,this.snapshot?.dispose(),this.snapshot=null}destroy(){this.impl.unregister(this),this.unregisterOnDestroy?.();let r=this.view?.[tg];r&&(this.view[tg]=r.filter(e=>e!==this))}};function z_(n,r){!r?.injector&&cg(z_);let e=r?.injector??we(Jn);return gg("NgAfterRender"),$k(n,e,r,!1)}function Xc(n,r){!r?.injector&&cg(Xc);let e=r?.injector??we(Jn);return gg("NgAfterNextRender"),$k(n,e,r,!0)}function kB(n,r){if(n instanceof Function){let e=[void 0,void 0,void 0,void 0];return e[r]=n,e}else return[n.earlyRead,n.write,n.mixedReadWrite,n.read]}function $k(n,r,e,s){let u=r.get(Uk);u.impl??=r.get(AB);let i=r.get(mg,null,{optional:!0}),E=e?.phase??Jm.MixedReadWrite,L=e?.manualCleanup!==!0?r.get(Zc):null,j=r.get(GE,null,{optional:!0}),Y=new XC(u.impl,kB(n,E),j?.view,s,L,i?.snapshot(null));return u.impl.register(Y),Y}var RB=()=>null;function Hk(n,r,e=!1){return RB(n,r,e)}function Gk(n,r){let e=n.contentQueries;if(e!==null){let s=si(null);try{for(let u=0;u<e.length;u+=2){let i=e[u],E=e[u+1];if(E!==-1){let L=n.data[E];RE(i),L.contentQueries(2,r[E],E)}}}finally{si(s)}}}function YC(n,r,e){RE(0);let s=si(null);try{r(n,e)}finally{si(s)}}function Wk(n,r,e){if($A(r)){let s=si(null);try{let u=r.directiveStart,i=r.directiveEnd;for(let E=u;E<i;E++){let L=n.data[E];if(L.contentQueries){let j=e[E];L.contentQueries(1,j,E)}}}finally{si(s)}}}var Wc=function(n){return n[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",n}(Wc||{}),o0;function PB(){if(o0===void 0&&(o0=null,Yl.trustedTypes))try{o0=Yl.trustedTypes.createPolicy("angular",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch{}return o0}function Q0(n){return PB()?.createHTML(n)||n}var Ju=class{changingThisBreaksApplicationSecurity;constructor(r){this.changingThisBreaksApplicationSecurity=r}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${xA})`}},KC=class extends Ju{getTypeName(){return"HTML"}},QC=class extends Ju{getTypeName(){return"Style"}},JC=class extends Ju{getTypeName(){return"Script"}},eE=class extends Ju{getTypeName(){return"URL"}},tE=class extends Ju{getTypeName(){return"ResourceURL"}};function Yc(n){return n instanceof Ju?n.changingThisBreaksApplicationSecurity:n}function yg(n,r){let e=OB(n);if(e!=null&&e!==r){if(e==="ResourceURL"&&r==="URL")return!0;throw new Error(`Required a safe ${r}, got a ${e} (see ${xA})`)}return e===r}function OB(n){return n instanceof Ju&&n.getTypeName()||null}function qk(n){return new KC(n)}function Zk(n){return new QC(n)}function Xk(n){return new JC(n)}function Yk(n){return new eE(n)}function Kk(n){return new tE(n)}function LB(n){let r=new iE(n);return FB()?new nE(r):r}var nE=class{inertDocumentHelper;constructor(r){this.inertDocumentHelper=r}getInertBodyElement(r){r="<body><remove></remove>"+r;try{let e=new window.DOMParser().parseFromString(Q0(r),"text/html").body;return e===null?this.inertDocumentHelper.getInertBodyElement(r):(e.firstChild?.remove(),e)}catch{return null}}},iE=class{defaultDoc;inertDocument;constructor(r){this.defaultDoc=r,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert")}getInertBodyElement(r){let e=this.inertDocument.createElement("template");return e.innerHTML=Q0(r),e}};function FB(){try{return!!new window.DOMParser().parseFromString(Q0(""),"text/html")}catch{return!1}}var NB=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function WE(n){return n=String(n),n.match(NB)?n:"unsafe:"+n}function ad(n){let r={};for(let e of n.split(","))r[e]=!0;return r}function B_(...n){let r={};for(let e of n)for(let s in e)e.hasOwnProperty(s)&&(r[s]=!0);return r}var Qk=ad("area,br,col,hr,img,wbr"),Jk=ad("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),eR=ad("rp,rt"),zB=B_(eR,Jk),BB=B_(Jk,ad("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),jB=B_(eR,ad("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),JS=B_(Qk,BB,jB,zB),tR=ad("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),VB=ad("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,srcset,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),UB=ad("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext"),$B=B_(tR,VB,UB),HB=ad("script,style,template"),rE=class{sanitizedSomething=!1;buf=[];sanitizeChildren(r){let e=r.firstChild,s=!0,u=[];for(;e;){if(e.nodeType===Node.ELEMENT_NODE?s=this.startElement(e):e.nodeType===Node.TEXT_NODE?this.chars(e.nodeValue):this.sanitizedSomething=!0,s&&e.firstChild){u.push(e),e=qB(e);continue}for(;e;){e.nodeType===Node.ELEMENT_NODE&&this.endElement(e);let i=WB(e);if(i){e=i;break}e=u.pop()}}return this.buf.join("")}startElement(r){let e=eA(r).toLowerCase();if(!JS.hasOwnProperty(e))return this.sanitizedSomething=!0,!HB.hasOwnProperty(e);this.buf.push("<"),this.buf.push(e);let s=r.attributes;for(let u=0;u<s.length;u++){let i=s.item(u),E=i.name,L=E.toLowerCase();if(!$B.hasOwnProperty(L)){this.sanitizedSomething=!0;continue}let j=i.value;tR[L]&&(j=WE(j)),this.buf.push(" ",E,'="',tA(j),'"')}return this.buf.push(">"),!0}endElement(r){let e=eA(r).toLowerCase();JS.hasOwnProperty(e)&&!Qk.hasOwnProperty(e)&&(this.buf.push("</"),this.buf.push(e),this.buf.push(">"))}chars(r){this.buf.push(tA(r))}};function GB(n,r){return(n.compareDocumentPosition(r)&Node.DOCUMENT_POSITION_CONTAINED_BY)!==Node.DOCUMENT_POSITION_CONTAINED_BY}function WB(n){let r=n.nextSibling;if(r&&n!==r.previousSibling)throw nR(r);return r}function qB(n){let r=n.firstChild;if(r&&GB(n,r))throw nR(r);return r}function eA(n){let r=n.nodeName;return typeof r=="string"?r:"FORM"}function nR(n){return new Error(`Failed to sanitize html because the element is clobbered: ${n.outerHTML}`)}var ZB=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,XB=/([^\#-~ |!])/g;function tA(n){return n.replace(/&/g,"&amp;").replace(ZB,function(r){let e=r.charCodeAt(0),s=r.charCodeAt(1);return"&#"+((e-55296)*1024+(s-56320)+65536)+";"}).replace(XB,function(r){return"&#"+r.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}var s0;function iR(n,r){let e=null;try{s0=s0||LB(n);let s=r?String(r):"";e=s0.getInertBodyElement(s);let u=5,i=s;do{if(u===0)throw new Error("Failed to sanitize html because the input is unstable");u--,s=i,i=e.innerHTML,e=s0.getInertBodyElement(s)}while(s!==i);let L=new rE().sanitizeChildren(nA(e)||e);return Q0(L)}finally{if(e){let s=nA(e)||e;for(;s.firstChild;)s.firstChild.remove()}}}function nA(n){return"content"in n&&YB(n)?n.content:null}function YB(n){return n.nodeType===Node.ELEMENT_NODE&&n.nodeName==="TEMPLATE"}var $s=function(n){return n[n.NONE=0]="NONE",n[n.HTML=1]="HTML",n[n.STYLE=2]="STYLE",n[n.SCRIPT=3]="SCRIPT",n[n.URL=4]="URL",n[n.RESOURCE_URL=5]="RESOURCE_URL",n}($s||{});function rR(n){return n instanceof Function?n():n}function KB(n,r,e){let s=n.length;for(;;){let u=n.indexOf(r,e);if(u===-1)return u;if(u===0||n.charCodeAt(u-1)<=32){let i=r.length;if(u+i===s||n.charCodeAt(u+i)<=32)return u}e=u+1}}var oR="ng-template";function QB(n,r,e,s){let u=0;if(s){for(;u<r.length&&typeof r[u]=="string";u+=2)if(r[u]==="class"&&KB(r[u+1].toLowerCase(),e,0)!==-1)return!0}else if(qE(n))return!1;if(u=r.indexOf(1,u),u>-1){let i;for(;++u<r.length&&typeof(i=r[u])=="string";)if(i.toLowerCase()===e)return!0}return!1}function qE(n){return n.type===4&&n.value!==oR}function JB(n,r,e){let s=n.type===4&&!e?oR:n.value;return r===s}function ej(n,r,e){let s=4,u=n.attrs,i=u!==null?ij(u):0,E=!1;for(let L=0;L<r.length;L++){let j=r[L];if(typeof j=="number"){if(!E&&!Zl(s)&&!Zl(j))return!1;if(E&&Zl(j))continue;E=!1,s=j|s&1;continue}if(!E)if(s&4){if(s=2|s&1,j!==""&&!JB(n,j,e)||j===""&&r.length===1){if(Zl(s))return!1;E=!0}}else if(s&8){if(u===null||!QB(n,u,j,e)){if(Zl(s))return!1;E=!0}}else{let Y=r[++L],oe=tj(j,u,qE(n),e);if(oe===-1){if(Zl(s))return!1;E=!0;continue}if(Y!==""){let Ee;if(oe>i?Ee="":Ee=u[oe+1].toLowerCase(),s&2&&Y!==Ee){if(Zl(s))return!1;E=!0}}}}return Zl(s)||E}function Zl(n){return(n&1)===0}function tj(n,r,e,s){if(r===null)return-1;let u=0;if(s||!e){let i=!1;for(;u<r.length;){let E=r[u];if(E===n)return u;if(E===3||E===6)i=!0;else if(E===1||E===2){let L=r[++u];for(;typeof L=="string";)L=r[++u];continue}else{if(E===4)break;if(E===0){u+=4;continue}}u+=i?1:2}return-1}else return rj(r,n)}function sR(n,r,e=!1){for(let s=0;s<r.length;s++)if(ej(n,r[s],e))return!0;return!1}function nj(n){let r=n.attrs;if(r!=null){let e=r.indexOf(5);if((e&1)===0)return r[e+1]}return null}function ij(n){for(let r=0;r<n.length;r++){let e=n[r];if(_k(e))return r}return n.length}function rj(n,r){let e=n.indexOf(4);if(e>-1)for(e++;e<n.length;){let s=n[e];if(typeof s=="number")return-1;if(s===r)return e;e++}return-1}function oj(n,r){e:for(let e=0;e<r.length;e++){let s=r[e];if(n.length===s.length){for(let u=0;u<n.length;u++)if(n[u]!==s[u])continue e;return!0}}return!1}function iA(n,r){return n?":not("+r.trim()+")":r}function sj(n){let r=n[0],e=1,s=2,u="",i=!1;for(;e<n.length;){let E=n[e];if(typeof E=="string")if(s&2){let L=n[++e];u+="["+E+(L.length>0?'="'+L+'"':"")+"]"}else s&8?u+="."+E:s&4&&(u+=" "+E);else u!==""&&!Zl(E)&&(r+=iA(i,u),u=""),s=E,i=i||!Zl(s);e++}return u!==""&&(r+=iA(i,u)),r}function aj(n){return n.map(sj).join(",")}function lj(n){let r=[],e=[],s=1,u=2;for(;s<n.length;){let i=n[s];if(typeof i=="string")u===2?i!==""&&r.push(i,n[++s]):u===8&&e.push(i);else{if(!Zl(u))break;u=i}s++}return e.length&&r.push(1,...e),r}var va={};function cj(n,r){return n.createText(r)}function uj(n,r,e){n.setValue(r,e)}function aR(n,r,e){return n.createElement(r,e)}function k0(n,r,e,s,u){n.insertBefore(r,e,s,u)}function lR(n,r,e){n.appendChild(r,e)}function rA(n,r,e,s,u){s!==null?k0(n,r,e,s,u):lR(n,r,e)}function dj(n,r,e){n.removeChild(null,r,e)}function hj(n,r,e){n.setAttribute(r,"style",e)}function fj(n,r,e){e===""?n.removeAttribute(r,"class"):n.setAttribute(r,"class",e)}function cR(n,r,e){let{mergedAttrs:s,classes:u,styles:i}=e;s!==null&&Zz(n,r,s),u!==null&&fj(n,r,u),i!==null&&hj(n,r,i)}function ZE(n,r,e,s,u,i,E,L,j,Y,oe){let Ee=zs+s,Ye=Ee+u,Ne=pj(Ee,Ye),ct=typeof Y=="function"?Y():Y;return Ne[ni]={type:n,blueprint:Ne,template:e,queries:null,viewQuery:L,declTNode:r,data:Ne.slice().fill(null,Ee),bindingStartIndex:Ee,expandoStartIndex:Ye,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof i=="function"?i():i,pipeRegistry:typeof E=="function"?E():E,firstChild:null,schemas:j,consts:ct,incompleteFirstPass:!1,ssrId:oe}}function pj(n,r){let e=[];for(let s=0;s<r;s++)e.push(s<n?null:va);return e}function mj(n){let r=n.tView;return r===null||r.incompleteFirstPass?n.tView=ZE(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts,n.id):r}function XE(n,r,e,s,u,i,E,L,j,Y,oe){let Ee=r.blueprint.slice();return Ee[id]=u,Ee[zn]=s|4|128|8|64|1024,(Y!==null||n&&n[zn]&2048)&&(Ee[zn]|=2048),YA(Ee),Ee[Go]=Ee[ug]=n,Ee[ds]=e,Ee[bh]=E||n&&n[bh],Ee[eo]=L||n&&n[eo],Ee[x_]=j||n&&n[x_]||null,Ee[Us]=i,Ee[X0]=xB(),Ee[b_]=oe,Ee[VA]=Y,Ee[Za]=r.type==2?n[Za]:Ee,Ee}function gj(n,r,e){let s=qc(r,n),u=mj(e),i=n[bh].rendererFactory,E=YE(n,XE(n,u,null,uR(e),s,r,null,i.createRenderer(s,e),null,null,null));return n[r.index]=E}function uR(n){let r=16;return n.signals?r=4096:n.onPush&&(r=64),r}function dR(n,r,e,s){if(e===0)return-1;let u=r.length;for(let i=0;i<e;i++)r.push(s),n.blueprint.push(s),n.data.push(null);return u}function YE(n,r){return n[w_]?n[BS][Xl]=r:n[w_]=r,n[BS]=r,r}function Xn(n=1){hR(Wo(),gi(),Eh()+n,!1)}function hR(n,r,e,s){if(!s)if((r[zn]&3)===3){let i=n.preOrderCheckHooks;i!==null&&u0(r,i,e)}else{let i=n.preOrderHooks;i!==null&&d0(r,i,0,e)}op(e)}var J0=function(n){return n[n.None=0]="None",n[n.SignalBased=1]="SignalBased",n[n.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",n}(J0||{});function oE(n,r,e,s){let u=si(null);try{let[i,E,L]=n.inputs[e],j=null;(E&J0.SignalBased)!==0&&(j=r[i][Ga]),j!==null&&j.transformFn!==void 0?s=j.transformFn(s):L!==null&&(s=L.call(r,s)),n.setInput!==null?n.setInput(r,j,s,e,i):HA(r,j,i,s)}finally{si(u)}}function fR(n,r,e,s,u){let i=Eh(),E=s&2;try{op(-1),E&&r.length>zs&&hR(n,r,zs,!1),lr(E?2:0,u),e(s,u)}finally{op(i),lr(E?3:1,u)}}function KE(n,r,e){wj(n,r,e),(e.flags&64)===64&&Cj(n,r,e)}function pR(n,r,e=qc){let s=r.localNames;if(s!==null){let u=r.index+1;for(let i=0;i<s.length;i+=2){let E=s[i+1],L=E===-1?e(r,n):n[E];n[u++]=L}}}function yj(n,r,e,s){let i=s.get(TB,Vk)||e===Wc.ShadowDom,E=n.selectRootElement(r,i);return _j(E),E}function _j(n){vj(n)}var vj=()=>null;function bj(n){return n==="class"?"className":n==="for"?"htmlFor":n==="formaction"?"formAction":n==="innerHtml"?"innerHTML":n==="readonly"?"readOnly":n==="tabindex"?"tabIndex":n}function mR(n,r,e,s,u,i,E,L){if(!L&&QE(r,n,e,s,u)){dg(r)&&xj(e,r.index);return}if(r.type&3){let j=qc(r,e);s=bj(s),u=E!=null?E(u,r.value||"",s):u,i.setProperty(j,s,u)}else r.type&12}function xj(n,r){let e=Gc(r,n);e[zn]&16||(e[zn]|=64)}function wj(n,r,e){let s=e.directiveStart,u=e.directiveEnd;dg(e)&&gj(r,e,n.data[s+e.componentOffset]),n.firstCreatePass||M0(e,r);let i=e.initialInputs;for(let E=s;E<u;E++){let L=n.data[E],j=E_(r,n,E,e);if(F_(j,r),i!==null&&Tj(r,E-s,j,L,e,i),$c(L)){let Y=Gc(e.index,r);Y[ds]=E_(r,n,E,e)}}}function Cj(n,r,e){let s=e.directiveStart,u=e.directiveEnd,i=e.index,E=Bz();try{op(i);for(let L=s;L<u;L++){let j=n.data[L],Y=r[L];BC(L),(j.hostBindings!==null||j.hostVars!==0||j.hostAttrs!==null)&&Ej(j,Y)}}finally{op(-1),BC(E)}}function Ej(n,r){n.hostBindings!==null&&n.hostBindings(1,r)}function gR(n,r){let e=n.directiveRegistry,s=null;if(e)for(let u=0;u<e.length;u++){let i=e[u];sR(r,i.selectors,!1)&&(s??=[],$c(i)?s.unshift(i):s.push(i))}return s}function Dj(n,r,e,s,u,i){let E=qc(n,r);Mj(r[eo],E,i,n.value,e,s,u)}function Mj(n,r,e,s,u,i,E){if(i==null)n.removeAttribute(r,u,e);else{let L=E==null?__(i):E(i,s||"",u);n.setAttribute(r,u,L,e)}}function Tj(n,r,e,s,u,i){let E=i[r];if(E!==null)for(let L=0;L<E.length;L+=2){let j=E[L],Y=E[L+1];oE(s,e,j,Y)}}function yR(n,r){let e=n[x_],s=e?e.get(Bs,null):null;s&&s.handleError(r)}function QE(n,r,e,s,u){let i=n.inputs?.[s],E=n.hostDirectiveInputs?.[s],L=!1;if(E)for(let j=0;j<E.length;j+=2){let Y=E[j],oe=E[j+1],Ee=r.data[Y];oE(Ee,e[Y],oe,u),L=!0}if(i)for(let j of i){let Y=e[j],oe=r.data[j];oE(oe,Y,s,u),L=!0}return L}function Ij(n,r){let e=Gc(r,n),s=e[ni];Sj(s,e);let u=e[id];u!==null&&e[b_]===null&&(e[b_]=Hk(u,e[x_])),lr(18),JE(s,e,e[ds]),lr(19,e[ds])}function Sj(n,r){for(let e=r.length;e<n.blueprint.length;e++)r.push(n.blueprint[e])}function JE(n,r,e){PE(r);try{let s=n.viewQuery;s!==null&&YC(1,s,e);let u=n.template;u!==null&&fR(n,r,u,1,e),n.firstCreatePass&&(n.firstCreatePass=!1),r[Qu]?.finishViewCreation(n),n.staticContentQueries&&Gk(n,r),n.staticViewQueries&&YC(2,n.viewQuery,e);let i=n.components;i!==null&&Aj(r,i)}catch(s){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),s}finally{r[zn]&=-5,OE()}}function Aj(n,r){for(let e=0;e<r.length;e++)Ij(n,r[e])}function eD(n,r,e,s){let u=si(null);try{let i=r.tView,L=n[zn]&4096?4096:16,j=XE(n,i,e,L,null,r,null,null,s?.injector??null,s?.embeddedViewInjector??null,s?.dehydratedView??null),Y=n[r.index];j[tp]=Y;let oe=n[Qu];return oe!==null&&(j[Qu]=oe.createEmbeddedView(i)),JE(i,j,e),j}finally{si(u)}}function R0(n,r){return!r||r.firstChild===null||Ok(n)}var kj;function tD(n,r){return kj(n,r)}var ed=function(n){return n[n.Important=1]="Important",n[n.DashCase=2]="DashCase",n}(ed||{});function nD(n){return(n.flags&32)===32}function eg(n,r,e,s,u){if(s!=null){let i,E=!1;rd(s)?i=s:_h(s)&&(E=!0,s=s[id]);let L=Hc(s);n===0&&e!==null?u==null?lR(r,e,L):k0(r,e,L,u||null,!0):n===1&&e!==null?k0(r,e,L,u||null,!0):n===2?dj(r,L,E):n===3&&r.destroyNode(L),i!=null&&Vj(r,n,i,e,u)}}function Rj(n,r){_R(n,r),r[id]=null,r[Us]=null}function Pj(n,r,e,s,u,i){s[id]=u,s[Us]=r,ex(n,s,e,1,u,i)}function _R(n,r){r[bh].changeDetectionScheduler?.notify(9),ex(n,r,r[eo],2,null,null)}function Oj(n){let r=n[w_];if(!r)return wC(n[ni],n);for(;r;){let e=null;if(_h(r))e=r[w_];else{let s=r[Ns];s&&(e=s)}if(!e){for(;r&&!r[Xl]&&r!==n;)_h(r)&&wC(r[ni],r),r=r[Go];r===null&&(r=n),_h(r)&&wC(r[ni],r),e=r&&r[Xl]}r=e}}function iD(n,r){let e=n[og],s=e.indexOf(r);e.splice(s,1)}function rD(n,r){if(R_(r))return;let e=r[eo];e.destroyNode&&ex(n,r,e,3,null,null),Oj(r)}function wC(n,r){if(R_(r))return;let e=si(null);try{r[zn]&=-129,r[zn]|=256,r[qa]&&o_(r[qa]),Fj(n,r),Lj(n,r),r[ni].type===1&&r[eo].destroy();let s=r[tp];if(s!==null&&rd(r[Go])){s!==r[Go]&&iD(s,r);let u=r[Qu];u!==null&&u.detachView(n)}qC(r)}finally{si(e)}}function Lj(n,r){let e=n.cleanup,s=r[v0];if(e!==null)for(let E=0;E<e.length-1;E+=2)if(typeof e[E]=="string"){let L=e[E+3];L>=0?s[L]():s[-L].unsubscribe(),E+=2}else{let L=s[e[E+1]];e[E].call(L)}s!==null&&(r[v0]=null);let u=r[yh];if(u!==null){r[yh]=null;for(let E=0;E<u.length;E++){let L=u[E];L()}}let i=r[np];if(i!==null){r[np]=null;for(let E of i)E.destroy()}}function Fj(n,r){let e;if(n!=null&&(e=n.destroyHooks)!=null)for(let s=0;s<e.length;s+=2){let u=r[e[s]];if(!(u instanceof sp)){let i=e[s+1];if(Array.isArray(i))for(let E=0;E<i.length;E+=2){let L=u[i[E]],j=i[E+1];lr(4,L,j);try{j.call(L)}finally{lr(5,L,j)}}else{lr(4,u,i);try{i.call(u)}finally{lr(5,u,i)}}}}}function vR(n,r,e){return Nj(n,r.parent,e)}function Nj(n,r,e){let s=r;for(;s!==null&&s.type&168;)r=s,s=r.parent;if(s===null)return e[id];if(dg(s)){let{encapsulation:u}=n.data[s.directiveStart+s.componentOffset];if(u===Wc.None||u===Wc.Emulated)return null}return qc(s,e)}function bR(n,r,e){return Bj(n,r,e)}function zj(n,r,e){return n.type&40?qc(n,e):null}var Bj=zj,oA;function oD(n,r,e,s){let u=vR(n,s,r),i=r[eo],E=s.parent||r[Us],L=bR(E,s,r);if(u!=null)if(Array.isArray(e))for(let j=0;j<e.length;j++)rA(i,u,e[j],L,!1);else rA(i,u,e,L,!1);oA!==void 0&&oA(i,s,r,e,u)}function m_(n,r){if(r!==null){let e=r.type;if(e&3)return qc(r,n);if(e&4)return sE(-1,n[r.index]);if(e&8){let s=r.child;if(s!==null)return m_(n,s);{let u=n[r.index];return rd(u)?sE(-1,u):Hc(u)}}else{if(e&128)return m_(n,r.next);if(e&32)return tD(r,n)()||Hc(n[r.index]);{let s=xR(n,r);if(s!==null){if(Array.isArray(s))return s[0];let u=rp(n[Za]);return m_(u,s)}else return m_(n,r.next)}}}return null}function xR(n,r){if(r!==null){let s=n[Za][Us],u=r.projection;return s.projection[u]}return null}function sE(n,r){let e=Ns+n+1;if(e<r.length){let s=r[e],u=s[ni].firstChild;if(u!==null)return m_(s,u)}return r[ip]}function sD(n,r,e,s,u,i,E){for(;e!=null;){if(e.type===128){e=e.next;continue}let L=s[e.index],j=e.type;if(E&&r===0&&(L&&F_(Hc(L),s),e.flags|=2),!nD(e))if(j&8)sD(n,r,e.child,s,u,i,!1),eg(r,n,u,L,i);else if(j&32){let Y=tD(e,s),oe;for(;oe=Y();)eg(r,n,u,oe,i);eg(r,n,u,L,i)}else j&16?wR(n,r,s,e,u,i):eg(r,n,u,L,i);e=E?e.projectionNext:e.next}}function ex(n,r,e,s,u,i){sD(e,s,n.firstChild,r,u,i,!1)}function jj(n,r,e){let s=r[eo],u=vR(n,e,r),i=e.parent||r[Us],E=bR(i,e,r);wR(s,0,r,e,u,E)}function wR(n,r,e,s,u,i){let E=e[Za],j=E[Us].projection[s.projection];if(Array.isArray(j))for(let Y=0;Y<j.length;Y++){let oe=j[Y];eg(r,n,u,oe,i)}else{let Y=j,oe=E[Go];Ok(s)&&(Y.flags|=128),sD(n,r,Y,oe,u,i,!0)}}function Vj(n,r,e,s,u){let i=e[ip],E=Hc(e);i!==E&&eg(r,n,s,i,u);for(let L=Ns;L<e.length;L++){let j=e[L];ex(j[ni],j,n,r,s,i)}}function Uj(n,r,e,s,u){if(r)u?n.addClass(e,s):n.removeClass(e,s);else{let i=s.indexOf("-")===-1?void 0:ed.DashCase;u==null?n.removeStyle(e,s,i):(typeof u=="string"&&u.endsWith("!important")&&(u=u.slice(0,-10),i|=ed.Important),n.setStyle(e,s,u,i))}}function P0(n,r,e,s,u=!1){for(;e!==null;){if(e.type===128){e=u?e.projectionNext:e.next;continue}let i=r[e.index];i!==null&&s.push(Hc(i)),rd(i)&&$j(i,s);let E=e.type;if(E&8)P0(n,r,e.child,s);else if(E&32){let L=tD(e,r),j;for(;j=L();)s.push(j)}else if(E&16){let L=xR(r,e);if(Array.isArray(L))s.push(...L);else{let j=rp(r[Za]);P0(j[ni],j,L,s,!0)}}e=u?e.projectionNext:e.next}return s}function $j(n,r){for(let e=Ns;e<n.length;e++){let s=n[e],u=s[ni].firstChild;u!==null&&P0(s[ni],s,u,r)}n[ip]!==n[id]&&r.push(n[ip])}function CR(n){if(n[tg]!==null){for(let r of n[tg])r.impl.addSequence(r);n[tg].length=0}}var ER=[];function Hj(n){return n[qa]??Gj(n)}function Gj(n){let r=ER.pop()??Object.create(qj);return r.lView=n,r}function Wj(n){n.lView[qa]!==n&&(n.lView=null,ER.push(n))}var qj=Cn(ut({},Nm),{consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:n=>{hg(n.lView)},consumerOnSignalRead(){this.lView[qa]=this}});function Zj(n){let r=n[qa]??Object.create(Xj);return r.lView=n,r}var Xj=Cn(ut({},Nm),{consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:n=>{let r=rp(n.lView);for(;r&&!DR(r[ni]);)r=rp(r);r&&KA(r)},consumerOnSignalRead(){this.lView[qa]=this}});function DR(n){return n.type!==2}function MR(n){if(n[np]===null)return;let r=!0;for(;r;){let e=!1;for(let s of n[np])s.dirty&&(e=!0,s.zone===null||Zone.current===s.zone?s.run():s.zone.run(()=>s.run()));r=e&&!!(n[zn]&8192)}}var Yj=100;function TR(n,r=!0,e=0){let u=n[bh].rendererFactory,i=!1;i||u.begin?.();try{Kj(n,e)}catch(E){throw r&&yR(n,E),E}finally{i||u.end?.()}}function Kj(n,r){let e=sk();try{C0(!0),aE(n,r);let s=0;for(;Y0(n);){if(s===Yj)throw new Ht(103,!1);s++,aE(n,1)}}finally{C0(e)}}function Qj(n,r,e,s){if(R_(r))return;let u=r[zn],i=!1,E=!1;PE(r);let L=!0,j=null,Y=null;i||(DR(n)?(Y=Hj(r),j=r_(Y)):qI()===null?(L=!1,Y=Zj(r),j=r_(Y)):r[qa]&&(o_(r[qa]),r[qa]=null));try{YA(r),Fz(n.bindingStartIndex),e!==null&&fR(n,r,e,2,s);let oe=(u&3)===3;if(!i)if(oe){let Ne=n.preOrderCheckHooks;Ne!==null&&u0(r,Ne,null)}else{let Ne=n.preOrderHooks;Ne!==null&&d0(r,Ne,0,null),vC(r,0)}if(E||Jj(r),MR(r),IR(r,0),n.contentQueries!==null&&Gk(n,r),!i)if(oe){let Ne=n.contentCheckHooks;Ne!==null&&u0(r,Ne)}else{let Ne=n.contentHooks;Ne!==null&&d0(r,Ne,1),vC(r,1)}tV(n,r);let Ee=n.components;Ee!==null&&AR(r,Ee,0);let Ye=n.viewQuery;if(Ye!==null&&YC(2,Ye,s),!i)if(oe){let Ne=n.viewCheckHooks;Ne!==null&&u0(r,Ne)}else{let Ne=n.viewHooks;Ne!==null&&d0(r,Ne,2),vC(r,2)}if(n.firstUpdatePass===!0&&(n.firstUpdatePass=!1),r[_C]){for(let Ne of r[_C])Ne();r[_C]=null}i||(CR(r),r[zn]&=-73)}catch(oe){throw i||hg(r),oe}finally{Y!==null&&(Mb(Y,j),L&&Wj(Y)),OE()}}function IR(n,r){for(let e=Nk(n);e!==null;e=zk(e))for(let s=Ns;s<e.length;s++){let u=e[s];SR(u,r)}}function Jj(n){for(let r=Nk(n);r!==null;r=zk(r)){if(!(r[zn]&2))continue;let e=r[og];for(let s=0;s<e.length;s++){let u=e[s];KA(u)}}}function eV(n,r,e){lr(18);let s=Gc(r,n);SR(s,e),lr(19,s[ds])}function SR(n,r){AE(n)&&aE(n,r)}function aE(n,r){let s=n[ni],u=n[zn],i=n[qa],E=!!(r===0&&u&16);if(E||=!!(u&64&&r===0),E||=!!(u&1024),E||=!!(i?.dirty&&Tb(i)),E||=!1,i&&(i.dirty=!1),n[zn]&=-9217,E)Qj(s,n,s.template,n[ds]);else if(u&8192){MR(n),IR(n,1);let L=s.components;L!==null&&AR(n,L,1),CR(n)}}function AR(n,r,e){for(let s=0;s<r.length;s++)eV(n,r[s],e)}function tV(n,r){let e=n.hostBindingOpCodes;if(e!==null)try{for(let s=0;s<e.length;s++){let u=e[s];if(u<0)op(~u);else{let i=u,E=e[++s],L=e[++s];zz(E,i);let j=r[i];lr(24,j),L(2,j),lr(25,j)}}}finally{op(-1)}}function aD(n,r){let e=sk()?64:1088;for(n[bh].changeDetectionScheduler?.notify(r);n;){n[zn]|=e;let s=rp(n);if(x0(n)&&!s)return n;n=s}return null}function kR(n,r,e,s){return[n,!0,0,r,null,s,null,e,null,null]}function nV(n,r){let e=Ns+r;if(e<n.length)return n[e]}function lD(n,r,e,s=!0){let u=r[ni];if(rV(u,r,n,e),s){let E=sE(e,n),L=r[eo],j=L.parentNode(n[ip]);j!==null&&Pj(u,n[Us],L,r,j,E)}let i=r[b_];i!==null&&i.firstChild!==null&&(i.firstChild=null)}function iV(n,r){let e=O0(n,r);return e!==void 0&&rD(e[ni],e),e}function O0(n,r){if(n.length<=Ns)return;let e=Ns+r,s=n[e];if(s){let u=s[tp];u!==null&&u!==n&&iD(u,s),r>0&&(n[e-1][Xl]=s[Xl]);let i=y0(n,Ns+r);Rj(s[ni],s);let E=i[Qu];E!==null&&E.detachView(i[ni]),s[Go]=null,s[Xl]=null,s[zn]&=-129}return s}function rV(n,r,e,s){let u=Ns+s,i=e.length;s>0&&(e[u-1][Xl]=r),s<i-Ns?(r[Xl]=e[u],RA(e,Ns+s,r)):(e.push(r),r[Xl]=null),r[Go]=e;let E=r[tp];E!==null&&e!==E&&RR(E,r);let L=r[Qu];L!==null&&L.insertView(n),NC(r),r[zn]|=128}function RR(n,r){let e=n[og],s=r[Go];if(_h(s))n[zn]|=2;else{let u=s[Go][Za];r[Za]!==u&&(n[zn]|=2)}e===null?n[og]=[r]:e.push(r)}var M_=class{_lView;_cdRefInjectingView;notifyErrorHandler;_appRef=null;_attachedToViewContainer=!1;get rootNodes(){let r=this._lView,e=r[ni];return P0(e,r,e.firstChild,[])}constructor(r,e,s=!0){this._lView=r,this._cdRefInjectingView=e,this.notifyErrorHandler=s}get context(){return this._lView[ds]}set context(r){this._lView[ds]=r}get destroyed(){return R_(this._lView)}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let r=this._lView[Go];if(rd(r)){let e=r[b0],s=e?e.indexOf(this):-1;s>-1&&(O0(r,s),y0(e,s))}this._attachedToViewContainer=!1}rD(this._lView[ni],this._lView)}onDestroy(r){QA(this._lView,r)}markForCheck(){aD(this._cdRefInjectingView||this._lView,4)}detach(){this._lView[zn]&=-129}reattach(){NC(this._lView),this._lView[zn]|=128}detectChanges(){this._lView[zn]|=1024,TR(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new Ht(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null;let r=x0(this._lView),e=this._lView[tp];e!==null&&!r&&iD(e,this._lView),_R(this._lView[ni],this._lView)}attachToAppRef(r){if(this._attachedToViewContainer)throw new Ht(902,!1);this._appRef=r;let e=x0(this._lView),s=this._lView[tp];s!==null&&!e&&RR(s,this._lView),NC(this._lView)}};var Xa=(()=>{class n{static __NG_ELEMENT_ID__=aV}return n})(),oV=Xa,sV=class extends oV{_declarationLView;_declarationTContainer;elementRef;constructor(r,e,s){super(),this._declarationLView=r,this._declarationTContainer=e,this.elementRef=s}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(r,e){return this.createEmbeddedViewImpl(r,e)}createEmbeddedViewImpl(r,e,s){let u=eD(this._declarationLView,this._declarationTContainer,r,{embeddedViewInjector:e,dehydratedView:s});return new M_(u)}};function aV(){return cD(ga(),gi())}function cD(n,r){return n.type&4?new sV(r,n,fg(n,r)):null}function tx(n,r,e,s,u){let i=n.data[r];if(i===null)i=lV(n,r,e,s,u),Nz()&&(i.flags|=32);else if(i.type&64){i.type=e,i.value=s,i.attrs=u;let E=Pz();i.injectorIndex=E===null?-1:E.injectorIndex}return P_(i,!0),i}function lV(n,r,e,s,u){let i=ik(),E=rk(),L=E?i:i&&i.parent,j=n.data[r]=uV(n,L,e,r,s,u);return cV(n,j,i,E),j}function cV(n,r,e,s){n.firstChild===null&&(n.firstChild=r),e!==null&&(s?e.child==null&&r.parent!==null&&(e.child=r):e.next===null&&(e.next=r,r.prev=e))}function uV(n,r,e,s,u,i){let E=r?r.injectorIndex:-1,L=0;return nk()&&(L|=128),{type:e,index:s,insertBeforeIndex:null,injectorIndex:E,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:L,providerIndexes:0,value:u,attrs:i,mergedAttrs:null,localNames:null,initialInputs:null,inputs:null,hostDirectiveInputs:null,outputs:null,hostDirectiveOutputs:null,directiveToIndex:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:r,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}var GY=new RegExp(`^(\\d+)*(${MB}|${DB})*(.*)`);var dV=()=>null;function L0(n,r){return dV(n,r)}var hV=class{},PR=class{},lE=class{resolveComponentFactory(r){throw Error(`No component factory found for ${Fs(r)}.`)}},nx=class{static NULL=new lE},ko=class{},dp=(()=>{class n{destroyNode=null;static __NG_ELEMENT_ID__=()=>fV()}return n})();function fV(){let n=gi(),r=ga(),e=Gc(r.index,n);return(_h(e)?e:n)[eo]}var pV=(()=>{class n{static \u0275prov=xt({token:n,providedIn:"root",factory:()=>null})}return n})();function sA(n,r,e){let s=e?n.styles:null,u=e?n.classes:null,i=0;if(r!==null)for(let E=0;E<r.length;E++){let L=r[E];if(typeof L=="number")i=L;else if(i==1)u=SC(u,L);else if(i==2){let j=L,Y=r[++E];s=SC(s,j+": "+Y+";")}}e?n.styles=s:n.stylesWithoutHost=s,e?n.classes=u:n.classesWithoutHost=u}function Hi(n,r=ti.Default){let e=gi();if(e===null)return St(n,r);let s=ga();return Dk(s,e,us(n),r)}function OR(){let n="invalid";throw new Error(n)}function LR(n,r,e,s,u){let i=s===null?null:{"":-1},E=u(n,e);if(E!==null){let L,j=null,Y=null,oe=gV(E);oe===null?L=E:[L,j,Y]=oe,vV(n,r,e,L,i,j,Y)}i!==null&&s!==null&&mV(e,s,i)}function mV(n,r,e){let s=n.localNames=[];for(let u=0;u<r.length;u+=2){let i=e[r[u+1]];if(i==null)throw new Ht(-301,!1);s.push(r[u],i)}}function gV(n){let r=null,e=!1;for(let E=0;E<n.length;E++){let L=n[E];if(E===0&&$c(L)&&(r=L),L.findHostDirectiveDefs!==null){e=!0;break}}if(!e)return null;let s=null,u=null,i=null;for(let E of n)E.findHostDirectiveDefs!==null&&(s??=[],u??=new Map,i??=new Map,yV(E,s,i,u)),E===r&&(s??=[],s.push(E));return s!==null?(s.push(...r===null?n:n.slice(1)),[s,u,i]):null}function yV(n,r,e,s){let u=r.length;n.findHostDirectiveDefs(n,r,s),e.set(n,[u,r.length-1])}function _V(n,r,e){r.componentOffset=e,(n.components??=[]).push(r.index)}function vV(n,r,e,s,u,i,E){let L=s.length,j=!1;for(let Ye=0;Ye<L;Ye++){let Ne=s[Ye];!j&&$c(Ne)&&(j=!0,_V(n,e,Ye)),UC(M0(e,r),n,Ne.type)}DV(e,n.data.length,L);for(let Ye=0;Ye<L;Ye++){let Ne=s[Ye];Ne.providersResolver&&Ne.providersResolver(Ne)}let Y=!1,oe=!1,Ee=dR(n,r,L,null);L>0&&(e.directiveToIndex=new Map);for(let Ye=0;Ye<L;Ye++){let Ne=s[Ye];if(e.mergedAttrs=C_(e.mergedAttrs,Ne.hostAttrs),xV(n,e,r,Ee,Ne),EV(Ee,Ne,u),E!==null&&E.has(Ne)){let[bt,Ut]=E.get(Ne);e.directiveToIndex.set(Ne.type,[Ee,bt+e.directiveStart,Ut+e.directiveStart])}else(i===null||!i.has(Ne))&&e.directiveToIndex.set(Ne.type,Ee);Ne.contentQueries!==null&&(e.flags|=4),(Ne.hostBindings!==null||Ne.hostAttrs!==null||Ne.hostVars!==0)&&(e.flags|=64);let ct=Ne.type.prototype;!Y&&(ct.ngOnChanges||ct.ngOnInit||ct.ngDoCheck)&&((n.preOrderHooks??=[]).push(e.index),Y=!0),!oe&&(ct.ngOnChanges||ct.ngDoCheck)&&((n.preOrderCheckHooks??=[]).push(e.index),oe=!0),Ee++}bV(n,e,i)}function bV(n,r,e){for(let s=r.directiveStart;s<r.directiveEnd;s++){let u=n.data[s];if(e===null||!e.has(u))aA(0,r,u,s),aA(1,r,u,s),cA(r,s,!1);else{let i=e.get(u);lA(0,r,i,s),lA(1,r,i,s),cA(r,s,!0)}}}function aA(n,r,e,s){let u=n===0?e.inputs:e.outputs;for(let i in u)if(u.hasOwnProperty(i)){let E;n===0?E=r.inputs??={}:E=r.outputs??={},E[i]??=[],E[i].push(s),FR(r,i)}}function lA(n,r,e,s){let u=n===0?e.inputs:e.outputs;for(let i in u)if(u.hasOwnProperty(i)){let E=u[i],L;n===0?L=r.hostDirectiveInputs??={}:L=r.hostDirectiveOutputs??={},L[E]??=[],L[E].push(s,i),FR(r,E)}}function FR(n,r){r==="class"?n.flags|=8:r==="style"&&(n.flags|=16)}function cA(n,r,e){let{attrs:s,inputs:u,hostDirectiveInputs:i}=n;if(s===null||!e&&u===null||e&&i===null||qE(n)){n.initialInputs??=[],n.initialInputs.push(null);return}let E=null,L=0;for(;L<s.length;){let j=s[L];if(j===0){L+=4;continue}else if(j===5){L+=2;continue}else if(typeof j=="number")break;if(!e&&u.hasOwnProperty(j)){let Y=u[j];for(let oe of Y)if(oe===r){E??=[],E.push(j,s[L+1]);break}}else if(e&&i.hasOwnProperty(j)){let Y=i[j];for(let oe=0;oe<Y.length;oe+=2)if(Y[oe]===r){E??=[],E.push(Y[oe+1],s[L+1]);break}}L+=2}n.initialInputs??=[],n.initialInputs.push(E)}function xV(n,r,e,s,u){n.data[s]=u;let i=u.factory||(u.factory=ig(u.type,!0)),E=new sp(i,$c(u),Hi);n.blueprint[s]=E,e[s]=E,wV(n,r,s,dR(n,e,u.hostVars,va),u)}function wV(n,r,e,s,u){let i=u.hostBindings;if(i){let E=n.hostBindingOpCodes;E===null&&(E=n.hostBindingOpCodes=[]);let L=~r.index;CV(E)!=L&&E.push(L),E.push(e,s,i)}}function CV(n){let r=n.length;for(;r>0;){let e=n[--r];if(typeof e=="number"&&e<0)return e}return 0}function EV(n,r,e){if(e){if(r.exportAs)for(let s=0;s<r.exportAs.length;s++)e[r.exportAs[s]]=n;$c(r)&&(e[""]=n)}}function DV(n,r,e){n.flags|=1,n.directiveStart=r,n.directiveEnd=r+e,n.providerIndexes=r}function NR(n,r,e,s,u,i,E,L){let j=r.consts,Y=w0(j,E),oe=tx(r,n,2,s,Y);return i&&LR(r,e,oe,w0(j,L),u),oe.mergedAttrs=C_(oe.mergedAttrs,oe.attrs),oe.attrs!==null&&sA(oe,oe.attrs,!1),oe.mergedAttrs!==null&&sA(oe,oe.mergedAttrs,!0),r.queries!==null&&r.queries.elementStart(r,oe),oe}function zR(n,r){gk(n,r),$A(r)&&n.queries.elementEnd(r)}var F0=class extends nx{ngModule;constructor(r){super(),this.ngModule=r}resolveComponentFactory(r){let e=vh(r);return new lp(e,this.ngModule)}};function MV(n){return Object.keys(n).map(r=>{let[e,s,u]=n[r],i={propName:e,templateName:r,isSignal:(s&J0.SignalBased)!==0};return u&&(i.transform=u),i})}function TV(n){return Object.keys(n).map(r=>({propName:n[r],templateName:r}))}function IV(n,r,e){let s=r instanceof jr?r:r?.injector;return s&&n.getStandaloneInjector!==null&&(s=n.getStandaloneInjector(s)||s),s?new jC(e,s):e}function SV(n){let r=n.get(ko,null);if(r===null)throw new Ht(407,!1);let e=n.get(pV,null),s=n.get(ap,null);return{rendererFactory:r,sanitizer:e,changeDetectionScheduler:s}}function AV(n,r){let e=(n.selectors[0][0]||"div").toLowerCase();return aR(r,e,e==="svg"?ZA:e==="math"?xz:null)}var lp=class extends PR{componentDef;ngModule;selector;componentType;ngContentSelectors;isBoundToModule;cachedInputs=null;cachedOutputs=null;get inputs(){return this.cachedInputs??=MV(this.componentDef.inputs),this.cachedInputs}get outputs(){return this.cachedOutputs??=TV(this.componentDef.outputs),this.cachedOutputs}constructor(r,e){super(),this.componentDef=r,this.ngModule=e,this.componentType=r.type,this.selector=aj(r.selectors),this.ngContentSelectors=r.ngContentSelectors??[],this.isBoundToModule=!!e}create(r,e,s,u){lr(22);let i=si(null);try{let E=this.componentDef,L=s?["ng-version","19.2.2"]:lj(this.componentDef.selectors[0]),j=ZE(0,null,null,1,0,null,null,null,null,[L],null),Y=IV(E,u||this.ngModule,r),oe=SV(Y),Ee=oe.rendererFactory.createRenderer(null,E),Ye=s?yj(Ee,s,E.encapsulation,Y):AV(E,Ee),Ne=XE(null,j,null,512|uR(E),null,null,oe,Ee,Y,null,Hk(Ye,Y,!0));Ne[zs]=Ye,PE(Ne);let ct=null;try{let bt=NR(zs,j,Ne,"#host",()=>[this.componentDef],!0,0);Ye&&(cR(Ee,Ye,bt),F_(Ye,Ne)),KE(j,Ne,bt),Wk(j,bt,Ne),zR(j,bt),e!==void 0&&kV(bt,this.ngContentSelectors,e),ct=Gc(bt.index,Ne),Ne[ds]=ct[ds],JE(j,Ne,null)}catch(bt){throw ct!==null&&qC(ct),qC(Ne),bt}finally{lr(23),OE()}return new cE(this.componentType,Ne)}finally{si(i)}}},cE=class extends hV{_rootLView;instance;hostView;changeDetectorRef;componentType;location;previousInputValues=null;_tNode;constructor(r,e){super(),this._rootLView=e,this._tNode=SE(e[ni],zs),this.location=fg(this._tNode,e),this.instance=Gc(this._tNode.index,e)[ds],this.hostView=this.changeDetectorRef=new M_(e,void 0,!1),this.componentType=r}setInput(r,e){let s=this._tNode;if(this.previousInputValues??=new Map,this.previousInputValues.has(r)&&Object.is(this.previousInputValues.get(r),e))return;let u=this._rootLView,i=QE(s,u[ni],u,r,e);this.previousInputValues.set(r,e);let E=Gc(s.index,u);aD(E,1)}get injector(){return new Qf(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(r){this.hostView.onDestroy(r)}};function kV(n,r,e){let s=n.projection=[];for(let u=0;u<r.length;u++){let i=e[u];s.push(i!=null&&i.length?Array.from(i):null)}}var ba=(()=>{class n{static __NG_ELEMENT_ID__=RV}return n})();function RV(){let n=ga();return jR(n,gi())}var PV=ba,BR=class extends PV{_lContainer;_hostTNode;_hostLView;constructor(r,e,s){super(),this._lContainer=r,this._hostTNode=e,this._hostLView=s}get element(){return fg(this._hostTNode,this._hostLView)}get injector(){return new Qf(this._hostTNode,this._hostLView)}get parentInjector(){let r=zE(this._hostTNode,this._hostLView);if(vk(r)){let e=D0(r,this._hostLView),s=E0(r),u=e[ni].data[s+8];return new Qf(u,e)}else return new Qf(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(r){let e=uA(this._lContainer);return e!==null&&e[r]||null}get length(){return this._lContainer.length-Ns}createEmbeddedView(r,e,s){let u,i;typeof s=="number"?u=s:s!=null&&(u=s.index,i=s.injector);let E=L0(this._lContainer,r.ssrId),L=r.createEmbeddedViewImpl(e||{},i,E);return this.insertImpl(L,u,R0(this._hostTNode,E)),L}createComponent(r,e,s,u,i){let E=r&&!yz(r),L;if(E)L=e;else{let ct=e||{};L=ct.index,s=ct.injector,u=ct.projectableNodes,i=ct.environmentInjector||ct.ngModuleRef}let j=E?r:new lp(vh(r)),Y=s||this.parentInjector;if(!i&&j.ngModule==null){let bt=(E?Y:this.parentInjector).get(jr,null);bt&&(i=bt)}let oe=vh(j.componentType??{}),Ee=L0(this._lContainer,oe?.id??null),Ye=Ee?.firstChild??null,Ne=j.create(Y,u,Ye,i);return this.insertImpl(Ne.hostView,L,R0(this._hostTNode,Ee)),Ne}insert(r,e){return this.insertImpl(r,e,!0)}insertImpl(r,e,s){let u=r._lView;if(Ez(u)){let L=this.indexOf(r);if(L!==-1)this.detach(L);else{let j=u[Go],Y=new BR(j,j[Us],j[Go]);Y.detach(Y.indexOf(r))}}let i=this._adjustIndex(e),E=this._lContainer;return lD(E,u,i,s),r.attachToViewContainerRef(),RA(CC(E),i,r),r}move(r,e){return this.insert(r,e)}indexOf(r){let e=uA(this._lContainer);return e!==null?e.indexOf(r):-1}remove(r){let e=this._adjustIndex(r,-1),s=O0(this._lContainer,e);s&&(y0(CC(this._lContainer),e),rD(s[ni],s))}detach(r){let e=this._adjustIndex(r,-1),s=O0(this._lContainer,e);return s&&y0(CC(this._lContainer),e)!=null?new M_(s):null}_adjustIndex(r,e=0){return r??this.length+e}};function uA(n){return n[b0]}function CC(n){return n[b0]||(n[b0]=[])}function jR(n,r){let e,s=r[n.index];return rd(s)?e=s:(e=kR(s,r,null,n),r[n.index]=e,YE(r,e)),LV(e,r,n,s),new BR(e,n,r)}function OV(n,r){let e=n[eo],s=e.createComment(""),u=qc(r,n),i=e.parentNode(u);return k0(e,i,s,e.nextSibling(u),!1),s}var LV=zV,FV=()=>!1;function NV(n,r,e){return FV(n,r,e)}function zV(n,r,e,s){if(n[ip])return;let u;e.type&8?u=Hc(s):u=OV(r,e),n[ip]=u}var uE=class n{queryList;matches=null;constructor(r){this.queryList=r}clone(){return new n(this.queryList)}setDirty(){this.queryList.setDirty()}},dE=class n{queries;constructor(r=[]){this.queries=r}createEmbeddedView(r){let e=r.queries;if(e!==null){let s=r.contentQueries!==null?r.contentQueries[0]:e.length,u=[];for(let i=0;i<s;i++){let E=e.getByIndex(i),L=this.queries[E.indexInDeclarationView];u.push(L.clone())}return new n(u)}return null}insertView(r){this.dirtyQueriesWithMatches(r)}detachView(r){this.dirtyQueriesWithMatches(r)}finishViewCreation(r){this.dirtyQueriesWithMatches(r)}dirtyQueriesWithMatches(r){for(let e=0;e<this.queries.length;e++)uD(r,e).matches!==null&&this.queries[e].setDirty()}},hE=class{flags;read;predicate;constructor(r,e,s=null){this.flags=e,this.read=s,typeof r=="string"?this.predicate=WV(r):this.predicate=r}},fE=class n{queries;constructor(r=[]){this.queries=r}elementStart(r,e){for(let s=0;s<this.queries.length;s++)this.queries[s].elementStart(r,e)}elementEnd(r){for(let e=0;e<this.queries.length;e++)this.queries[e].elementEnd(r)}embeddedTView(r){let e=null;for(let s=0;s<this.length;s++){let u=e!==null?e.length:0,i=this.getByIndex(s).embeddedTView(r,u);i&&(i.indexInDeclarationView=s,e!==null?e.push(i):e=[i])}return e!==null?new n(e):null}template(r,e){for(let s=0;s<this.queries.length;s++)this.queries[s].template(r,e)}getByIndex(r){return this.queries[r]}get length(){return this.queries.length}track(r){this.queries.push(r)}},pE=class n{metadata;matches=null;indexInDeclarationView=-1;crossesNgTemplate=!1;_declarationNodeIndex;_appliesToNextNode=!0;constructor(r,e=-1){this.metadata=r,this._declarationNodeIndex=e}elementStart(r,e){this.isApplyingToNode(e)&&this.matchTNode(r,e)}elementEnd(r){this._declarationNodeIndex===r.index&&(this._appliesToNextNode=!1)}template(r,e){this.elementStart(r,e)}embeddedTView(r,e){return this.isApplyingToNode(r)?(this.crossesNgTemplate=!0,this.addMatch(-r.index,e),new n(this.metadata)):null}isApplyingToNode(r){if(this._appliesToNextNode&&(this.metadata.flags&1)!==1){let e=this._declarationNodeIndex,s=r.parent;for(;s!==null&&s.type&8&&s.index!==e;)s=s.parent;return e===(s!==null?s.index:-1)}return this._appliesToNextNode}matchTNode(r,e){let s=this.metadata.predicate;if(Array.isArray(s))for(let u=0;u<s.length;u++){let i=s[u];this.matchTNodeWithReadOption(r,e,BV(e,i)),this.matchTNodeWithReadOption(r,e,h0(e,r,i,!1,!1))}else s===Xa?e.type&4&&this.matchTNodeWithReadOption(r,e,-1):this.matchTNodeWithReadOption(r,e,h0(e,r,s,!1,!1))}matchTNodeWithReadOption(r,e,s){if(s!==null){let u=this.metadata.read;if(u!==null)if(u===yi||u===ba||u===Xa&&e.type&4)this.addMatch(e.index,-2);else{let i=h0(e,r,u,!1,!1);i!==null&&this.addMatch(e.index,i)}else this.addMatch(e.index,s)}}addMatch(r,e){this.matches===null?this.matches=[r,e]:this.matches.push(r,e)}};function BV(n,r){let e=n.localNames;if(e!==null){for(let s=0;s<e.length;s+=2)if(e[s]===r)return e[s+1]}return null}function jV(n,r){return n.type&11?fg(n,r):n.type&4?cD(n,r):null}function VV(n,r,e,s){return e===-1?jV(r,n):e===-2?UV(n,r,s):E_(n,n[ni],e,r)}function UV(n,r,e){if(e===yi)return fg(r,n);if(e===Xa)return cD(r,n);if(e===ba)return jR(r,n)}function VR(n,r,e,s){let u=r[Qu].queries[s];if(u.matches===null){let i=n.data,E=e.matches,L=[];for(let j=0;E!==null&&j<E.length;j+=2){let Y=E[j];if(Y<0)L.push(null);else{let oe=i[Y];L.push(VV(r,oe,E[j+1],e.metadata.read))}}u.matches=L}return u.matches}function mE(n,r,e,s){let u=n.queries.getByIndex(e),i=u.matches;if(i!==null){let E=VR(n,r,u,e);for(let L=0;L<i.length;L+=2){let j=i[L];if(j>0)s.push(E[L/2]);else{let Y=i[L+1],oe=r[-j];for(let Ee=Ns;Ee<oe.length;Ee++){let Ye=oe[Ee];Ye[tp]===Ye[Go]&&mE(Ye[ni],Ye,Y,s)}if(oe[og]!==null){let Ee=oe[og];for(let Ye=0;Ye<Ee.length;Ye++){let Ne=Ee[Ye];mE(Ne[ni],Ne,Y,s)}}}}}return s}function $V(n,r){return n[Qu].queries[r].queryList}function HV(n,r,e){let s=new A0((e&4)===4);return Tz(n,r,s,s.destroy),(r[Qu]??=new dE).queries.push(new uE(s))-1}function GV(n,r,e){let s=Wo();return s.firstCreatePass&&(qV(s,new hE(n,r,e),-1),(r&2)===2&&(s.staticViewQueries=!0)),HV(s,gi(),r)}function WV(n){return n.split(",").map(r=>r.trim())}function qV(n,r,e){n.queries===null&&(n.queries=new fE),n.queries.track(new pE(r,e))}function uD(n,r){return n.queries.getByIndex(r)}function ZV(n,r){let e=n[ni],s=uD(e,r);return s.crossesNgTemplate?mE(e,n,r,[]):VR(e,n,s,r)}function XV(n){let r=[],e=new Map;function s(u){let i=e.get(u);if(!i){let E=n(u);e.set(u,i=E.then(JV))}return i}return N0.forEach((u,i)=>{let E=[];u.templateUrl&&E.push(s(u.templateUrl).then(Y=>{u.template=Y}));let L=typeof u.styles=="string"?[u.styles]:u.styles||[];if(u.styles=L,u.styleUrl&&u.styleUrls?.length)throw new Error("@Component cannot define both `styleUrl` and `styleUrls`. Use `styleUrl` if the component has one stylesheet, or `styleUrls` if it has multiple");if(u.styleUrls?.length){let Y=u.styles.length,oe=u.styleUrls;u.styleUrls.forEach((Ee,Ye)=>{L.push(""),E.push(s(Ee).then(Ne=>{L[Y+Ye]=Ne,oe.splice(oe.indexOf(Ee),1),oe.length==0&&(u.styleUrls=void 0)}))})}else u.styleUrl&&E.push(s(u.styleUrl).then(Y=>{L.push(Y),u.styleUrl=void 0}));let j=Promise.all(E).then(()=>e3(i));r.push(j)}),KV(),Promise.all(r).then(()=>{})}var N0=new Map,YV=new Set;function KV(){let n=N0;return N0=new Map,n}function QV(){return N0.size===0}function JV(n){return typeof n=="string"?n:n.text()}function e3(n){YV.delete(n)}var td=class{},dD=class{};var z0=class extends td{ngModuleType;_parent;_bootstrapComponents=[];_r3Injector;instance;destroyCbs=[];componentFactoryResolver=new F0(this);constructor(r,e,s,u=!0){super(),this.ngModuleType=r,this._parent=e;let i=LA(r);this._bootstrapComponents=rR(i.bootstrap),this._r3Injector=Ik(r,e,[{provide:td,useValue:this},{provide:nx,useValue:this.componentFactoryResolver},...s],Fs(r),new Set(["environment"])),u&&this.resolveInjectorInitializers()}resolveInjectorInitializers(){this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(this.ngModuleType)}get injector(){return this._r3Injector}destroy(){let r=this._r3Injector;!r.destroyed&&r.destroy(),this.destroyCbs.forEach(e=>e()),this.destroyCbs=null}onDestroy(r){this.destroyCbs.push(r)}},B0=class extends dD{moduleType;constructor(r){super(),this.moduleType=r}create(r){return new z0(this.moduleType,r,[])}};function t3(n,r,e){return new z0(n,r,e,!1)}var gE=class extends td{injector;componentFactoryResolver=new F0(this);instance=null;constructor(r){super();let e=new v_([...r.providers,{provide:td,useValue:this},{provide:nx,useValue:this.componentFactoryResolver}],r.parent||Z0(),r.debugName,new Set(["environment"]));this.injector=e,r.runEnvironmentInitializers&&e.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(r){this.injector.onDestroy(r)}};function ix(n,r,e=null){return new gE({providers:n,parent:r,debugName:e,runEnvironmentInitializers:!0}).injector}var n3=(()=>{class n{_injector;cachedInjectors=new Map;constructor(e){this._injector=e}getOrCreateStandaloneInjector(e){if(!e.standalone)return null;if(!this.cachedInjectors.has(e)){let s=FA(!1,e.type),u=s.length>0?ix([s],this._injector,`Standalone[${e.type.name}]`):null;this.cachedInjectors.set(e,u)}return this.cachedInjectors.get(e)}ngOnDestroy(){try{for(let e of this.cachedInjectors.values())e!==null&&e.destroy()}finally{this.cachedInjectors.clear()}}static \u0275prov=xt({token:n,providedIn:"environment",factory:()=>new n(St(jr))})}return n})();function Bn(n){return S_(()=>{let r=UR(n),e=Cn(ut({},r),{decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===Lk.OnPush,directiveDefs:null,pipeDefs:null,dependencies:r.standalone&&n.dependencies||null,getStandaloneInjector:r.standalone?u=>u.get(n3).getOrCreateStandaloneInjector(e):null,getExternalStyles:null,signals:n.signals??!1,data:n.data||{},encapsulation:n.encapsulation||Wc.Emulated,styles:n.styles||Ls,_:null,schemas:n.schemas||null,tView:null,id:""});r.standalone&&gg("NgStandalone"),$R(e);let s=n.dependencies;return e.directiveDefs=dA(s,!1),e.pipeDefs=dA(s,!0),e.id=a3(e),e})}function i3(n){return vh(n)||rz(n)}function r3(n){return n!==null}function en(n){return S_(()=>({type:n.type,bootstrap:n.bootstrap||Ls,declarations:n.declarations||Ls,imports:n.imports||Ls,exports:n.exports||Ls,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function o3(n,r){if(n==null)return Jf;let e={};for(let s in n)if(n.hasOwnProperty(s)){let u=n[s],i,E,L,j;Array.isArray(u)?(L=u[0],i=u[1],E=u[2]??i,j=u[3]||null):(i=u,E=u,L=J0.None,j=null),e[i]=[s,L,j],r[i]=E}return e}function s3(n){if(n==null)return Jf;let r={};for(let e in n)n.hasOwnProperty(e)&&(r[n[e]]=e);return r}function Ni(n){return S_(()=>{let r=UR(n);return $R(r),r})}function UR(n){let r={};return{type:n.type,providersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:r,inputConfig:n.inputs||Jf,exportAs:n.exportAs||null,standalone:n.standalone??!0,signals:n.signals===!0,selectors:n.selectors||Ls,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:o3(n.inputs,r),outputs:s3(n.outputs),debugInfo:null}}function $R(n){n.features?.forEach(r=>r(n))}function dA(n,r){if(!n)return null;let e=r?oz:i3;return()=>(typeof n=="function"?n():n).map(s=>e(s)).filter(r3)}function a3(n){let r=0,e=typeof n.consts=="function"?"":n.consts,s=[n.selectors,n.ngContentSelectors,n.hostVars,n.hostAttrs,e,n.vars,n.decls,n.encapsulation,n.standalone,n.signals,n.exportAs,JSON.stringify(n.inputs),JSON.stringify(n.outputs),Object.getOwnPropertyNames(n.type.prototype),!!n.contentQueries,!!n.viewQuery];for(let i of s.join("|"))r=Math.imul(31,r)+i.charCodeAt(0)<<0;return r+=2147483648,"c"+r}function l3(n){return Object.getPrototypeOf(n.prototype).constructor}function Kc(n){let r=l3(n.type),e=!0,s=[n];for(;r;){let u;if($c(n))u=r.\u0275cmp||r.\u0275dir;else{if(r.\u0275cmp)throw new Ht(903,!1);u=r.\u0275dir}if(u){if(e){s.push(u);let E=n;E.inputs=EC(n.inputs),E.declaredInputs=EC(n.declaredInputs),E.outputs=EC(n.outputs);let L=u.hostBindings;L&&f3(n,L);let j=u.viewQuery,Y=u.contentQueries;if(j&&d3(n,j),Y&&h3(n,Y),c3(n,u),LN(n.outputs,u.outputs),$c(u)&&u.data.animation){let oe=n.data;oe.animation=(oe.animation||[]).concat(u.data.animation)}}let i=u.features;if(i)for(let E=0;E<i.length;E++){let L=i[E];L&&L.ngInherit&&L(n),L===Kc&&(e=!1)}}r=Object.getPrototypeOf(r)}u3(s)}function c3(n,r){for(let e in r.inputs){if(!r.inputs.hasOwnProperty(e)||n.inputs.hasOwnProperty(e))continue;let s=r.inputs[e];s!==void 0&&(n.inputs[e]=s,n.declaredInputs[e]=r.declaredInputs[e])}}function u3(n){let r=0,e=null;for(let s=n.length-1;s>=0;s--){let u=n[s];u.hostVars=r+=u.hostVars,u.hostAttrs=C_(u.hostAttrs,e=C_(e,u.hostAttrs))}}function EC(n){return n===Jf?{}:n===Ls?[]:n}function d3(n,r){let e=n.viewQuery;e?n.viewQuery=(s,u)=>{r(s,u),e(s,u)}:n.viewQuery=r}function h3(n,r){let e=n.contentQueries;e?n.contentQueries=(s,u,i)=>{r(s,u,i),e(s,u,i)}:n.contentQueries=r}function f3(n,r){let e=n.hostBindings;e?n.hostBindings=(s,u)=>{r(s,u),e(s,u)}:n.hostBindings=r}function HR(n,r,e){return n[r]=e}function p3(n,r){return n[r]}function nd(n,r,e){let s=n[r];return Object.is(s,e)?!1:(n[r]=e,!0)}function GR(n,r,e,s){let u=nd(n,r,e);return nd(n,r+1,s)||u}function m3(n,r,e,s,u,i,E,L,j){let Y=r.consts,oe=tx(r,n,4,E||null,L||null);tk()&&LR(r,e,oe,w0(Y,j),gR),oe.mergedAttrs=C_(oe.mergedAttrs,oe.attrs),gk(r,oe);let Ee=oe.tView=ZE(2,oe,s,u,i,r.directiveRegistry,r.pipeRegistry,null,r.schemas,Y,null);return r.queries!==null&&(r.queries.template(r,oe),Ee.queries=r.queries.embeddedTView(oe)),oe}function WR(n,r,e,s,u,i,E,L,j,Y){let oe=e+zs,Ee=r.firstCreatePass?m3(oe,r,n,s,u,i,E,L,j):r.data[oe];P_(Ee,!1);let Ye=g3(r,n,Ee,e);FE()&&oD(r,n,Ye,Ee),F_(Ye,n);let Ne=kR(Ye,n,Ye,Ee);return n[oe]=Ne,YE(n,Ne),NV(Ne,Ee,n),IE(Ee)&&KE(r,n,Ee),j!=null&&pR(n,Ee,Y),Ee}function qo(n,r,e,s,u,i,E,L){let j=gi(),Y=Wo(),oe=w0(Y.consts,i);return WR(j,Y,n,r,e,s,u,oe,E,L),qo}var g3=y3;function y3(n,r,e,s){return NE(!0),r[eo].createComment("")}var hD=(()=>{class n{log(e){console.log(e)}warn(e){console.warn(e)}static \u0275fac=function(s){return new(s||n)};static \u0275prov=xt({token:n,factory:n.\u0275fac,providedIn:"platform"})}return n})();var fD=new dt(""),j_=new dt(""),rx=(()=>{class n{_ngZone;registry;_isZoneStable=!0;_callbacks=[];taskTrackingZone=null;constructor(e,s,u){this._ngZone=e,this.registry=s,pD||(_3(u),u.addToWindow(s)),this._watchAngularEvents(),e.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{ln.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}isStable(){return this._isZoneStable&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;this._callbacks.length!==0;){let e=this._callbacks.pop();clearTimeout(e.timeoutId),e.doneCb()}});else{let e=this.getPendingTasks();this._callbacks=this._callbacks.filter(s=>s.updateCb&&s.updateCb(e)?(clearTimeout(s.timeoutId),!1):!0)}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(e=>({source:e.source,creationLocation:e.creationLocation,data:e.data})):[]}addCallback(e,s,u){let i=-1;s&&s>0&&(i=setTimeout(()=>{this._callbacks=this._callbacks.filter(E=>E.timeoutId!==i),e()},s)),this._callbacks.push({doneCb:e,timeoutId:i,updateCb:u})}whenStable(e,s,u){if(u&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(e,s,u),this._runCallbacksIfReady()}registerApplication(e){this.registry.registerApplication(e,this)}unregisterApplication(e){this.registry.unregisterApplication(e)}findProviders(e,s,u){return[]}static \u0275fac=function(s){return new(s||n)(St(ln),St(ox),St(j_))};static \u0275prov=xt({token:n,factory:n.\u0275fac})}return n})(),ox=(()=>{class n{_applications=new Map;registerApplication(e,s){this._applications.set(e,s)}unregisterApplication(e){this._applications.delete(e)}unregisterAllApplications(){this._applications.clear()}getTestability(e){return this._applications.get(e)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(e,s=!0){return pD?.findTestabilityInTree(this,e,s)??null}static \u0275fac=function(s){return new(s||n)};static \u0275prov=xt({token:n,factory:n.\u0275fac,providedIn:"platform"})}return n})();function _3(n){pD=n}var pD,qR=(()=>{class n{static \u0275prov=xt({token:n,providedIn:"root",factory:()=>new yE})}return n})(),yE=class{queuedEffectCount=0;queues=new Map;schedule(r){this.enqueue(r)}remove(r){let e=r.zone,s=this.queues.get(e);s.has(r)&&(s.delete(r),this.queuedEffectCount--)}enqueue(r){let e=r.zone;this.queues.has(e)||this.queues.set(e,new Set);let s=this.queues.get(e);s.has(r)||(this.queuedEffectCount++,s.add(r))}flush(){for(;this.queuedEffectCount>0;)for(let[r,e]of this.queues)r===null?this.flushQueue(e):r.run(()=>this.flushQueue(e))}flushQueue(r){for(let e of r)r.delete(e),this.queuedEffectCount--,e.run()}};function _g(n){return!!n&&typeof n.then=="function"}function ZR(n){return!!n&&typeof n.subscribe=="function"}var sx=new dt("");var XR=(()=>{class n{resolve;reject;initialized=!1;done=!1;donePromise=new Promise((e,s)=>{this.resolve=e,this.reject=s});appInits=we(sx,{optional:!0})??[];injector=we(Jn);constructor(){}runInitializers(){if(this.initialized)return;let e=[];for(let u of this.appInits){let i=Vs(this.injector,u);if(_g(i))e.push(i);else if(ZR(i)){let E=new Promise((L,j)=>{i.subscribe({complete:L,error:j})});e.push(E)}}let s=()=>{this.done=!0,this.resolve()};Promise.all(e).then(()=>{s()}).catch(u=>{this.reject(u)}),e.length===0&&s(),this.initialized=!0}static \u0275fac=function(s){return new(s||n)};static \u0275prov=xt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),ax=new dt("");function v3(){iS(()=>{throw new Ht(600,!1)})}function b3(n){return n.isBoundToModule}var x3=10;function YR(n,r){return Array.isArray(r)?r.reduce(YR,n):ut(ut({},n),r)}var js=(()=>{class n{_runningTick=!1;_destroyed=!1;_destroyListeners=[];_views=[];internalErrorHandler=we(pB);afterRenderManager=we(Uk);zonelessEnabled=we(jE);rootEffectScheduler=we(qR);dirtyFlags=0;tracingSnapshot=null;externalTestViews=new Set;afterTick=new _n;get allViews(){return[...this.externalTestViews.keys(),...this._views]}get destroyed(){return this._destroyed}componentTypes=[];components=[];isStable=we(od).hasPendingTasks.pipe(un(e=>!e));constructor(){we(mg,{optional:!0})}whenStable(){let e;return new Promise(s=>{e=this.isStable.subscribe({next:u=>{u&&s()}})}).finally(()=>{e.unsubscribe()})}_injector=we(jr);_rendererFactory=null;get injector(){return this._injector}bootstrap(e,s){lr(10);let u=e instanceof PR;if(!this._injector.get(XR).done){let Ye="";throw new Ht(405,Ye)}let E;u?E=e:E=this._injector.get(nx).resolveComponentFactory(e),this.componentTypes.push(E.componentType);let L=b3(E)?void 0:this._injector.get(td),j=s||E.selector,Y=E.create(Jn.NULL,[],j,L),oe=Y.location.nativeElement,Ee=Y.injector.get(fD,null);return Ee?.registerApplication(oe),Y.onDestroy(()=>{this.detachView(Y.hostView),f0(this.components,Y),Ee?.unregisterApplication(oe)}),this._loadComponent(Y),lr(11,Y),Y}tick(){this.zonelessEnabled||(this.dirtyFlags|=1),this._tick()}_tick(){lr(12),this.tracingSnapshot!==null?this.tracingSnapshot.run(HE.CHANGE_DETECTION,this.tickImpl):this.tickImpl()}tickImpl=()=>{if(this._runningTick)throw new Ht(101,!1);let e=si(null);try{this._runningTick=!0,this.synchronize()}catch(s){this.internalErrorHandler(s)}finally{this._runningTick=!1,this.tracingSnapshot?.dispose(),this.tracingSnapshot=null,si(e),this.afterTick.next(),lr(13)}};synchronize(){this._rendererFactory===null&&!this._injector.destroyed&&(this._rendererFactory=this._injector.get(ko,null,{optional:!0}));let e=0;for(;this.dirtyFlags!==0&&e++<x3;)lr(14),this.synchronizeOnce(),lr(15)}synchronizeOnce(){if(this.dirtyFlags&16&&(this.dirtyFlags&=-17,this.rootEffectScheduler.flush()),this.dirtyFlags&7){let e=!!(this.dirtyFlags&1);this.dirtyFlags&=-8,this.dirtyFlags|=8;for(let{_lView:s,notifyErrorHandler:u}of this.allViews)w3(s,u,e,this.zonelessEnabled);if(this.dirtyFlags&=-5,this.syncDirtyFlagsWithViews(),this.dirtyFlags&23)return}else this._rendererFactory?.begin?.(),this._rendererFactory?.end?.();this.dirtyFlags&8&&(this.dirtyFlags&=-9,this.afterRenderManager.execute()),this.syncDirtyFlagsWithViews()}syncDirtyFlagsWithViews(){if(this.allViews.some(({_lView:e})=>Y0(e))){this.dirtyFlags|=2;return}else this.dirtyFlags&=-8}attachView(e){let s=e;this._views.push(s),s.attachToAppRef(this)}detachView(e){let s=e;f0(this._views,s),s.detachFromAppRef()}_loadComponent(e){this.attachView(e.hostView),this.tick(),this.components.push(e),this._injector.get(ax,[]).forEach(u=>u(e))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(e=>e()),this._views.slice().forEach(e=>e.destroy())}finally{this._destroyed=!0,this._views=[],this._destroyListeners=[]}}onDestroy(e){return this._destroyListeners.push(e),()=>f0(this._destroyListeners,e)}destroy(){if(this._destroyed)throw new Ht(406,!1);let e=this._injector;e.destroy&&!e.destroyed&&e.destroy()}get viewCount(){return this._views.length}static \u0275fac=function(s){return new(s||n)};static \u0275prov=xt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function f0(n,r){let e=n.indexOf(r);e>-1&&n.splice(e,1)}function w3(n,r,e,s){if(!e&&!Y0(n))return;TR(n,r,e&&!s?0:1)}function co(n,r,e,s){let u=gi(),i=O_();if(nd(u,i,r)){let E=Wo(),L=LE();Dj(L,u,n,r,e,s)}return co}function C3(n,r,e,s){return nd(n,O_(),e)?r+__(e)+s:va}function E3(n,r,e,s,u,i){let E=Lz(),L=GR(n,E,e,u);return kE(2),L?r+__(e)+s+__(u)+i:va}function a0(n,r){return n<<17|r<<2}function cp(n){return n>>17&32767}function D3(n){return(n&2)==2}function M3(n,r){return n&131071|r<<17}function _E(n){return n|2}function ag(n){return(n&131068)>>2}function DC(n,r){return n&-131069|r<<2}function T3(n){return(n&1)===1}function vE(n){return n|1}function I3(n,r,e,s,u,i){let E=i?r.classBindings:r.styleBindings,L=cp(E),j=ag(E);n[s]=e;let Y=!1,oe;if(Array.isArray(e)){let Ee=e;oe=Ee[1],(oe===null||A_(Ee,oe)>0)&&(Y=!0)}else oe=e;if(u)if(j!==0){let Ye=cp(n[L+1]);n[s+1]=a0(Ye,L),Ye!==0&&(n[Ye+1]=DC(n[Ye+1],s)),n[L+1]=M3(n[L+1],s)}else n[s+1]=a0(L,0),L!==0&&(n[L+1]=DC(n[L+1],s)),L=s;else n[s+1]=a0(j,0),L===0?L=s:n[j+1]=DC(n[j+1],s),j=s;Y&&(n[s+1]=_E(n[s+1])),hA(n,oe,s,!0),hA(n,oe,s,!1),S3(r,oe,n,s,i),E=a0(L,j),i?r.classBindings=E:r.styleBindings=E}function S3(n,r,e,s,u){let i=u?n.residualClasses:n.residualStyles;i!=null&&typeof r=="string"&&A_(i,r)>=0&&(e[s+1]=vE(e[s+1]))}function hA(n,r,e,s){let u=n[e+1],i=r===null,E=s?cp(u):ag(u),L=!1;for(;E!==0&&(L===!1||i);){let j=n[E],Y=n[E+1];A3(j,r)&&(L=!0,n[E+1]=s?vE(Y):_E(Y)),E=s?cp(Y):ag(Y)}L&&(n[e+1]=s?_E(u):vE(u))}function A3(n,r){return n===null||r==null||(Array.isArray(n)?n[1]:n)===r?!0:Array.isArray(n)&&typeof r=="string"?A_(n,r)>=0:!1}var lo={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function KR(n){return n.substring(lo.key,lo.keyEnd)}function k3(n){return n.substring(lo.value,lo.valueEnd)}function R3(n){return eP(n),QR(n,lg(n,0,lo.textEnd))}function QR(n,r){let e=lo.textEnd;return e===r?-1:(r=lo.keyEnd=O3(n,lo.key=r,e),lg(n,r,e))}function P3(n){return eP(n),JR(n,lg(n,0,lo.textEnd))}function JR(n,r){let e=lo.textEnd,s=lo.key=lg(n,r,e);return e===s?-1:(s=lo.keyEnd=L3(n,s,e),s=fA(n,s,e,58),s=lo.value=lg(n,s,e),s=lo.valueEnd=F3(n,s,e),fA(n,s,e,59))}function eP(n){lo.key=0,lo.keyEnd=0,lo.value=0,lo.valueEnd=0,lo.textEnd=n.length}function lg(n,r,e){for(;r<e&&n.charCodeAt(r)<=32;)r++;return r}function O3(n,r,e){for(;r<e&&n.charCodeAt(r)>32;)r++;return r}function L3(n,r,e){let s;for(;r<e&&((s=n.charCodeAt(r))===45||s===95||(s&-33)>=65&&(s&-33)<=90||s>=48&&s<=57);)r++;return r}function fA(n,r,e,s){return r=lg(n,r,e),r<e&&r++,r}function F3(n,r,e){let s=-1,u=-1,i=-1,E=r,L=E;for(;E<e;){let j=n.charCodeAt(E++);if(j===59)return L;j===34||j===39?L=E=pA(n,j,E,e):r===E-4&&i===85&&u===82&&s===76&&j===40?L=E=pA(n,41,E,e):j>32&&(L=E),i=u,u=s,s=j&-33}return L}function pA(n,r,e,s){let u=-1,i=e;for(;i<s;){let E=n.charCodeAt(i++);if(E==r&&u!==92)return i;E==92&&u===92?u=0:u=E}throw new Error}function Gi(n,r,e){let s=gi(),u=O_();if(nd(s,u,r)){let i=Wo(),E=LE();mR(i,E,s,n,r,s[eo],e,!1)}return Gi}function bE(n,r,e,s,u){QE(r,n,e,u?"class":"style",s)}function mr(n,r){return B3(n,r,null,!0),mr}function tP(n){nP(oP,N3,n,!1)}function N3(n,r){for(let e=P3(r);e>=0;e=JR(r,e))oP(n,KR(r),k3(r))}function Dh(n){nP(G3,z3,n,!0)}function z3(n,r){for(let e=R3(r);e>=0;e=QR(r,e))W0(n,KR(r),!0)}function B3(n,r,e,s){let u=gi(),i=Wo(),E=kE(2);if(i.firstUpdatePass&&rP(i,n,E,s),r!==va&&nd(u,E,r)){let L=i.data[Eh()];sP(i,L,u,u[eo],n,u[E+1]=q3(r,e),s,E)}}function nP(n,r,e,s){let u=Wo(),i=kE(2);u.firstUpdatePass&&rP(u,null,i,s);let E=gi();if(e!==va&&nd(E,i,e)){let L=u.data[Eh()];if(aP(L,s)&&!iP(u,i)){let j=s?L.classesWithoutHost:L.stylesWithoutHost;j!==null&&(e=SC(j,e||"")),bE(u,L,E,e,s)}else W3(u,L,E,E[eo],E[i+1],E[i+1]=H3(n,r,e),s,i)}}function iP(n,r){return r>=n.expandoStartIndex}function rP(n,r,e,s){let u=n.data;if(u[e+1]===null){let i=u[Eh()],E=iP(n,e);aP(i,s)&&r===null&&!E&&(r=!1),r=j3(u,i,r,s),I3(u,i,r,e,E,s)}}function j3(n,r,e,s){let u=jz(n),i=s?r.residualClasses:r.residualStyles;if(u===null)(s?r.classBindings:r.styleBindings)===0&&(e=MC(null,n,r,e,s),e=T_(e,r.attrs,s),i=null);else{let E=r.directiveStylingLast;if(E===-1||n[E]!==u)if(e=MC(u,n,r,e,s),i===null){let j=V3(n,r,s);j!==void 0&&Array.isArray(j)&&(j=MC(null,n,r,j[1],s),j=T_(j,r.attrs,s),U3(n,r,s,j))}else i=$3(n,r,s)}return i!==void 0&&(s?r.residualClasses=i:r.residualStyles=i),e}function V3(n,r,e){let s=e?r.classBindings:r.styleBindings;if(ag(s)!==0)return n[cp(s)]}function U3(n,r,e,s){let u=e?r.classBindings:r.styleBindings;n[cp(u)]=s}function $3(n,r,e){let s,u=r.directiveEnd;for(let i=1+r.directiveStylingLast;i<u;i++){let E=n[i].hostAttrs;s=T_(s,E,e)}return T_(s,r.attrs,e)}function MC(n,r,e,s,u){let i=null,E=e.directiveEnd,L=e.directiveStylingLast;for(L===-1?L=e.directiveStart:L++;L<E&&(i=r[L],s=T_(s,i.hostAttrs,u),i!==n);)L++;return n!==null&&(e.directiveStylingLast=L),s}function T_(n,r,e){let s=e?1:2,u=-1;if(r!==null)for(let i=0;i<r.length;i++){let E=r[i];typeof E=="number"?u=E:u===s&&(Array.isArray(n)||(n=n===void 0?[]:["",n]),W0(n,E,e?!0:r[++i]))}return n===void 0?null:n}function H3(n,r,e){if(e==null||e==="")return Ls;let s=[],u=Yc(e);if(Array.isArray(u))for(let i=0;i<u.length;i++)n(s,u[i],!0);else if(typeof u=="object")for(let i in u)u.hasOwnProperty(i)&&n(s,i,u[i]);else typeof u=="string"&&r(s,u);return s}function oP(n,r,e){W0(n,r,Yc(e))}function G3(n,r,e){let s=String(r);s!==""&&!s.includes(" ")&&W0(n,s,e)}function W3(n,r,e,s,u,i,E,L){u===va&&(u=Ls);let j=0,Y=0,oe=0<u.length?u[0]:null,Ee=0<i.length?i[0]:null;for(;oe!==null||Ee!==null;){let Ye=j<u.length?u[j+1]:void 0,Ne=Y<i.length?i[Y+1]:void 0,ct=null,bt;oe===Ee?(j+=2,Y+=2,Ye!==Ne&&(ct=Ee,bt=Ne)):Ee===null||oe!==null&&oe<Ee?(j+=2,ct=oe):(Y+=2,ct=Ee,bt=Ne),ct!==null&&sP(n,r,e,s,ct,bt,E,L),oe=j<u.length?u[j]:null,Ee=Y<i.length?i[Y]:null}}function sP(n,r,e,s,u,i,E,L){if(!(r.type&3))return;let j=n.data,Y=j[L+1],oe=T3(Y)?mA(j,r,e,u,ag(Y),E):void 0;if(!j0(oe)){j0(i)||D3(Y)&&(i=mA(j,null,e,u,L,E));let Ee=XA(Eh(),e);Uj(s,E,Ee,u,i)}}function mA(n,r,e,s,u,i){let E=r===null,L;for(;u>0;){let j=n[u],Y=Array.isArray(j),oe=Y?j[1]:j,Ee=oe===null,Ye=e[u+1];Ye===va&&(Ye=Ee?Ls:void 0);let Ne=Ee?gC(Ye,s):oe===s?Ye:void 0;if(Y&&!j0(Ne)&&(Ne=gC(j,s)),j0(Ne)&&(L=Ne,E))return L;let ct=n[u+1];u=E?cp(ct):ag(ct)}if(r!==null){let j=i?r.residualClasses:r.residualStyles;j!=null&&(L=gC(j,s))}return L}function j0(n){return n!==void 0}function q3(n,r){return n==null||n===""||(typeof r=="string"?n=n+r:typeof n=="object"&&(n=Fs(Yc(n)))),n}function aP(n,r){return(n.flags&(r?8:16))!==0}function Mh(n,r){gg("NgControlFlow");let e=gi(),s=O_(),u=e[s]!==va?e[s]:-1,i=u!==-1?gA(e,zs+u):void 0,E=0;if(nd(e,s,n)){let L=si(null);try{if(i!==void 0&&iV(i,E),n!==-1){let j=zs+n,Y=gA(e,j),oe=Z3(e[ni],j),Ee=L0(Y,oe.tView.ssrId),Ye=eD(e,oe,r,{dehydratedView:Ee});lD(Y,Ye,E,R0(oe,Ee))}}finally{si(L)}}else if(i!==void 0){let L=nV(i,E);L!==void 0&&(L[ds]=r)}}function gA(n,r){return n[r]}function Z3(n,r){return SE(n,r)}function pn(n,r,e,s){let u=gi(),i=Wo(),E=zs+n,L=u[eo],j=i.firstCreatePass?NR(E,i,u,r,gR,tk(),e,s):i.data[E],Y=X3(i,u,j,L,r,n);u[E]=Y;let oe=IE(j);return P_(j,!0),cR(L,Y,j),!nD(j)&&FE()&&oD(i,u,Y,j),(Iz()===0||oe)&&F_(Y,u),Sz(),oe&&(KE(i,u,j),Wk(i,j,u)),s!==null&&pR(u,j),pn}function on(){let n=ga();rk()?ok():(n=n.parent,P_(n,!1));let r=n;kz(r)&&Rz(),Az();let e=Wo();return e.firstCreatePass&&zR(e,r),r.classesWithoutHost!=null&&Wz(r)&&bE(e,r,gi(),r.classesWithoutHost,!0),r.stylesWithoutHost!=null&&qz(r)&&bE(e,r,gi(),r.stylesWithoutHost,!1),on}function Ui(n,r,e,s){return pn(n,r,e,s),on(),Ui}var X3=(n,r,e,s,u,i)=>(NE(!0),aR(s,u,$z()));function hp(){return gi()}function vg(n,r,e){let s=gi(),u=O_();if(nd(s,u,r)){let i=Wo(),E=LE();mR(i,E,s,n,r,s[eo],e,!0)}return vg}var V0="en-US";var Y3=V0;function K3(n){typeof n=="string"&&(Y3=n.toLowerCase().replace(/_/g,"-"))}var Q3=(n,r,e)=>{};function cr(n,r,e,s){let u=gi(),i=Wo(),E=ga();return eU(i,u,u[eo],E,n,r,s),cr}function J3(n,r,e,s){let u=n.cleanup;if(u!=null)for(let i=0;i<u.length-1;i+=2){let E=u[i];if(E===e&&u[i+1]===s){let L=r[v0],j=u[i+2];return L.length>j?L[j]:null}typeof E=="string"&&(i+=2)}return null}function eU(n,r,e,s,u,i,E){let L=IE(s),Y=n.firstCreatePass?ek(n):null,oe=r[ds],Ee=JA(r),Ye=!0;if(s.type&3||E){let Ne=qc(s,r),ct=E?E(Ne):Ne,bt=Ee.length,Ut=E?_i=>E(Hc(_i[s.index])):s.index,Qt=null;if(!E&&L&&(Qt=J3(n,r,u,s.index)),Qt!==null){let _i=Qt.__ngLastListenerFn__||Qt;_i.__ngNextListenerFn__=i,Qt.__ngLastListenerFn__=i,Ye=!1}else{i=vA(s,r,oe,i),Q3(ct,u,i);let _i=e.listen(ct,u,i);Ee.push(i,_i),Y&&Y.push(u,Ut,bt,bt+1)}}else i=vA(s,r,oe,i);if(Ye){let Ne=s.outputs?.[u],ct=s.hostDirectiveOutputs?.[u];if(ct&&ct.length)for(let bt=0;bt<ct.length;bt+=2){let Ut=ct[bt],Qt=ct[bt+1];yA(s,n,r,Ut,Qt,u,i,Ee,Y)}if(Ne&&Ne.length)for(let bt of Ne)yA(s,n,r,bt,u,u,i,Ee,Y)}}function yA(n,r,e,s,u,i,E,L,j){let Y=e[s],Ee=r.data[s].outputs[u],Ne=Y[Ee].subscribe(E),ct=L.length;L.push(E,Ne),j&&j.push(i,n.index,ct,-(ct+1))}function _A(n,r,e,s){let u=si(null);try{return lr(6,r,e),e(s)!==!1}catch(i){return yR(n,i),!1}finally{lr(7,r,e),si(u)}}function vA(n,r,e,s){return function u(i){if(i===Function)return s;let E=dg(n)?Gc(n.index,r):r;aD(E,5);let L=_A(r,e,s,i),j=u.__ngNextListenerFn__;for(;j;)L=_A(r,e,j,i)&&L,j=j.__ngNextListenerFn__;return L}}function xa(n=1){return Uz(n)}function tU(n,r){let e=null,s=nj(n);for(let u=0;u<r.length;u++){let i=r[u];if(i==="*"){e=u;continue}if(s===null?sR(n,i,!0):oj(s,i))return u}return e}function Hs(n){let r=gi()[Za][Us];if(!r.projection){let e=n?n.length:1,s=r.projection=tz(e,null),u=s.slice(),i=r.child;for(;i!==null;){if(i.type!==128){let E=n?tU(i,n):0;E!==null&&(u[E]?u[E].projectionNext=i:s[E]=i,u[E]=i)}i=i.next}}}function Zo(n,r=0,e,s,u,i){let E=gi(),L=Wo(),j=s?n+1:null;j!==null&&WR(E,L,j,s,u,i,null,e);let Y=tx(L,zs+n,16,null,e||null);Y.projection===null&&(Y.projection=r),ok();let Ee=!E[b_]||nk();E[Za][Us].projection[Y.projection]===null&&j!==null?nU(E,L,j):Ee&&!nD(Y)&&jj(L,E,Y)}function nU(n,r,e){let s=zs+e,u=r.data[s],i=n[s],E=L0(i,u.tView.ssrId),L=eD(n,u,void 0,{dehydratedView:E});lD(i,L,0,R0(u,E))}function wa(n,r,e){GV(n,r,e)}function Gs(n){let r=gi(),e=Wo(),s=lk();RE(s+1);let u=uD(e,s);if(n.dirty&&Cz(r)===((u.metadata.flags&2)===2)){if(u.matches===null)n.reset([]);else{let i=ZV(r,s);n.reset(i,yB),n.notifyOnChanges()}return!0}return!1}function Ws(){return $V(gi(),lk())}function mD(n){let r=Oz();return wz(r,zs+n)}function Li(n,r=""){let e=gi(),s=Wo(),u=n+zs,i=s.firstCreatePass?tx(s,u,1,r,null):s.data[u],E=iU(s,e,i,r,n);e[u]=E,FE()&&oD(s,e,E,i),P_(i,!1)}var iU=(n,r,e,s,u)=>(NE(!0),cj(r[eo],s));function bg(n){return Xo("",n,""),bg}function Xo(n,r,e){let s=gi(),u=C3(s,n,r,e);return u!==va&&lP(s,Eh(),u),Xo}function lx(n,r,e,s,u){let i=gi(),E=E3(i,n,r,e,s,u);return E!==va&&lP(i,Eh(),E),lx}function lP(n,r,e){let s=XA(r,n);uj(n[eo],s,e)}function rU(n,r,e){let s=Wo();if(s.firstCreatePass){let u=$c(n);xE(e,s.data,s.blueprint,u,!0),xE(r,s.data,s.blueprint,u,!1)}}function xE(n,r,e,s,u){if(n=us(n),Array.isArray(n))for(let i=0;i<n.length;i++)xE(n[i],r,e,s,u);else{let i=Wo(),E=gi(),L=ga(),j=rg(n)?n:us(n.provide),Y=BA(n),oe=L.providerIndexes&1048575,Ee=L.directiveStart,Ye=L.providerIndexes>>20;if(rg(n)||!n.multi){let Ne=new sp(Y,u,Hi),ct=IC(j,r,u?oe:oe+Ye,Ee);ct===-1?(UC(M0(L,E),i,j),TC(i,n,r.length),r.push(j),L.directiveStart++,L.directiveEnd++,u&&(L.providerIndexes+=1048576),e.push(Ne),E.push(Ne)):(e[ct]=Ne,E[ct]=Ne)}else{let Ne=IC(j,r,oe+Ye,Ee),ct=IC(j,r,oe,oe+Ye),bt=Ne>=0&&e[Ne],Ut=ct>=0&&e[ct];if(u&&!Ut||!u&&!bt){UC(M0(L,E),i,j);let Qt=aU(u?sU:oU,e.length,u,s,Y);!u&&Ut&&(e[ct].providerFactory=Qt),TC(i,n,r.length,0),r.push(j),L.directiveStart++,L.directiveEnd++,u&&(L.providerIndexes+=1048576),e.push(Qt),E.push(Qt)}else{let Qt=cP(e[u?ct:Ne],Y,!u&&s);TC(i,n,Ne>-1?Ne:ct,Qt)}!u&&s&&Ut&&e[ct].componentProviders++}}}function TC(n,r,e,s){let u=rg(r),i=uz(r);if(u||i){let j=(i?us(r.useClass):r).prototype.ngOnDestroy;if(j){let Y=n.destroyHooks||(n.destroyHooks=[]);if(!u&&r.multi){let oe=Y.indexOf(e);oe===-1?Y.push(e,[s,j]):Y[oe+1].push(s,j)}else Y.push(e,j)}}}function cP(n,r,e){return e&&n.componentProviders++,n.multi.push(r)-1}function IC(n,r,e,s){for(let u=e;u<s;u++)if(r[u]===n)return u;return-1}function oU(n,r,e,s){return wE(this.multi,[])}function sU(n,r,e,s){let u=this.multi,i;if(this.providerFactory){let E=this.providerFactory.componentProviders,L=E_(e,e[ni],this.providerFactory.index,s);i=L.slice(0,E),wE(u,i);for(let j=E;j<L.length;j++)i.push(L[j])}else i=[],wE(u,i);return i}function wE(n,r){for(let e=0;e<n.length;e++){let s=n[e];r.push(s())}return r}function aU(n,r,e,s,u){let i=new sp(n,e,Hi);return i.multi=[],i.index=r,i.componentProviders=0,cP(i,u,s&&!e),i}function Ca(n,r=[]){return e=>{e.providersResolver=(s,u)=>rU(s,u?u(n):n,r)}}function gD(n,r,e){let s=ak()+n,u=gi();return u[s]===va?HR(u,s,e?r.call(e):r()):p3(u,s)}function yD(n,r,e,s,u){return cU(gi(),ak(),n,r,e,s,u)}function lU(n,r){let e=n[r];return e===va?void 0:e}function cU(n,r,e,s,u,i,E){let L=r+e;return GR(n,L,u,i)?HR(n,L+2,E?s.call(E,u,i):s(u,i)):lU(n,L+2)}var l0=null;function uU(n){l0!==null&&(n.defaultEncapsulation!==l0.defaultEncapsulation||n.preserveWhitespaces!==l0.preserveWhitespaces)||(l0=n)}var xh=class{full;major;minor;patch;constructor(r){this.full=r;let e=r.split(".");this.major=e[0],this.minor=e[1],this.patch=e.slice(2).join(".")}},_D=new xh("19.2.2"),CE=class{ngModuleFactory;componentFactories;constructor(r,e){this.ngModuleFactory=r,this.componentFactories=e}},cx=(()=>{class n{compileModuleSync(e){return new B0(e)}compileModuleAsync(e){return Promise.resolve(this.compileModuleSync(e))}compileModuleAndAllComponentsSync(e){let s=this.compileModuleSync(e),u=LA(e),i=rR(u.declarations).reduce((E,L)=>{let j=vh(L);return j&&E.push(new lp(j)),E},[]);return new CE(s,i)}compileModuleAndAllComponentsAsync(e){return Promise.resolve(this.compileModuleAndAllComponentsSync(e))}clearCache(){}clearCacheFor(e){}getModuleId(e){}static \u0275fac=function(s){return new(s||n)};static \u0275prov=xt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),dU=new dt("");function hU(n,r,e){let s=new B0(e);return Promise.resolve(s)}function bA(n){for(let r=n.length-1;r>=0;r--)if(n[r]!==void 0)return n[r]}var fU=(()=>{class n{zone=we(ln);changeDetectionScheduler=we(ap);applicationRef=we(js);_onMicrotaskEmptySubscription;initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.changeDetectionScheduler.runningTick||this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static \u0275fac=function(s){return new(s||n)};static \u0275prov=xt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function pU({ngZoneFactory:n,ignoreChangesOutsideZone:r,scheduleInRootZone:e}){return n??=()=>new ln(Cn(ut({},uP()),{scheduleInRootZone:e})),[{provide:ln,useFactory:n},{provide:ep,multi:!0,useFactory:()=>{let s=we(fU,{optional:!0});return()=>s.initialize()}},{provide:ep,multi:!0,useFactory:()=>{let s=we(mU);return()=>{s.initialize()}}},r===!0?{provide:Ak,useValue:!0}:[],{provide:kk,useValue:e??Sk}]}function uP(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:n?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:n?.runCoalescing??!1}}var mU=(()=>{class n{subscription=new Oi;initialized=!1;zone=we(ln);pendingTasks=we(od);initialize(){if(this.initialized)return;this.initialized=!0;let e=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(e=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{ln.assertNotInAngularZone(),queueMicrotask(()=>{e!==null&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(e),e=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{ln.assertInAngularZone(),e??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}static \u0275fac=function(s){return new(s||n)};static \u0275prov=xt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var gU=(()=>{class n{appRef=we(js);taskService=we(od);ngZone=we(ln);zonelessEnabled=we(jE);tracing=we(mg,{optional:!0});disableScheduling=we(Ak,{optional:!0})??!1;zoneIsDefined=typeof Zone<"u"&&!!Zone.root.run;schedulerTickApplyArgs=[{data:{__scheduler_tick__:!0}}];subscriptions=new Oi;angularZoneId=this.zoneIsDefined?this.ngZone._inner?.get(I0):null;scheduleInRootZone=!this.zonelessEnabled&&this.zoneIsDefined&&(we(kk,{optional:!0})??!1);cancelScheduledCallback=null;useMicrotaskScheduler=!1;runningTick=!1;pendingRenderTaskId=null;constructor(){this.subscriptions.add(this.appRef.afterTick.subscribe(()=>{this.runningTick||this.cleanup()})),this.subscriptions.add(this.ngZone.onUnstable.subscribe(()=>{this.runningTick||this.cleanup()})),this.disableScheduling||=!this.zonelessEnabled&&(this.ngZone instanceof S0||!this.zoneIsDefined)}notify(e){if(!this.zonelessEnabled&&e===5)return;let s=!1;switch(e){case 0:{this.appRef.dirtyFlags|=2;break}case 3:case 2:case 4:case 5:case 1:{this.appRef.dirtyFlags|=4;break}case 6:{this.appRef.dirtyFlags|=2,s=!0;break}case 12:{this.appRef.dirtyFlags|=16,s=!0;break}case 13:{this.appRef.dirtyFlags|=2,s=!0;break}case 11:{s=!0;break}case 9:case 8:case 7:case 10:default:this.appRef.dirtyFlags|=8}if(this.appRef.tracingSnapshot=this.tracing?.snapshot(this.appRef.tracingSnapshot)??null,!this.shouldScheduleTick(s))return;let u=this.useMicrotaskScheduler?qS:Rk;this.pendingRenderTaskId=this.taskService.add(),this.scheduleInRootZone?this.cancelScheduledCallback=Zone.root.run(()=>u(()=>this.tick())):this.cancelScheduledCallback=this.ngZone.runOutsideAngular(()=>u(()=>this.tick()))}shouldScheduleTick(e){return!(this.disableScheduling&&!e||this.appRef.destroyed||this.pendingRenderTaskId!==null||this.runningTick||this.appRef._runningTick||!this.zonelessEnabled&&this.zoneIsDefined&&Zone.current.get(I0+this.angularZoneId))}tick(){if(this.runningTick||this.appRef.destroyed)return;if(this.appRef.dirtyFlags===0){this.cleanup();return}!this.zonelessEnabled&&this.appRef.dirtyFlags&7&&(this.appRef.dirtyFlags|=1);let e=this.taskService.add();try{this.ngZone.run(()=>{this.runningTick=!0,this.appRef._tick()},void 0,this.schedulerTickApplyArgs)}catch(s){throw this.taskService.remove(e),s}finally{this.cleanup()}this.useMicrotaskScheduler=!0,qS(()=>{this.useMicrotaskScheduler=!1,this.taskService.remove(e)})}ngOnDestroy(){this.subscriptions.unsubscribe(),this.cleanup()}cleanup(){if(this.runningTick=!1,this.cancelScheduledCallback?.(),this.cancelScheduledCallback=null,this.pendingRenderTaskId!==null){let e=this.pendingRenderTaskId;this.pendingRenderTaskId=null,this.taskService.remove(e)}}static \u0275fac=function(s){return new(s||n)};static \u0275prov=xt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function yU(){return typeof $localize<"u"&&$localize.locale||V0}var ux=new dt("",{providedIn:"root",factory:()=>we(ux,ti.Optional|ti.SkipSelf)||yU()});var U0=new dt(""),_U=new dt("");function f_(n){return!n.moduleRef}function vU(n){let r=f_(n)?n.r3Injector:n.moduleRef.injector,e=r.get(ln);return e.run(()=>{f_(n)?n.r3Injector.resolveInjectorInitializers():n.moduleRef.resolveInjectorInitializers();let s=r.get(Bs,null),u;if(e.runOutsideAngular(()=>{u=e.onError.subscribe({next:i=>{s.handleError(i)}})}),f_(n)){let i=()=>r.destroy(),E=n.platformInjector.get(U0);E.add(i),r.onDestroy(()=>{u.unsubscribe(),E.delete(i)})}else{let i=()=>n.moduleRef.destroy(),E=n.platformInjector.get(U0);E.add(i),n.moduleRef.onDestroy(()=>{f0(n.allPlatformModules,n.moduleRef),u.unsubscribe(),E.delete(i)})}return xU(s,e,()=>{let i=r.get(XR);return i.runInitializers(),i.donePromise.then(()=>{let E=r.get(ux,V0);if(K3(E||V0),!r.get(_U,!0))return f_(n)?r.get(js):(n.allPlatformModules.push(n.moduleRef),n.moduleRef);if(f_(n)){let j=r.get(js);return n.rootComponent!==void 0&&j.bootstrap(n.rootComponent),j}else return bU(n.moduleRef,n.allPlatformModules),n.moduleRef})})})}function bU(n,r){let e=n.injector.get(js);if(n._bootstrapComponents.length>0)n._bootstrapComponents.forEach(s=>e.bootstrap(s));else if(n.instance.ngDoBootstrap)n.instance.ngDoBootstrap(e);else throw new Ht(-403,!1);r.push(n)}function xU(n,r,e){try{let s=e();return _g(s)?s.catch(u=>{throw r.runOutsideAngular(()=>n.handleError(u)),u}):s}catch(s){throw r.runOutsideAngular(()=>n.handleError(s)),s}}var dP=(()=>{class n{_injector;_modules=[];_destroyListeners=[];_destroyed=!1;constructor(e){this._injector=e}bootstrapModuleFactory(e,s){let u=s?.scheduleInRootZone,i=()=>fB(s?.ngZone,Cn(ut({},uP({eventCoalescing:s?.ngZoneEventCoalescing,runCoalescing:s?.ngZoneRunCoalescing})),{scheduleInRootZone:u})),E=s?.ignoreChangesOutsideZone,L=[pU({ngZoneFactory:i,ignoreChangesOutsideZone:E}),{provide:ap,useExisting:gU}],j=t3(e.moduleType,this.injector,L);return vU({moduleRef:j,allPlatformModules:this._modules,platformInjector:this.injector})}bootstrapModule(e,s=[]){let u=YR({},s);return hU(this.injector,u,e).then(i=>this.bootstrapModuleFactory(i,u))}onDestroy(e){this._destroyListeners.push(e)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Ht(404,!1);this._modules.slice().forEach(s=>s.destroy()),this._destroyListeners.forEach(s=>s());let e=this._injector.get(U0,null);e&&(e.forEach(s=>s()),e.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}static \u0275fac=function(s){return new(s||n)(St(Jn))};static \u0275prov=xt({token:n,factory:n.\u0275fac,providedIn:"platform"})}return n})(),y_=null,hP=new dt("");function wU(n){if(y_&&!y_.get(hP,!1))throw new Ht(400,!1);v3(),y_=n;let r=n.get(dP);return DU(n),r}function vD(n,r,e=[]){let s=`Platform: ${r}`,u=new dt(s);return(i=[])=>{let E=fP();if(!E||E.injector.get(hP,!1)){let L=[...e,...i,{provide:u,useValue:!0}];n?n(L):wU(CU(L,s))}return EU(u)}}function CU(n=[],r){return Jn.create({name:r,providers:[{provide:q0,useValue:"platform"},{provide:U0,useValue:new Set([()=>y_=null])},...n]})}function EU(n){let r=fP();if(!r)throw new Ht(401,!1);return r}function fP(){return y_?.get(dP)??null}function DU(n){let r=n.get($E,null);Vs(n,()=>{r?.forEach(e=>e())})}function bD(){return!1}var ps=(()=>{class n{static __NG_ELEMENT_ID__=MU}return n})();function MU(n){return TU(ga(),gi(),(n&16)===16)}function TU(n,r,e){if(dg(n)&&!e){let s=Gc(n.index,r);return new M_(s,s)}else if(n.type&175){let s=r[Za];return new M_(s,r)}return null}var pP=vD(null,"core",[]),mP=(()=>{class n{constructor(e){}static \u0275fac=function(s){return new(s||n)(St(js))};static \u0275mod=en({type:n});static \u0275inj=Jt({})}return n})();function Vr(n){return typeof n=="boolean"?n:n!=null&&n!=="false"}function dx(n,r=NaN){return!isNaN(parseFloat(n))&&!isNaN(Number(n))?Number(n):r}function fp(n){let r=si(null);try{return n()}finally{si(r)}}function xg(n,r){let e=eS(n);return r?.equal&&(e[Ga].equal=r.equal),e}var EE=class{[Ga];constructor(r){this[Ga]=r}destroy(){this[Ga].destroy()}};function V_(n,r){!r?.injector&&cg(V_);let e=r?.injector??we(Jn),s=r?.manualCleanup!==!0?e.get(Zc):null,u,i=e.get(GE,null,{optional:!0}),E=e.get(ap);return i!==null&&!r?.forceRoot?(u=AU(i.view,E,n),s instanceof T0&&s._lView===i.view&&(s=null)):u=kU(n,e.get(qR),E),u.injector=e,s!==null&&(u.onDestroyFn=s.onDestroy(()=>u.destroy())),new EE(u)}var gP=Cn(ut({},Nm),{consumerIsAlwaysLive:!0,consumerAllowSignalWrites:!0,dirty:!0,hasRun:!1,cleanupFns:void 0,zone:null,kind:"effect",onDestroyFn:D_,run(){if(this.dirty=!1,this.hasRun&&!Tb(this))return;this.hasRun=!0;let n=s=>(this.cleanupFns??=[]).push(s),r=r_(this),e=C0(!1);try{this.maybeCleanup(),this.fn(n)}finally{C0(e),Mb(this,r)}},maybeCleanup(){if(this.cleanupFns?.length)try{for(;this.cleanupFns.length;)this.cleanupFns.pop()()}finally{this.cleanupFns=[]}}}),IU=Cn(ut({},gP),{consumerMarkedDirty(){this.scheduler.schedule(this),this.notifier.notify(12)},destroy(){o_(this),this.onDestroyFn(),this.maybeCleanup(),this.scheduler.remove(this)}}),SU=Cn(ut({},gP),{consumerMarkedDirty(){this.view[zn]|=8192,hg(this.view),this.notifier.notify(13)},destroy(){o_(this),this.onDestroyFn(),this.maybeCleanup(),this.view[np]?.delete(this)}});function AU(n,r,e){let s=Object.create(SU);return s.view=n,s.zone=typeof Zone<"u"?Zone.current:null,s.notifier=r,s.fn=e,n[np]??=new Set,n[np].add(s),s.consumerMarkedDirty(s),s}function kU(n,r,e){let s=Object.create(IU);return s.fn=n,s.scheduler=r,s.notifier=e,s.zone=typeof Zone<"u"?Zone.current:null,s.scheduler.schedule(s),s.notifier.notify(12),s}function hx(n,r){let e=vh(n),s=r.elementInjector||Z0();return new lp(e).create(s,r.projectableNodes,r.hostElement,r.environmentInjector)}function yP(n){let r=vh(n);if(!r)return null;let e=new lp(r);return{get selector(){return e.selector},get type(){return e.componentType},get inputs(){return e.inputs},get outputs(){return e.outputs},get ngContentSelectors(){return e.ngContentSelectors},get isStandalone(){return r.standalone},get isSignal(){return r.signals}}}var wP=null;function pp(){return wP}function CP(n){wP??=n}var fx=class{};var Un=new dt(""),ED=(()=>{class n{historyGo(e){throw new Error("")}static \u0275fac=function(s){return new(s||n)};static \u0275prov=xt({token:n,factory:()=>we(OU),providedIn:"platform"})}return n})(),EP=new dt(""),OU=(()=>{class n extends ED{_location;_history;_doc=we(Un);constructor(){super(),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return pp().getBaseHref(this._doc)}onPopState(e){let s=pp().getGlobalEventTarget(this._doc,"window");return s.addEventListener("popstate",e,!1),()=>s.removeEventListener("popstate",e)}onHashChange(e){let s=pp().getGlobalEventTarget(this._doc,"window");return s.addEventListener("hashchange",e,!1),()=>s.removeEventListener("hashchange",e)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(e){this._location.pathname=e}pushState(e,s,u){this._history.pushState(e,s,u)}replaceState(e,s,u){this._history.replaceState(e,s,u)}forward(){this._history.forward()}back(){this._history.back()}historyGo(e=0){this._history.go(e)}getState(){return this._history.state}static \u0275fac=function(s){return new(s||n)};static \u0275prov=xt({token:n,factory:()=>new n,providedIn:"platform"})}return n})();function DD(n,r){return n?r?n.endsWith("/")?r.startsWith("/")?n+r.slice(1):n+r:r.startsWith("/")?n+r:`${n}/${r}`:n:r}function _P(n){let r=n.search(/#|\?|$/);return n[r-1]==="/"?n.slice(0,r-1)+n.slice(r):n}function ld(n){return n&&n[0]!=="?"?`?${n}`:n}var mp=(()=>{class n{historyGo(e){throw new Error("")}static \u0275fac=function(s){return new(s||n)};static \u0275prov=xt({token:n,factory:()=>we(MD),providedIn:"root"})}return n})(),DP=new dt(""),MD=(()=>{class n extends mp{_platformLocation;_baseHref;_removeListenerFns=[];constructor(e,s){super(),this._platformLocation=e,this._baseHref=s??this._platformLocation.getBaseHrefFromDOM()??we(Un).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}getBaseHref(){return this._baseHref}prepareExternalUrl(e){return DD(this._baseHref,e)}path(e=!1){let s=this._platformLocation.pathname+ld(this._platformLocation.search),u=this._platformLocation.hash;return u&&e?`${s}${u}`:s}pushState(e,s,u,i){let E=this.prepareExternalUrl(u+ld(i));this._platformLocation.pushState(e,s,E)}replaceState(e,s,u,i){let E=this.prepareExternalUrl(u+ld(i));this._platformLocation.replaceState(e,s,E)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(e=0){this._platformLocation.historyGo?.(e)}static \u0275fac=function(s){return new(s||n)(St(ED),St(DP,8))};static \u0275prov=xt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),MP=(()=>{class n extends mp{_platformLocation;_baseHref="";_removeListenerFns=[];constructor(e,s){super(),this._platformLocation=e,s!=null&&(this._baseHref=s)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}getBaseHref(){return this._baseHref}path(e=!1){let s=this._platformLocation.hash??"#";return s.length>0?s.substring(1):s}prepareExternalUrl(e){let s=DD(this._baseHref,e);return s.length>0?"#"+s:s}pushState(e,s,u,i){let E=this.prepareExternalUrl(u+ld(i))||this._platformLocation.pathname;this._platformLocation.pushState(e,s,E)}replaceState(e,s,u,i){let E=this.prepareExternalUrl(u+ld(i))||this._platformLocation.pathname;this._platformLocation.replaceState(e,s,E)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(e=0){this._platformLocation.historyGo?.(e)}static \u0275fac=function(s){return new(s||n)(St(ED),St(DP,8))};static \u0275prov=xt({token:n,factory:n.\u0275fac})}return n})(),Th=(()=>{class n{_subject=new _n;_basePath;_locationStrategy;_urlChangeListeners=[];_urlChangeSubscription=null;constructor(e){this._locationStrategy=e;let s=this._locationStrategy.getBaseHref();this._basePath=NU(_P(vP(s))),this._locationStrategy.onPopState(u=>{this._subject.next({url:this.path(!0),pop:!0,state:u.state,type:u.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(e=!1){return this.normalize(this._locationStrategy.path(e))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(e,s=""){return this.path()==this.normalize(e+ld(s))}normalize(e){return n.stripTrailingSlash(FU(this._basePath,vP(e)))}prepareExternalUrl(e){return e&&e[0]!=="/"&&(e="/"+e),this._locationStrategy.prepareExternalUrl(e)}go(e,s="",u=null){this._locationStrategy.pushState(u,"",e,s),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+ld(s)),u)}replaceState(e,s="",u=null){this._locationStrategy.replaceState(u,"",e,s),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+ld(s)),u)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(e=0){this._locationStrategy.historyGo?.(e)}onUrlChange(e){return this._urlChangeListeners.push(e),this._urlChangeSubscription??=this.subscribe(s=>{this._notifyUrlChangeListeners(s.url,s.state)}),()=>{let s=this._urlChangeListeners.indexOf(e);this._urlChangeListeners.splice(s,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(e="",s){this._urlChangeListeners.forEach(u=>u(e,s))}subscribe(e,s,u){return this._subject.subscribe({next:e,error:s??void 0,complete:u??void 0})}static normalizeQueryParams=ld;static joinWithSlash=DD;static stripTrailingSlash=_P;static \u0275fac=function(s){return new(s||n)(St(mp))};static \u0275prov=xt({token:n,factory:()=>LU(),providedIn:"root"})}return n})();function LU(){return new Th(St(mp))}function FU(n,r){if(!n||!r.startsWith(n))return r;let e=r.substring(n.length);return e===""||["/",";","?","#"].includes(e[0])?e:r}function vP(n){return n.replace(/\/index.html$/,"")}function NU(n){if(new RegExp("^(https?:)?//").test(n)){let[,e]=n.split(/\/\/[^\/]+/);return e}return n}function px(n,r){r=encodeURIComponent(r);for(let e of n.split(";")){let s=e.indexOf("="),[u,i]=s==-1?[e,""]:[e.slice(0,s),e.slice(s+1)];if(u.trim()===r)return decodeURIComponent(i)}return null}var xD=/\s+/,bP=[],Cg=(()=>{class n{_ngEl;_renderer;initialClasses=bP;rawClass;stateMap=new Map;constructor(e,s){this._ngEl=e,this._renderer=s}set klass(e){this.initialClasses=e!=null?e.trim().split(xD):bP}set ngClass(e){this.rawClass=typeof e=="string"?e.trim().split(xD):e}ngDoCheck(){for(let s of this.initialClasses)this._updateState(s,!0);let e=this.rawClass;if(Array.isArray(e)||e instanceof Set)for(let s of e)this._updateState(s,!0);else if(e!=null)for(let s of Object.keys(e))this._updateState(s,!!e[s]);this._applyStateDiff()}_updateState(e,s){let u=this.stateMap.get(e);u!==void 0?(u.enabled!==s&&(u.changed=!0,u.enabled=s),u.touched=!0):this.stateMap.set(e,{enabled:s,changed:!0,touched:!0})}_applyStateDiff(){for(let e of this.stateMap){let s=e[0],u=e[1];u.changed?(this._toggleClass(s,u.enabled),u.changed=!1):u.touched||(u.enabled&&this._toggleClass(s,!1),this.stateMap.delete(s)),u.touched=!1}}_toggleClass(e,s){e=e.trim(),e.length>0&&e.split(xD).forEach(u=>{s?this._renderer.addClass(this._ngEl.nativeElement,u):this._renderer.removeClass(this._ngEl.nativeElement,u)})}static \u0275fac=function(s){return new(s||n)(Hi(yi),Hi(dp))};static \u0275dir=Ni({type:n,selectors:[["","ngClass",""]],inputs:{klass:[0,"class","klass"],ngClass:"ngClass"}})}return n})();var mx=(()=>{class n{_viewContainer;_context=new wD;_thenTemplateRef=null;_elseTemplateRef=null;_thenViewRef=null;_elseViewRef=null;constructor(e,s){this._viewContainer=e,this._thenTemplateRef=s}set ngIf(e){this._context.$implicit=this._context.ngIf=e,this._updateView()}set ngIfThen(e){xP(e,!1),this._thenTemplateRef=e,this._thenViewRef=null,this._updateView()}set ngIfElse(e){xP(e,!1),this._elseTemplateRef=e,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngIfUseIfTypeGuard;static ngTemplateGuard_ngIf;static ngTemplateContextGuard(e,s){return!0}static \u0275fac=function(s){return new(s||n)(Hi(ba),Hi(Xa))};static \u0275dir=Ni({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}})}return n})(),wD=class{$implicit=null;ngIf=null};function xP(n,r){if(n&&!n.createEmbeddedView)throw new Ht(2020,!1)}var Eg=(()=>{class n{static \u0275fac=function(s){return new(s||n)};static \u0275mod=en({type:n});static \u0275inj=Jt({})}return n})(),TD="browser",zU="server";function TP(n){return n===TD}function ID(n){return n===zU}var IP=(()=>{class n{static \u0275prov=xt({token:n,providedIn:"root",factory:()=>new CD(we(Un),window)})}return n})(),CD=class{document;window;offset=()=>[0,0];constructor(r,e){this.document=r,this.window=e}setOffset(r){Array.isArray(r)?this.offset=()=>r:this.offset=r}getScrollPosition(){return[this.window.scrollX,this.window.scrollY]}scrollToPosition(r){this.window.scrollTo(r[0],r[1])}scrollToAnchor(r){let e=BU(this.document,r);e&&(this.scrollToElement(e),e.focus())}setHistoryScrollRestoration(r){this.window.history.scrollRestoration=r}scrollToElement(r){let e=r.getBoundingClientRect(),s=e.left+this.window.pageXOffset,u=e.top+this.window.pageYOffset,i=this.offset();this.window.scrollTo(s-i[0],u-i[1])}};function BU(n,r){let e=n.getElementById(r)||n.getElementsByName(r)[0];if(e)return e;if(typeof n.createTreeWalker=="function"&&n.body&&typeof n.body.attachShadow=="function"){let s=n.createTreeWalker(n.body,NodeFilter.SHOW_ELEMENT),u=s.currentNode;for(;u;){let i=u.shadowRoot;if(i){let E=i.getElementById(r)||i.querySelector(`[name="${r}"]`);if(E)return E}u=s.nextNode()}}return null}var wg=class{};var $_=class{},_x=class{},gp=class n{headers;normalizedNames=new Map;lazyInit;lazyUpdate=null;constructor(r){r?typeof r=="string"?this.lazyInit=()=>{this.headers=new Map,r.split(`
`).forEach(e=>{let s=e.indexOf(":");if(s>0){let u=e.slice(0,s),i=e.slice(s+1).trim();this.addHeaderEntry(u,i)}})}:typeof Headers<"u"&&r instanceof Headers?(this.headers=new Map,r.forEach((e,s)=>{this.addHeaderEntry(s,e)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(r).forEach(([e,s])=>{this.setHeaderEntries(e,s)})}:this.headers=new Map}has(r){return this.init(),this.headers.has(r.toLowerCase())}get(r){this.init();let e=this.headers.get(r.toLowerCase());return e&&e.length>0?e[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(r){return this.init(),this.headers.get(r.toLowerCase())||null}append(r,e){return this.clone({name:r,value:e,op:"a"})}set(r,e){return this.clone({name:r,value:e,op:"s"})}delete(r,e){return this.clone({name:r,value:e,op:"d"})}maybeSetNormalizedName(r,e){this.normalizedNames.has(e)||this.normalizedNames.set(e,r)}init(){this.lazyInit&&(this.lazyInit instanceof n?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(r=>this.applyUpdate(r)),this.lazyUpdate=null))}copyFrom(r){r.init(),Array.from(r.headers.keys()).forEach(e=>{this.headers.set(e,r.headers.get(e)),this.normalizedNames.set(e,r.normalizedNames.get(e))})}clone(r){let e=new n;return e.lazyInit=this.lazyInit&&this.lazyInit instanceof n?this.lazyInit:this,e.lazyUpdate=(this.lazyUpdate||[]).concat([r]),e}applyUpdate(r){let e=r.name.toLowerCase();switch(r.op){case"a":case"s":let s=r.value;if(typeof s=="string"&&(s=[s]),s.length===0)return;this.maybeSetNormalizedName(r.name,e);let u=(r.op==="a"?this.headers.get(e):void 0)||[];u.push(...s),this.headers.set(e,u);break;case"d":let i=r.value;if(!i)this.headers.delete(e),this.normalizedNames.delete(e);else{let E=this.headers.get(e);if(!E)return;E=E.filter(L=>i.indexOf(L)===-1),E.length===0?(this.headers.delete(e),this.normalizedNames.delete(e)):this.headers.set(e,E)}break}}addHeaderEntry(r,e){let s=r.toLowerCase();this.maybeSetNormalizedName(r,s),this.headers.has(s)?this.headers.get(s).push(e):this.headers.set(s,[e])}setHeaderEntries(r,e){let s=(Array.isArray(e)?e:[e]).map(i=>i.toString()),u=r.toLowerCase();this.headers.set(u,s),this.maybeSetNormalizedName(r,u)}forEach(r){this.init(),Array.from(this.normalizedNames.keys()).forEach(e=>r(this.normalizedNames.get(e),this.headers.get(e)))}};var AD=class{encodeKey(r){return SP(r)}encodeValue(r){return SP(r)}decodeKey(r){return decodeURIComponent(r)}decodeValue(r){return decodeURIComponent(r)}};function jU(n,r){let e=new Map;return n.length>0&&n.replace(/^\?/,"").split("&").forEach(u=>{let i=u.indexOf("="),[E,L]=i==-1?[r.decodeKey(u),""]:[r.decodeKey(u.slice(0,i)),r.decodeValue(u.slice(i+1))],j=e.get(E)||[];j.push(L),e.set(E,j)}),e}var VU=/%(\d[a-f0-9])/gi,UU={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function SP(n){return encodeURIComponent(n).replace(VU,(r,e)=>UU[e]??r)}function yx(n){return`${n}`}var Ih=class n{map;encoder;updates=null;cloneFrom=null;constructor(r={}){if(this.encoder=r.encoder||new AD,r.fromString){if(r.fromObject)throw new Ht(2805,!1);this.map=jU(r.fromString,this.encoder)}else r.fromObject?(this.map=new Map,Object.keys(r.fromObject).forEach(e=>{let s=r.fromObject[e],u=Array.isArray(s)?s.map(yx):[yx(s)];this.map.set(e,u)})):this.map=null}has(r){return this.init(),this.map.has(r)}get(r){this.init();let e=this.map.get(r);return e?e[0]:null}getAll(r){return this.init(),this.map.get(r)||null}keys(){return this.init(),Array.from(this.map.keys())}append(r,e){return this.clone({param:r,value:e,op:"a"})}appendAll(r){let e=[];return Object.keys(r).forEach(s=>{let u=r[s];Array.isArray(u)?u.forEach(i=>{e.push({param:s,value:i,op:"a"})}):e.push({param:s,value:u,op:"a"})}),this.clone(e)}set(r,e){return this.clone({param:r,value:e,op:"s"})}delete(r,e){return this.clone({param:r,value:e,op:"d"})}toString(){return this.init(),this.keys().map(r=>{let e=this.encoder.encodeKey(r);return this.map.get(r).map(s=>e+"="+this.encoder.encodeValue(s)).join("&")}).filter(r=>r!=="").join("&")}clone(r){let e=new n({encoder:this.encoder});return e.cloneFrom=this.cloneFrom||this,e.updates=(this.updates||[]).concat(r),e}init(){this.map===null&&(this.map=new Map),this.cloneFrom!==null&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(r=>this.map.set(r,this.cloneFrom.map.get(r))),this.updates.forEach(r=>{switch(r.op){case"a":case"s":let e=(r.op==="a"?this.map.get(r.param):void 0)||[];e.push(yx(r.value)),this.map.set(r.param,e);break;case"d":if(r.value!==void 0){let s=this.map.get(r.param)||[],u=s.indexOf(yx(r.value));u!==-1&&s.splice(u,1),s.length>0?this.map.set(r.param,s):this.map.delete(r.param)}else{this.map.delete(r.param);break}}}),this.cloneFrom=this.updates=null)}};var kD=class{map=new Map;set(r,e){return this.map.set(r,e),this}get(r){return this.map.has(r)||this.map.set(r,r.defaultValue()),this.map.get(r)}delete(r){return this.map.delete(r),this}has(r){return this.map.has(r)}keys(){return this.map.keys()}};function $U(n){switch(n){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}function AP(n){return typeof ArrayBuffer<"u"&&n instanceof ArrayBuffer}function kP(n){return typeof Blob<"u"&&n instanceof Blob}function RP(n){return typeof FormData<"u"&&n instanceof FormData}function HU(n){return typeof URLSearchParams<"u"&&n instanceof URLSearchParams}var PP="Content-Type",OP="Accept",zP="X-Request-URL",BP="text/plain",jP="application/json",GU=`${jP}, ${BP}, */*`,U_=class n{url;body=null;headers;context;reportProgress=!1;withCredentials=!1;responseType="json";method;params;urlWithParams;transferCache;constructor(r,e,s,u){this.url=e,this.method=r.toUpperCase();let i;if($U(this.method)||u?(this.body=s!==void 0?s:null,i=u):i=s,i&&(this.reportProgress=!!i.reportProgress,this.withCredentials=!!i.withCredentials,i.responseType&&(this.responseType=i.responseType),i.headers&&(this.headers=i.headers),i.context&&(this.context=i.context),i.params&&(this.params=i.params),this.transferCache=i.transferCache),this.headers??=new gp,this.context??=new kD,!this.params)this.params=new Ih,this.urlWithParams=e;else{let E=this.params.toString();if(E.length===0)this.urlWithParams=e;else{let L=e.indexOf("?"),j=L===-1?"?":L<e.length-1?"&":"";this.urlWithParams=e+j+E}}}serializeBody(){return this.body===null?null:typeof this.body=="string"||AP(this.body)||kP(this.body)||RP(this.body)||HU(this.body)?this.body:this.body instanceof Ih?this.body.toString():typeof this.body=="object"||typeof this.body=="boolean"||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return this.body===null||RP(this.body)?null:kP(this.body)?this.body.type||null:AP(this.body)?null:typeof this.body=="string"?BP:this.body instanceof Ih?"application/x-www-form-urlencoded;charset=UTF-8":typeof this.body=="object"||typeof this.body=="number"||typeof this.body=="boolean"?jP:null}clone(r={}){let e=r.method||this.method,s=r.url||this.url,u=r.responseType||this.responseType,i=r.transferCache??this.transferCache,E=r.body!==void 0?r.body:this.body,L=r.withCredentials??this.withCredentials,j=r.reportProgress??this.reportProgress,Y=r.headers||this.headers,oe=r.params||this.params,Ee=r.context??this.context;return r.setHeaders!==void 0&&(Y=Object.keys(r.setHeaders).reduce((Ye,Ne)=>Ye.set(Ne,r.setHeaders[Ne]),Y)),r.setParams&&(oe=Object.keys(r.setParams).reduce((Ye,Ne)=>Ye.set(Ne,r.setParams[Ne]),oe)),new n(e,s,E,{params:oe,headers:Y,context:Ee,reportProgress:j,responseType:u,withCredentials:L,transferCache:i})}},Dg=function(n){return n[n.Sent=0]="Sent",n[n.UploadProgress=1]="UploadProgress",n[n.ResponseHeader=2]="ResponseHeader",n[n.DownloadProgress=3]="DownloadProgress",n[n.Response=4]="Response",n[n.User=5]="User",n}(Dg||{}),H_=class{headers;status;statusText;url;ok;type;constructor(r,e=200,s="OK"){this.headers=r.headers||new gp,this.status=r.status!==void 0?r.status:e,this.statusText=r.statusText||s,this.url=r.url||null,this.ok=this.status>=200&&this.status<300}},RD=class n extends H_{constructor(r={}){super(r)}type=Dg.ResponseHeader;clone(r={}){return new n({headers:r.headers||this.headers,status:r.status!==void 0?r.status:this.status,statusText:r.statusText||this.statusText,url:r.url||this.url||void 0})}},vx=class n extends H_{body;constructor(r={}){super(r),this.body=r.body!==void 0?r.body:null}type=Dg.Response;clone(r={}){return new n({body:r.body!==void 0?r.body:this.body,headers:r.headers||this.headers,status:r.status!==void 0?r.status:this.status,statusText:r.statusText||this.statusText,url:r.url||this.url||void 0})}},bx=class extends H_{name="HttpErrorResponse";message;error;ok=!1;constructor(r){super(r,0,"Unknown Error"),this.status>=200&&this.status<300?this.message=`Http failure during parsing for ${r.url||"(unknown url)"}`:this.message=`Http failure response for ${r.url||"(unknown url)"}: ${r.status} ${r.statusText}`,this.error=r.error||null}},WU=200,qU=204;function SD(n,r){return{body:r,headers:n.headers,context:n.context,observe:n.observe,params:n.params,reportProgress:n.reportProgress,responseType:n.responseType,withCredentials:n.withCredentials,transferCache:n.transferCache}}var G_=(()=>{class n{handler;constructor(e){this.handler=e}request(e,s,u={}){let i;if(e instanceof U_)i=e;else{let j;u.headers instanceof gp?j=u.headers:j=new gp(u.headers);let Y;u.params&&(u.params instanceof Ih?Y=u.params:Y=new Ih({fromObject:u.params})),i=new U_(e,s,u.body!==void 0?u.body:null,{headers:j,context:u.context,params:Y,reportProgress:u.reportProgress,responseType:u.responseType||"json",withCredentials:u.withCredentials,transferCache:u.transferCache})}let E=nn(i).pipe(Ku(j=>this.handler.handle(j)));if(e instanceof U_||u.observe==="events")return E;let L=E.pipe(Lr(j=>j instanceof vx));switch(u.observe||"body"){case"body":switch(i.responseType){case"arraybuffer":return L.pipe(un(j=>{if(j.body!==null&&!(j.body instanceof ArrayBuffer))throw new Ht(2806,!1);return j.body}));case"blob":return L.pipe(un(j=>{if(j.body!==null&&!(j.body instanceof Blob))throw new Ht(2807,!1);return j.body}));case"text":return L.pipe(un(j=>{if(j.body!==null&&typeof j.body!="string")throw new Ht(2808,!1);return j.body}));case"json":default:return L.pipe(un(j=>j.body))}case"response":return L;default:throw new Ht(2809,!1)}}delete(e,s={}){return this.request("DELETE",e,s)}get(e,s={}){return this.request("GET",e,s)}head(e,s={}){return this.request("HEAD",e,s)}jsonp(e,s){return this.request("JSONP",e,{params:new Ih().append(s,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(e,s={}){return this.request("OPTIONS",e,s)}patch(e,s,u={}){return this.request("PATCH",e,SD(u,s))}post(e,s,u={}){return this.request("POST",e,SD(u,s))}put(e,s,u={}){return this.request("PUT",e,SD(u,s))}static \u0275fac=function(s){return new(s||n)(St($_))};static \u0275prov=xt({token:n,factory:n.\u0275fac})}return n})();var ZU=new dt("");function VP(n,r){return r(n)}function XU(n,r){return(e,s)=>r.intercept(e,{handle:u=>n(u,s)})}function YU(n,r,e){return(s,u)=>Vs(e,()=>r(s,i=>n(i,u)))}var KU=new dt(""),PD=new dt(""),QU=new dt(""),UP=new dt("",{providedIn:"root",factory:()=>!0});function JU(){let n=null;return(r,e)=>{n===null&&(n=(we(KU,{optional:!0})??[]).reduceRight(XU,VP));let s=we(od);if(we(UP)){let i=s.add();return n(r,e).pipe(Vc(()=>s.remove(i)))}else return n(r,e)}}var LP=(()=>{class n extends $_{backend;injector;chain=null;pendingTasks=we(od);contributeToStability=we(UP);constructor(e,s){super(),this.backend=e,this.injector=s}handle(e){if(this.chain===null){let s=Array.from(new Set([...this.injector.get(PD),...this.injector.get(QU,[])]));this.chain=s.reduceRight((u,i)=>YU(u,i,this.injector),VP)}if(this.contributeToStability){let s=this.pendingTasks.add();return this.chain(e,u=>this.backend.handle(u)).pipe(Vc(()=>this.pendingTasks.remove(s)))}else return this.chain(e,s=>this.backend.handle(s))}static \u0275fac=function(s){return new(s||n)(St(_x),St(jr))};static \u0275prov=xt({token:n,factory:n.\u0275fac})}return n})();var e5=/^\)\]\}',?\n/,t5=RegExp(`^${zP}:`,"m");function n5(n){return"responseURL"in n&&n.responseURL?n.responseURL:t5.test(n.getAllResponseHeaders())?n.getResponseHeader(zP):null}var FP=(()=>{class n{xhrFactory;constructor(e){this.xhrFactory=e}handle(e){if(e.method==="JSONP")throw new Ht(-2800,!1);let s=this.xhrFactory;return(s.\u0275loadImpl?pr(s.\u0275loadImpl()):nn(null)).pipe(Ho(()=>new Hn(i=>{let E=s.build();if(E.open(e.method,e.urlWithParams),e.withCredentials&&(E.withCredentials=!0),e.headers.forEach((bt,Ut)=>E.setRequestHeader(bt,Ut.join(","))),e.headers.has(OP)||E.setRequestHeader(OP,GU),!e.headers.has(PP)){let bt=e.detectContentTypeHeader();bt!==null&&E.setRequestHeader(PP,bt)}if(e.responseType){let bt=e.responseType.toLowerCase();E.responseType=bt!=="json"?bt:"text"}let L=e.serializeBody(),j=null,Y=()=>{if(j!==null)return j;let bt=E.statusText||"OK",Ut=new gp(E.getAllResponseHeaders()),Qt=n5(E)||e.url;return j=new RD({headers:Ut,status:E.status,statusText:bt,url:Qt}),j},oe=()=>{let{headers:bt,status:Ut,statusText:Qt,url:_i}=Y(),Gn=null;Ut!==qU&&(Gn=typeof E.response>"u"?E.responseText:E.response),Ut===0&&(Ut=Gn?WU:0);let Ro=Ut>=200&&Ut<300;if(e.responseType==="json"&&typeof Gn=="string"){let lt=Gn;Gn=Gn.replace(e5,"");try{Gn=Gn!==""?JSON.parse(Gn):null}catch(_o){Gn=lt,Ro&&(Ro=!1,Gn={error:_o,text:Gn})}}Ro?(i.next(new vx({body:Gn,headers:bt,status:Ut,statusText:Qt,url:_i||void 0})),i.complete()):i.error(new bx({error:Gn,headers:bt,status:Ut,statusText:Qt,url:_i||void 0}))},Ee=bt=>{let{url:Ut}=Y(),Qt=new bx({error:bt,status:E.status||0,statusText:E.statusText||"Unknown Error",url:Ut||void 0});i.error(Qt)},Ye=!1,Ne=bt=>{Ye||(i.next(Y()),Ye=!0);let Ut={type:Dg.DownloadProgress,loaded:bt.loaded};bt.lengthComputable&&(Ut.total=bt.total),e.responseType==="text"&&E.responseText&&(Ut.partialText=E.responseText),i.next(Ut)},ct=bt=>{let Ut={type:Dg.UploadProgress,loaded:bt.loaded};bt.lengthComputable&&(Ut.total=bt.total),i.next(Ut)};return E.addEventListener("load",oe),E.addEventListener("error",Ee),E.addEventListener("timeout",Ee),E.addEventListener("abort",Ee),e.reportProgress&&(E.addEventListener("progress",Ne),L!==null&&E.upload&&E.upload.addEventListener("progress",ct)),E.send(L),i.next({type:Dg.Sent}),()=>{E.removeEventListener("error",Ee),E.removeEventListener("abort",Ee),E.removeEventListener("load",oe),E.removeEventListener("timeout",Ee),e.reportProgress&&(E.removeEventListener("progress",Ne),L!==null&&E.upload&&E.upload.removeEventListener("progress",ct)),E.readyState!==E.DONE&&E.abort()}})))}static \u0275fac=function(s){return new(s||n)(St(wg))};static \u0275prov=xt({token:n,factory:n.\u0275fac})}return n})(),$P=new dt(""),i5="XSRF-TOKEN",r5=new dt("",{providedIn:"root",factory:()=>i5}),o5="X-XSRF-TOKEN",s5=new dt("",{providedIn:"root",factory:()=>o5}),xx=class{},a5=(()=>{class n{doc;platform;cookieName;lastCookieString="";lastToken=null;parseCount=0;constructor(e,s,u){this.doc=e,this.platform=s,this.cookieName=u}getToken(){if(this.platform==="server")return null;let e=this.doc.cookie||"";return e!==this.lastCookieString&&(this.parseCount++,this.lastToken=px(e,this.cookieName),this.lastCookieString=e),this.lastToken}static \u0275fac=function(s){return new(s||n)(St(Un),St(sd),St(r5))};static \u0275prov=xt({token:n,factory:n.\u0275fac})}return n})();function l5(n,r){let e=n.url.toLowerCase();if(!we($P)||n.method==="GET"||n.method==="HEAD"||e.startsWith("http://")||e.startsWith("https://"))return r(n);let s=we(xx).getToken(),u=we(s5);return s!=null&&!n.headers.has(u)&&(n=n.clone({headers:n.headers.set(u,s)})),r(n)}var HP=function(n){return n[n.Interceptors=0]="Interceptors",n[n.LegacyInterceptors=1]="LegacyInterceptors",n[n.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",n[n.NoXsrfProtection=3]="NoXsrfProtection",n[n.JsonpSupport=4]="JsonpSupport",n[n.RequestsMadeViaParent=5]="RequestsMadeViaParent",n[n.Fetch=6]="Fetch",n}(HP||{});function c5(n,r){return{\u0275kind:n,\u0275providers:r}}function u5(...n){let r=[G_,FP,LP,{provide:$_,useExisting:LP},{provide:_x,useFactory:()=>we(ZU,{optional:!0})??we(FP)},{provide:PD,useValue:l5,multi:!0},{provide:$P,useValue:!0},{provide:xx,useClass:a5}];for(let e of n)r.push(...e.\u0275providers);return k_(r)}var NP=new dt("");function d5(){return c5(HP.LegacyInterceptors,[{provide:NP,useFactory:JU},{provide:PD,useExisting:NP,multi:!0}])}var GP=(()=>{class n{static \u0275fac=function(s){return new(s||n)};static \u0275mod=en({type:n});static \u0275inj=Jt({providers:[u5(d5())]})}return n})();var LD=class extends fx{supportsDOMEvents=!0},FD=class n extends LD{static makeCurrent(){CP(new n)}onAndCancel(r,e,s,u){return r.addEventListener(e,s,u),()=>{r.removeEventListener(e,s,u)}}dispatchEvent(r,e){r.dispatchEvent(e)}remove(r){r.remove()}createElement(r,e){return e=e||this.getDefaultDocument(),e.createElement(r)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(r){return r.nodeType===Node.ELEMENT_NODE}isShadowRoot(r){return r instanceof DocumentFragment}getGlobalEventTarget(r,e){return e==="window"?window:e==="document"?r:e==="body"?r.body:null}getBaseHref(r){let e=h5();return e==null?null:f5(e)}resetBaseElement(){W_=null}getUserAgent(){return window.navigator.userAgent}getCookie(r){return px(document.cookie,r)}},W_=null;function h5(){return W_=W_||document.querySelector("base"),W_?W_.getAttribute("href"):null}function f5(n){return new URL(n,document.baseURI).pathname}var ND=class{addToWindow(r){Yl.getAngularTestability=(s,u=!0)=>{let i=r.findTestabilityInTree(s,u);if(i==null)throw new Ht(5103,!1);return i},Yl.getAllAngularTestabilities=()=>r.getAllTestabilities(),Yl.getAllAngularRootElements=()=>r.getAllRootElements();let e=s=>{let u=Yl.getAllAngularTestabilities(),i=u.length,E=function(){i--,i==0&&s()};u.forEach(L=>{L.whenStable(E)})};Yl.frameworkStabilizers||(Yl.frameworkStabilizers=[]),Yl.frameworkStabilizers.push(e)}findTestabilityInTree(r,e,s){if(e==null)return null;let u=r.getTestability(e);return u??(s?pp().isShadowRoot(e)?this.findTestabilityInTree(r,e.host,!0):this.findTestabilityInTree(r,e.parentElement,!0):null)}},p5=(()=>{class n{build(){return new XMLHttpRequest}static \u0275fac=function(s){return new(s||n)};static \u0275prov=xt({token:n,factory:n.\u0275fac})}return n})(),zD=new dt(""),JP=(()=>{class n{_zone;_plugins;_eventNameToPlugin=new Map;constructor(e,s){this._zone=s,e.forEach(u=>{u.manager=this}),this._plugins=e.slice().reverse()}addEventListener(e,s,u,i){return this._findPluginFor(s).addEventListener(e,s,u,i)}getZone(){return this._zone}_findPluginFor(e){let s=this._eventNameToPlugin.get(e);if(s)return s;if(s=this._plugins.find(i=>i.supports(e)),!s)throw new Ht(5101,!1);return this._eventNameToPlugin.set(e,s),s}static \u0275fac=function(s){return new(s||n)(St(zD),St(ln))};static \u0275prov=xt({token:n,factory:n.\u0275fac})}return n})(),Cx=class{_doc;constructor(r){this._doc=r}manager},wx="ng-app-id";function qP(n){for(let r of n)r.remove()}function ZP(n,r){let e=r.createElement("style");return e.textContent=n,e}function m5(n,r,e,s){let u=n.head?.querySelectorAll(`style[${wx}="${r}"],link[${wx}="${r}"]`);if(u)for(let i of u)i.removeAttribute(wx),i instanceof HTMLLinkElement?s.set(i.href.slice(i.href.lastIndexOf("/")+1),{usage:0,elements:[i]}):i.textContent&&e.set(i.textContent,{usage:0,elements:[i]})}function BD(n,r){let e=r.createElement("link");return e.setAttribute("rel","stylesheet"),e.setAttribute("href",n),e}var eO=(()=>{class n{doc;appId;nonce;inline=new Map;external=new Map;hosts=new Set;isServer;constructor(e,s,u,i={}){this.doc=e,this.appId=s,this.nonce=u,this.isServer=ID(i),m5(e,s,this.inline,this.external),this.hosts.add(e.head)}addStyles(e,s){for(let u of e)this.addUsage(u,this.inline,ZP);s?.forEach(u=>this.addUsage(u,this.external,BD))}removeStyles(e,s){for(let u of e)this.removeUsage(u,this.inline);s?.forEach(u=>this.removeUsage(u,this.external))}addUsage(e,s,u){let i=s.get(e);i?i.usage++:s.set(e,{usage:1,elements:[...this.hosts].map(E=>this.addElement(E,u(e,this.doc)))})}removeUsage(e,s){let u=s.get(e);u&&(u.usage--,u.usage<=0&&(qP(u.elements),s.delete(e)))}ngOnDestroy(){for(let[,{elements:e}]of[...this.inline,...this.external])qP(e);this.hosts.clear()}addHost(e){this.hosts.add(e);for(let[s,{elements:u}]of this.inline)u.push(this.addElement(e,ZP(s,this.doc)));for(let[s,{elements:u}]of this.external)u.push(this.addElement(e,BD(s,this.doc)))}removeHost(e){this.hosts.delete(e)}addElement(e,s){return this.nonce&&s.setAttribute("nonce",this.nonce),this.isServer&&s.setAttribute(wx,this.appId),e.appendChild(s)}static \u0275fac=function(s){return new(s||n)(St(Un),St(pg),St(N_,8),St(sd))};static \u0275prov=xt({token:n,factory:n.\u0275fac})}return n})(),OD={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},VD=/%COMP%/g;var tO="%COMP%",g5=`_nghost-${tO}`,y5=`_ngcontent-${tO}`,_5=!0,v5=new dt("",{providedIn:"root",factory:()=>_5});function b5(n){return y5.replace(VD,n)}function x5(n){return g5.replace(VD,n)}function nO(n,r){return r.map(e=>e.replace(VD,n))}var XP=(()=>{class n{eventManager;sharedStylesHost;appId;removeStylesOnCompDestroy;doc;platformId;ngZone;nonce;tracingService;rendererByCompId=new Map;defaultRenderer;platformIsServer;constructor(e,s,u,i,E,L,j,Y=null,oe=null){this.eventManager=e,this.sharedStylesHost=s,this.appId=u,this.removeStylesOnCompDestroy=i,this.doc=E,this.platformId=L,this.ngZone=j,this.nonce=Y,this.tracingService=oe,this.platformIsServer=ID(L),this.defaultRenderer=new q_(e,E,j,this.platformIsServer,this.tracingService)}createRenderer(e,s){if(!e||!s)return this.defaultRenderer;this.platformIsServer&&s.encapsulation===Wc.ShadowDom&&(s=Cn(ut({},s),{encapsulation:Wc.Emulated}));let u=this.getOrCreateRenderer(e,s);return u instanceof Ex?u.applyToHost(e):u instanceof Z_&&u.applyStyles(),u}getOrCreateRenderer(e,s){let u=this.rendererByCompId,i=u.get(s.id);if(!i){let E=this.doc,L=this.ngZone,j=this.eventManager,Y=this.sharedStylesHost,oe=this.removeStylesOnCompDestroy,Ee=this.platformIsServer,Ye=this.tracingService;switch(s.encapsulation){case Wc.Emulated:i=new Ex(j,Y,s,this.appId,oe,E,L,Ee,Ye);break;case Wc.ShadowDom:return new jD(j,Y,e,s,E,L,this.nonce,Ee,Ye);default:i=new Z_(j,Y,s,oe,E,L,Ee,Ye);break}u.set(s.id,i)}return i}ngOnDestroy(){this.rendererByCompId.clear()}componentReplaced(e){this.rendererByCompId.delete(e)}static \u0275fac=function(s){return new(s||n)(St(JP),St(eO),St(pg),St(v5),St(Un),St(sd),St(ln),St(N_),St(mg,8))};static \u0275prov=xt({token:n,factory:n.\u0275fac})}return n})(),q_=class{eventManager;doc;ngZone;platformIsServer;tracingService;data=Object.create(null);throwOnSyntheticProps=!0;constructor(r,e,s,u,i){this.eventManager=r,this.doc=e,this.ngZone=s,this.platformIsServer=u,this.tracingService=i}destroy(){}destroyNode=null;createElement(r,e){return e?this.doc.createElementNS(OD[e]||e,r):this.doc.createElement(r)}createComment(r){return this.doc.createComment(r)}createText(r){return this.doc.createTextNode(r)}appendChild(r,e){(YP(r)?r.content:r).appendChild(e)}insertBefore(r,e,s){r&&(YP(r)?r.content:r).insertBefore(e,s)}removeChild(r,e){e.remove()}selectRootElement(r,e){let s=typeof r=="string"?this.doc.querySelector(r):r;if(!s)throw new Ht(-5104,!1);return e||(s.textContent=""),s}parentNode(r){return r.parentNode}nextSibling(r){return r.nextSibling}setAttribute(r,e,s,u){if(u){e=u+":"+e;let i=OD[u];i?r.setAttributeNS(i,e,s):r.setAttribute(e,s)}else r.setAttribute(e,s)}removeAttribute(r,e,s){if(s){let u=OD[s];u?r.removeAttributeNS(u,e):r.removeAttribute(`${s}:${e}`)}else r.removeAttribute(e)}addClass(r,e){r.classList.add(e)}removeClass(r,e){r.classList.remove(e)}setStyle(r,e,s,u){u&(ed.DashCase|ed.Important)?r.style.setProperty(e,s,u&ed.Important?"important":""):r.style[e]=s}removeStyle(r,e,s){s&ed.DashCase?r.style.removeProperty(e):r.style[e]=""}setProperty(r,e,s){r!=null&&(r[e]=s)}setValue(r,e){r.nodeValue=e}listen(r,e,s,u){if(typeof r=="string"&&(r=pp().getGlobalEventTarget(this.doc,r),!r))throw new Ht(5102,!1);let i=this.decoratePreventDefault(s);return this.tracingService?.wrapEventListener&&(i=this.tracingService.wrapEventListener(r,e,i)),this.eventManager.addEventListener(r,e,i,u)}decoratePreventDefault(r){return e=>{if(e==="__ngUnwrap__")return r;(this.platformIsServer?this.ngZone.runGuarded(()=>r(e)):r(e))===!1&&e.preventDefault()}}};function YP(n){return n.tagName==="TEMPLATE"&&n.content!==void 0}var jD=class extends q_{sharedStylesHost;hostEl;shadowRoot;constructor(r,e,s,u,i,E,L,j,Y){super(r,i,E,j,Y),this.sharedStylesHost=e,this.hostEl=s,this.shadowRoot=s.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let oe=u.styles;oe=nO(u.id,oe);for(let Ye of oe){let Ne=document.createElement("style");L&&Ne.setAttribute("nonce",L),Ne.textContent=Ye,this.shadowRoot.appendChild(Ne)}let Ee=u.getExternalStyles?.();if(Ee)for(let Ye of Ee){let Ne=BD(Ye,i);L&&Ne.setAttribute("nonce",L),this.shadowRoot.appendChild(Ne)}}nodeOrShadowRoot(r){return r===this.hostEl?this.shadowRoot:r}appendChild(r,e){return super.appendChild(this.nodeOrShadowRoot(r),e)}insertBefore(r,e,s){return super.insertBefore(this.nodeOrShadowRoot(r),e,s)}removeChild(r,e){return super.removeChild(null,e)}parentNode(r){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(r)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},Z_=class extends q_{sharedStylesHost;removeStylesOnCompDestroy;styles;styleUrls;constructor(r,e,s,u,i,E,L,j,Y){super(r,i,E,L,j),this.sharedStylesHost=e,this.removeStylesOnCompDestroy=u;let oe=s.styles;this.styles=Y?nO(Y,oe):oe,this.styleUrls=s.getExternalStyles?.(Y)}applyStyles(){this.sharedStylesHost.addStyles(this.styles,this.styleUrls)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles,this.styleUrls)}},Ex=class extends Z_{contentAttr;hostAttr;constructor(r,e,s,u,i,E,L,j,Y){let oe=u+"-"+s.id;super(r,e,s,i,E,L,j,Y,oe),this.contentAttr=b5(oe),this.hostAttr=x5(oe)}applyToHost(r){this.applyStyles(),this.setAttribute(r,this.hostAttr,"")}createElement(r,e){let s=super.createElement(r,e);return super.setAttribute(s,this.contentAttr,""),s}},w5=(()=>{class n extends Cx{constructor(e){super(e)}supports(e){return!0}addEventListener(e,s,u,i){return e.addEventListener(s,u,i),()=>this.removeEventListener(e,s,u,i)}removeEventListener(e,s,u,i){return e.removeEventListener(s,u,i)}static \u0275fac=function(s){return new(s||n)(St(Un))};static \u0275prov=xt({token:n,factory:n.\u0275fac})}return n})(),KP=["alt","control","meta","shift"],C5={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},E5={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey},D5=(()=>{class n extends Cx{constructor(e){super(e)}supports(e){return n.parseEventName(e)!=null}addEventListener(e,s,u,i){let E=n.parseEventName(s),L=n.eventCallback(E.fullKey,u,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>pp().onAndCancel(e,E.domEventName,L,i))}static parseEventName(e){let s=e.toLowerCase().split("."),u=s.shift();if(s.length===0||!(u==="keydown"||u==="keyup"))return null;let i=n._normalizeKey(s.pop()),E="",L=s.indexOf("code");if(L>-1&&(s.splice(L,1),E="code."),KP.forEach(Y=>{let oe=s.indexOf(Y);oe>-1&&(s.splice(oe,1),E+=Y+".")}),E+=i,s.length!=0||i.length===0)return null;let j={};return j.domEventName=u,j.fullKey=E,j}static matchEventFullKeyCode(e,s){let u=C5[e.key]||e.key,i="";return s.indexOf("code.")>-1&&(u=e.code,i="code."),u==null||!u?!1:(u=u.toLowerCase(),u===" "?u="space":u==="."&&(u="dot"),KP.forEach(E=>{if(E!==u){let L=E5[E];L(e)&&(i+=E+".")}}),i+=u,i===s)}static eventCallback(e,s,u){return i=>{n.matchEventFullKeyCode(i,e)&&u.runGuarded(()=>s(i))}}static _normalizeKey(e){return e==="esc"?"escape":e}static \u0275fac=function(s){return new(s||n)(St(Un))};static \u0275prov=xt({token:n,factory:n.\u0275fac})}return n})();function M5(){FD.makeCurrent()}function T5(){return new Bs}function I5(){return jk(document),document}var S5=[{provide:sd,useValue:TD},{provide:$E,useValue:M5,multi:!0},{provide:Un,useFactory:I5,deps:[]}],iO=vD(pP,"browser",S5);var A5=[{provide:j_,useClass:ND,deps:[]},{provide:fD,useClass:rx,deps:[ln,ox,j_]},{provide:rx,useClass:rx,deps:[ln,ox,j_]}],k5=[{provide:q0,useValue:"root"},{provide:Bs,useFactory:T5,deps:[]},{provide:zD,useClass:w5,multi:!0,deps:[Un]},{provide:zD,useClass:D5,multi:!0,deps:[Un]},XP,eO,JP,{provide:ko,useExisting:XP},{provide:wg,useClass:p5,deps:[]},[]],rO=(()=>{class n{constructor(){}static \u0275fac=function(s){return new(s||n)};static \u0275mod=en({type:n});static \u0275inj=Jt({providers:[...k5,...A5],imports:[Eg,mP]})}return n})();var oO=(()=>{class n{_doc;constructor(e){this._doc=e}getTitle(){return this._doc.title}setTitle(e){this._doc.title=e||""}static \u0275fac=function(s){return new(s||n)(St(Un))};static \u0275prov=xt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var UD=(()=>{class n{static \u0275fac=function(s){return new(s||n)};static \u0275prov=xt({token:n,factory:function(s){let u=null;return s?u=new(s||n):u=St(R5),u},providedIn:"root"})}return n})(),R5=(()=>{class n extends UD{_doc;constructor(e){super(),this._doc=e}sanitize(e,s){if(s==null)return null;switch(e){case $s.NONE:return s;case $s.HTML:return yg(s,"HTML")?Yc(s):iR(this._doc,String(s)).toString();case $s.STYLE:return yg(s,"Style")?Yc(s):s;case $s.SCRIPT:if(yg(s,"Script"))return Yc(s);throw new Ht(5200,!1);case $s.URL:return yg(s,"URL")?Yc(s):WE(String(s));case $s.RESOURCE_URL:if(yg(s,"ResourceURL"))return Yc(s);throw new Ht(5201,!1);default:throw new Ht(5202,!1)}}bypassSecurityTrustHtml(e){return qk(e)}bypassSecurityTrustStyle(e){return Zk(e)}bypassSecurityTrustScript(e){return Xk(e)}bypassSecurityTrustUrl(e){return Yk(e)}bypassSecurityTrustResourceUrl(e){return Kk(e)}static \u0275fac=function(s){return new(s||n)(St(Un))};static \u0275prov=xt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var Yn="primary",lv=Symbol("RouteTitle"),ZD=class{params;constructor(r){this.params=r||{}}has(r){return Object.prototype.hasOwnProperty.call(this.params,r)}get(r){if(this.has(r)){let e=this.params[r];return Array.isArray(e)?e[0]:e}return null}getAll(r){if(this.has(r)){let e=this.params[r];return Array.isArray(e)?e:[e]}return[]}get keys(){return Object.keys(this.params)}};function kg(n){return new ZD(n)}function P5(n,r,e){let s=e.path.split("/");if(s.length>n.length||e.pathMatch==="full"&&(r.hasChildren()||s.length<n.length))return null;let u={};for(let i=0;i<s.length;i++){let E=s[i],L=n[i];if(E[0]===":")u[E.substring(1)]=L;else if(E!==L.path)return null}return{consumed:n.slice(0,s.length),posParams:u}}function O5(n,r){if(n.length!==r.length)return!1;for(let e=0;e<n.length;++e)if(!Qc(n[e],r[e]))return!1;return!0}function Qc(n,r){let e=n?XD(n):void 0,s=r?XD(r):void 0;if(!e||!s||e.length!=s.length)return!1;let u;for(let i=0;i<e.length;i++)if(u=e[i],!gO(n[u],r[u]))return!1;return!0}function XD(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}function gO(n,r){if(Array.isArray(n)&&Array.isArray(r)){if(n.length!==r.length)return!1;let e=[...n].sort(),s=[...r].sort();return e.every((u,i)=>s[i]===u)}else return n===r}function yO(n){return n.length>0?n[n.length-1]:null}function Ah(n){return c_(n)?n:_g(n)?pr(Promise.resolve(n)):nn(n)}var L5={exact:vO,subset:bO},_O={exact:F5,subset:N5,ignored:()=>!0};function sO(n,r,e){return L5[e.paths](n.root,r.root,e.matrixParams)&&_O[e.queryParams](n.queryParams,r.queryParams)&&!(e.fragment==="exact"&&n.fragment!==r.fragment)}function F5(n,r){return Qc(n,r)}function vO(n,r,e){if(!_p(n.segments,r.segments)||!Tx(n.segments,r.segments,e)||n.numberOfChildren!==r.numberOfChildren)return!1;for(let s in r.children)if(!n.children[s]||!vO(n.children[s],r.children[s],e))return!1;return!0}function N5(n,r){return Object.keys(r).length<=Object.keys(n).length&&Object.keys(r).every(e=>gO(n[e],r[e]))}function bO(n,r,e){return xO(n,r,r.segments,e)}function xO(n,r,e,s){if(n.segments.length>e.length){let u=n.segments.slice(0,e.length);return!(!_p(u,e)||r.hasChildren()||!Tx(u,e,s))}else if(n.segments.length===e.length){if(!_p(n.segments,e)||!Tx(n.segments,e,s))return!1;for(let u in r.children)if(!n.children[u]||!bO(n.children[u],r.children[u],s))return!1;return!0}else{let u=e.slice(0,n.segments.length),i=e.slice(n.segments.length);return!_p(n.segments,u)||!Tx(n.segments,u,s)||!n.children[Yn]?!1:xO(n.children[Yn],r,i,s)}}function Tx(n,r,e){return r.every((s,u)=>_O[e](n[u].parameters,s.parameters))}var ud=class{root;queryParams;fragment;_queryParamMap;constructor(r=new zi([],{}),e={},s=null){this.root=r,this.queryParams=e,this.fragment=s}get queryParamMap(){return this._queryParamMap??=kg(this.queryParams),this._queryParamMap}toString(){return j5.serialize(this)}},zi=class{segments;children;parent=null;constructor(r,e){this.segments=r,this.children=e,Object.values(e).forEach(s=>s.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Ix(this)}},yp=class{path;parameters;_parameterMap;constructor(r,e){this.path=r,this.parameters=e}get parameterMap(){return this._parameterMap??=kg(this.parameters),this._parameterMap}toString(){return CO(this)}};function z5(n,r){return _p(n,r)&&n.every((e,s)=>Qc(e.parameters,r[s].parameters))}function _p(n,r){return n.length!==r.length?!1:n.every((e,s)=>e.path===r[s].path)}function B5(n,r){let e=[];return Object.entries(n.children).forEach(([s,u])=>{s===Yn&&(e=e.concat(r(u,s)))}),Object.entries(n.children).forEach(([s,u])=>{s!==Yn&&(e=e.concat(r(u,s)))}),e}var cv=(()=>{class n{static \u0275fac=function(s){return new(s||n)};static \u0275prov=xt({token:n,factory:()=>new Rg,providedIn:"root"})}return n})(),Rg=class{parse(r){let e=new KD(r);return new ud(e.parseRootSegment(),e.parseQueryParams(),e.parseFragment())}serialize(r){let e=`/${X_(r.root,!0)}`,s=$5(r.queryParams),u=typeof r.fragment=="string"?`#${V5(r.fragment)}`:"";return`${e}${s}${u}`}},j5=new Rg;function Ix(n){return n.segments.map(r=>CO(r)).join("/")}function X_(n,r){if(!n.hasChildren())return Ix(n);if(r){let e=n.children[Yn]?X_(n.children[Yn],!1):"",s=[];return Object.entries(n.children).forEach(([u,i])=>{u!==Yn&&s.push(`${u}:${X_(i,!1)}`)}),s.length>0?`${e}(${s.join("//")})`:e}else{let e=B5(n,(s,u)=>u===Yn?[X_(n.children[Yn],!1)]:[`${u}:${X_(s,!1)}`]);return Object.keys(n.children).length===1&&n.children[Yn]!=null?`${Ix(n)}/${e[0]}`:`${Ix(n)}/(${e.join("//")})`}}function wO(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Dx(n){return wO(n).replace(/%3B/gi,";")}function V5(n){return encodeURI(n)}function YD(n){return wO(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Sx(n){return decodeURIComponent(n)}function aO(n){return Sx(n.replace(/\+/g,"%20"))}function CO(n){return`${YD(n.path)}${U5(n.parameters)}`}function U5(n){return Object.entries(n).map(([r,e])=>`;${YD(r)}=${YD(e)}`).join("")}function $5(n){let r=Object.entries(n).map(([e,s])=>Array.isArray(s)?s.map(u=>`${Dx(e)}=${Dx(u)}`).join("&"):`${Dx(e)}=${Dx(s)}`).filter(e=>e);return r.length?`?${r.join("&")}`:""}var H5=/^[^\/()?;#]+/;function HD(n){let r=n.match(H5);return r?r[0]:""}var G5=/^[^\/()?;=#]+/;function W5(n){let r=n.match(G5);return r?r[0]:""}var q5=/^[^=?&#]+/;function Z5(n){let r=n.match(q5);return r?r[0]:""}var X5=/^[^&#]+/;function Y5(n){let r=n.match(X5);return r?r[0]:""}var KD=class{url;remaining;constructor(r){this.url=r,this.remaining=r}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new zi([],{}):new zi([],this.parseChildren())}parseQueryParams(){let r={};if(this.consumeOptional("?"))do this.parseQueryParam(r);while(this.consumeOptional("&"));return r}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let r=[];for(this.peekStartsWith("(")||r.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),r.push(this.parseSegment());let e={};this.peekStartsWith("/(")&&(this.capture("/"),e=this.parseParens(!0));let s={};return this.peekStartsWith("(")&&(s=this.parseParens(!1)),(r.length>0||Object.keys(e).length>0)&&(s[Yn]=new zi(r,e)),s}parseSegment(){let r=HD(this.remaining);if(r===""&&this.peekStartsWith(";"))throw new Ht(4009,!1);return this.capture(r),new yp(Sx(r),this.parseMatrixParams())}parseMatrixParams(){let r={};for(;this.consumeOptional(";");)this.parseParam(r);return r}parseParam(r){let e=W5(this.remaining);if(!e)return;this.capture(e);let s="";if(this.consumeOptional("=")){let u=HD(this.remaining);u&&(s=u,this.capture(s))}r[Sx(e)]=Sx(s)}parseQueryParam(r){let e=Z5(this.remaining);if(!e)return;this.capture(e);let s="";if(this.consumeOptional("=")){let E=Y5(this.remaining);E&&(s=E,this.capture(s))}let u=aO(e),i=aO(s);if(r.hasOwnProperty(u)){let E=r[u];Array.isArray(E)||(E=[E],r[u]=E),E.push(i)}else r[u]=i}parseParens(r){let e={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let s=HD(this.remaining),u=this.remaining[s.length];if(u!=="/"&&u!==")"&&u!==";")throw new Ht(4010,!1);let i;s.indexOf(":")>-1?(i=s.slice(0,s.indexOf(":")),this.capture(i),this.capture(":")):r&&(i=Yn);let E=this.parseChildren();e[i]=Object.keys(E).length===1?E[Yn]:new zi([],E),this.consumeOptional("//")}return e}peekStartsWith(r){return this.remaining.startsWith(r)}consumeOptional(r){return this.peekStartsWith(r)?(this.remaining=this.remaining.substring(r.length),!0):!1}capture(r){if(!this.consumeOptional(r))throw new Ht(4011,!1)}};function EO(n){return n.segments.length>0?new zi([],{[Yn]:n}):n}function DO(n){let r={};for(let[s,u]of Object.entries(n.children)){let i=DO(u);if(s===Yn&&i.segments.length===0&&i.hasChildren())for(let[E,L]of Object.entries(i.children))r[E]=L;else(i.segments.length>0||i.hasChildren())&&(r[s]=i)}let e=new zi(n.segments,r);return K5(e)}function K5(n){if(n.numberOfChildren===1&&n.children[Yn]){let r=n.children[Yn];return new zi(n.segments.concat(r.segments),r.children)}return n}function ev(n){return n instanceof ud}function Q5(n,r,e=null,s=null){let u=MO(n);return TO(u,r,e,s)}function MO(n){let r;function e(i){let E={};for(let j of i.children){let Y=e(j);E[j.outlet]=Y}let L=new zi(i.url,E);return i===n&&(r=L),L}let s=e(n.root),u=EO(s);return r??u}function TO(n,r,e,s){let u=n;for(;u.parent;)u=u.parent;if(r.length===0)return GD(u,u,u,e,s);let i=J5(r);if(i.toRoot())return GD(u,u,new zi([],{}),e,s);let E=e4(i,u,n),L=E.processChildren?K_(E.segmentGroup,E.index,i.commands):SO(E.segmentGroup,E.index,i.commands);return GD(u,E.segmentGroup,L,e,s)}function Ax(n){return typeof n=="object"&&n!=null&&!n.outlets&&!n.segmentPath}function tv(n){return typeof n=="object"&&n!=null&&n.outlets}function GD(n,r,e,s,u){let i={};s&&Object.entries(s).forEach(([j,Y])=>{i[j]=Array.isArray(Y)?Y.map(oe=>`${oe}`):`${Y}`});let E;n===r?E=e:E=IO(n,r,e);let L=EO(DO(E));return new ud(L,i,u)}function IO(n,r,e){let s={};return Object.entries(n.children).forEach(([u,i])=>{i===r?s[u]=e:s[u]=IO(i,r,e)}),new zi(n.segments,s)}var kx=class{isAbsolute;numberOfDoubleDots;commands;constructor(r,e,s){if(this.isAbsolute=r,this.numberOfDoubleDots=e,this.commands=s,r&&s.length>0&&Ax(s[0]))throw new Ht(4003,!1);let u=s.find(tv);if(u&&u!==yO(s))throw new Ht(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function J5(n){if(typeof n[0]=="string"&&n.length===1&&n[0]==="/")return new kx(!0,0,n);let r=0,e=!1,s=n.reduce((u,i,E)=>{if(typeof i=="object"&&i!=null){if(i.outlets){let L={};return Object.entries(i.outlets).forEach(([j,Y])=>{L[j]=typeof Y=="string"?Y.split("/"):Y}),[...u,{outlets:L}]}if(i.segmentPath)return[...u,i.segmentPath]}return typeof i!="string"?[...u,i]:E===0?(i.split("/").forEach((L,j)=>{j==0&&L==="."||(j==0&&L===""?e=!0:L===".."?r++:L!=""&&u.push(L))}),u):[...u,i]},[]);return new kx(e,r,s)}var Ig=class{segmentGroup;processChildren;index;constructor(r,e,s){this.segmentGroup=r,this.processChildren=e,this.index=s}};function e4(n,r,e){if(n.isAbsolute)return new Ig(r,!0,0);if(!e)return new Ig(r,!1,NaN);if(e.parent===null)return new Ig(e,!0,0);let s=Ax(n.commands[0])?0:1,u=e.segments.length-1+s;return t4(e,u,n.numberOfDoubleDots)}function t4(n,r,e){let s=n,u=r,i=e;for(;i>u;){if(i-=u,s=s.parent,!s)throw new Ht(4005,!1);u=s.segments.length}return new Ig(s,!1,u-i)}function n4(n){return tv(n[0])?n[0].outlets:{[Yn]:n}}function SO(n,r,e){if(n??=new zi([],{}),n.segments.length===0&&n.hasChildren())return K_(n,r,e);let s=i4(n,r,e),u=e.slice(s.commandIndex);if(s.match&&s.pathIndex<n.segments.length){let i=new zi(n.segments.slice(0,s.pathIndex),{});return i.children[Yn]=new zi(n.segments.slice(s.pathIndex),n.children),K_(i,0,u)}else return s.match&&u.length===0?new zi(n.segments,{}):s.match&&!n.hasChildren()?QD(n,r,e):s.match?K_(n,0,u):QD(n,r,e)}function K_(n,r,e){if(e.length===0)return new zi(n.segments,{});{let s=n4(e),u={};if(Object.keys(s).some(i=>i!==Yn)&&n.children[Yn]&&n.numberOfChildren===1&&n.children[Yn].segments.length===0){let i=K_(n.children[Yn],r,e);return new zi(n.segments,i.children)}return Object.entries(s).forEach(([i,E])=>{typeof E=="string"&&(E=[E]),E!==null&&(u[i]=SO(n.children[i],r,E))}),Object.entries(n.children).forEach(([i,E])=>{s[i]===void 0&&(u[i]=E)}),new zi(n.segments,u)}}function i4(n,r,e){let s=0,u=r,i={match:!1,pathIndex:0,commandIndex:0};for(;u<n.segments.length;){if(s>=e.length)return i;let E=n.segments[u],L=e[s];if(tv(L))break;let j=`${L}`,Y=s<e.length-1?e[s+1]:null;if(u>0&&j===void 0)break;if(j&&Y&&typeof Y=="object"&&Y.outlets===void 0){if(!cO(j,Y,E))return i;s+=2}else{if(!cO(j,{},E))return i;s++}u++}return{match:!0,pathIndex:u,commandIndex:s}}function QD(n,r,e){let s=n.segments.slice(0,r),u=0;for(;u<e.length;){let i=e[u];if(tv(i)){let j=r4(i.outlets);return new zi(s,j)}if(u===0&&Ax(e[0])){let j=n.segments[r];s.push(new yp(j.path,lO(e[0]))),u++;continue}let E=tv(i)?i.outlets[Yn]:`${i}`,L=u<e.length-1?e[u+1]:null;E&&L&&Ax(L)?(s.push(new yp(E,lO(L))),u+=2):(s.push(new yp(E,{})),u++)}return new zi(s,{})}function r4(n){let r={};return Object.entries(n).forEach(([e,s])=>{typeof s=="string"&&(s=[s]),s!==null&&(r[e]=QD(new zi([],{}),0,s))}),r}function lO(n){let r={};return Object.entries(n).forEach(([e,s])=>r[e]=`${s}`),r}function cO(n,r,e){return n==e.path&&Qc(r,e.parameters)}var Q_="imperative",yo=function(n){return n[n.NavigationStart=0]="NavigationStart",n[n.NavigationEnd=1]="NavigationEnd",n[n.NavigationCancel=2]="NavigationCancel",n[n.NavigationError=3]="NavigationError",n[n.RoutesRecognized=4]="RoutesRecognized",n[n.ResolveStart=5]="ResolveStart",n[n.ResolveEnd=6]="ResolveEnd",n[n.GuardsCheckStart=7]="GuardsCheckStart",n[n.GuardsCheckEnd=8]="GuardsCheckEnd",n[n.RouteConfigLoadStart=9]="RouteConfigLoadStart",n[n.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",n[n.ChildActivationStart=11]="ChildActivationStart",n[n.ChildActivationEnd=12]="ChildActivationEnd",n[n.ActivationStart=13]="ActivationStart",n[n.ActivationEnd=14]="ActivationEnd",n[n.Scroll=15]="Scroll",n[n.NavigationSkipped=16]="NavigationSkipped",n}(yo||{}),Ya=class{id;url;constructor(r,e){this.id=r,this.url=e}},Pg=class extends Ya{type=yo.NavigationStart;navigationTrigger;restoredState;constructor(r,e,s="imperative",u=null){super(r,e),this.navigationTrigger=s,this.restoredState=u}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},dd=class extends Ya{urlAfterRedirects;type=yo.NavigationEnd;constructor(r,e,s){super(r,e),this.urlAfterRedirects=s}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},Da=function(n){return n[n.Redirect=0]="Redirect",n[n.SupersededByNewNavigation=1]="SupersededByNewNavigation",n[n.NoDataFromResolver=2]="NoDataFromResolver",n[n.GuardRejected=3]="GuardRejected",n}(Da||{}),Rx=function(n){return n[n.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",n[n.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",n}(Rx||{}),cd=class extends Ya{reason;code;type=yo.NavigationCancel;constructor(r,e,s,u){super(r,e),this.reason=s,this.code=u}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},Sh=class extends Ya{reason;code;type=yo.NavigationSkipped;constructor(r,e,s,u){super(r,e),this.reason=s,this.code=u}},nv=class extends Ya{error;target;type=yo.NavigationError;constructor(r,e,s,u){super(r,e),this.error=s,this.target=u}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},Px=class extends Ya{urlAfterRedirects;state;type=yo.RoutesRecognized;constructor(r,e,s,u){super(r,e),this.urlAfterRedirects=s,this.state=u}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},JD=class extends Ya{urlAfterRedirects;state;type=yo.GuardsCheckStart;constructor(r,e,s,u){super(r,e),this.urlAfterRedirects=s,this.state=u}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},eM=class extends Ya{urlAfterRedirects;state;shouldActivate;type=yo.GuardsCheckEnd;constructor(r,e,s,u,i){super(r,e),this.urlAfterRedirects=s,this.state=u,this.shouldActivate=i}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},tM=class extends Ya{urlAfterRedirects;state;type=yo.ResolveStart;constructor(r,e,s,u){super(r,e),this.urlAfterRedirects=s,this.state=u}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},nM=class extends Ya{urlAfterRedirects;state;type=yo.ResolveEnd;constructor(r,e,s,u){super(r,e),this.urlAfterRedirects=s,this.state=u}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},iM=class{route;type=yo.RouteConfigLoadStart;constructor(r){this.route=r}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},rM=class{route;type=yo.RouteConfigLoadEnd;constructor(r){this.route=r}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},oM=class{snapshot;type=yo.ChildActivationStart;constructor(r){this.snapshot=r}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},sM=class{snapshot;type=yo.ChildActivationEnd;constructor(r){this.snapshot=r}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},aM=class{snapshot;type=yo.ActivationStart;constructor(r){this.snapshot=r}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},lM=class{snapshot;type=yo.ActivationEnd;constructor(r){this.snapshot=r}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Ox=class{routerEvent;position;anchor;type=yo.Scroll;constructor(r,e,s){this.routerEvent=r,this.position=e,this.anchor=s}toString(){let r=this.position?`${this.position[0]}, ${this.position[1]}`:null;return`Scroll(anchor: '${this.anchor}', position: '${r}')`}},iv=class{},Og=class{url;navigationBehaviorOptions;constructor(r,e){this.url=r,this.navigationBehaviorOptions=e}};function o4(n,r){return n.providers&&!n._injector&&(n._injector=ix(n.providers,r,`Route: ${n.path}`)),n._injector??r}function Kl(n){return n.outlet||Yn}function s4(n,r){let e=n.filter(s=>Kl(s)===r);return e.push(...n.filter(s=>Kl(s)!==r)),e}function uv(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let r=n.parent;r;r=r.parent){let e=r.routeConfig;if(e?._loadedInjector)return e._loadedInjector;if(e?._injector)return e._injector}return null}var cM=class{rootInjector;outlet=null;route=null;children;attachRef=null;get injector(){return uv(this.route?.snapshot)??this.rootInjector}constructor(r){this.rootInjector=r,this.children=new dv(this.rootInjector)}},dv=(()=>{class n{rootInjector;contexts=new Map;constructor(e){this.rootInjector=e}onChildOutletCreated(e,s){let u=this.getOrCreateContext(e);u.outlet=s,this.contexts.set(e,u)}onChildOutletDestroyed(e){let s=this.getContext(e);s&&(s.outlet=null,s.attachRef=null)}onOutletDeactivated(){let e=this.contexts;return this.contexts=new Map,e}onOutletReAttached(e){this.contexts=e}getOrCreateContext(e){let s=this.getContext(e);return s||(s=new cM(this.rootInjector),this.contexts.set(e,s)),s}getContext(e){return this.contexts.get(e)||null}static \u0275fac=function(s){return new(s||n)(St(jr))};static \u0275prov=xt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Lx=class{_root;constructor(r){this._root=r}get root(){return this._root.value}parent(r){let e=this.pathFromRoot(r);return e.length>1?e[e.length-2]:null}children(r){let e=uM(r,this._root);return e?e.children.map(s=>s.value):[]}firstChild(r){let e=uM(r,this._root);return e&&e.children.length>0?e.children[0].value:null}siblings(r){let e=dM(r,this._root);return e.length<2?[]:e[e.length-2].children.map(u=>u.value).filter(u=>u!==r)}pathFromRoot(r){return dM(r,this._root).map(e=>e.value)}};function uM(n,r){if(n===r.value)return r;for(let e of r.children){let s=uM(n,e);if(s)return s}return null}function dM(n,r){if(n===r.value)return[r];for(let e of r.children){let s=dM(n,e);if(s.length)return s.unshift(r),s}return[]}var Ea=class{value;children;constructor(r,e){this.value=r,this.children=e}toString(){return`TreeNode(${this.value})`}};function Tg(n){let r={};return n&&n.children.forEach(e=>r[e.value.outlet]=e),r}var Fx=class extends Lx{snapshot;constructor(r,e){super(r),this.snapshot=e,bM(this,r)}toString(){return this.snapshot.toString()}};function AO(n){let r=a4(n),e=new Ir([new yp("",{})]),s=new Ir({}),u=new Ir({}),i=new Ir({}),E=new Ir(""),L=new Lg(e,s,i,E,u,Yn,n,r.root);return L.snapshot=r.root,new Fx(new Ea(L,[]),r)}function a4(n){let r={},e={},s={},u="",i=new Sg([],r,s,u,e,Yn,n,null,{});return new zx("",new Ea(i,[]))}var Lg=class{urlSubject;paramsSubject;queryParamsSubject;fragmentSubject;dataSubject;outlet;component;snapshot;_futureSnapshot;_routerState;_paramMap;_queryParamMap;title;url;params;queryParams;fragment;data;constructor(r,e,s,u,i,E,L,j){this.urlSubject=r,this.paramsSubject=e,this.queryParamsSubject=s,this.fragmentSubject=u,this.dataSubject=i,this.outlet=E,this.component=L,this._futureSnapshot=j,this.title=this.dataSubject?.pipe(un(Y=>Y[lv]))??nn(void 0),this.url=r,this.params=e,this.queryParams=s,this.fragment=u,this.data=i}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(un(r=>kg(r))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(un(r=>kg(r))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function Nx(n,r,e="emptyOnly"){let s,{routeConfig:u}=n;return r!==null&&(e==="always"||u?.path===""||!r.component&&!r.routeConfig?.loadComponent)?s={params:ut(ut({},r.params),n.params),data:ut(ut({},r.data),n.data),resolve:ut(ut(ut(ut({},n.data),r.data),u?.data),n._resolvedData)}:s={params:ut({},n.params),data:ut({},n.data),resolve:ut(ut({},n.data),n._resolvedData??{})},u&&RO(u)&&(s.resolve[lv]=u.title),s}var Sg=class{url;params;queryParams;fragment;data;outlet;component;routeConfig;_resolve;_resolvedData;_routerState;_paramMap;_queryParamMap;get title(){return this.data?.[lv]}constructor(r,e,s,u,i,E,L,j,Y){this.url=r,this.params=e,this.queryParams=s,this.fragment=u,this.data=i,this.outlet=E,this.component=L,this.routeConfig=j,this._resolve=Y}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=kg(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=kg(this.queryParams),this._queryParamMap}toString(){let r=this.url.map(s=>s.toString()).join("/"),e=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${r}', path:'${e}')`}},zx=class extends Lx{url;constructor(r,e){super(e),this.url=r,bM(this,e)}toString(){return kO(this._root)}};function bM(n,r){r.value._routerState=n,r.children.forEach(e=>bM(n,e))}function kO(n){let r=n.children.length>0?` { ${n.children.map(kO).join(", ")} } `:"";return`${n.value}${r}`}function WD(n){if(n.snapshot){let r=n.snapshot,e=n._futureSnapshot;n.snapshot=e,Qc(r.queryParams,e.queryParams)||n.queryParamsSubject.next(e.queryParams),r.fragment!==e.fragment&&n.fragmentSubject.next(e.fragment),Qc(r.params,e.params)||n.paramsSubject.next(e.params),O5(r.url,e.url)||n.urlSubject.next(e.url),Qc(r.data,e.data)||n.dataSubject.next(e.data)}else n.snapshot=n._futureSnapshot,n.dataSubject.next(n._futureSnapshot.data)}function hM(n,r){let e=Qc(n.params,r.params)&&z5(n.url,r.url),s=!n.parent!=!r.parent;return e&&!s&&(!n.parent||hM(n.parent,r.parent))}function RO(n){return typeof n.title=="string"||n.title===null}var l4=new dt(""),xM=(()=>{class n{activated=null;get activatedComponentRef(){return this.activated}_activatedRoute=null;name=Yn;activateEvents=new Dt;deactivateEvents=new Dt;attachEvents=new Dt;detachEvents=new Dt;routerOutletData=L_(void 0);parentContexts=we(dv);location=we(ba);changeDetector=we(ps);inputBinder=we($x,{optional:!0});supportsBindingToComponentInputs=!0;ngOnChanges(e){if(e.name){let{firstChange:s,previousValue:u}=e.name;if(s)return;this.isTrackedInParentContexts(u)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(u)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(e){return this.parentContexts.getContext(e)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let e=this.parentContexts.getContext(this.name);e?.route&&(e.attachRef?this.attach(e.attachRef,e.route):this.activateWith(e.route,e.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Ht(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Ht(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Ht(4012,!1);this.location.detach();let e=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(e.instance),e}attach(e,s){this.activated=e,this._activatedRoute=s,this.location.insert(e.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(e.instance)}deactivate(){if(this.activated){let e=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(e)}}activateWith(e,s){if(this.isActivated)throw new Ht(4013,!1);this._activatedRoute=e;let u=this.location,E=e.snapshot.component,L=this.parentContexts.getOrCreateContext(this.name).children,j=new fM(e,L,u.injector,this.routerOutletData);this.activated=u.createComponent(E,{index:u.length,injector:j,environmentInjector:s}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static \u0275fac=function(s){return new(s||n)};static \u0275dir=Ni({type:n,selectors:[["router-outlet"]],inputs:{name:"name",routerOutletData:[1,"routerOutletData"]},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],features:[hs]})}return n})(),fM=class n{route;childContexts;parent;outletData;__ngOutletInjector(r){return new n(this.route,this.childContexts,r,this.outletData)}constructor(r,e,s,u){this.route=r,this.childContexts=e,this.parent=s,this.outletData=u}get(r,e){return r===Lg?this.route:r===dv?this.childContexts:r===l4?this.outletData:this.parent.get(r,e)}},$x=new dt(""),uO=(()=>{class n{outletDataSubscriptions=new Map;bindActivatedRouteToOutletComponent(e){this.unsubscribeFromRouteData(e),this.subscribeToRouteData(e)}unsubscribeFromRouteData(e){this.outletDataSubscriptions.get(e)?.unsubscribe(),this.outletDataSubscriptions.delete(e)}subscribeToRouteData(e){let{activatedRoute:s}=e,u=Xf([s.queryParams,s.params,s.data]).pipe(Ho(([i,E,L],j)=>(L=ut(ut(ut({},i),E),L),j===0?nn(L):Promise.resolve(L)))).subscribe(i=>{if(!e.isActivated||!e.activatedComponentRef||e.activatedRoute!==s||s.component===null){this.unsubscribeFromRouteData(e);return}let E=yP(s.component);if(!E){this.unsubscribeFromRouteData(e);return}for(let{templateName:L}of E.inputs)e.activatedComponentRef.setInput(L,i[L])});this.outletDataSubscriptions.set(e,u)}static \u0275fac=function(s){return new(s||n)};static \u0275prov=xt({token:n,factory:n.\u0275fac})}return n})();function c4(n,r,e){let s=rv(n,r._root,e?e._root:void 0);return new Fx(s,r)}function rv(n,r,e){if(e&&n.shouldReuseRoute(r.value,e.value.snapshot)){let s=e.value;s._futureSnapshot=r.value;let u=u4(n,r,e);return new Ea(s,u)}else{if(n.shouldAttach(r.value)){let i=n.retrieve(r.value);if(i!==null){let E=i.route;return E.value._futureSnapshot=r.value,E.children=r.children.map(L=>rv(n,L)),E}}let s=d4(r.value),u=r.children.map(i=>rv(n,i));return new Ea(s,u)}}function u4(n,r,e){return r.children.map(s=>{for(let u of e.children)if(n.shouldReuseRoute(s.value,u.value.snapshot))return rv(n,s,u);return rv(n,s)})}function d4(n){return new Lg(new Ir(n.url),new Ir(n.params),new Ir(n.queryParams),new Ir(n.fragment),new Ir(n.data),n.outlet,n.component,n)}var ov=class{redirectTo;navigationBehaviorOptions;constructor(r,e){this.redirectTo=r,this.navigationBehaviorOptions=e}},PO="ngNavigationCancelingError";function Bx(n,r){let{redirectTo:e,navigationBehaviorOptions:s}=ev(r)?{redirectTo:r,navigationBehaviorOptions:void 0}:r,u=OO(!1,Da.Redirect);return u.url=e,u.navigationBehaviorOptions=s,u}function OO(n,r){let e=new Error(`NavigationCancelingError: ${n||""}`);return e[PO]=!0,e.cancellationCode=r,e}function h4(n){return LO(n)&&ev(n.url)}function LO(n){return!!n&&n[PO]}var f4=(n,r,e,s)=>un(u=>(new pM(r,u.targetRouterState,u.currentRouterState,e,s).activate(n),u)),pM=class{routeReuseStrategy;futureState;currState;forwardEvent;inputBindingEnabled;constructor(r,e,s,u,i){this.routeReuseStrategy=r,this.futureState=e,this.currState=s,this.forwardEvent=u,this.inputBindingEnabled=i}activate(r){let e=this.futureState._root,s=this.currState?this.currState._root:null;this.deactivateChildRoutes(e,s,r),WD(this.futureState.root),this.activateChildRoutes(e,s,r)}deactivateChildRoutes(r,e,s){let u=Tg(e);r.children.forEach(i=>{let E=i.value.outlet;this.deactivateRoutes(i,u[E],s),delete u[E]}),Object.values(u).forEach(i=>{this.deactivateRouteAndItsChildren(i,s)})}deactivateRoutes(r,e,s){let u=r.value,i=e?e.value:null;if(u===i)if(u.component){let E=s.getContext(u.outlet);E&&this.deactivateChildRoutes(r,e,E.children)}else this.deactivateChildRoutes(r,e,s);else i&&this.deactivateRouteAndItsChildren(e,s)}deactivateRouteAndItsChildren(r,e){r.value.component&&this.routeReuseStrategy.shouldDetach(r.value.snapshot)?this.detachAndStoreRouteSubtree(r,e):this.deactivateRouteAndOutlet(r,e)}detachAndStoreRouteSubtree(r,e){let s=e.getContext(r.value.outlet),u=s&&r.value.component?s.children:e,i=Tg(r);for(let E of Object.values(i))this.deactivateRouteAndItsChildren(E,u);if(s&&s.outlet){let E=s.outlet.detach(),L=s.children.onOutletDeactivated();this.routeReuseStrategy.store(r.value.snapshot,{componentRef:E,route:r,contexts:L})}}deactivateRouteAndOutlet(r,e){let s=e.getContext(r.value.outlet),u=s&&r.value.component?s.children:e,i=Tg(r);for(let E of Object.values(i))this.deactivateRouteAndItsChildren(E,u);s&&(s.outlet&&(s.outlet.deactivate(),s.children.onOutletDeactivated()),s.attachRef=null,s.route=null)}activateChildRoutes(r,e,s){let u=Tg(e);r.children.forEach(i=>{this.activateRoutes(i,u[i.value.outlet],s),this.forwardEvent(new lM(i.value.snapshot))}),r.children.length&&this.forwardEvent(new sM(r.value.snapshot))}activateRoutes(r,e,s){let u=r.value,i=e?e.value:null;if(WD(u),u===i)if(u.component){let E=s.getOrCreateContext(u.outlet);this.activateChildRoutes(r,e,E.children)}else this.activateChildRoutes(r,e,s);else if(u.component){let E=s.getOrCreateContext(u.outlet);if(this.routeReuseStrategy.shouldAttach(u.snapshot)){let L=this.routeReuseStrategy.retrieve(u.snapshot);this.routeReuseStrategy.store(u.snapshot,null),E.children.onOutletReAttached(L.contexts),E.attachRef=L.componentRef,E.route=L.route.value,E.outlet&&E.outlet.attach(L.componentRef,L.route.value),WD(L.route.value),this.activateChildRoutes(r,null,E.children)}else E.attachRef=null,E.route=u,E.outlet&&E.outlet.activateWith(u,E.injector),this.activateChildRoutes(r,null,E.children)}else this.activateChildRoutes(r,null,s)}},jx=class{path;route;constructor(r){this.path=r,this.route=this.path[this.path.length-1]}},Ag=class{component;route;constructor(r,e){this.component=r,this.route=e}};function p4(n,r,e){let s=n._root,u=r?r._root:null;return Y_(s,u,e,[s.value])}function m4(n){let r=n.routeConfig?n.routeConfig.canActivateChild:null;return!r||r.length===0?null:{node:n,guards:r}}function zg(n,r){let e=Symbol(),s=r.get(n,e);return s===e?typeof n=="function"&&!DA(n)?n:r.get(n):s}function Y_(n,r,e,s,u={canDeactivateChecks:[],canActivateChecks:[]}){let i=Tg(r);return n.children.forEach(E=>{g4(E,i[E.value.outlet],e,s.concat([E.value]),u),delete i[E.value.outlet]}),Object.entries(i).forEach(([E,L])=>J_(L,e.getContext(E),u)),u}function g4(n,r,e,s,u={canDeactivateChecks:[],canActivateChecks:[]}){let i=n.value,E=r?r.value:null,L=e?e.getContext(n.value.outlet):null;if(E&&i.routeConfig===E.routeConfig){let j=y4(E,i,i.routeConfig.runGuardsAndResolvers);j?u.canActivateChecks.push(new jx(s)):(i.data=E.data,i._resolvedData=E._resolvedData),i.component?Y_(n,r,L?L.children:null,s,u):Y_(n,r,e,s,u),j&&L&&L.outlet&&L.outlet.isActivated&&u.canDeactivateChecks.push(new Ag(L.outlet.component,E))}else E&&J_(r,L,u),u.canActivateChecks.push(new jx(s)),i.component?Y_(n,null,L?L.children:null,s,u):Y_(n,null,e,s,u);return u}function y4(n,r,e){if(typeof e=="function")return e(n,r);switch(e){case"pathParamsChange":return!_p(n.url,r.url);case"pathParamsOrQueryParamsChange":return!_p(n.url,r.url)||!Qc(n.queryParams,r.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!hM(n,r)||!Qc(n.queryParams,r.queryParams);case"paramsChange":default:return!hM(n,r)}}function J_(n,r,e){let s=Tg(n),u=n.value;Object.entries(s).forEach(([i,E])=>{u.component?r?J_(E,r.children.getContext(i),e):J_(E,null,e):J_(E,r,e)}),u.component?r&&r.outlet&&r.outlet.isActivated?e.canDeactivateChecks.push(new Ag(r.outlet.component,u)):e.canDeactivateChecks.push(new Ag(null,u)):e.canDeactivateChecks.push(new Ag(null,u))}function hv(n){return typeof n=="function"}function _4(n){return typeof n=="boolean"}function v4(n){return n&&hv(n.canLoad)}function b4(n){return n&&hv(n.canActivate)}function x4(n){return n&&hv(n.canActivateChild)}function w4(n){return n&&hv(n.canDeactivate)}function C4(n){return n&&hv(n.canMatch)}function FO(n){return n instanceof Wl||n?.name==="EmptyError"}var Mx=Symbol("INITIAL_VALUE");function Fg(){return Ho(n=>Xf(n.map(r=>r.pipe(go(1),Yf(Mx)))).pipe(un(r=>{for(let e of r)if(e!==!0){if(e===Mx)return Mx;if(e===!1||E4(e))return e}return!0}),Lr(r=>r!==Mx),go(1)))}function E4(n){return ev(n)||n instanceof ov}function D4(n,r){return Jr(e=>{let{targetSnapshot:s,currentSnapshot:u,guards:{canActivateChecks:i,canDeactivateChecks:E}}=e;return E.length===0&&i.length===0?nn(Cn(ut({},e),{guardsResult:!0})):M4(E,s,u,n).pipe(Jr(L=>L&&_4(L)?T4(s,i,n,r):nn(L)),un(L=>Cn(ut({},e),{guardsResult:L})))})}function M4(n,r,e,s){return pr(n).pipe(Jr(u=>R4(u.component,u.route,e,r,s)),ql(u=>u!==!0,!0))}function T4(n,r,e,s){return pr(r).pipe(Ku(u=>mh(S4(u.route.parent,s),I4(u.route,s),k4(n,u.path,e),A4(n,u.route,e))),ql(u=>u!==!0,!0))}function I4(n,r){return n!==null&&r&&r(new aM(n)),nn(!0)}function S4(n,r){return n!==null&&r&&r(new oM(n)),nn(!0)}function A4(n,r,e){let s=r.routeConfig?r.routeConfig.canActivate:null;if(!s||s.length===0)return nn(!0);let u=s.map(i=>e0(()=>{let E=uv(r)??e,L=zg(i,E),j=b4(L)?L.canActivate(r,n):Vs(E,()=>L(r,n));return Ah(j).pipe(ql())}));return nn(u).pipe(Fg())}function k4(n,r,e){let s=r[r.length-1],i=r.slice(0,r.length-1).reverse().map(E=>m4(E)).filter(E=>E!==null).map(E=>e0(()=>{let L=E.guards.map(j=>{let Y=uv(E.node)??e,oe=zg(j,Y),Ee=x4(oe)?oe.canActivateChild(s,n):Vs(Y,()=>oe(s,n));return Ah(Ee).pipe(ql())});return nn(L).pipe(Fg())}));return nn(i).pipe(Fg())}function R4(n,r,e,s,u){let i=r&&r.routeConfig?r.routeConfig.canDeactivate:null;if(!i||i.length===0)return nn(!0);let E=i.map(L=>{let j=uv(r)??u,Y=zg(L,j),oe=w4(Y)?Y.canDeactivate(n,r,e,s):Vs(j,()=>Y(n,r,e,s));return Ah(oe).pipe(ql())});return nn(E).pipe(Fg())}function P4(n,r,e,s){let u=r.canLoad;if(u===void 0||u.length===0)return nn(!0);let i=u.map(E=>{let L=zg(E,n),j=v4(L)?L.canLoad(r,e):Vs(n,()=>L(r,e));return Ah(j)});return nn(i).pipe(Fg(),NO(s))}function NO(n){return nC(xr(r=>{if(typeof r!="boolean")throw Bx(n,r)}),un(r=>r===!0))}function O4(n,r,e,s){let u=r.canMatch;if(!u||u.length===0)return nn(!0);let i=u.map(E=>{let L=zg(E,n),j=C4(L)?L.canMatch(r,e):Vs(n,()=>L(r,e));return Ah(j)});return nn(i).pipe(Fg(),NO(s))}var sv=class{segmentGroup;constructor(r){this.segmentGroup=r||null}},av=class extends Error{urlTree;constructor(r){super(),this.urlTree=r}};function Mg(n){return fh(new sv(n))}function L4(n){return fh(new Ht(4e3,!1))}function F4(n){return fh(OO(!1,Da.GuardRejected))}var mM=class{urlSerializer;urlTree;constructor(r,e){this.urlSerializer=r,this.urlTree=e}lineralizeSegments(r,e){let s=[],u=e.root;for(;;){if(s=s.concat(u.segments),u.numberOfChildren===0)return nn(s);if(u.numberOfChildren>1||!u.children[Yn])return L4(`${r.redirectTo}`);u=u.children[Yn]}}applyRedirectCommands(r,e,s,u,i){if(typeof e!="string"){let L=e,{queryParams:j,fragment:Y,routeConfig:oe,url:Ee,outlet:Ye,params:Ne,data:ct,title:bt}=u,Ut=Vs(i,()=>L({params:Ne,data:ct,queryParams:j,fragment:Y,routeConfig:oe,url:Ee,outlet:Ye,title:bt}));if(Ut instanceof ud)throw new av(Ut);e=Ut}let E=this.applyRedirectCreateUrlTree(e,this.urlSerializer.parse(e),r,s);if(e[0]==="/")throw new av(E);return E}applyRedirectCreateUrlTree(r,e,s,u){let i=this.createSegmentGroup(r,e.root,s,u);return new ud(i,this.createQueryParams(e.queryParams,this.urlTree.queryParams),e.fragment)}createQueryParams(r,e){let s={};return Object.entries(r).forEach(([u,i])=>{if(typeof i=="string"&&i[0]===":"){let L=i.substring(1);s[u]=e[L]}else s[u]=i}),s}createSegmentGroup(r,e,s,u){let i=this.createSegments(r,e.segments,s,u),E={};return Object.entries(e.children).forEach(([L,j])=>{E[L]=this.createSegmentGroup(r,j,s,u)}),new zi(i,E)}createSegments(r,e,s,u){return e.map(i=>i.path[0]===":"?this.findPosParam(r,i,u):this.findOrReturn(i,s))}findPosParam(r,e,s){let u=s[e.path.substring(1)];if(!u)throw new Ht(4001,!1);return u}findOrReturn(r,e){let s=0;for(let u of e){if(u.path===r.path)return e.splice(s),u;s++}return r}},gM={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function N4(n,r,e,s,u){let i=zO(n,r,e);return i.matched?(s=o4(r,s),O4(s,r,e,u).pipe(un(E=>E===!0?i:ut({},gM)))):nn(i)}function zO(n,r,e){if(r.path==="**")return z4(e);if(r.path==="")return r.pathMatch==="full"&&(n.hasChildren()||e.length>0)?ut({},gM):{matched:!0,consumedSegments:[],remainingSegments:e,parameters:{},positionalParamSegments:{}};let u=(r.matcher||P5)(e,n,r);if(!u)return ut({},gM);let i={};Object.entries(u.posParams??{}).forEach(([L,j])=>{i[L]=j.path});let E=u.consumed.length>0?ut(ut({},i),u.consumed[u.consumed.length-1].parameters):i;return{matched:!0,consumedSegments:u.consumed,remainingSegments:e.slice(u.consumed.length),parameters:E,positionalParamSegments:u.posParams??{}}}function z4(n){return{matched:!0,parameters:n.length>0?yO(n).parameters:{},consumedSegments:n,remainingSegments:[],positionalParamSegments:{}}}function dO(n,r,e,s){return e.length>0&&V4(n,e,s)?{segmentGroup:new zi(r,j4(s,new zi(e,n.children))),slicedSegments:[]}:e.length===0&&U4(n,e,s)?{segmentGroup:new zi(n.segments,B4(n,e,s,n.children)),slicedSegments:e}:{segmentGroup:new zi(n.segments,n.children),slicedSegments:e}}function B4(n,r,e,s){let u={};for(let i of e)if(Hx(n,r,i)&&!s[Kl(i)]){let E=new zi([],{});u[Kl(i)]=E}return ut(ut({},s),u)}function j4(n,r){let e={};e[Yn]=r;for(let s of n)if(s.path===""&&Kl(s)!==Yn){let u=new zi([],{});e[Kl(s)]=u}return e}function V4(n,r,e){return e.some(s=>Hx(n,r,s)&&Kl(s)!==Yn)}function U4(n,r,e){return e.some(s=>Hx(n,r,s))}function Hx(n,r,e){return(n.hasChildren()||r.length>0)&&e.pathMatch==="full"?!1:e.path===""}function $4(n,r,e){return r.length===0&&!n.children[e]}var yM=class{};function H4(n,r,e,s,u,i,E="emptyOnly"){return new _M(n,r,e,s,u,E,i).recognize()}var G4=31,_M=class{injector;configLoader;rootComponentType;config;urlTree;paramsInheritanceStrategy;urlSerializer;applyRedirects;absoluteRedirectCount=0;allowRedirects=!0;constructor(r,e,s,u,i,E,L){this.injector=r,this.configLoader=e,this.rootComponentType=s,this.config=u,this.urlTree=i,this.paramsInheritanceStrategy=E,this.urlSerializer=L,this.applyRedirects=new mM(this.urlSerializer,this.urlTree)}noMatchError(r){return new Ht(4002,`'${r.segmentGroup}'`)}recognize(){let r=dO(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(r).pipe(un(({children:e,rootSnapshot:s})=>{let u=new Ea(s,e),i=new zx("",u),E=Q5(s,[],this.urlTree.queryParams,this.urlTree.fragment);return E.queryParams=this.urlTree.queryParams,i.url=this.urlSerializer.serialize(E),{state:i,tree:E}}))}match(r){let e=new Sg([],Object.freeze({}),Object.freeze(ut({},this.urlTree.queryParams)),this.urlTree.fragment,Object.freeze({}),Yn,this.rootComponentType,null,{});return this.processSegmentGroup(this.injector,this.config,r,Yn,e).pipe(un(s=>({children:s,rootSnapshot:e})),jc(s=>{if(s instanceof av)return this.urlTree=s.urlTree,this.match(s.urlTree.root);throw s instanceof sv?this.noMatchError(s):s}))}processSegmentGroup(r,e,s,u,i){return s.segments.length===0&&s.hasChildren()?this.processChildren(r,e,s,i):this.processSegment(r,e,s,s.segments,u,!0,i).pipe(un(E=>E instanceof Ea?[E]:[]))}processChildren(r,e,s,u){let i=[];for(let E of Object.keys(s.children))E==="primary"?i.unshift(E):i.push(E);return pr(i).pipe(Ku(E=>{let L=s.children[E],j=s4(e,E);return this.processSegmentGroup(r,j,L,E,u)}),d_((E,L)=>(E.push(...L),E)),gh(null),dC(),Jr(E=>{if(E===null)return Mg(s);let L=BO(E);return W4(L),nn(L)}))}processSegment(r,e,s,u,i,E,L){return pr(e).pipe(Ku(j=>this.processSegmentAgainstRoute(j._injector??r,e,j,s,u,i,E,L).pipe(jc(Y=>{if(Y instanceof sv)return nn(null);throw Y}))),ql(j=>!!j),jc(j=>{if(FO(j))return $4(s,u,i)?nn(new yM):Mg(s);throw j}))}processSegmentAgainstRoute(r,e,s,u,i,E,L,j){return Kl(s)!==E&&(E===Yn||!Hx(u,i,s))?Mg(u):s.redirectTo===void 0?this.matchSegmentAgainstRoute(r,u,s,i,E,j):this.allowRedirects&&L?this.expandSegmentAgainstRouteUsingRedirect(r,u,e,s,i,E,j):Mg(u)}expandSegmentAgainstRouteUsingRedirect(r,e,s,u,i,E,L){let{matched:j,parameters:Y,consumedSegments:oe,positionalParamSegments:Ee,remainingSegments:Ye}=zO(e,u,i);if(!j)return Mg(e);typeof u.redirectTo=="string"&&u.redirectTo[0]==="/"&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>G4&&(this.allowRedirects=!1));let Ne=new Sg(i,Y,Object.freeze(ut({},this.urlTree.queryParams)),this.urlTree.fragment,hO(u),Kl(u),u.component??u._loadedComponent??null,u,fO(u)),ct=Nx(Ne,L,this.paramsInheritanceStrategy);Ne.params=Object.freeze(ct.params),Ne.data=Object.freeze(ct.data);let bt=this.applyRedirects.applyRedirectCommands(oe,u.redirectTo,Ee,Ne,r);return this.applyRedirects.lineralizeSegments(u,bt).pipe(Jr(Ut=>this.processSegment(r,s,e,Ut.concat(Ye),E,!1,L)))}matchSegmentAgainstRoute(r,e,s,u,i,E){let L=N4(e,s,u,r,this.urlSerializer);return s.path==="**"&&(e.children={}),L.pipe(Ho(j=>j.matched?(r=s._injector??r,this.getChildConfig(r,s,u).pipe(Ho(({routes:Y})=>{let oe=s._loadedInjector??r,{parameters:Ee,consumedSegments:Ye,remainingSegments:Ne}=j,ct=new Sg(Ye,Ee,Object.freeze(ut({},this.urlTree.queryParams)),this.urlTree.fragment,hO(s),Kl(s),s.component??s._loadedComponent??null,s,fO(s)),bt=Nx(ct,E,this.paramsInheritanceStrategy);ct.params=Object.freeze(bt.params),ct.data=Object.freeze(bt.data);let{segmentGroup:Ut,slicedSegments:Qt}=dO(e,Ye,Ne,Y);if(Qt.length===0&&Ut.hasChildren())return this.processChildren(oe,Y,Ut,ct).pipe(un(Gn=>new Ea(ct,Gn)));if(Y.length===0&&Qt.length===0)return nn(new Ea(ct,[]));let _i=Kl(s)===i;return this.processSegment(oe,Y,Ut,Qt,_i?Yn:i,!0,ct).pipe(un(Gn=>new Ea(ct,Gn instanceof Ea?[Gn]:[])))}))):Mg(e)))}getChildConfig(r,e,s){return e.children?nn({routes:e.children,injector:r}):e.loadChildren?e._loadedRoutes!==void 0?nn({routes:e._loadedRoutes,injector:e._loadedInjector}):P4(r,e,s,this.urlSerializer).pipe(Jr(u=>u?this.configLoader.loadChildren(r,e).pipe(xr(i=>{e._loadedRoutes=i.routes,e._loadedInjector=i.injector})):F4(e))):nn({routes:[],injector:r})}};function W4(n){n.sort((r,e)=>r.value.outlet===Yn?-1:e.value.outlet===Yn?1:r.value.outlet.localeCompare(e.value.outlet))}function q4(n){let r=n.value.routeConfig;return r&&r.path===""}function BO(n){let r=[],e=new Set;for(let s of n){if(!q4(s)){r.push(s);continue}let u=r.find(i=>s.value.routeConfig===i.value.routeConfig);u!==void 0?(u.children.push(...s.children),e.add(u)):r.push(s)}for(let s of e){let u=BO(s.children);r.push(new Ea(s.value,u))}return r.filter(s=>!e.has(s))}function hO(n){return n.data||{}}function fO(n){return n.resolve||{}}function Z4(n,r,e,s,u,i){return Jr(E=>H4(n,r,e,s,E.extractedUrl,u,i).pipe(un(({state:L,tree:j})=>Cn(ut({},E),{targetSnapshot:L,urlAfterRedirects:j}))))}function X4(n,r){return Jr(e=>{let{targetSnapshot:s,guards:{canActivateChecks:u}}=e;if(!u.length)return nn(e);let i=new Set(u.map(j=>j.route)),E=new Set;for(let j of i)if(!E.has(j))for(let Y of jO(j))E.add(Y);let L=0;return pr(E).pipe(Ku(j=>i.has(j)?Y4(j,s,n,r):(j.data=Nx(j,j.parent,n).resolve,nn(void 0))),xr(()=>L++),Ym(1),Jr(j=>L===E.size?nn(e):$o))})}function jO(n){let r=n.children.map(e=>jO(e)).flat();return[n,...r]}function Y4(n,r,e,s){let u=n.routeConfig,i=n._resolve;return u?.title!==void 0&&!RO(u)&&(i[lv]=u.title),K4(i,n,r,s).pipe(un(E=>(n._resolvedData=E,n.data=Nx(n,n.parent,e).resolve,null)))}function K4(n,r,e,s){let u=XD(n);if(u.length===0)return nn({});let i={};return pr(u).pipe(Jr(E=>Q4(n[E],r,e,s).pipe(ql(),xr(L=>{if(L instanceof ov)throw Bx(new Rg,L);i[E]=L}))),Ym(1),un(()=>i),jc(E=>FO(E)?$o:fh(E)))}function Q4(n,r,e,s){let u=uv(r)??s,i=zg(n,u),E=i.resolve?i.resolve(r,e):Vs(u,()=>i(r,e));return Ah(E)}function qD(n){return Ho(r=>{let e=n(r);return e?pr(e).pipe(un(()=>r)):nn(r)})}var VO=(()=>{class n{buildTitle(e){let s,u=e.root;for(;u!==void 0;)s=this.getResolvedTitleForRoute(u)??s,u=u.children.find(i=>i.outlet===Yn);return s}getResolvedTitleForRoute(e){return e.data[lv]}static \u0275fac=function(s){return new(s||n)};static \u0275prov=xt({token:n,factory:()=>we(J4),providedIn:"root"})}return n})(),J4=(()=>{class n extends VO{title;constructor(e){super(),this.title=e}updateTitle(e){let s=this.buildTitle(e);s!==void 0&&this.title.setTitle(s)}static \u0275fac=function(s){return new(s||n)(St(oO))};static \u0275prov=xt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),fv=new dt("",{providedIn:"root",factory:()=>({})}),e$=(()=>{class n{static \u0275fac=function(s){return new(s||n)};static \u0275cmp=Bn({type:n,selectors:[["ng-component"]],exportAs:["emptyRouterOutlet"],decls:1,vars:0,template:function(s,u){s&1&&Ui(0,"router-outlet")},dependencies:[xM],encapsulation:2})}return n})();function wM(n){let r=n.children&&n.children.map(wM),e=r?Cn(ut({},n),{children:r}):ut({},n);return!e.component&&!e.loadComponent&&(r||e.loadChildren)&&e.outlet&&e.outlet!==Yn&&(e.component=e$),e}var Vx=new dt(""),CM=(()=>{class n{componentLoaders=new WeakMap;childrenLoaders=new WeakMap;onLoadStartListener;onLoadEndListener;compiler=we(cx);loadComponent(e){if(this.componentLoaders.get(e))return this.componentLoaders.get(e);if(e._loadedComponent)return nn(e._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(e);let s=Ah(e.loadComponent()).pipe(un(UO),xr(i=>{this.onLoadEndListener&&this.onLoadEndListener(e),e._loadedComponent=i}),Vc(()=>{this.componentLoaders.delete(e)})),u=new $m(s,()=>new _n).pipe(Um());return this.componentLoaders.set(e,u),u}loadChildren(e,s){if(this.childrenLoaders.get(s))return this.childrenLoaders.get(s);if(s._loadedRoutes)return nn({routes:s._loadedRoutes,injector:s._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(s);let i=t$(s,this.compiler,e,this.onLoadEndListener).pipe(Vc(()=>{this.childrenLoaders.delete(s)})),E=new $m(i,()=>new _n).pipe(Um());return this.childrenLoaders.set(s,E),E}static \u0275fac=function(s){return new(s||n)};static \u0275prov=xt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function t$(n,r,e,s){return Ah(n.loadChildren()).pipe(un(UO),Jr(u=>u instanceof dD||Array.isArray(u)?nn(u):pr(r.compileModuleAsync(u))),un(u=>{s&&s(n);let i,E,L=!1;return Array.isArray(u)?(E=u,L=!0):(i=u.create(e).injector,E=i.get(Vx,[],{optional:!0,self:!0}).flat()),{routes:E.map(wM),injector:i}}))}function n$(n){return n&&typeof n=="object"&&"default"in n}function UO(n){return n$(n)?n.default:n}var EM=(()=>{class n{static \u0275fac=function(s){return new(s||n)};static \u0275prov=xt({token:n,factory:()=>we(i$),providedIn:"root"})}return n})(),i$=(()=>{class n{shouldProcessUrl(e){return!0}extract(e){return e}merge(e,s){return e}static \u0275fac=function(s){return new(s||n)};static \u0275prov=xt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),$O=new dt(""),HO=new dt("");function r$(n,r,e){let s=n.get(HO),u=n.get(Un);return n.get(ln).runOutsideAngular(()=>{if(!u.startViewTransition||s.skipNextTransition)return s.skipNextTransition=!1,new Promise(Y=>setTimeout(Y));let i,E=new Promise(Y=>{i=Y}),L=u.startViewTransition(()=>(i(),o$(n))),{onViewTransitionCreated:j}=s;return j&&Vs(n,()=>j({transition:L,from:r,to:e})),E})}function o$(n){return new Promise(r=>{Xc({read:()=>setTimeout(r)},{injector:n})})}var GO=new dt(""),DM=(()=>{class n{currentNavigation=null;currentTransition=null;lastSuccessfulNavigation=null;events=new _n;transitionAbortSubject=new _n;configLoader=we(CM);environmentInjector=we(jr);destroyRef=we(Zc);urlSerializer=we(cv);rootContexts=we(dv);location=we(Th);inputBindingEnabled=we($x,{optional:!0})!==null;titleStrategy=we(VO);options=we(fv,{optional:!0})||{};paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly";urlHandlingStrategy=we(EM);createViewTransition=we($O,{optional:!0});navigationErrorHandler=we(GO,{optional:!0});navigationId=0;get hasRequestedNavigation(){return this.navigationId!==0}transitions;afterPreactivation=()=>nn(void 0);rootComponentType=null;destroyed=!1;constructor(){let e=u=>this.events.next(new iM(u)),s=u=>this.events.next(new rM(u));this.configLoader.onLoadEndListener=s,this.configLoader.onLoadStartListener=e,this.destroyRef.onDestroy(()=>{this.destroyed=!0})}complete(){this.transitions?.complete()}handleNavigationRequest(e){let s=++this.navigationId;this.transitions?.next(Cn(ut(ut({},this.transitions.value),e),{id:s}))}setupNavigations(e,s,u){return this.transitions=new Ir({id:0,currentUrlTree:s,currentRawUrl:s,extractedUrl:this.urlHandlingStrategy.extract(s),urlAfterRedirects:this.urlHandlingStrategy.extract(s),rawUrl:s,extras:{},resolve:()=>{},reject:()=>{},promise:Promise.resolve(!0),source:Q_,restoredState:null,currentSnapshot:u.snapshot,targetSnapshot:null,currentRouterState:u,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(Lr(i=>i.id!==0),un(i=>Cn(ut({},i),{extractedUrl:this.urlHandlingStrategy.extract(i.rawUrl)})),Ho(i=>{let E=!1,L=!1;return nn(i).pipe(Ho(j=>{if(this.navigationId>i.id)return this.cancelNavigationTransition(i,"",Da.SupersededByNewNavigation),$o;this.currentTransition=i,this.currentNavigation={id:j.id,initialUrl:j.rawUrl,extractedUrl:j.extractedUrl,targetBrowserUrl:typeof j.extras.browserUrl=="string"?this.urlSerializer.parse(j.extras.browserUrl):j.extras.browserUrl,trigger:j.source,extras:j.extras,previousNavigation:this.lastSuccessfulNavigation?Cn(ut({},this.lastSuccessfulNavigation),{previousNavigation:null}):null};let Y=!e.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),oe=j.extras.onSameUrlNavigation??e.onSameUrlNavigation;if(!Y&&oe!=="reload"){let Ee="";return this.events.next(new Sh(j.id,this.urlSerializer.serialize(j.rawUrl),Ee,Rx.IgnoredSameUrlNavigation)),j.resolve(!1),$o}if(this.urlHandlingStrategy.shouldProcessUrl(j.rawUrl))return nn(j).pipe(Ho(Ee=>{let Ye=this.transitions?.getValue();return this.events.next(new Pg(Ee.id,this.urlSerializer.serialize(Ee.extractedUrl),Ee.source,Ee.restoredState)),Ye!==this.transitions?.getValue()?$o:Promise.resolve(Ee)}),Z4(this.environmentInjector,this.configLoader,this.rootComponentType,e.config,this.urlSerializer,this.paramsInheritanceStrategy),xr(Ee=>{i.targetSnapshot=Ee.targetSnapshot,i.urlAfterRedirects=Ee.urlAfterRedirects,this.currentNavigation=Cn(ut({},this.currentNavigation),{finalUrl:Ee.urlAfterRedirects});let Ye=new Px(Ee.id,this.urlSerializer.serialize(Ee.extractedUrl),this.urlSerializer.serialize(Ee.urlAfterRedirects),Ee.targetSnapshot);this.events.next(Ye)}));if(Y&&this.urlHandlingStrategy.shouldProcessUrl(j.currentRawUrl)){let{id:Ee,extractedUrl:Ye,source:Ne,restoredState:ct,extras:bt}=j,Ut=new Pg(Ee,this.urlSerializer.serialize(Ye),Ne,ct);this.events.next(Ut);let Qt=AO(this.rootComponentType).snapshot;return this.currentTransition=i=Cn(ut({},j),{targetSnapshot:Qt,urlAfterRedirects:Ye,extras:Cn(ut({},bt),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=Ye,nn(i)}else{let Ee="";return this.events.next(new Sh(j.id,this.urlSerializer.serialize(j.extractedUrl),Ee,Rx.IgnoredByUrlHandlingStrategy)),j.resolve(!1),$o}}),xr(j=>{let Y=new JD(j.id,this.urlSerializer.serialize(j.extractedUrl),this.urlSerializer.serialize(j.urlAfterRedirects),j.targetSnapshot);this.events.next(Y)}),un(j=>(this.currentTransition=i=Cn(ut({},j),{guards:p4(j.targetSnapshot,j.currentSnapshot,this.rootContexts)}),i)),D4(this.environmentInjector,j=>this.events.next(j)),xr(j=>{if(i.guardsResult=j.guardsResult,j.guardsResult&&typeof j.guardsResult!="boolean")throw Bx(this.urlSerializer,j.guardsResult);let Y=new eM(j.id,this.urlSerializer.serialize(j.extractedUrl),this.urlSerializer.serialize(j.urlAfterRedirects),j.targetSnapshot,!!j.guardsResult);this.events.next(Y)}),Lr(j=>j.guardsResult?!0:(this.cancelNavigationTransition(j,"",Da.GuardRejected),!1)),qD(j=>{if(j.guards.canActivateChecks.length)return nn(j).pipe(xr(Y=>{let oe=new tM(Y.id,this.urlSerializer.serialize(Y.extractedUrl),this.urlSerializer.serialize(Y.urlAfterRedirects),Y.targetSnapshot);this.events.next(oe)}),Ho(Y=>{let oe=!1;return nn(Y).pipe(X4(this.paramsInheritanceStrategy,this.environmentInjector),xr({next:()=>oe=!0,complete:()=>{oe||this.cancelNavigationTransition(Y,"",Da.NoDataFromResolver)}}))}),xr(Y=>{let oe=new nM(Y.id,this.urlSerializer.serialize(Y.extractedUrl),this.urlSerializer.serialize(Y.urlAfterRedirects),Y.targetSnapshot);this.events.next(oe)}))}),qD(j=>{let Y=oe=>{let Ee=[];oe.routeConfig?.loadComponent&&!oe.routeConfig._loadedComponent&&Ee.push(this.configLoader.loadComponent(oe.routeConfig).pipe(xr(Ye=>{oe.component=Ye}),un(()=>{})));for(let Ye of oe.children)Ee.push(...Y(Ye));return Ee};return Xf(Y(j.targetSnapshot.root)).pipe(gh(null),go(1))}),qD(()=>this.afterPreactivation()),Ho(()=>{let{currentSnapshot:j,targetSnapshot:Y}=i,oe=this.createViewTransition?.(this.environmentInjector,j.root,Y.root);return oe?pr(oe).pipe(un(()=>i)):nn(i)}),un(j=>{let Y=c4(e.routeReuseStrategy,j.targetSnapshot,j.currentRouterState);return this.currentTransition=i=Cn(ut({},j),{targetRouterState:Y}),this.currentNavigation.targetRouterState=Y,i}),xr(()=>{this.events.next(new iv)}),f4(this.rootContexts,e.routeReuseStrategy,j=>this.events.next(j),this.inputBindingEnabled),go(1),xr({next:j=>{E=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new dd(j.id,this.urlSerializer.serialize(j.extractedUrl),this.urlSerializer.serialize(j.urlAfterRedirects))),this.titleStrategy?.updateTitle(j.targetRouterState.snapshot),j.resolve(!0)},complete:()=>{E=!0}}),Br(this.transitionAbortSubject.pipe(xr(j=>{throw j}))),Vc(()=>{!E&&!L&&this.cancelNavigationTransition(i,"",Da.SupersededByNewNavigation),this.currentTransition?.id===i.id&&(this.currentNavigation=null,this.currentTransition=null)}),jc(j=>{if(this.destroyed)return i.resolve(!1),$o;if(L=!0,LO(j))this.events.next(new cd(i.id,this.urlSerializer.serialize(i.extractedUrl),j.message,j.cancellationCode)),h4(j)?this.events.next(new Og(j.url,j.navigationBehaviorOptions)):i.resolve(!1);else{let Y=new nv(i.id,this.urlSerializer.serialize(i.extractedUrl),j,i.targetSnapshot??void 0);try{let oe=Vs(this.environmentInjector,()=>this.navigationErrorHandler?.(Y));if(oe instanceof ov){let{message:Ee,cancellationCode:Ye}=Bx(this.urlSerializer,oe);this.events.next(new cd(i.id,this.urlSerializer.serialize(i.extractedUrl),Ee,Ye)),this.events.next(new Og(oe.redirectTo,oe.navigationBehaviorOptions))}else throw this.events.next(Y),j}catch(oe){this.options.resolveNavigationPromiseOnError?i.resolve(!1):i.reject(oe)}}return $o}))}))}cancelNavigationTransition(e,s,u){let i=new cd(e.id,this.urlSerializer.serialize(e.extractedUrl),s,u);this.events.next(i),e.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){let e=this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))),s=this.currentNavigation?.targetBrowserUrl??this.currentNavigation?.extractedUrl;return e.toString()!==s?.toString()&&!this.currentNavigation?.extras.skipLocationChange}static \u0275fac=function(s){return new(s||n)};static \u0275prov=xt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function s$(n){return n!==Q_}var a$=(()=>{class n{static \u0275fac=function(s){return new(s||n)};static \u0275prov=xt({token:n,factory:()=>we(l$),providedIn:"root"})}return n})(),vM=class{shouldDetach(r){return!1}store(r,e){}shouldAttach(r){return!1}retrieve(r){return null}shouldReuseRoute(r,e){return r.routeConfig===e.routeConfig}},l$=(()=>{class n extends vM{static \u0275fac=(()=>{let e;return function(u){return(e||(e=ya(n)))(u||n)}})();static \u0275prov=xt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),WO=(()=>{class n{static \u0275fac=function(s){return new(s||n)};static \u0275prov=xt({token:n,factory:()=>we(c$),providedIn:"root"})}return n})(),c$=(()=>{class n extends WO{location=we(Th);urlSerializer=we(cv);options=we(fv,{optional:!0})||{};canceledNavigationResolution=this.options.canceledNavigationResolution||"replace";urlHandlingStrategy=we(EM);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";currentUrlTree=new ud;getCurrentUrlTree(){return this.currentUrlTree}rawUrlTree=this.currentUrlTree;getRawUrlTree(){return this.rawUrlTree}currentPageId=0;lastSuccessfulId=-1;restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}routerState=AO(null);getRouterState(){return this.routerState}stateMemento=this.createStateMemento();createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(e){return this.location.subscribe(s=>{s.type==="popstate"&&e(s.url,s.state)})}handleRouterEvent(e,s){if(e instanceof Pg)this.stateMemento=this.createStateMemento();else if(e instanceof Sh)this.rawUrlTree=s.initialUrl;else if(e instanceof Px){if(this.urlUpdateStrategy==="eager"&&!s.extras.skipLocationChange){let u=this.urlHandlingStrategy.merge(s.finalUrl,s.initialUrl);this.setBrowserUrl(s.targetBrowserUrl??u,s)}}else e instanceof iv?(this.currentUrlTree=s.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(s.finalUrl,s.initialUrl),this.routerState=s.targetRouterState,this.urlUpdateStrategy==="deferred"&&!s.extras.skipLocationChange&&this.setBrowserUrl(s.targetBrowserUrl??this.rawUrlTree,s)):e instanceof cd&&(e.code===Da.GuardRejected||e.code===Da.NoDataFromResolver)?this.restoreHistory(s):e instanceof nv?this.restoreHistory(s,!0):e instanceof dd&&(this.lastSuccessfulId=e.id,this.currentPageId=this.browserPageId)}setBrowserUrl(e,s){let u=e instanceof ud?this.urlSerializer.serialize(e):e;if(this.location.isCurrentPathEqualTo(u)||s.extras.replaceUrl){let i=this.browserPageId,E=ut(ut({},s.extras.state),this.generateNgRouterState(s.id,i));this.location.replaceState(u,"",E)}else{let i=ut(ut({},s.extras.state),this.generateNgRouterState(s.id,this.browserPageId+1));this.location.go(u,"",i)}}restoreHistory(e,s=!1){if(this.canceledNavigationResolution==="computed"){let u=this.browserPageId,i=this.currentPageId-u;i!==0?this.location.historyGo(i):this.currentUrlTree===e.finalUrl&&i===0&&(this.resetState(e),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(s&&this.resetState(e),this.resetUrlToCurrentUrlTree())}resetState(e){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,e.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(e,s){return this.canceledNavigationResolution==="computed"?{navigationId:e,\u0275routerPageId:s}:{navigationId:e}}static \u0275fac=(()=>{let e;return function(u){return(e||(e=ya(n)))(u||n)}})();static \u0275prov=xt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function qO(n,r){n.events.pipe(Lr(e=>e instanceof dd||e instanceof cd||e instanceof nv||e instanceof Sh),un(e=>e instanceof dd||e instanceof Sh?0:(e instanceof cd?e.code===Da.Redirect||e.code===Da.SupersededByNewNavigation:!1)?2:1),Lr(e=>e!==2),go(1)).subscribe(()=>{r()})}var u$={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},d$={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},Ng=(()=>{class n{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}disposed=!1;nonRouterCurrentEntryChangeSubscription;console=we(hD);stateManager=we(WO);options=we(fv,{optional:!0})||{};pendingTasks=we(od);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";navigationTransitions=we(DM);urlSerializer=we(cv);location=we(Th);urlHandlingStrategy=we(EM);_events=new _n;get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}navigated=!1;routeReuseStrategy=we(a$);onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore";config=we(Vx,{optional:!0})?.flat()??[];componentInputBindingEnabled=!!we($x,{optional:!0});constructor(){this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:e=>{this.console.warn(e)}}),this.subscribeToNavigationEvents()}eventsSubscription=new Oi;subscribeToNavigationEvents(){let e=this.navigationTransitions.events.subscribe(s=>{try{let u=this.navigationTransitions.currentTransition,i=this.navigationTransitions.currentNavigation;if(u!==null&&i!==null){if(this.stateManager.handleRouterEvent(s,i),s instanceof cd&&s.code!==Da.Redirect&&s.code!==Da.SupersededByNewNavigation)this.navigated=!0;else if(s instanceof dd)this.navigated=!0;else if(s instanceof Og){let E=s.navigationBehaviorOptions,L=this.urlHandlingStrategy.merge(s.url,u.currentRawUrl),j=ut({browserUrl:u.extras.browserUrl,info:u.extras.info,skipLocationChange:u.extras.skipLocationChange,replaceUrl:u.extras.replaceUrl||this.urlUpdateStrategy==="eager"||s$(u.source)},E);this.scheduleNavigation(L,Q_,null,j,{resolve:u.resolve,reject:u.reject,promise:u.promise})}}f$(s)&&this._events.next(s)}catch(u){this.navigationTransitions.transitionAbortSubject.next(u)}});this.eventsSubscription.add(e)}resetRootComponentType(e){this.routerState.root.component=e,this.navigationTransitions.rootComponentType=e}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),Q_,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((e,s)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(e,"popstate",s)},0)})}navigateToSyncWithBrowser(e,s,u){let i={replaceUrl:!0},E=u?.navigationId?u:null;if(u){let j=ut({},u);delete j.navigationId,delete j.\u0275routerPageId,Object.keys(j).length!==0&&(i.state=j)}let L=this.parseUrl(e);this.scheduleNavigation(L,s,E,i)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(e){this.config=e.map(wM),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this._events.unsubscribe(),this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(e,s={}){let{relativeTo:u,queryParams:i,fragment:E,queryParamsHandling:L,preserveFragment:j}=s,Y=j?this.currentUrlTree.fragment:E,oe=null;switch(L??this.options.defaultQueryParamsHandling){case"merge":oe=ut(ut({},this.currentUrlTree.queryParams),i);break;case"preserve":oe=this.currentUrlTree.queryParams;break;default:oe=i||null}oe!==null&&(oe=this.removeEmptyProps(oe));let Ee;try{let Ye=u?u.snapshot:this.routerState.snapshot.root;Ee=MO(Ye)}catch{(typeof e[0]!="string"||e[0][0]!=="/")&&(e=[]),Ee=this.currentUrlTree.root}return TO(Ee,e,oe,Y??null)}navigateByUrl(e,s={skipLocationChange:!1}){let u=ev(e)?e:this.parseUrl(e),i=this.urlHandlingStrategy.merge(u,this.rawUrlTree);return this.scheduleNavigation(i,Q_,null,s)}navigate(e,s={skipLocationChange:!1}){return h$(e),this.navigateByUrl(this.createUrlTree(e,s),s)}serializeUrl(e){return this.urlSerializer.serialize(e)}parseUrl(e){try{return this.urlSerializer.parse(e)}catch{return this.urlSerializer.parse("/")}}isActive(e,s){let u;if(s===!0?u=ut({},u$):s===!1?u=ut({},d$):u=s,ev(e))return sO(this.currentUrlTree,e,u);let i=this.parseUrl(e);return sO(this.currentUrlTree,i,u)}removeEmptyProps(e){return Object.entries(e).reduce((s,[u,i])=>(i!=null&&(s[u]=i),s),{})}scheduleNavigation(e,s,u,i,E){if(this.disposed)return Promise.resolve(!1);let L,j,Y;E?(L=E.resolve,j=E.reject,Y=E.promise):Y=new Promise((Ee,Ye)=>{L=Ee,j=Ye});let oe=this.pendingTasks.add();return qO(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(oe))}),this.navigationTransitions.handleNavigationRequest({source:s,restoredState:u,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:e,extras:i,resolve:L,reject:j,promise:Y,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),Y.catch(Ee=>Promise.reject(Ee))}static \u0275fac=function(s){return new(s||n)};static \u0275prov=xt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function h$(n){for(let r=0;r<n.length;r++)if(n[r]==null)throw new Ht(4008,!1)}function f$(n){return!(n instanceof iv)&&!(n instanceof Og)}var Ux=class{};var p$=(()=>{class n{router;injector;preloadingStrategy;loader;subscription;constructor(e,s,u,i,E){this.router=e,this.injector=u,this.preloadingStrategy=i,this.loader=E}setUpPreloading(){this.subscription=this.router.events.pipe(Lr(e=>e instanceof dd),Ku(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(e,s){let u=[];for(let i of s){i.providers&&!i._injector&&(i._injector=ix(i.providers,e,`Route: ${i.path}`));let E=i._injector??e,L=i._loadedInjector??E;(i.loadChildren&&!i._loadedRoutes&&i.canLoad===void 0||i.loadComponent&&!i._loadedComponent)&&u.push(this.preloadConfig(E,i)),(i.children||i._loadedRoutes)&&u.push(this.processRoutes(L,i.children??i._loadedRoutes))}return pr(u).pipe(ph())}preloadConfig(e,s){return this.preloadingStrategy.preload(s,()=>{let u;s.loadChildren&&s.canLoad===void 0?u=this.loader.loadChildren(e,s):u=nn(null);let i=u.pipe(Jr(E=>E===null?nn(void 0):(s._loadedRoutes=E.routes,s._loadedInjector=E.injector,this.processRoutes(E.injector??e,E.routes))));if(s.loadComponent&&!s._loadedComponent){let E=this.loader.loadComponent(s);return pr([i,E]).pipe(ph())}else return i})}static \u0275fac=function(s){return new(s||n)(St(Ng),St(cx),St(jr),St(Ux),St(CM))};static \u0275prov=xt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),ZO=new dt(""),m$=(()=>{class n{urlSerializer;transitions;viewportScroller;zone;options;routerEventsSubscription;scrollEventsSubscription;lastId=0;lastSource="imperative";restoredId=0;store={};constructor(e,s,u,i,E={}){this.urlSerializer=e,this.transitions=s,this.viewportScroller=u,this.zone=i,this.options=E,E.scrollPositionRestoration||="disabled",E.anchorScrolling||="disabled"}init(){this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(e=>{e instanceof Pg?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=e.navigationTrigger,this.restoredId=e.restoredState?e.restoredState.navigationId:0):e instanceof dd?(this.lastId=e.id,this.scheduleScrollEvent(e,this.urlSerializer.parse(e.urlAfterRedirects).fragment)):e instanceof Sh&&e.code===Rx.IgnoredSameUrlNavigation&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(e,this.urlSerializer.parse(e.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(e=>{e instanceof Ox&&(e.position?this.options.scrollPositionRestoration==="top"?this.viewportScroller.scrollToPosition([0,0]):this.options.scrollPositionRestoration==="enabled"&&this.viewportScroller.scrollToPosition(e.position):e.anchor&&this.options.anchorScrolling==="enabled"?this.viewportScroller.scrollToAnchor(e.anchor):this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(e,s){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new Ox(e,this.lastSource==="popstate"?this.store[this.restoredId]:null,s))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}static \u0275fac=function(s){OR()};static \u0275prov=xt({token:n,factory:n.\u0275fac})}return n})();function g$(n){return n.routerState.root}function pv(n,r){return{\u0275kind:n,\u0275providers:r}}function y$(){let n=we(Jn);return r=>{let e=n.get(js);if(r!==e.components[0])return;let s=n.get(Ng),u=n.get(XO);n.get(MM)===1&&s.initialNavigation(),n.get(YO,null,ti.Optional)?.setUpPreloading(),n.get(ZO,null,ti.Optional)?.init(),s.resetRootComponentType(e.componentTypes[0]),u.closed||(u.next(),u.complete(),u.unsubscribe())}}var XO=new dt("",{factory:()=>new _n}),MM=new dt("",{providedIn:"root",factory:()=>1});function _$(){return pv(2,[{provide:MM,useValue:0},{provide:sx,multi:!0,deps:[Jn],useFactory:r=>{let e=r.get(EP,Promise.resolve());return()=>e.then(()=>new Promise(s=>{let u=r.get(Ng),i=r.get(XO);qO(u,()=>{s(!0)}),r.get(DM).afterPreactivation=()=>(s(!0),i.closed?nn(void 0):i),u.initialNavigation()}))}}])}function v$(){return pv(3,[{provide:sx,multi:!0,useFactory:()=>{let r=we(Ng);return()=>{r.setUpLocationChangeListener()}}},{provide:MM,useValue:2}])}var YO=new dt("");function b$(n){return pv(0,[{provide:YO,useExisting:p$},{provide:Ux,useExisting:n}])}function x$(){return pv(8,[uO,{provide:$x,useExisting:uO}])}function w$(n){let r=[{provide:$O,useValue:r$},{provide:HO,useValue:ut({skipNextTransition:!!n?.skipInitialTransition},n)}];return pv(9,r)}var C$=[Th,{provide:cv,useClass:Rg},Ng,dv,{provide:Lg,useFactory:g$,deps:[Ng]},CM,[]],TM=(()=>{class n{constructor(){}static forRoot(e,s){return{ngModule:n,providers:[C$,[],{provide:Vx,multi:!0,useValue:e},[],s?.errorHandler?{provide:GO,useValue:s.errorHandler}:[],{provide:fv,useValue:s||{}},s?.useHash?D$():M$(),E$(),s?.preloadingStrategy?b$(s.preloadingStrategy).\u0275providers:[],s?.initialNavigation?T$(s):[],s?.bindToComponentInputs?x$().\u0275providers:[],s?.enableViewTransitions?w$().\u0275providers:[],I$()]}}static forChild(e){return{ngModule:n,providers:[{provide:Vx,multi:!0,useValue:e}]}}static \u0275fac=function(s){return new(s||n)};static \u0275mod=en({type:n});static \u0275inj=Jt({})}return n})();function E$(){return{provide:ZO,useFactory:()=>{let n=we(IP),r=we(ln),e=we(fv),s=we(DM),u=we(cv);return e.scrollOffset&&n.setOffset(e.scrollOffset),new m$(u,s,n,r,e)}}}function D$(){return{provide:mp,useClass:MP}}function M$(){return{provide:mp,useClass:MD}}function T$(n){return[n.initialNavigation==="disabled"?v$().\u0275providers:[],n.initialNavigation==="enabledBlocking"?_$().\u0275providers:[]]}var pO=new dt("");function I$(){return[{provide:pO,useFactory:y$},{provide:ax,multi:!0,useExisting:pO}]}var Gx=class n{title="weather-app";static \u0275fac=function(e){return new(e||n)};static \u0275cmp=Bn({type:n,selectors:[["app-root"]],standalone:!1,decls:1,vars:0,template:function(e,s){e&1&&Ui(0,"router-outlet")},dependencies:[xM],encapsulation:2})};var Bg={production:!1,api_key:"180aff8985c4d1be039fb47bf05ae0a3",location_api:"https://api.openweathermap.org/geo/1.0/",city_wise_search:"https://api.openweathermap.org/data/2.5/weather",forecast_api:"https://api.openweathermap.org/data/2.5/forecast",weather_api:"https://api.openweathermap.org/data/2.5/"};var jg=class n{constructor(){}getDetailsViaCityName(r,e,s){return`${s?Bg.forecast_api:Bg.city_wise_search}?q=${r}&appid=${Bg.api_key}&units=${e?"metric":"imperial"}`}getDetailsViaLatLong(r,e,s){return Bg.weather_api+"weather?lat="+r+"&lon="+e+"&appid="+Bg.api_key+`&units=${s?"metric":"imperial"}`}static \u0275fac=function(e){return new(e||n)};static \u0275prov=xt({token:n,factory:n.\u0275fac,providedIn:"root"})};var Vg=class n{constructor(r){this.http=r}get(r,e){return this.http.get(r,e)}static \u0275fac=function(e){return new(e||n)(St(G_))};static \u0275prov=xt({token:n,factory:n.\u0275fac,providedIn:"root"})};var Jc=HI(QO(),1);var R$=["content"],P$=["*"],O$=["container"];var JO=new dt("MapboxApiKey"),AM=(()=>{class n{constructor(e,s){this.zone=e,this.MAPBOX_API_KEY=s,this.mapCreated=new Hm,this.mapLoaded=new Hm,this.markersToRemove=[],this.popupsToRemove=[],this.imageIdsToRemove=[],this.subscription=new Oi,this.mapCreated$=this.mapCreated.asObservable(),this.mapLoaded$=this.mapLoaded.asObservable()}setup(e){this.zone.onStable.pipe(ql()).subscribe(()=>{e.customMapboxApiUrl&&(Jc.default.baseApiUrl=e.customMapboxApiUrl),this.createMap(Cn(ut({},e.mapOptions),{accessToken:e.accessToken||this.MAPBOX_API_KEY||""})),this.hookEvents(e.mapEvents),this.mapEvents=e.mapEvents,this.mapCreated.next(void 0),this.mapCreated.complete(),e.mapEvents.mapCreate.observed&&this.zone.run(()=>{e.mapEvents.mapCreate.emit(this.mapInstance)})})}destroyMap(){this.mapInstance&&(this.subscription.unsubscribe(),this.mapInstance.remove())}updateProjection(e){return this.zone.runOutsideAngular(()=>{this.mapInstance.setProjection(e)})}updateMinZoom(e){return this.zone.runOutsideAngular(()=>{this.mapInstance.setMinZoom(e)})}updateMaxZoom(e){return this.zone.runOutsideAngular(()=>{this.mapInstance.setMaxZoom(e)})}updateMinPitch(e){return this.zone.runOutsideAngular(()=>{this.mapInstance.setMinPitch(e)})}updateMaxPitch(e){return this.zone.runOutsideAngular(()=>{this.mapInstance.setMaxPitch(e)})}updateRenderWorldCopies(e){return this.zone.runOutsideAngular(()=>{this.mapInstance.setRenderWorldCopies(e)})}updateScrollZoom(e){return this.zone.runOutsideAngular(()=>{e?this.mapInstance.scrollZoom.enable():this.mapInstance.scrollZoom.disable()})}updateDragRotate(e){return this.zone.runOutsideAngular(()=>{e?this.mapInstance.dragRotate.enable():this.mapInstance.dragRotate.disable()})}updateTouchPitch(e){return this.zone.runOutsideAngular(()=>{e?this.mapInstance.touchPitch.enable():this.mapInstance.touchPitch.disable()})}updateTouchZoomRotate(e){return this.zone.runOutsideAngular(()=>{e?this.mapInstance.touchZoomRotate.enable():this.mapInstance.touchZoomRotate.disable()})}updateDoubleClickZoom(e){return this.zone.runOutsideAngular(()=>{e?this.mapInstance.doubleClickZoom.enable():this.mapInstance.doubleClickZoom.disable()})}updateKeyboard(e){return this.zone.runOutsideAngular(()=>{e?this.mapInstance.keyboard.enable():this.mapInstance.keyboard.disable()})}updateDragPan(e){return this.zone.runOutsideAngular(()=>{e?this.mapInstance.dragPan.enable():this.mapInstance.dragPan.disable()})}updateBoxZoom(e){return this.zone.runOutsideAngular(()=>{e?this.mapInstance.boxZoom.enable():this.mapInstance.boxZoom.disable()})}updateStyle(e){return this.zone.runOutsideAngular(()=>{this.mapInstance.setStyle(e)})}updateMaxBounds(e){return this.zone.runOutsideAngular(()=>{this.mapInstance.setMaxBounds(e)})}changeCanvasCursor(e){let s=this.mapInstance.getCanvasContainer();s.style.cursor=e}queryRenderedFeatures(e,s){return this.mapInstance.queryRenderedFeatures(e,s)}panTo(e,s){return this.zone.runOutsideAngular(()=>{this.mapInstance.panTo(e,s)})}move(e,s,u,i,E,L){return this.zone.runOutsideAngular(()=>{this.mapInstance[e](Cn(ut({},s),{zoom:u??this.mapInstance.getZoom(),center:i??this.mapInstance.getCenter(),bearing:E??this.mapInstance.getBearing(),pitch:L??this.mapInstance.getPitch()}))})}addLayer(e,s,u){this.zone.runOutsideAngular(()=>{Object.keys(e.layerOptions).forEach(i=>{let E=i;e.layerOptions[E]===void 0&&delete e.layerOptions[E]}),this.mapInstance.addLayer(e.layerOptions,u),s&&((e.layerEvents.layerClick.observed||e.layerEvents.click.observed)&&this.mapInstance.on("click",e.layerOptions.id,i=>{this.zone.run(()=>{e.layerEvents.layerClick.emit(i),e.layerEvents.click.emit(i)})}),(e.layerEvents.layerDblClick.observed||e.layerEvents.dblClick.observed)&&this.mapInstance.on("dblclick",e.layerOptions.id,i=>{this.zone.run(()=>{e.layerEvents.layerDblClick.emit(i),e.layerEvents.dblClick.emit(i)})}),(e.layerEvents.layerMouseDown.observed||e.layerEvents.mouseDown.observed)&&this.mapInstance.on("mousedown",e.layerOptions.id,i=>{this.zone.run(()=>{e.layerEvents.layerMouseDown.emit(i),e.layerEvents.mouseDown.emit(i)})}),(e.layerEvents.layerMouseUp.observed||e.layerEvents.mouseUp.observed)&&this.mapInstance.on("mouseup",e.layerOptions.id,i=>{this.zone.run(()=>{e.layerEvents.layerMouseUp.emit(i),e.layerEvents.mouseUp.emit(i)})}),(e.layerEvents.layerMouseEnter.observed||e.layerEvents.mouseEnter.observed)&&this.mapInstance.on("mouseenter",e.layerOptions.id,i=>{this.zone.run(()=>{e.layerEvents.layerMouseEnter.emit(i),e.layerEvents.mouseEnter.emit(i)})}),(e.layerEvents.layerMouseLeave.observed||e.layerEvents.mouseLeave.observed)&&this.mapInstance.on("mouseleave",e.layerOptions.id,i=>{this.zone.run(()=>{e.layerEvents.layerMouseLeave.emit(i),e.layerEvents.mouseLeave.emit(i)})}),(e.layerEvents.layerMouseMove.observed||e.layerEvents.mouseMove.observed)&&this.mapInstance.on("mousemove",e.layerOptions.id,i=>{this.zone.run(()=>{e.layerEvents.layerMouseMove.emit(i),e.layerEvents.mouseMove.emit(i)})}),(e.layerEvents.layerMouseOver.observed||e.layerEvents.mouseOver.observed)&&this.mapInstance.on("mouseover",e.layerOptions.id,i=>{this.zone.run(()=>{e.layerEvents.layerMouseOver.emit(i),e.layerEvents.mouseOver.emit(i)})}),(e.layerEvents.layerMouseOut.observed||e.layerEvents.mouseOut.observed)&&this.mapInstance.on("mouseout",e.layerOptions.id,i=>{this.zone.run(()=>{e.layerEvents.layerMouseOut.emit(i),e.layerEvents.mouseOut.emit(i)})}),(e.layerEvents.layerContextMenu.observed||e.layerEvents.contextMenu.observed)&&this.mapInstance.on("contextmenu",e.layerOptions.id,i=>{this.zone.run(()=>{e.layerEvents.layerContextMenu.emit(i),e.layerEvents.contextMenu.emit(i)})}),(e.layerEvents.layerTouchStart.observed||e.layerEvents.touchStart.observed)&&this.mapInstance.on("touchstart",e.layerOptions.id,i=>{this.zone.run(()=>{e.layerEvents.layerTouchStart.emit(i),e.layerEvents.touchStart.emit(i)})}),(e.layerEvents.layerTouchEnd.observed||e.layerEvents.touchEnd.observed)&&this.mapInstance.on("touchend",e.layerOptions.id,i=>{this.zone.run(()=>{e.layerEvents.layerTouchEnd.emit(i),e.layerEvents.touchEnd.emit(i)})}),(e.layerEvents.layerTouchCancel.observed||e.layerEvents.touchCancel.observed)&&this.mapInstance.on("touchcancel",e.layerOptions.id,i=>{this.zone.run(()=>{e.layerEvents.layerTouchCancel.emit(i),e.layerEvents.touchCancel.emit(i)})}))})}removeLayer(e){this.zone.runOutsideAngular(()=>{this.mapInstance.getLayer(e)!=null&&this.mapInstance.removeLayer(e)})}addMarker(e){let s={offset:e.markersOptions.offset,anchor:e.markersOptions.anchor,draggable:!!e.markersOptions.draggable,rotationAlignment:e.markersOptions.rotationAlignment,pitchAlignment:e.markersOptions.pitchAlignment,clickTolerance:e.markersOptions.clickTolerance};e.markersOptions.element.childNodes.length>0&&(s.element=e.markersOptions.element);let u=new Jc.default.Marker(s);(e.markersEvents.markerDragStart.observed||e.markersEvents.dragStart.observed)&&u.on("dragstart",E=>{if(E){let{target:L}=E;this.zone.run(()=>{e.markersEvents.markerDragStart.emit(L),e.markersEvents.dragStart.emit(L)})}}),(e.markersEvents.markerDrag.observed||e.markersEvents.drag.observed)&&u.on("drag",E=>{if(E){let{target:L}=E;this.zone.run(()=>{e.markersEvents.markerDrag.emit(L),e.markersEvents.drag.emit(L)})}}),(e.markersEvents.markerDragEnd.observed||e.markersEvents.dragEnd.observed)&&u.on("dragend",E=>{if(E){let{target:L}=E;this.zone.run(()=>{e.markersEvents.markerDragEnd.emit(L),e.markersEvents.dragEnd.emit(L)})}});let i=e.markersOptions.feature?e.markersOptions.feature.geometry.coordinates:e.markersOptions.lngLat;return u.setLngLat(i),this.zone.runOutsideAngular(()=>(u.addTo(this.mapInstance),u))}removeMarker(e){this.markersToRemove.push(e)}createPopup(e,s){return this.zone.runOutsideAngular(()=>{Object.keys(e.popupOptions).forEach(i=>e.popupOptions[i]===void 0&&delete e.popupOptions[i]);let u=new Jc.default.Popup(e.popupOptions);return u.setDOMContent(s),(e.popupEvents.popupClose.observed||e.popupEvents.close.observed)&&u.on("close",()=>{this.zone.run(()=>{e.popupEvents.popupClose.emit(),e.popupEvents.close.emit()})}),(e.popupEvents.popupOpen.observed||e.popupEvents.open.observed)&&u.on("open",()=>{this.zone.run(()=>{e.popupEvents.popupOpen.emit(),e.popupEvents.open.emit()})}),u})}addPopupToMap(e,s,u=!1){return this.zone.runOutsideAngular(()=>{u&&e._listeners&&delete e._listeners.open,e.setLngLat(s),e.addTo(this.mapInstance)})}addPopupToMarker(e,s){return this.zone.runOutsideAngular(()=>{e.setPopup(s)})}removePopupFromMap(e,s=!1){s&&e._listeners&&delete e._listeners.close,this.popupsToRemove.push(e)}removePopupFromMarker(e){return this.zone.runOutsideAngular(()=>{e.setPopup(void 0)})}addControl(e,s){return this.zone.runOutsideAngular(()=>{this.mapInstance.addControl(e,s)})}removeControl(e){return this.zone.runOutsideAngular(()=>{this.mapInstance.removeControl(e)})}loadAndAddImage(e,s,u){return Fm(this,null,function*(){return this.zone.runOutsideAngular(()=>new Promise((i,E)=>{this.mapInstance.loadImage(s,(L,j)=>{if(L){E(L);return}this.addImage(e,j,u),i()})}))})}addImage(e,s,u){return this.zone.runOutsideAngular(()=>{this.mapInstance.addImage(e,s,u)})}removeImage(e){this.imageIdsToRemove.push(e)}addSource(e,s){return this.zone.runOutsideAngular(()=>{Object.keys(s).forEach(u=>s[u]===void 0&&delete s[u]),this.mapInstance.addSource(e,s)})}getSource(e){return this.mapInstance.getSource(e)}removeSource(e){this.zone.runOutsideAngular(()=>{this.findLayersBySourceId(e).forEach(s=>this.mapInstance.removeLayer(s.id)),this.mapInstance.removeSource(e)})}setAllLayerPaintProperty(e,s){return this.zone.runOutsideAngular(()=>{Object.keys(s).forEach(u=>{this.mapInstance.setPaintProperty(e,u,s[u])})})}setAllLayerLayoutProperty(e,s){return this.zone.runOutsideAngular(()=>{Object.keys(s).forEach(u=>{this.mapInstance.setLayoutProperty(e,u,s[u])})})}setLayerFilter(e,s){return this.zone.runOutsideAngular(()=>{this.mapInstance.setFilter(e,s)})}setLayerBefore(e,s){return this.zone.runOutsideAngular(()=>{this.mapInstance.moveLayer(e,s)})}setLayerZoomRange(e,s,u){return this.zone.runOutsideAngular(()=>{this.mapInstance.setLayerZoomRange(e,s||0,u||20)})}fitBounds(e,s){return this.zone.runOutsideAngular(()=>{this.mapInstance.fitBounds(e,s)})}fitScreenCoordinates(e,s,u){return this.zone.runOutsideAngular(()=>{this.mapInstance.fitScreenCoordinates(e[0],e[1],s,u)})}applyChanges(){this.zone.runOutsideAngular(()=>{this.removeMarkers(),this.removePopups(),this.removeImages()})}createMap(e){ln.assertNotInAngularZone(),Object.keys(e).forEach(u=>{let i=u;e[i]===void 0&&delete e[i]}),this.mapInstance=new Jc.default.Map(e),window&&/msie\s|trident\/|edge\//i.test(window.navigator.userAgent)&&this.mapInstance.setStyle(e.style),this.subscription.add(this.zone.onMicrotaskEmpty.subscribe(()=>this.applyChanges()))}removeMarkers(){for(let e of this.markersToRemove)e.remove();this.markersToRemove=[]}removePopups(){for(let e of this.popupsToRemove)e.remove();this.popupsToRemove=[]}removeImages(){for(let e of this.imageIdsToRemove)this.mapInstance.removeImage(e);this.imageIdsToRemove=[]}findLayersBySourceId(e){let s=this.mapInstance.getStyle().layers;return s==null?[]:s.filter(u=>"source"in u?u.source===e:!1)}hookEvents(e){this.mapInstance.on("load",s=>{this.mapLoaded.next(void 0),this.mapLoaded.complete(),this.zone.run(()=>{e.mapLoad.emit(s),e.load.emit(s.target)})}),(e.mapResize.observed||e.resize.observed)&&this.mapInstance.on("resize",s=>this.zone.run(()=>{e.mapResize.emit(s),e.resize.emit(s)})),(e.mapRemove.observed||e.remove.observed)&&this.mapInstance.on("remove",s=>this.zone.run(()=>{e.mapRemove.emit(s),e.remove.emit(s)})),(e.mapMouseDown.observed||e.mouseDown.observed)&&this.mapInstance.on("mousedown",s=>this.zone.run(()=>{e.mapMouseDown.emit(s),e.mouseDown.emit(s)})),(e.mapMouseUp.observed||e.mouseUp.observed)&&this.mapInstance.on("mouseup",s=>this.zone.run(()=>{e.mapMouseUp.emit(s),e.mouseUp.emit(s)})),(e.mapMouseMove.observed||e.mouseMove.observed)&&this.mapInstance.on("mousemove",s=>this.zone.run(()=>{e.mapMouseMove.emit(s),e.mouseMove.emit(s)})),(e.mapClick.observed||e.click.observed)&&this.mapInstance.on("click",s=>this.zone.run(()=>{e.mapClick.emit(s),e.click.emit(s)})),(e.mapDblClick.observed||e.dblClick.observed)&&this.mapInstance.on("dblclick",s=>this.zone.run(()=>{e.mapDblClick.emit(s),e.dblClick.emit(s)})),(e.mapMouseOver.observed||e.mouseOver.observed)&&this.mapInstance.on("mouseover",s=>this.zone.run(()=>{e.mapMouseOver.emit(s),e.mouseOver.emit(s)})),(e.mapMouseOut.observed||e.mouseOut.observed)&&this.mapInstance.on("mouseout",s=>this.zone.run(()=>{e.mapMouseOut.emit(s),e.mouseOut.emit(s)})),(e.mapContextMenu.observed||e.contextMenu.observed)&&this.mapInstance.on("contextmenu",s=>this.zone.run(()=>{e.mapContextMenu.emit(s),e.contextMenu.emit(s)})),(e.mapTouchStart.observed||e.touchStart.observed)&&this.mapInstance.on("touchstart",s=>this.zone.run(()=>{e.mapTouchStart.emit(s),e.touchStart.emit(s)})),(e.mapTouchEnd.observed||e.touchEnd.observed)&&this.mapInstance.on("touchend",s=>this.zone.run(()=>{e.mapTouchEnd.emit(s),e.touchEnd.emit(s)})),(e.mapTouchMove.observed||e.touchMove.observed)&&this.mapInstance.on("touchmove",s=>this.zone.run(()=>{e.mapTouchMove.emit(s),e.touchMove.emit(s)})),(e.mapTouchCancel.observed||e.touchCancel.observed)&&this.mapInstance.on("touchcancel",s=>this.zone.run(()=>{e.mapTouchCancel.emit(s),e.touchCancel.emit(s)})),(e.mapWheel.observed||e.wheel.observed)&&this.mapInstance.on("wheel",s=>this.zone.run(()=>{e.mapWheel.emit(s),e.wheel.emit(s)})),e.moveStart.observed&&this.mapInstance.on("movestart",s=>this.zone.run(()=>e.moveStart.emit(s))),e.move.observed&&this.mapInstance.on("move",s=>this.zone.run(()=>e.move.emit(s))),e.moveEnd.observed&&this.mapInstance.on("moveend",s=>this.zone.run(()=>e.moveEnd.emit(s))),(e.mapDragStart.observed||e.dragStart.observed)&&this.mapInstance.on("dragstart",s=>this.zone.run(()=>{e.mapDragStart.emit(s),e.dragStart.emit(s)})),(e.mapDrag.observed||e.drag.observed)&&this.mapInstance.on("drag",s=>this.zone.run(()=>{e.mapDrag.emit(s),e.drag.emit(s)})),(e.mapDragEnd.observed||e.dragEnd.observed)&&this.mapInstance.on("dragend",s=>this.zone.run(()=>{e.mapDragEnd.emit(s),e.dragEnd.emit(s)})),e.zoomStart.observed&&this.mapInstance.on("zoomstart",s=>this.zone.run(()=>e.zoomStart.emit(s))),e.zoomEvt.observed&&this.mapInstance.on("zoom",s=>this.zone.run(()=>e.zoomEvt.emit(s))),e.zoomEnd.observed&&this.mapInstance.on("zoomend",s=>this.zone.run(()=>e.zoomEnd.emit(s))),e.rotateStart.observed&&this.mapInstance.on("rotatestart",s=>this.zone.run(()=>e.rotateStart.emit(s))),e.rotate.observed&&this.mapInstance.on("rotate",s=>this.zone.run(()=>e.rotate.emit(s))),e.rotateEnd.observed&&this.mapInstance.on("rotateend",s=>this.zone.run(()=>e.rotateEnd.emit(s))),e.pitchStart.observed&&this.mapInstance.on("pitchstart",s=>this.zone.run(()=>e.pitchStart.emit(s))),e.pitchEvt.observed&&this.mapInstance.on("pitch",s=>this.zone.run(()=>e.pitchEvt.emit(s))),e.pitchEnd.observed&&this.mapInstance.on("pitchend",s=>this.zone.run(()=>e.pitchEnd.emit(s))),e.boxZoomStart.observed&&this.mapInstance.on("boxzoomstart",s=>this.zone.run(()=>e.boxZoomStart.emit(s))),e.boxZoomEnd.observed&&this.mapInstance.on("boxzoomend",s=>this.zone.run(()=>e.boxZoomEnd.emit(s))),e.boxZoomCancel.observed&&this.mapInstance.on("boxzoomcancel",s=>this.zone.run(()=>e.boxZoomCancel.emit(s))),e.webGlContextLost.observed&&this.mapInstance.on("webglcontextlost",s=>this.zone.run(()=>e.webGlContextLost.emit(s))),e.webGlContextRestored.observed&&this.mapInstance.on("webglcontextrestored",s=>this.zone.run(()=>e.webGlContextRestored.emit(s))),e.render.observed&&this.mapInstance.on("render",s=>this.zone.run(()=>e.render.emit(s))),(e.mapError.observed||e.error.observed)&&this.mapInstance.on("error",s=>this.zone.run(()=>{e.mapError.emit(s),e.error.emit(s)})),e.data.observed&&this.mapInstance.on("data",s=>this.zone.run(()=>e.data.emit(s))),e.styleData.observed&&this.mapInstance.on("styledata",s=>this.zone.run(()=>e.styleData.emit(s))),e.sourceData.observed&&this.mapInstance.on("sourcedata",s=>this.zone.run(()=>e.sourceData.emit(s))),e.dataLoading.observed&&this.mapInstance.on("dataloading",s=>this.zone.run(()=>e.dataLoading.emit(s))),e.styleDataLoading.observed&&this.mapInstance.on("styledataloading",s=>this.zone.run(()=>e.styleDataLoading.emit(s))),e.sourceDataLoading.observed&&this.mapInstance.on("sourcedataloading",s=>this.zone.run(()=>e.sourceDataLoading.emit(s))),e.styleImageMissing.observed&&this.mapInstance.on("styleimagemissing",s=>this.zone.run(()=>e.styleImageMissing.emit(s))),e.idle.observed&&this.mapInstance.on("idle",s=>this.zone.run(()=>e.idle.emit(s)))}assign(e,s,u){if(typeof s=="string"&&(s=s.split(".")),s.length>1){let i=s.shift();this.assign(e[i]=Object.prototype.toString.call(e[i])==="[object Object]"?e[i]:{},s,u)}else e[s[0]]=u}static{this.\u0275fac=function(s){return new(s||n)(St(ln),St(JO,8))}}static{this.\u0275prov=xt({token:n,factory:n.\u0275fac})}}return n})();var e2=(n,r,e)=>{console.warn(`[ngx-mapbox-gl]: ${n}: ${r} is deprecated, please use ${e} instead.`)};var t2=(()=>{class n{get mapInstance(){return this.mapService.mapInstance}constructor(e){this.mapService=e,this.movingMethod="flyTo",this.mapResize=new Dt,this.mapRemove=new Dt,this.mapMouseDown=new Dt,this.mapMouseUp=new Dt,this.mapMouseMove=new Dt,this.mapClick=new Dt,this.mapDblClick=new Dt,this.mapMouseOver=new Dt,this.mapMouseOut=new Dt,this.mapContextMenu=new Dt,this.mapTouchStart=new Dt,this.mapTouchEnd=new Dt,this.mapTouchMove=new Dt,this.mapTouchCancel=new Dt,this.mapWheel=new Dt,this.moveStart=new Dt,this.move=new Dt,this.moveEnd=new Dt,this.mapDragStart=new Dt,this.mapDrag=new Dt,this.mapDragEnd=new Dt,this.zoomStart=new Dt,this.zoomEvt=new Dt,this.zoomEnd=new Dt,this.rotateStart=new Dt,this.rotate=new Dt,this.rotateEnd=new Dt,this.pitchStart=new Dt,this.pitchEvt=new Dt,this.pitchEnd=new Dt,this.boxZoomStart=new Dt,this.boxZoomEnd=new Dt,this.boxZoomCancel=new Dt,this.webGlContextLost=new Dt,this.webGlContextRestored=new Dt,this.mapLoad=new Dt,this.mapCreate=new Dt,this.idle=new Dt,this.render=new Dt,this.mapError=new Dt,this.data=new Dt,this.styleData=new Dt,this.sourceData=new Dt,this.dataLoading=new Dt,this.styleDataLoading=new Dt,this.sourceDataLoading=new Dt,this.styleImageMissing=new Dt,this.resize=new Dt,this.remove=new Dt,this.mouseDown=new Dt,this.mouseUp=new Dt,this.mouseMove=new Dt,this.click=new Dt,this.dblClick=new Dt,this.mouseOver=new Dt,this.mouseOut=new Dt,this.contextMenu=new Dt,this.touchStart=new Dt,this.touchEnd=new Dt,this.touchMove=new Dt,this.touchCancel=new Dt,this.wheel=new Dt,this.dragStart=new Dt,this.drag=new Dt,this.dragEnd=new Dt,this.load=new Dt,this.error=new Dt}ngAfterViewInit(){this.warnDeprecatedOutputs(),this.mapService.setup({accessToken:this.accessToken,customMapboxApiUrl:this.customMapboxApiUrl,mapOptions:{collectResourceTiming:this.collectResourceTiming,container:this.mapContainer.nativeElement,crossSourceCollisions:this.crossSourceCollisions,fadeDuration:this.fadeDuration,minZoom:this.minZoom,maxZoom:this.maxZoom,minPitch:this.minPitch,maxPitch:this.maxPitch,style:this.style,hash:this.hash,interactive:this.interactive,bearingSnap:this.bearingSnap,pitchWithRotate:this.pitchWithRotate,clickTolerance:this.clickTolerance,attributionControl:this.attributionControl,logoPosition:this.logoPosition,failIfMajorPerformanceCaveat:this.failIfMajorPerformanceCaveat,preserveDrawingBuffer:this.preserveDrawingBuffer,refreshExpiredTiles:this.refreshExpiredTiles,maxBounds:this.maxBounds,scrollZoom:this.scrollZoom,boxZoom:this.boxZoom,dragRotate:this.dragRotate,dragPan:this.dragPan,keyboard:this.keyboard,doubleClickZoom:this.doubleClickZoom,touchPitch:this.touchPitch,touchZoomRotate:this.touchZoomRotate,trackResize:this.trackResize,center:this.center,zoom:this.zoom,bearing:this.bearing,pitch:this.pitch,renderWorldCopies:this.renderWorldCopies,maxTileCacheSize:this.maxTileCacheSize,localIdeographFontFamily:this.localIdeographFontFamily,transformRequest:this.transformRequest,bounds:this.bounds?this.bounds:this.fitBounds,fitBoundsOptions:this.fitBoundsOptions,antialias:this.antialias,locale:this.locale,cooperativeGestures:this.cooperativeGestures,projection:this.projection},mapEvents:this}),this.cursorStyle&&this.mapService.changeCanvasCursor(this.cursorStyle)}ngOnDestroy(){this.mapService.destroyMap()}ngOnChanges(e){return Fm(this,null,function*(){yield cC(this.mapService.mapCreated$),e.cursorStyle&&!e.cursorStyle.isFirstChange()&&this.mapService.changeCanvasCursor(e.cursorStyle.currentValue),e.projection&&!e.projection.isFirstChange()&&this.mapService.updateProjection(e.projection.currentValue),e.minZoom&&!e.minZoom.isFirstChange()&&this.mapService.updateMinZoom(e.minZoom.currentValue),e.maxZoom&&!e.maxZoom.isFirstChange()&&this.mapService.updateMaxZoom(e.maxZoom.currentValue),e.minPitch&&!e.minPitch.isFirstChange()&&this.mapService.updateMinPitch(e.minPitch.currentValue),e.maxPitch&&!e.maxPitch.isFirstChange()&&this.mapService.updateMaxPitch(e.maxPitch.currentValue),e.renderWorldCopies&&!e.renderWorldCopies.isFirstChange()&&this.mapService.updateRenderWorldCopies(e.renderWorldCopies.currentValue),e.scrollZoom&&!e.scrollZoom.isFirstChange()&&this.mapService.updateScrollZoom(e.scrollZoom.currentValue),e.dragRotate&&!e.dragRotate.isFirstChange()&&this.mapService.updateDragRotate(e.dragRotate.currentValue),e.touchPitch&&!e.touchPitch.isFirstChange()&&this.mapService.updateTouchPitch(e.touchPitch.currentValue),e.touchZoomRotate&&!e.touchZoomRotate.isFirstChange()&&this.mapService.updateTouchZoomRotate(e.touchZoomRotate.currentValue),e.doubleClickZoom&&!e.doubleClickZoom.isFirstChange()&&this.mapService.updateDoubleClickZoom(e.doubleClickZoom.currentValue),e.keyboard&&!e.keyboard.isFirstChange()&&this.mapService.updateKeyboard(e.keyboard.currentValue),e.dragPan&&!e.dragPan.isFirstChange()&&this.mapService.updateDragPan(e.dragPan.currentValue),e.boxZoom&&!e.boxZoom.isFirstChange()&&this.mapService.updateBoxZoom(e.boxZoom.currentValue),e.style&&!e.style.isFirstChange()&&this.mapService.updateStyle(e.style.currentValue),e.maxBounds&&!e.maxBounds.isFirstChange()&&this.mapService.updateMaxBounds(e.maxBounds.currentValue),e.fitBounds&&e.fitBounds.currentValue&&!e.fitBounds.isFirstChange()&&this.mapService.fitBounds(e.fitBounds.currentValue,this.fitBoundsOptions),e.fitScreenCoordinates&&e.fitScreenCoordinates.currentValue&&((this.center||this.zoom||this.pitch||this.fitBounds)&&e.fitScreenCoordinates.isFirstChange()&&console.warn("[ngx-mapbox-gl] center / zoom / pitch / fitBounds inputs are being overridden by fitScreenCoordinates input"),this.mapService.fitScreenCoordinates(e.fitScreenCoordinates.currentValue,this.bearing?this.bearing[0]:0,this.movingOptions)),this.centerWithPanTo&&e.center&&!e.center.isFirstChange()&&!e.zoom&&!e.bearing&&!e.pitch?this.mapService.panTo(this.center,this.panToOptions):(e.center&&!e.center.isFirstChange()||e.zoom&&!e.zoom.isFirstChange()||e.bearing&&!e.bearing.isFirstChange()&&!e.fitScreenCoordinates||e.pitch&&!e.pitch.isFirstChange())&&this.mapService.move(this.movingMethod,this.movingOptions,e.zoom&&this.zoom?this.zoom[0]:void 0,e.center?this.center:void 0,e.bearing&&this.bearing?this.bearing[0]:void 0,e.pitch&&this.pitch?this.pitch[0]:void 0)})}warnDeprecatedOutputs(){let e=e2.bind(void 0,n.name);this.resize.observed&&e("resize","mapResize"),this.remove.observed&&e("remove","mapRemove"),this.mouseDown.observed&&e("mouseDown","mapMouseDown"),this.mouseUp.observed&&e("mouseUp","mapMouseUp"),this.mouseMove.observed&&e("mouseMove","mapMouseMove"),this.click.observed&&e("click","mapClick"),this.dblClick.observed&&e("dblClick","mapDblClick"),this.mouseOver.observed&&e("mouseOver","mapMouseOver"),this.mouseOut.observed&&e("mouseOut","mapMouseOut"),this.contextMenu.observed&&e("contextMenu","mapContextMenu"),this.touchStart.observed&&e("touchStart","mapTouchStart"),this.touchEnd.observed&&e("touchEnd","mapTouchEnd"),this.touchMove.observed&&e("touchMove","mapTouchMove"),this.touchCancel.observed&&e("touchCancel","mapTouchCancel"),this.wheel.observed&&e("wheel","mapWheel"),this.dragStart.observed&&e("dragStart","mapDragStart"),this.drag.observed&&e("drag","mapDrag"),this.dragEnd.observed&&e("dragEnd","mapDragEnd"),this.load.observed&&e("load","mapLoad"),this.error.observed&&e("error","mapError")}static{this.\u0275fac=function(s){return new(s||n)(Hi(AM))}}static{this.\u0275cmp=Bn({type:n,selectors:[["mgl-map"]],viewQuery:function(s,u){if(s&1&&wa(O$,7),s&2){let i;Gs(i=Ws())&&(u.mapContainer=i.first)}},inputs:{accessToken:"accessToken",collectResourceTiming:"collectResourceTiming",crossSourceCollisions:"crossSourceCollisions",customMapboxApiUrl:"customMapboxApiUrl",fadeDuration:"fadeDuration",hash:"hash",refreshExpiredTiles:"refreshExpiredTiles",failIfMajorPerformanceCaveat:"failIfMajorPerformanceCaveat",bearingSnap:"bearingSnap",interactive:"interactive",pitchWithRotate:"pitchWithRotate",clickTolerance:"clickTolerance",attributionControl:"attributionControl",logoPosition:"logoPosition",maxTileCacheSize:"maxTileCacheSize",localIdeographFontFamily:"localIdeographFontFamily",preserveDrawingBuffer:"preserveDrawingBuffer",trackResize:"trackResize",transformRequest:"transformRequest",bounds:"bounds",antialias:"antialias",locale:"locale",cooperativeGestures:"cooperativeGestures",minZoom:"minZoom",maxZoom:"maxZoom",minPitch:"minPitch",maxPitch:"maxPitch",scrollZoom:"scrollZoom",dragRotate:"dragRotate",touchPitch:"touchPitch",touchZoomRotate:"touchZoomRotate",doubleClickZoom:"doubleClickZoom",keyboard:"keyboard",dragPan:"dragPan",boxZoom:"boxZoom",style:"style",center:"center",maxBounds:"maxBounds",zoom:"zoom",bearing:"bearing",pitch:"pitch",fitBoundsOptions:"fitBoundsOptions",renderWorldCopies:"renderWorldCopies",projection:"projection",movingMethod:"movingMethod",movingOptions:"movingOptions",fitBounds:"fitBounds",fitScreenCoordinates:"fitScreenCoordinates",centerWithPanTo:"centerWithPanTo",panToOptions:"panToOptions",cursorStyle:"cursorStyle"},outputs:{mapResize:"mapResize",mapRemove:"mapRemove",mapMouseDown:"mapMouseDown",mapMouseUp:"mapMouseUp",mapMouseMove:"mapMouseMove",mapClick:"mapClick",mapDblClick:"mapDblClick",mapMouseOver:"mapMouseOver",mapMouseOut:"mapMouseOut",mapContextMenu:"mapContextMenu",mapTouchStart:"mapTouchStart",mapTouchEnd:"mapTouchEnd",mapTouchMove:"mapTouchMove",mapTouchCancel:"mapTouchCancel",mapWheel:"mapWheel",moveStart:"moveStart",move:"move",moveEnd:"moveEnd",mapDragStart:"mapDragStart",mapDrag:"mapDrag",mapDragEnd:"mapDragEnd",zoomStart:"zoomStart",zoomEvt:"zoomEvt",zoomEnd:"zoomEnd",rotateStart:"rotateStart",rotate:"rotate",rotateEnd:"rotateEnd",pitchStart:"pitchStart",pitchEvt:"pitchEvt",pitchEnd:"pitchEnd",boxZoomStart:"boxZoomStart",boxZoomEnd:"boxZoomEnd",boxZoomCancel:"boxZoomCancel",webGlContextLost:"webGlContextLost",webGlContextRestored:"webGlContextRestored",mapLoad:"mapLoad",mapCreate:"mapCreate",idle:"idle",render:"render",mapError:"mapError",data:"data",styleData:"styleData",sourceData:"sourceData",dataLoading:"dataLoading",styleDataLoading:"styleDataLoading",sourceDataLoading:"sourceDataLoading",styleImageMissing:"styleImageMissing",resize:"resize",remove:"remove",mouseDown:"mouseDown",mouseUp:"mouseUp",mouseMove:"mouseMove",click:"click",dblClick:"dblClick",mouseOver:"mouseOver",mouseOut:"mouseOut",contextMenu:"contextMenu",touchStart:"touchStart",touchEnd:"touchEnd",touchMove:"touchMove",touchCancel:"touchCancel",wheel:"wheel",dragStart:"dragStart",drag:"drag",dragEnd:"dragEnd",load:"load",error:"error"},standalone:!1,features:[Ca([AM]),hs],decls:2,vars:0,consts:[["container",""]],template:function(s,u){s&1&&Ui(0,"div",null,0)},styles:["[_nghost-%COMP%]{display:block}div[_ngcontent-%COMP%]{height:100%;width:100%}"],changeDetection:0})}}return n})(),n2=(()=>{class n{constructor(e){this.mapService=e,this.markerDragStart=new Dt,this.markerDragEnd=new Dt,this.markerDrag=new Dt,this.dragStart=new Dt,this.dragEnd=new Dt,this.drag=new Dt}ngOnInit(){if(this.warnDeprecatedOutputs(),this.feature&&this.lngLat)throw new Error("feature and lngLat input are mutually exclusive")}ngOnChanges(e){e.lngLat&&!e.lngLat.isFirstChange()&&this.markerInstance.setLngLat(this.lngLat),e.feature&&!e.feature.isFirstChange()&&this.markerInstance.setLngLat(this.feature.geometry.coordinates),e.draggable&&!e.draggable.isFirstChange()&&this.markerInstance.setDraggable(!!this.draggable),e.popupShown&&!e.popupShown.isFirstChange()&&(e.popupShown.currentValue?this.markerInstance.getPopup().addTo(this.mapService.mapInstance):this.markerInstance.getPopup().remove()),e.pitchAlignment&&!e.pitchAlignment.isFirstChange()&&this.markerInstance.setPitchAlignment(e.pitchAlignment.currentValue),e.rotationAlignment&&!e.rotationAlignment.isFirstChange()&&this.markerInstance.setRotationAlignment(e.rotationAlignment.currentValue)}ngAfterViewInit(){this.mapService.mapCreated$.subscribe(()=>{this.markerInstance=this.mapService.addMarker({markersOptions:{offset:this.offset,anchor:this.anchor,pitchAlignment:this.pitchAlignment,rotationAlignment:this.rotationAlignment,draggable:!!this.draggable,element:this.content.nativeElement,feature:this.feature,lngLat:this.lngLat,clickTolerance:this.clickTolerance},markersEvents:{markerDragStart:this.markerDragStart,markerDrag:this.markerDrag,markerDragEnd:this.markerDragEnd,dragStart:this.markerDragStart,drag:this.markerDrag,dragEnd:this.markerDragEnd}})})}ngOnDestroy(){this.mapService.removeMarker(this.markerInstance),this.markerInstance=void 0}togglePopup(){this.markerInstance.togglePopup()}updateCoordinates(e){this.markerInstance.setLngLat(e)}warnDeprecatedOutputs(){let e=e2.bind(void 0,n.name);this.markerDragStart.observed&&e("dragStart","markerDragStart"),this.markerDragEnd.observed&&e("dragEnd","markerDragEnd"),this.markerDrag.observed&&e("drag","markerDrag")}static{this.\u0275fac=function(s){return new(s||n)(Hi(AM))}}static{this.\u0275cmp=Bn({type:n,selectors:[["mgl-marker"]],viewQuery:function(s,u){if(s&1&&wa(R$,7),s&2){let i;Gs(i=Ws())&&(u.content=i.first)}},inputs:{offset:"offset",anchor:"anchor",clickTolerance:"clickTolerance",feature:"feature",lngLat:"lngLat",draggable:"draggable",popupShown:"popupShown",className:"className",pitchAlignment:"pitchAlignment",rotationAlignment:"rotationAlignment"},outputs:{markerDragStart:"markerDragStart",markerDragEnd:"markerDragEnd",markerDrag:"markerDrag",dragStart:"dragStart",dragEnd:"dragEnd",drag:"drag"},standalone:!1,features:[hs],ngContentSelectors:P$,decls:3,vars:2,consts:[["content",""]],template:function(s,u){s&1&&(Hs(),pn(0,"div",null,0),Zo(2),on()),s&2&&Dh(u.className)},encapsulation:2,changeDetection:0})}}return n})();var i2=(()=>{class n{static withConfig(e){return{ngModule:n,providers:[{provide:JO,useValue:e.accessToken}]}}static{this.\u0275fac=function(s){return new(s||n)}}static{this.\u0275mod=en({type:n})}static{this.\u0275inj=Jt({imports:[Eg]})}}return n})();function kM(n,r){let e=!r?.manualCleanup;e&&!r?.injector&&cg(kM);let s=e?r?.injector?.get(Zc)??we(Zc):null,u=F$(r?.equal),i;r?.requireSync?i=fs({kind:0},{equal:u}):i=fs({kind:1,value:r?.initialValue},{equal:u});let E=n.subscribe({next:L=>i.set({kind:1,value:L}),error:L=>{if(r?.rejectErrors)throw L;i.set({kind:2,error:L})}});if(r?.requireSync&&i().kind===0)throw new Ht(601,!1);return s?.onDestroy(E.unsubscribe.bind(E)),xg(()=>{let L=i();switch(L.kind){case 1:return L.value;case 2:throw L.error;case 0:throw new Ht(601,!1)}},{equal:r?.equal})}function F$(n=Object.is){return(r,e)=>r.kind===1&&e.kind===1&&n(r.value,e.value)}var LM={};function BM(n,r){if(LM[n]=(LM[n]||0)+1,typeof r=="function")return RM(n,(...s)=>Cn(ut({},r(...s)),{type:n}));switch(r?r._as:"empty"){case"empty":return RM(n,()=>({type:n}));case"props":return RM(n,s=>Cn(ut({},s),{type:n}));default:throw new Error("Unexpected config.")}}function jM(){return{_as:"props",_p:void 0}}function RM(n,r){return Object.defineProperty(r,"type",{value:n,writable:!1})}function N$(n,r){if(n==null)throw new Error(`${r} must be defined.`)}var v2="@ngrx/store/init",Ug=(()=>{class n extends Ir{constructor(){super({type:v2})}next(e){if(typeof e=="function")throw new TypeError(`
        Dispatch expected an object, instead it received a function.
        If you're using the createAction function, make sure to invoke the function
        before dispatching the action. For example, someAction should be someAction().`);if(typeof e>"u")throw new TypeError("Actions must be objects");if(typeof e.type>"u")throw new TypeError("Actions must have a type property");super.next(e)}complete(){}ngOnDestroy(){super.complete()}static{this.\u0275fac=function(s){return new(s||n)}}static{this.\u0275prov=xt({token:n,factory:n.\u0275fac})}}return n})(),z$=[Ug],b2=new dt("@ngrx/store Internal Root Guard"),r2=new dt("@ngrx/store Internal Initial State"),VM=new dt("@ngrx/store Initial State"),x2=new dt("@ngrx/store Reducer Factory"),o2=new dt("@ngrx/store Internal Reducer Factory Provider"),w2=new dt("@ngrx/store Initial Reducers"),PM=new dt("@ngrx/store Internal Initial Reducers"),s2=new dt("@ngrx/store Store Features"),a2=new dt("@ngrx/store Internal Store Reducers"),OM=new dt("@ngrx/store Internal Feature Reducers"),l2=new dt("@ngrx/store Internal Feature Configs"),C2=new dt("@ngrx/store Internal Store Features"),c2=new dt("@ngrx/store Internal Feature Reducers Token"),E2=new dt("@ngrx/store Feature Reducers"),u2=new dt("@ngrx/store User Provided Meta Reducers"),Wx=new dt("@ngrx/store Meta Reducers"),d2=new dt("@ngrx/store Internal Resolved Meta Reducers"),h2=new dt("@ngrx/store User Runtime Checks Config"),f2=new dt("@ngrx/store Internal User Runtime Checks Config"),gv=new dt("@ngrx/store Internal Runtime Checks"),UM=new dt("@ngrx/store Check if Action types are unique"),iJ=new dt("@ngrx/store Root Store Provider"),rJ=new dt("@ngrx/store Feature State Provider");function $M(n,r={}){let e=Object.keys(n),s={};for(let i=0;i<e.length;i++){let E=e[i];typeof n[E]=="function"&&(s[E]=n[E])}let u=Object.keys(s);return function(E,L){E=E===void 0?r:E;let j=!1,Y={};for(let oe=0;oe<u.length;oe++){let Ee=u[oe],Ye=s[Ee],Ne=E[Ee],ct=Ye(Ne,L);Y[Ee]=ct,j=j||ct!==Ne}return j?Y:E}}function B$(n,r){return Object.keys(n).filter(e=>e!==r).reduce((e,s)=>Object.assign(e,{[s]:n[s]}),{})}function D2(...n){return function(r){if(n.length===0)return r;let e=n[n.length-1];return n.slice(0,-1).reduceRight((u,i)=>i(u),e(r))}}function M2(n,r){return Array.isArray(r)&&r.length>0&&(n=D2.apply(null,[...r,n])),(e,s)=>{let u=n(e);return(i,E)=>(i=i===void 0?s:i,u(i,E))}}function j$(n){let r=Array.isArray(n)&&n.length>0?D2(...n):e=>e;return(e,s)=>(e=r(e),(u,i)=>(u=u===void 0?s:u,e(u,i)))}var yv=class extends Hn{},qx=class extends Ug{},V$="@ngrx/store/update-reducers",Zx=(()=>{class n extends Ir{get currentReducers(){return this.reducers}constructor(e,s,u,i){super(i(u,s)),this.dispatcher=e,this.initialState=s,this.reducers=u,this.reducerFactory=i}addFeature(e){this.addFeatures([e])}addFeatures(e){let s=e.reduce((u,{reducers:i,reducerFactory:E,metaReducers:L,initialState:j,key:Y})=>{let oe=typeof i=="function"?j$(L)(i,j):M2(E,L)(i,j);return u[Y]=oe,u},{});this.addReducers(s)}removeFeature(e){this.removeFeatures([e])}removeFeatures(e){this.removeReducers(e.map(s=>s.key))}addReducer(e,s){this.addReducers({[e]:s})}addReducers(e){this.reducers=ut(ut({},this.reducers),e),this.updateReducers(Object.keys(e))}removeReducer(e){this.removeReducers([e])}removeReducers(e){e.forEach(s=>{this.reducers=B$(this.reducers,s)}),this.updateReducers(e)}updateReducers(e){this.next(this.reducerFactory(this.reducers,this.initialState)),this.dispatcher.next({type:V$,features:e})}ngOnDestroy(){this.complete()}static{this.\u0275fac=function(s){return new(s||n)(St(qx),St(VM),St(w2),St(x2))}}static{this.\u0275prov=xt({token:n,factory:n.\u0275fac})}}return n})(),U$=[Zx,{provide:yv,useExisting:Zx},{provide:qx,useExisting:Ug}],HM=(()=>{class n extends _n{ngOnDestroy(){this.complete()}static{this.\u0275fac=(()=>{let e;return function(u){return(e||(e=ya(n)))(u||n)}})()}static{this.\u0275prov=xt({token:n,factory:n.\u0275fac})}}return n})(),$$=[HM],Xx=class extends Hn{},p2=(()=>{class n extends Ir{static{this.INIT=v2}constructor(e,s,u,i){super(i);let L=e.pipe(Zf(aC)).pipe(mC(s)),j={state:i},Y=L.pipe(d_(H$,j));this.stateSubscription=Y.subscribe(({state:oe,action:Ee})=>{this.next(oe),u.next(Ee)}),this.state=kM(this,{manualCleanup:!0,requireSync:!0})}ngOnDestroy(){this.stateSubscription.unsubscribe(),this.complete()}static{this.\u0275fac=function(s){return new(s||n)(St(Ug),St(yv),St(HM),St(VM))}}static{this.\u0275prov=xt({token:n,factory:n.\u0275fac})}}return n})();function H$(n={state:void 0},[r,e]){let{state:s}=n;return{state:e(s,r),action:r}}var G$=[p2,{provide:Xx,useExisting:p2}],hd=(()=>{class n extends Hn{constructor(e,s,u,i){super(),this.actionsObserver=s,this.reducerManager=u,this.injector=i,this.source=e,this.state=e.state}select(e,...s){return kh.call(null,e,...s)(this)}selectSignal(e,s){return xg(()=>e(this.state()),s)}lift(e){let s=new n(this,this.actionsObserver,this.reducerManager);return s.operator=e,s}dispatch(e,s){if(typeof e=="function")return this.processDispatchFn(e,s);this.actionsObserver.next(e)}next(e){this.actionsObserver.next(e)}error(e){this.actionsObserver.error(e)}complete(){this.actionsObserver.complete()}addReducer(e,s){this.reducerManager.addReducer(e,s)}removeReducer(e){this.reducerManager.removeReducer(e)}processDispatchFn(e,s){N$(this.injector,"Store Injector");let u=s?.injector??q$()??this.injector;return V_(()=>{let i=e();fp(()=>this.dispatch(i))},{injector:u})}static{this.\u0275fac=function(s){return new(s||n)(St(Xx),St(Ug),St(Zx),St(Jn))}}static{this.\u0275prov=xt({token:n,factory:n.\u0275fac})}}return n})(),W$=[hd];function kh(n,r,...e){return function(u){let i;if(typeof n=="string"){let E=[r,...e].filter(Boolean);i=u.pipe(hC(n,...E))}else if(typeof n=="function")i=u.pipe(un(E=>n(E,r)));else throw new TypeError(`Unexpected type '${typeof n}' in select operator, expected 'string' or 'function'`);return i.pipe(Xm())}}function q$(){try{return we(Jn)}catch{return}}var GM="https://ngrx.io/guide/store/configuration/runtime-checks";function m2(n){return n===void 0}function g2(n){return n===null}function T2(n){return Array.isArray(n)}function Z$(n){return typeof n=="string"}function X$(n){return typeof n=="boolean"}function Y$(n){return typeof n=="number"}function I2(n){return typeof n=="object"&&n!==null}function K$(n){return I2(n)&&!T2(n)}function Q$(n){if(!K$(n))return!1;let r=Object.getPrototypeOf(n);return r===Object.prototype||r===null}function FM(n){return typeof n=="function"}function J$(n){return FM(n)&&n.hasOwnProperty("\u0275cmp")}function eH(n,r){return Object.prototype.hasOwnProperty.call(n,r)}var tH=!1;function nH(){return tH}function y2(n,r){return n===r}function iH(n,r,e){for(let s=0;s<n.length;s++)if(!e(n[s],r[s]))return!0;return!1}function S2(n,r=y2,e=y2){let s=null,u=null,i;function E(){s=null,u=null}function L(oe=void 0){i={result:oe}}function j(){i=void 0}function Y(){if(i!==void 0)return i.result;if(!s)return u=n.apply(null,arguments),s=arguments,u;if(!iH(arguments,s,r))return u;let oe=n.apply(null,arguments);return s=arguments,e(u,oe)?u:(u=oe,oe)}return{memoized:Y,reset:E,setResult:L,clearResult:j}}function $g(...n){return oH(S2)(...n)}function rH(n,r,e,s){if(e===void 0){let i=r.map(E=>E(n));return s.memoized.apply(null,i)}let u=r.map(i=>i(n,e));return s.memoized.apply(null,[...u,e])}function oH(n,r={stateFn:rH}){return function(...e){let s=e;if(Array.isArray(s[0])){let[oe,...Ee]=s;s=[...oe,...Ee]}else s.length===1&&sH(s[0])&&(s=aH(s[0]));let u=s.slice(0,s.length-1),i=s[s.length-1],E=u.filter(oe=>oe.release&&typeof oe.release=="function"),L=n(function(...oe){return i.apply(null,oe)}),j=S2(function(oe,Ee){return r.stateFn.apply(null,[oe,u,Ee,L])});function Y(){j.reset(),L.reset(),E.forEach(oe=>oe.release())}return Object.assign(j.memoized,{release:Y,projector:L.memoized,setResult:j.setResult,clearResult:j.clearResult})}}function A2(n){return $g(r=>{let e=r[n];return!nH()&&bD()&&!(n in r)&&console.warn(`@ngrx/store: The feature name "${n}" does not exist in the state, therefore createFeatureSelector cannot access it.  Be sure it is imported in a loaded module using StoreModule.forRoot('${n}', ...) or StoreModule.forFeature('${n}', ...).  If the default state is intended to be undefined, as is the case with router state, this development-only warning message can be ignored.`),e},r=>r)}function sH(n){return!!n&&typeof n=="object"&&Object.values(n).every(r=>typeof r=="function")}function aH(n){let r=Object.values(n),e=Object.keys(n),s=(...u)=>e.reduce((i,E,L)=>Cn(ut({},i),{[E]:u[L]}),{});return[...r,s]}function lH(n){return n instanceof dt?we(n):n}function cH(n,r){return r.map((e,s)=>{if(n[s]instanceof dt){let u=we(n[s]);return{key:e.key,reducerFactory:u.reducerFactory?u.reducerFactory:$M,metaReducers:u.metaReducers?u.metaReducers:[],initialState:u.initialState}}return e})}function uH(n){return n.map(r=>r instanceof dt?we(r):r)}function k2(n){return typeof n=="function"?n():n}function dH(n,r){return n.concat(r)}function hH(){if(we(hd,{optional:!0,skipSelf:!0}))throw new TypeError("The root Store has been provided more than once. Feature modules should provide feature states instead.");return"guarded"}function fH(n,r){return function(e,s){let u=r.action(s)?NM(s):s,i=n(e,u);return r.state()?NM(i):i}}function NM(n){Object.freeze(n);let r=FM(n);return Object.getOwnPropertyNames(n).forEach(e=>{if(!e.startsWith("\u0275")&&eH(n,e)&&(!r||e!=="caller"&&e!=="callee"&&e!=="arguments")){let s=n[e];(I2(s)||FM(s))&&!Object.isFrozen(s)&&NM(s)}}),n}function pH(n,r){return function(e,s){if(r.action(s)){let i=zM(s);_2(i,"action")}let u=n(e,s);if(r.state()){let i=zM(u);_2(i,"state")}return u}}function zM(n,r=[]){return(m2(n)||g2(n))&&r.length===0?{path:["root"],value:n}:Object.keys(n).reduce((s,u)=>{if(s)return s;let i=n[u];return J$(i)?s:m2(i)||g2(i)||Y$(i)||X$(i)||Z$(i)||T2(i)?!1:Q$(i)?zM(i,[...r,u]):{path:[...r,u],value:i}},!1)}function _2(n,r){if(n===!1)return;let e=n.path.join("."),s=new Error(`Detected unserializable ${r} at "${e}". ${GM}#strict${r}serializability`);throw s.value=n.value,s.unserializablePath=e,s}function mH(n,r){return function(e,s){if(r.action(s)&&!ln.isInAngularZone())throw new Error(`Action '${s.type}' running outside NgZone. ${GM}#strictactionwithinngzone`);return n(e,s)}}function gH(n){return bD()?ut({strictStateSerializability:!1,strictActionSerializability:!1,strictStateImmutability:!0,strictActionImmutability:!0,strictActionWithinNgZone:!1,strictActionTypeUniqueness:!1},n):{strictStateSerializability:!1,strictActionSerializability:!1,strictStateImmutability:!1,strictActionImmutability:!1,strictActionWithinNgZone:!1,strictActionTypeUniqueness:!1}}function yH({strictActionSerializability:n,strictStateSerializability:r}){return e=>n||r?pH(e,{action:s=>n&&!WM(s),state:()=>r}):e}function _H({strictActionImmutability:n,strictStateImmutability:r}){return e=>n||r?fH(e,{action:s=>n&&!WM(s),state:()=>r}):e}function WM(n){return n.type.startsWith("@ngrx")}function vH({strictActionWithinNgZone:n}){return r=>n?mH(r,{action:e=>n&&!WM(e)}):r}function bH(n){return[{provide:f2,useValue:n},{provide:h2,useFactory:xH,deps:[f2]},{provide:gv,deps:[h2],useFactory:gH},{provide:Wx,multi:!0,deps:[gv],useFactory:_H},{provide:Wx,multi:!0,deps:[gv],useFactory:yH},{provide:Wx,multi:!0,deps:[gv],useFactory:vH}]}function R2(){return[{provide:UM,multi:!0,deps:[gv],useFactory:wH}]}function xH(n){return n}function wH(n){if(!n.strictActionTypeUniqueness)return;let r=Object.entries(LM).filter(([,e])=>e>1).map(([e])=>e);if(r.length)throw new Error(`Action types are registered more than once, ${r.map(e=>`"${e}"`).join(", ")}. ${GM}#strictactiontypeuniqueness`)}function CH(n={},r={}){return[{provide:b2,useFactory:hH},{provide:r2,useValue:r.initialState},{provide:VM,useFactory:k2,deps:[r2]},{provide:PM,useValue:n},{provide:a2,useExisting:n instanceof dt?n:PM},{provide:w2,deps:[PM,[new G0(a2)]],useFactory:lH},{provide:u2,useValue:r.metaReducers?r.metaReducers:[]},{provide:d2,deps:[Wx,u2],useFactory:dH},{provide:o2,useValue:r.reducerFactory?r.reducerFactory:$M},{provide:x2,deps:[o2,d2],useFactory:M2},z$,U$,$$,G$,W$,bH(r.runtimeChecks),R2()]}function EH(n,r,e={}){return[{provide:l2,multi:!0,useValue:n instanceof Object?{}:e},{provide:s2,multi:!0,useValue:{key:n instanceof Object?n.name:n,reducerFactory:!(e instanceof dt)&&e.reducerFactory?e.reducerFactory:$M,metaReducers:!(e instanceof dt)&&e.metaReducers?e.metaReducers:[],initialState:!(e instanceof dt)&&e.initialState?e.initialState:void 0}},{provide:C2,deps:[l2,s2],useFactory:cH},{provide:OM,multi:!0,useValue:n instanceof Object?n.reducer:r},{provide:c2,multi:!0,useExisting:r instanceof dt?r:OM},{provide:E2,multi:!0,deps:[OM,[new G0(c2)]],useFactory:uH},R2()]}var P2=(()=>{class n{constructor(e,s,u,i,E,L){}static{this.\u0275fac=function(s){return new(s||n)(St(Ug),St(yv),St(HM),St(hd),St(b2,8),St(UM,8))}}static{this.\u0275mod=en({type:n})}static{this.\u0275inj=Jt({})}}return n})(),DH=(()=>{class n{constructor(e,s,u,i,E){this.features=e,this.featureReducers=s,this.reducerManager=u;let L=e.map((j,Y)=>{let Ee=s.shift()[Y];return Cn(ut({},j),{reducers:Ee,initialState:k2(j.initialState)})});u.addFeatures(L)}ngOnDestroy(){this.reducerManager.removeFeatures(this.features)}static{this.\u0275fac=function(s){return new(s||n)(St(C2),St(E2),St(Zx),St(P2),St(UM,8))}}static{this.\u0275mod=en({type:n})}static{this.\u0275inj=Jt({})}}return n})(),O2=(()=>{class n{static forRoot(e,s){return{ngModule:P2,providers:[...CH(e,s)]}}static forFeature(e,s,u={}){return{ngModule:DH,providers:[...EH(e,s,u)]}}static{this.\u0275fac=function(s){return new(s||n)}}static{this.\u0275mod=en({type:n})}static{this.\u0275inj=Jt({})}}return n})();function qM(...n){let r=n.pop(),e=n.map(s=>s.type);return{reducer:r,types:e}}function L2(n,...r){let e=new Map;for(let s of r)for(let u of s.types){let i=e.get(u);if(i){let E=(L,j)=>s.reducer(i(L,j),j);e.set(u,E)}else e.set(u,s.reducer)}return function(s=n,u){let i=e.get(u.type);return i?i(s,u):s}}var Hg=BM("[Location] Update Coordinates",jM()),_v=BM("[Location] Update Location Name",jM());var Yx=A2("location"),F2=$g(Yx,n=>n.latitude),N2=$g(Yx,n=>n.longitude),lJ=$g(Yx,n=>({latitude:n.latitude,longitude:n.longitude})),Kx=$g(Yx,n=>n.locationName);function z2(n,...r){return r.length?r.some(e=>n[e]):n.altKey||n.shiftKey||n.ctrlKey||n.metaKey}var KM;try{KM=typeof Intl<"u"&&Intl.v8BreakIterator}catch{KM=!1}var Ur=(()=>{class n{_platformId=we(sd);isBrowser=this._platformId?TP(this._platformId):typeof document=="object"&&!!document;EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent);TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent);BLINK=this.isBrowser&&!!(window.chrome||KM)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT;WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT;IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window);FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent);ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT;SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT;constructor(){}static \u0275fac=function(s){return new(s||n)};static \u0275prov=xt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var vv;function MH(){if(vv==null&&typeof window<"u")try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>vv=!0}))}finally{vv=vv||!1}return vv}function bp(n){return MH()?n:!!n.capture}var vp;function QM(){if(vp==null){if(typeof document!="object"||!document||typeof Element!="function"||!Element)return vp=!1,vp;if("scrollBehavior"in document.documentElement.style)vp=!0;else{let n=Element.prototype.scrollTo;n?vp=!/\{\s*\[native code\]\s*\}/.test(n.toString()):vp=!1}}return vp}var YM;function TH(){if(YM==null){let n=typeof document<"u"?document.head:null;YM=!!(n&&(n.createShadowRoot||n.attachShadow))}return YM}function B2(n){if(TH()){let r=n.getRootNode?n.getRootNode():null;if(typeof ShadowRoot<"u"&&ShadowRoot&&r instanceof ShadowRoot)return r}return null}function Ka(n){return n.composedPath?n.composedPath()[0]:n.target}function JM(){return typeof __karma__<"u"&&!!__karma__||typeof jasmine<"u"&&!!jasmine||typeof jest<"u"&&!!jest||typeof Mocha<"u"&&!!Mocha}function Ql(n,r,e,s,u){let i=parseInt(_D.major),E=parseInt(_D.minor);return i>19||i===19&&E>0||i===0&&E===0?n.listen(r,e,s,u):(r.addEventListener(e,s,u),()=>{r.removeEventListener(e,s,u)})}function Gg(n){return n!=null&&`${n}`!="false"}function Qx(n,r=0){return IH(n)?Number(n):arguments.length===2?r:0}function IH(n){return!isNaN(parseFloat(n))&&!isNaN(Number(n))}function Wg(n){return Array.isArray(n)?n:[n]}function $r(n){return n==null?"":typeof n=="string"?n:`${n}px`}function fd(n){return n instanceof yi?n.nativeElement:n}var j2=new Set,xp,SH=(()=>{class n{_platform=we(Ur);_nonce=we(N_,{optional:!0});_matchMedia;constructor(){this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):kH}matchMedia(e){return(this._platform.WEBKIT||this._platform.BLINK)&&AH(e,this._nonce),this._matchMedia(e)}static \u0275fac=function(s){return new(s||n)};static \u0275prov=xt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function AH(n,r){if(!j2.has(n))try{xp||(xp=document.createElement("style"),r&&xp.setAttribute("nonce",r),xp.setAttribute("type","text/css"),document.head.appendChild(xp)),xp.sheet&&(xp.sheet.insertRule(`@media ${n} {body{ }}`,0),j2.add(n))}catch(e){console.error(e)}}function kH(n){return{matches:n==="all"||n==="",media:n,addListener:()=>{},removeListener:()=>{}}}var Jx=(()=>{class n{_mediaMatcher=we(SH);_zone=we(ln);_queries=new Map;_destroySubject=new _n;constructor(){}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(e){return V2(Wg(e)).some(u=>this._registerQuery(u).mql.matches)}observe(e){let u=V2(Wg(e)).map(E=>this._registerQuery(E).observable),i=Xf(u);return i=mh(i.pipe(go(1)),i.pipe(h_(1),u_(0))),i.pipe(un(E=>{let L={matches:!1,breakpoints:{}};return E.forEach(({matches:j,query:Y})=>{L.matches=L.matches||j,L.breakpoints[Y]=j}),L}))}_registerQuery(e){if(this._queries.has(e))return this._queries.get(e);let s=this._mediaMatcher.matchMedia(e),i={observable:new Hn(E=>{let L=j=>this._zone.run(()=>E.next(j));return s.addListener(L),()=>{s.removeListener(L)}}).pipe(Yf(s),un(({matches:E})=>({query:e,matches:E})),Br(this._destroySubject)),mql:s};return this._queries.set(e,i),i}static \u0275fac=function(s){return new(s||n)};static \u0275prov=xt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function V2(n){return n.map(r=>r.split(",")).reduce((r,e)=>r.concat(e)).map(r=>r.trim())}var U2={XSmall:"(max-width: 599.98px)",Small:"(min-width: 600px) and (max-width: 959.98px)",Medium:"(min-width: 960px) and (max-width: 1279.98px)",Large:"(min-width: 1280px) and (max-width: 1919.98px)",XLarge:"(min-width: 1920px)",Handset:"(max-width: 599.98px) and (orientation: portrait), (max-width: 959.98px) and (orientation: landscape)",Tablet:"(min-width: 600px) and (max-width: 839.98px) and (orientation: portrait), (min-width: 960px) and (max-width: 1279.98px) and (orientation: landscape)",Web:"(min-width: 840px) and (orientation: portrait), (min-width: 1280px) and (orientation: landscape)",HandsetPortrait:"(max-width: 599.98px) and (orientation: portrait)",TabletPortrait:"(min-width: 600px) and (max-width: 839.98px) and (orientation: portrait)",WebPortrait:"(min-width: 840px) and (orientation: portrait)",HandsetLandscape:"(max-width: 959.98px) and (orientation: landscape)",TabletLandscape:"(min-width: 960px) and (max-width: 1279.98px) and (orientation: landscape)",WebLandscape:"(min-width: 1280px) and (orientation: landscape)"};var ew=new WeakMap,Jl=(()=>{class n{_appRef;_injector=we(Jn);_environmentInjector=we(jr);load(e){let s=this._appRef=this._appRef||this._injector.get(js),u=ew.get(s);u||(u={loaders:new Set,refs:[]},ew.set(s,u),s.onDestroy(()=>{ew.get(s)?.refs.forEach(i=>i.destroy()),ew.delete(s)})),u.loaders.has(e)||(u.loaders.add(e),u.refs.push(hx(e,{environmentInjector:this._environmentInjector})))}static \u0275fac=function(s){return new(s||n)};static \u0275prov=xt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),eT=(()=>{class n{static \u0275fac=function(s){return new(s||n)};static \u0275cmp=Bn({type:n,selectors:[["ng-component"]],exportAs:["cdkVisuallyHidden"],decls:0,vars:0,template:function(s,u){},styles:[".cdk-visually-hidden{border:0;clip:rect(0 0 0 0);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px;white-space:nowrap;outline:0;-webkit-appearance:none;-moz-appearance:none;left:0}[dir=rtl] .cdk-visually-hidden{left:auto;right:0}"],encapsulation:2,changeDetection:0})}return n})();var RH=(()=>{class n{create(e){return typeof MutationObserver>"u"?null:new MutationObserver(e)}static \u0275fac=function(s){return new(s||n)};static \u0275prov=xt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var tw=(()=>{class n{static \u0275fac=function(s){return new(s||n)};static \u0275mod=en({type:n});static \u0275inj=Jt({providers:[RH]})}return n})();var W2=" ";function OH(n,r,e){let s=ow(n,r);e=e.trim(),!s.some(u=>u.trim()===e)&&(s.push(e),n.setAttribute(r,s.join(W2)))}function LH(n,r,e){let s=ow(n,r);e=e.trim();let u=s.filter(i=>i!==e);u.length?n.setAttribute(r,u.join(W2)):n.removeAttribute(r)}function ow(n,r){return n.getAttribute(r)?.match(/\S+/g)??[]}var q2="cdk-describedby-message",nw="cdk-describedby-host",oT=0,Z2=(()=>{class n{_platform=we(Ur);_document=we(Un);_messageRegistry=new Map;_messagesContainer=null;_id=`${oT++}`;constructor(){we(Jl).load(eT),this._id=we(pg)+"-"+oT++}describe(e,s,u){if(!this._canBeDescribed(e,s))return;let i=tT(s,u);typeof s!="string"?($2(s,this._id),this._messageRegistry.set(i,{messageElement:s,referenceCount:0})):this._messageRegistry.has(i)||this._createMessageElement(s,u),this._isElementDescribedByMessage(e,i)||this._addMessageReference(e,i)}removeDescription(e,s,u){if(!s||!this._isElementNode(e))return;let i=tT(s,u);if(this._isElementDescribedByMessage(e,i)&&this._removeMessageReference(e,i),typeof s=="string"){let E=this._messageRegistry.get(i);E&&E.referenceCount===0&&this._deleteMessageElement(i)}this._messagesContainer?.childNodes.length===0&&(this._messagesContainer.remove(),this._messagesContainer=null)}ngOnDestroy(){let e=this._document.querySelectorAll(`[${nw}="${this._id}"]`);for(let s=0;s<e.length;s++)this._removeCdkDescribedByReferenceIds(e[s]),e[s].removeAttribute(nw);this._messagesContainer?.remove(),this._messagesContainer=null,this._messageRegistry.clear()}_createMessageElement(e,s){let u=this._document.createElement("div");$2(u,this._id),u.textContent=e,s&&u.setAttribute("role",s),this._createMessagesContainer(),this._messagesContainer.appendChild(u),this._messageRegistry.set(tT(e,s),{messageElement:u,referenceCount:0})}_deleteMessageElement(e){this._messageRegistry.get(e)?.messageElement?.remove(),this._messageRegistry.delete(e)}_createMessagesContainer(){if(this._messagesContainer)return;let e="cdk-describedby-message-container",s=this._document.querySelectorAll(`.${e}[platform="server"]`);for(let i=0;i<s.length;i++)s[i].remove();let u=this._document.createElement("div");u.style.visibility="hidden",u.classList.add(e),u.classList.add("cdk-visually-hidden"),this._platform.isBrowser||u.setAttribute("platform","server"),this._document.body.appendChild(u),this._messagesContainer=u}_removeCdkDescribedByReferenceIds(e){let s=ow(e,"aria-describedby").filter(u=>u.indexOf(q2)!=0);e.setAttribute("aria-describedby",s.join(" "))}_addMessageReference(e,s){let u=this._messageRegistry.get(s);OH(e,"aria-describedby",u.messageElement.id),e.setAttribute(nw,this._id),u.referenceCount++}_removeMessageReference(e,s){let u=this._messageRegistry.get(s);u.referenceCount--,LH(e,"aria-describedby",u.messageElement.id),e.removeAttribute(nw)}_isElementDescribedByMessage(e,s){let u=ow(e,"aria-describedby"),i=this._messageRegistry.get(s),E=i&&i.messageElement.id;return!!E&&u.indexOf(E)!=-1}_canBeDescribed(e,s){if(!this._isElementNode(e))return!1;if(s&&typeof s=="object")return!0;let u=s==null?"":`${s}`.trim(),i=e.getAttribute("aria-label");return u?!i||i.trim()!==u:!1}_isElementNode(e){return e.nodeType===this._document.ELEMENT_NODE}static \u0275fac=function(s){return new(s||n)};static \u0275prov=xt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function tT(n,r){return typeof n=="string"?`${r||""}/${n}`:n}function $2(n,r){n.id||(n.id=`${q2}-${r}-${oT++}`)}function sT(n){return n.buttons===0||n.detail===0}function aT(n){let r=n.touches&&n.touches[0]||n.changedTouches&&n.changedTouches[0];return!!r&&r.identifier===-1&&(r.radiusX==null||r.radiusX===1)&&(r.radiusY==null||r.radiusY===1)}var FH=new dt("cdk-input-modality-detector-options"),NH={ignoreKeys:[18,17,224,91,16]},X2=650,nT={passive:!0,capture:!0},zH=(()=>{class n{_platform=we(Ur);_listenerCleanups;modalityDetected;modalityChanged;get mostRecentModality(){return this._modality.value}_mostRecentTarget=null;_modality=new Ir(null);_options;_lastTouchMs=0;_onKeydown=e=>{this._options?.ignoreKeys?.some(s=>s===e.keyCode)||(this._modality.next("keyboard"),this._mostRecentTarget=Ka(e))};_onMousedown=e=>{Date.now()-this._lastTouchMs<X2||(this._modality.next(sT(e)?"keyboard":"mouse"),this._mostRecentTarget=Ka(e))};_onTouchstart=e=>{if(aT(e)){this._modality.next("keyboard");return}this._lastTouchMs=Date.now(),this._modality.next("touch"),this._mostRecentTarget=Ka(e)};constructor(){let e=we(ln),s=we(Un),u=we(FH,{optional:!0});if(this._options=ut(ut({},NH),u),this.modalityDetected=this._modality.pipe(h_(1)),this.modalityChanged=this.modalityDetected.pipe(Xm()),this._platform.isBrowser){let i=we(ko).createRenderer(null,null);this._listenerCleanups=e.runOutsideAngular(()=>[Ql(i,s,"keydown",this._onKeydown,nT),Ql(i,s,"mousedown",this._onMousedown,nT),Ql(i,s,"touchstart",this._onTouchstart,nT)])}}ngOnDestroy(){this._modality.complete(),this._listenerCleanups?.forEach(e=>e())}static \u0275fac=function(s){return new(s||n)};static \u0275prov=xt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),BH=new dt("liveAnnouncerElement",{providedIn:"root",factory:jH});function jH(){return null}var VH=new dt("LIVE_ANNOUNCER_DEFAULT_OPTIONS"),UH=0,Y2=(()=>{class n{_ngZone=we(ln);_defaultOptions=we(VH,{optional:!0});_liveElement;_document=we(Un);_previousTimeout;_currentPromise;_currentResolve;constructor(){let e=we(BH,{optional:!0});this._liveElement=e||this._createLiveElement()}announce(e,...s){let u=this._defaultOptions,i,E;return s.length===1&&typeof s[0]=="number"?E=s[0]:[i,E]=s,this.clear(),clearTimeout(this._previousTimeout),i||(i=u&&u.politeness?u.politeness:"polite"),E==null&&u&&(E=u.duration),this._liveElement.setAttribute("aria-live",i),this._liveElement.id&&this._exposeAnnouncerToModals(this._liveElement.id),this._ngZone.runOutsideAngular(()=>(this._currentPromise||(this._currentPromise=new Promise(L=>this._currentResolve=L)),clearTimeout(this._previousTimeout),this._previousTimeout=setTimeout(()=>{this._liveElement.textContent=e,typeof E=="number"&&(this._previousTimeout=setTimeout(()=>this.clear(),E)),this._currentResolve?.(),this._currentPromise=this._currentResolve=void 0},100),this._currentPromise))}clear(){this._liveElement&&(this._liveElement.textContent="")}ngOnDestroy(){clearTimeout(this._previousTimeout),this._liveElement?.remove(),this._liveElement=null,this._currentResolve?.(),this._currentPromise=this._currentResolve=void 0}_createLiveElement(){let e="cdk-live-announcer-element",s=this._document.getElementsByClassName(e),u=this._document.createElement("div");for(let i=0;i<s.length;i++)s[i].remove();return u.classList.add(e),u.classList.add("cdk-visually-hidden"),u.setAttribute("aria-atomic","true"),u.setAttribute("aria-live","polite"),u.id=`cdk-live-announcer-${UH++}`,this._document.body.appendChild(u),u}_exposeAnnouncerToModals(e){let s=this._document.querySelectorAll('body > .cdk-overlay-container [aria-modal="true"]');for(let u=0;u<s.length;u++){let i=s[u],E=i.getAttribute("aria-owns");E?E.indexOf(e)===-1&&i.setAttribute("aria-owns",E+" "+e):i.setAttribute("aria-owns",e)}}static \u0275fac=function(s){return new(s||n)};static \u0275prov=xt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var rw=function(n){return n[n.IMMEDIATE=0]="IMMEDIATE",n[n.EVENTUAL=1]="EVENTUAL",n}(rw||{}),$H=new dt("cdk-focus-monitor-default-options"),iw=bp({passive:!0,capture:!0}),qg=(()=>{class n{_ngZone=we(ln);_platform=we(Ur);_inputModalityDetector=we(zH);_origin=null;_lastFocusOrigin;_windowFocused=!1;_windowFocusTimeoutId;_originTimeoutId;_originFromTouchInteraction=!1;_elementInfo=new Map;_monitoredElementCount=0;_rootNodeFocusListenerCount=new Map;_detectionMode;_windowFocusListener=()=>{this._windowFocused=!0,this._windowFocusTimeoutId=setTimeout(()=>this._windowFocused=!1)};_document=we(Un,{optional:!0});_stopInputModalityDetector=new _n;constructor(){let e=we($H,{optional:!0});this._detectionMode=e?.detectionMode||rw.IMMEDIATE}_rootNodeFocusAndBlurListener=e=>{let s=Ka(e);for(let u=s;u;u=u.parentElement)e.type==="focus"?this._onFocus(e,u):this._onBlur(e,u)};monitor(e,s=!1){let u=fd(e);if(!this._platform.isBrowser||u.nodeType!==1)return nn();let i=B2(u)||this._getDocument(),E=this._elementInfo.get(u);if(E)return s&&(E.checkChildren=!0),E.subject;let L={checkChildren:s,subject:new _n,rootNode:i};return this._elementInfo.set(u,L),this._registerGlobalListeners(L),L.subject}stopMonitoring(e){let s=fd(e),u=this._elementInfo.get(s);u&&(u.subject.complete(),this._setClasses(s),this._elementInfo.delete(s),this._removeGlobalListeners(u))}focusVia(e,s,u){let i=fd(e),E=this._getDocument().activeElement;i===E?this._getClosestElementsInfo(i).forEach(([L,j])=>this._originChanged(L,s,j)):(this._setOrigin(s),typeof i.focus=="function"&&i.focus(u))}ngOnDestroy(){this._elementInfo.forEach((e,s)=>this.stopMonitoring(s))}_getDocument(){return this._document||document}_getWindow(){return this._getDocument().defaultView||window}_getFocusOrigin(e){return this._origin?this._originFromTouchInteraction?this._shouldBeAttributedToTouch(e)?"touch":"program":this._origin:this._windowFocused&&this._lastFocusOrigin?this._lastFocusOrigin:e&&this._isLastInteractionFromInputLabel(e)?"mouse":"program"}_shouldBeAttributedToTouch(e){return this._detectionMode===rw.EVENTUAL||!!e?.contains(this._inputModalityDetector._mostRecentTarget)}_setClasses(e,s){e.classList.toggle("cdk-focused",!!s),e.classList.toggle("cdk-touch-focused",s==="touch"),e.classList.toggle("cdk-keyboard-focused",s==="keyboard"),e.classList.toggle("cdk-mouse-focused",s==="mouse"),e.classList.toggle("cdk-program-focused",s==="program")}_setOrigin(e,s=!1){this._ngZone.runOutsideAngular(()=>{if(this._origin=e,this._originFromTouchInteraction=e==="touch"&&s,this._detectionMode===rw.IMMEDIATE){clearTimeout(this._originTimeoutId);let u=this._originFromTouchInteraction?X2:1;this._originTimeoutId=setTimeout(()=>this._origin=null,u)}})}_onFocus(e,s){let u=this._elementInfo.get(s),i=Ka(e);!u||!u.checkChildren&&s!==i||this._originChanged(s,this._getFocusOrigin(i),u)}_onBlur(e,s){let u=this._elementInfo.get(s);!u||u.checkChildren&&e.relatedTarget instanceof Node&&s.contains(e.relatedTarget)||(this._setClasses(s),this._emitOrigin(u,null))}_emitOrigin(e,s){e.subject.observers.length&&this._ngZone.run(()=>e.subject.next(s))}_registerGlobalListeners(e){if(!this._platform.isBrowser)return;let s=e.rootNode,u=this._rootNodeFocusListenerCount.get(s)||0;u||this._ngZone.runOutsideAngular(()=>{s.addEventListener("focus",this._rootNodeFocusAndBlurListener,iw),s.addEventListener("blur",this._rootNodeFocusAndBlurListener,iw)}),this._rootNodeFocusListenerCount.set(s,u+1),++this._monitoredElementCount===1&&(this._ngZone.runOutsideAngular(()=>{this._getWindow().addEventListener("focus",this._windowFocusListener)}),this._inputModalityDetector.modalityDetected.pipe(Br(this._stopInputModalityDetector)).subscribe(i=>{this._setOrigin(i,!0)}))}_removeGlobalListeners(e){let s=e.rootNode;if(this._rootNodeFocusListenerCount.has(s)){let u=this._rootNodeFocusListenerCount.get(s);u>1?this._rootNodeFocusListenerCount.set(s,u-1):(s.removeEventListener("focus",this._rootNodeFocusAndBlurListener,iw),s.removeEventListener("blur",this._rootNodeFocusAndBlurListener,iw),this._rootNodeFocusListenerCount.delete(s))}--this._monitoredElementCount||(this._getWindow().removeEventListener("focus",this._windowFocusListener),this._stopInputModalityDetector.next(),clearTimeout(this._windowFocusTimeoutId),clearTimeout(this._originTimeoutId))}_originChanged(e,s,u){this._setClasses(e,s),this._emitOrigin(u,s),this._lastFocusOrigin=s}_getClosestElementsInfo(e){let s=[];return this._elementInfo.forEach((u,i)=>{(i===e||u.checkChildren&&i.contains(e))&&s.push([i,u])}),s}_isLastInteractionFromInputLabel(e){let{_mostRecentTarget:s,mostRecentModality:u}=this._inputModalityDetector;if(u!=="mouse"||!s||s===e||e.nodeName!=="INPUT"&&e.nodeName!=="TEXTAREA"||e.disabled)return!1;let i=e.labels;if(i){for(let E=0;E<i.length;E++)if(i[E].contains(s))return!0}return!1}static \u0275fac=function(s){return new(s||n)};static \u0275prov=xt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var wp=function(n){return n[n.NONE=0]="NONE",n[n.BLACK_ON_WHITE=1]="BLACK_ON_WHITE",n[n.WHITE_ON_BLACK=2]="WHITE_ON_BLACK",n}(wp||{}),H2="cdk-high-contrast-black-on-white",G2="cdk-high-contrast-white-on-black",iT="cdk-high-contrast-active",lT=(()=>{class n{_platform=we(Ur);_hasCheckedHighContrastMode;_document=we(Un);_breakpointSubscription;constructor(){this._breakpointSubscription=we(Jx).observe("(forced-colors: active)").subscribe(()=>{this._hasCheckedHighContrastMode&&(this._hasCheckedHighContrastMode=!1,this._applyBodyHighContrastModeCssClasses())})}getHighContrastMode(){if(!this._platform.isBrowser)return wp.NONE;let e=this._document.createElement("div");e.style.backgroundColor="rgb(1,2,3)",e.style.position="absolute",this._document.body.appendChild(e);let s=this._document.defaultView||window,u=s&&s.getComputedStyle?s.getComputedStyle(e):null,i=(u&&u.backgroundColor||"").replace(/ /g,"");switch(e.remove(),i){case"rgb(0,0,0)":case"rgb(45,50,54)":case"rgb(32,32,32)":return wp.WHITE_ON_BLACK;case"rgb(255,255,255)":case"rgb(255,250,239)":return wp.BLACK_ON_WHITE}return wp.NONE}ngOnDestroy(){this._breakpointSubscription.unsubscribe()}_applyBodyHighContrastModeCssClasses(){if(!this._hasCheckedHighContrastMode&&this._platform.isBrowser&&this._document.body){let e=this._document.body.classList;e.remove(iT,H2,G2),this._hasCheckedHighContrastMode=!0;let s=this.getHighContrastMode();s===wp.BLACK_ON_WHITE?e.add(iT,H2):s===wp.WHITE_ON_BLACK&&e.add(iT,G2)}}static \u0275fac=function(s){return new(s||n)};static \u0275prov=xt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),K2=(()=>{class n{constructor(){we(lT)._applyBodyHighContrastModeCssClasses()}static \u0275fac=function(s){return new(s||n)};static \u0275mod=en({type:n});static \u0275inj=Jt({imports:[tw]})}return n})(),rT={},Cp=(()=>{class n{_appId=we(pg);getId(e){return this._appId!=="ng"&&(e+=this._appId),rT.hasOwnProperty(e)||(rT[e]=0),`${e}${rT[e]++}`}static \u0275fac=function(s){return new(s||n)};static \u0275prov=xt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var HH=new dt("cdk-dir-doc",{providedIn:"root",factory:GH});function GH(){return we(Un)}var WH=/^(ar|ckb|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|.*[-_](Adlm|Arab|Hebr|Nkoo|Rohg|Thaa))(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)/i;function qH(n){let r=n?.toLowerCase()||"";return r==="auto"&&typeof navigator<"u"&&navigator?.language?WH.test(navigator.language)?"rtl":"ltr":r==="rtl"?"rtl":"ltr"}var bv=(()=>{class n{value="ltr";change=new Dt;constructor(){let e=we(HH,{optional:!0});if(e){let s=e.body?e.body.dir:null,u=e.documentElement?e.documentElement.dir:null;this.value=qH(s||u||"ltr")}}ngOnDestroy(){this.change.complete()}static \u0275fac=function(s){return new(s||n)};static \u0275prov=xt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var Rh=(()=>{class n{static \u0275fac=function(s){return new(s||n)};static \u0275mod=en({type:n});static \u0275inj=Jt({})}return n})();var ZH=["mat-internal-form-field",""],XH=["*"];var $i=(()=>{class n{constructor(){we(lT)._applyBodyHighContrastModeCssClasses()}static \u0275fac=function(s){return new(s||n)};static \u0275mod=en({type:n});static \u0275inj=Jt({imports:[Rh,Rh]})}return n})();var cw=(()=>{class n{static \u0275fac=function(s){return new(s||n)};static \u0275cmp=Bn({type:n,selectors:[["structural-styles"]],decls:0,vars:0,template:function(s,u){},styles:['.mat-focus-indicator{position:relative}.mat-focus-indicator::before{top:0;left:0;right:0;bottom:0;position:absolute;box-sizing:border-box;pointer-events:none;display:var(--mat-focus-indicator-display, none);border-width:var(--mat-focus-indicator-border-width, 3px);border-style:var(--mat-focus-indicator-border-style, solid);border-color:var(--mat-focus-indicator-border-color, transparent);border-radius:var(--mat-focus-indicator-border-radius, 4px)}.mat-focus-indicator:focus::before{content:""}@media(forced-colors: active){html{--mat-focus-indicator-display: block}}'],encapsulation:2,changeDetection:0})}return n})();var Qa=function(n){return n[n.FADING_IN=0]="FADING_IN",n[n.VISIBLE=1]="VISIBLE",n[n.FADING_OUT=2]="FADING_OUT",n[n.HIDDEN=3]="HIDDEN",n}(Qa||{}),dT=class{_renderer;element;config;_animationForciblyDisabledThroughCss;state=Qa.HIDDEN;constructor(r,e,s,u=!1){this._renderer=r,this.element=e,this.config=s,this._animationForciblyDisabledThroughCss=u}fadeOut(){this._renderer.fadeOutRipple(this)}},Q2=bp({passive:!0,capture:!0}),hT=class{_events=new Map;addHandler(r,e,s,u){let i=this._events.get(e);if(i){let E=i.get(s);E?E.add(u):i.set(s,new Set([u]))}else this._events.set(e,new Map([[s,new Set([u])]])),r.runOutsideAngular(()=>{document.addEventListener(e,this._delegateEventHandler,Q2)})}removeHandler(r,e,s){let u=this._events.get(r);if(!u)return;let i=u.get(e);i&&(i.delete(s),i.size===0&&u.delete(e),u.size===0&&(this._events.delete(r),document.removeEventListener(r,this._delegateEventHandler,Q2)))}_delegateEventHandler=r=>{let e=Ka(r);e&&this._events.get(r.type)?.forEach((s,u)=>{(u===e||u.contains(e))&&s.forEach(i=>i.handleEvent(r))})}},aw={enterDuration:225,exitDuration:150},YH=800,J2=bp({passive:!0,capture:!0}),eL=["mousedown","touchstart"],tL=["mouseup","mouseleave","touchend","touchcancel"],KH=(()=>{class n{static \u0275fac=function(s){return new(s||n)};static \u0275cmp=Bn({type:n,selectors:[["ng-component"]],hostAttrs:["mat-ripple-style-loader",""],decls:0,vars:0,template:function(s,u){},styles:[".mat-ripple{overflow:hidden;position:relative}.mat-ripple:not(:empty){transform:translateZ(0)}.mat-ripple.mat-ripple-unbounded{overflow:visible}.mat-ripple-element{position:absolute;border-radius:50%;pointer-events:none;transition:opacity,transform 0ms cubic-bezier(0, 0, 0.2, 1);transform:scale3d(0, 0, 0);background-color:var(--mat-ripple-color, color-mix(in srgb, var(--mat-sys-on-surface) 10%, transparent))}@media(forced-colors: active){.mat-ripple-element{display:none}}.cdk-drag-preview .mat-ripple-element,.cdk-drag-placeholder .mat-ripple-element{display:none}"],encapsulation:2,changeDetection:0})}return n})(),lw=class n{_target;_ngZone;_platform;_containerElement;_triggerElement;_isPointerDown=!1;_activeRipples=new Map;_mostRecentTransientRipple;_lastTouchStartEvent;_pointerUpEventsRegistered=!1;_containerRect;static _eventManager=new hT;constructor(r,e,s,u,i){this._target=r,this._ngZone=e,this._platform=u,u.isBrowser&&(this._containerElement=fd(s)),i&&i.get(Jl).load(KH)}fadeInRipple(r,e,s={}){let u=this._containerRect=this._containerRect||this._containerElement.getBoundingClientRect(),i=ut(ut({},aw),s.animation);s.centered&&(r=u.left+u.width/2,e=u.top+u.height/2);let E=s.radius||QH(r,e,u),L=r-u.left,j=e-u.top,Y=i.enterDuration,oe=document.createElement("div");oe.classList.add("mat-ripple-element"),oe.style.left=`${L-E}px`,oe.style.top=`${j-E}px`,oe.style.height=`${E*2}px`,oe.style.width=`${E*2}px`,s.color!=null&&(oe.style.backgroundColor=s.color),oe.style.transitionDuration=`${Y}ms`,this._containerElement.appendChild(oe);let Ee=window.getComputedStyle(oe),Ye=Ee.transitionProperty,Ne=Ee.transitionDuration,ct=Ye==="none"||Ne==="0s"||Ne==="0s, 0s"||u.width===0&&u.height===0,bt=new dT(this,oe,s,ct);oe.style.transform="scale3d(1, 1, 1)",bt.state=Qa.FADING_IN,s.persistent||(this._mostRecentTransientRipple=bt);let Ut=null;return!ct&&(Y||i.exitDuration)&&this._ngZone.runOutsideAngular(()=>{let Qt=()=>{Ut&&(Ut.fallbackTimer=null),clearTimeout(Gn),this._finishRippleTransition(bt)},_i=()=>this._destroyRipple(bt),Gn=setTimeout(_i,Y+100);oe.addEventListener("transitionend",Qt),oe.addEventListener("transitioncancel",_i),Ut={onTransitionEnd:Qt,onTransitionCancel:_i,fallbackTimer:Gn}}),this._activeRipples.set(bt,Ut),(ct||!Y)&&this._finishRippleTransition(bt),bt}fadeOutRipple(r){if(r.state===Qa.FADING_OUT||r.state===Qa.HIDDEN)return;let e=r.element,s=ut(ut({},aw),r.config.animation);e.style.transitionDuration=`${s.exitDuration}ms`,e.style.opacity="0",r.state=Qa.FADING_OUT,(r._animationForciblyDisabledThroughCss||!s.exitDuration)&&this._finishRippleTransition(r)}fadeOutAll(){this._getActiveRipples().forEach(r=>r.fadeOut())}fadeOutAllNonPersistent(){this._getActiveRipples().forEach(r=>{r.config.persistent||r.fadeOut()})}setupTriggerEvents(r){let e=fd(r);!this._platform.isBrowser||!e||e===this._triggerElement||(this._removeTriggerEvents(),this._triggerElement=e,eL.forEach(s=>{n._eventManager.addHandler(this._ngZone,s,e,this)}))}handleEvent(r){r.type==="mousedown"?this._onMousedown(r):r.type==="touchstart"?this._onTouchStart(r):this._onPointerUp(),this._pointerUpEventsRegistered||(this._ngZone.runOutsideAngular(()=>{tL.forEach(e=>{this._triggerElement.addEventListener(e,this,J2)})}),this._pointerUpEventsRegistered=!0)}_finishRippleTransition(r){r.state===Qa.FADING_IN?this._startFadeOutTransition(r):r.state===Qa.FADING_OUT&&this._destroyRipple(r)}_startFadeOutTransition(r){let e=r===this._mostRecentTransientRipple,{persistent:s}=r.config;r.state=Qa.VISIBLE,!s&&(!e||!this._isPointerDown)&&r.fadeOut()}_destroyRipple(r){let e=this._activeRipples.get(r)??null;this._activeRipples.delete(r),this._activeRipples.size||(this._containerRect=null),r===this._mostRecentTransientRipple&&(this._mostRecentTransientRipple=null),r.state=Qa.HIDDEN,e!==null&&(r.element.removeEventListener("transitionend",e.onTransitionEnd),r.element.removeEventListener("transitioncancel",e.onTransitionCancel),e.fallbackTimer!==null&&clearTimeout(e.fallbackTimer)),r.element.remove()}_onMousedown(r){let e=sT(r),s=this._lastTouchStartEvent&&Date.now()<this._lastTouchStartEvent+YH;!this._target.rippleDisabled&&!e&&!s&&(this._isPointerDown=!0,this.fadeInRipple(r.clientX,r.clientY,this._target.rippleConfig))}_onTouchStart(r){if(!this._target.rippleDisabled&&!aT(r)){this._lastTouchStartEvent=Date.now(),this._isPointerDown=!0;let e=r.changedTouches;if(e)for(let s=0;s<e.length;s++)this.fadeInRipple(e[s].clientX,e[s].clientY,this._target.rippleConfig)}}_onPointerUp(){this._isPointerDown&&(this._isPointerDown=!1,this._getActiveRipples().forEach(r=>{let e=r.state===Qa.VISIBLE||r.config.terminateOnPointerUp&&r.state===Qa.FADING_IN;!r.config.persistent&&e&&r.fadeOut()}))}_getActiveRipples(){return Array.from(this._activeRipples.keys())}_removeTriggerEvents(){let r=this._triggerElement;r&&(eL.forEach(e=>n._eventManager.removeHandler(e,r,this)),this._pointerUpEventsRegistered&&(tL.forEach(e=>r.removeEventListener(e,this,J2)),this._pointerUpEventsRegistered=!1))}};function QH(n,r,e){let s=Math.max(Math.abs(n-e.left),Math.abs(n-e.right)),u=Math.max(Math.abs(r-e.top),Math.abs(r-e.bottom));return Math.sqrt(s*s+u*u)}var iL=new dt("mat-ripple-global-options"),rL=(()=>{class n{_elementRef=we(yi);_animationMode=we(_a,{optional:!0});color;unbounded;centered;radius=0;animation;get disabled(){return this._disabled}set disabled(e){e&&this.fadeOutAllNonPersistent(),this._disabled=e,this._setupTriggerEventsIfEnabled()}_disabled=!1;get trigger(){return this._trigger||this._elementRef.nativeElement}set trigger(e){this._trigger=e,this._setupTriggerEventsIfEnabled()}_trigger;_rippleRenderer;_globalOptions;_isInitialized=!1;constructor(){let e=we(ln),s=we(Ur),u=we(iL,{optional:!0}),i=we(Jn);this._globalOptions=u||{},this._rippleRenderer=new lw(this,e,this._elementRef,s,i)}ngOnInit(){this._isInitialized=!0,this._setupTriggerEventsIfEnabled()}ngOnDestroy(){this._rippleRenderer._removeTriggerEvents()}fadeOutAll(){this._rippleRenderer.fadeOutAll()}fadeOutAllNonPersistent(){this._rippleRenderer.fadeOutAllNonPersistent()}get rippleConfig(){return{centered:this.centered,radius:this.radius,color:this.color,animation:ut(ut(ut({},this._globalOptions.animation),this._animationMode==="NoopAnimations"?{enterDuration:0,exitDuration:0}:{}),this.animation),terminateOnPointerUp:this._globalOptions.terminateOnPointerUp}}get rippleDisabled(){return this.disabled||!!this._globalOptions.disabled}_setupTriggerEventsIfEnabled(){!this.disabled&&this._isInitialized&&this._rippleRenderer.setupTriggerEvents(this.trigger)}launch(e,s=0,u){return typeof e=="number"?this._rippleRenderer.fadeInRipple(e,s,ut(ut({},this.rippleConfig),u)):this._rippleRenderer.fadeInRipple(0,0,ut(ut({},this.rippleConfig),e))}static \u0275fac=function(s){return new(s||n)};static \u0275dir=Ni({type:n,selectors:[["","mat-ripple",""],["","matRipple",""]],hostAttrs:[1,"mat-ripple"],hostVars:2,hostBindings:function(s,u){s&2&&mr("mat-ripple-unbounded",u.unbounded)},inputs:{color:[0,"matRippleColor","color"],unbounded:[0,"matRippleUnbounded","unbounded"],centered:[0,"matRippleCentered","centered"],radius:[0,"matRippleRadius","radius"],animation:[0,"matRippleAnimation","animation"],disabled:[0,"matRippleDisabled","disabled"],trigger:[0,"matRippleTrigger","trigger"]},exportAs:["matRipple"]})}return n})(),oL=(()=>{class n{static \u0275fac=function(s){return new(s||n)};static \u0275mod=en({type:n});static \u0275inj=Jt({imports:[$i,$i]})}return n})();var JH={capture:!0},e6=["focus","mousedown","mouseenter","touchstart"],cT="mat-ripple-loader-uninitialized",uT="mat-ripple-loader-class-name",nL="mat-ripple-loader-centered",sw="mat-ripple-loader-disabled",sL=(()=>{class n{_document=we(Un);_animationMode=we(_a,{optional:!0});_globalRippleOptions=we(iL,{optional:!0});_platform=we(Ur);_ngZone=we(ln);_injector=we(Jn);_eventCleanups;_hosts=new Map;constructor(){let e=we(ko).createRenderer(null,null);this._eventCleanups=this._ngZone.runOutsideAngular(()=>e6.map(s=>Ql(e,this._document,s,this._onInteraction,JH)))}ngOnDestroy(){let e=this._hosts.keys();for(let s of e)this.destroyRipple(s);this._eventCleanups.forEach(s=>s())}configureRipple(e,s){e.setAttribute(cT,this._globalRippleOptions?.namespace??""),(s.className||!e.hasAttribute(uT))&&e.setAttribute(uT,s.className||""),s.centered&&e.setAttribute(nL,""),s.disabled&&e.setAttribute(sw,"")}setDisabled(e,s){let u=this._hosts.get(e);u?(u.target.rippleDisabled=s,!s&&!u.hasSetUpEvents&&(u.hasSetUpEvents=!0,u.renderer.setupTriggerEvents(e))):s?e.setAttribute(sw,""):e.removeAttribute(sw)}_onInteraction=e=>{let s=Ka(e);if(s instanceof HTMLElement){let u=s.closest(`[${cT}="${this._globalRippleOptions?.namespace??""}"]`);u&&this._createRipple(u)}};_createRipple(e){if(!this._document||this._hosts.has(e))return;e.querySelector(".mat-ripple")?.remove();let s=this._document.createElement("span");s.classList.add("mat-ripple",e.getAttribute(uT)),e.append(s);let u=this._animationMode==="NoopAnimations",i=this._globalRippleOptions,E=u?0:i?.animation?.enterDuration??aw.enterDuration,L=u?0:i?.animation?.exitDuration??aw.exitDuration,j={rippleDisabled:u||i?.disabled||e.hasAttribute(sw),rippleConfig:{centered:e.hasAttribute(nL),terminateOnPointerUp:i?.terminateOnPointerUp,animation:{enterDuration:E,exitDuration:L}}},Y=new lw(j,this._ngZone,s,this._platform,this._injector),oe=!j.rippleDisabled;oe&&Y.setupTriggerEvents(e),this._hosts.set(e,{target:j,renderer:Y,hasSetUpEvents:oe}),e.removeAttribute(cT)}destroyRipple(e){let s=this._hosts.get(e);s&&(s.renderer._removeTriggerEvents(),this._hosts.delete(e))}static \u0275fac=function(s){return new(s||n)};static \u0275prov=xt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),aL=(()=>{class n{labelPosition;static \u0275fac=function(s){return new(s||n)};static \u0275cmp=Bn({type:n,selectors:[["div","mat-internal-form-field",""]],hostAttrs:[1,"mdc-form-field","mat-internal-form-field"],hostVars:2,hostBindings:function(s,u){s&2&&mr("mdc-form-field--align-end",u.labelPosition==="before")},inputs:{labelPosition:"labelPosition"},attrs:ZH,ngContentSelectors:XH,decls:1,vars:0,template:function(s,u){s&1&&(Hs(),Zo(0))},styles:[".mat-internal-form-field{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;display:inline-flex;align-items:center;vertical-align:middle}.mat-internal-form-field>label{margin-left:0;margin-right:auto;padding-left:4px;padding-right:0;order:0}[dir=rtl] .mat-internal-form-field>label{margin-left:auto;margin-right:0;padding-left:0;padding-right:4px}.mdc-form-field--align-end>label{margin-left:auto;margin-right:0;padding-left:0;padding-right:4px;order:-1}[dir=rtl] .mdc-form-field--align-end .mdc-form-field--align-end label{margin-left:0;margin-right:auto;padding-left:4px;padding-right:0}"],encapsulation:2,changeDetection:0})}return n})();var t6=["mat-button",""],n6=[[["",8,"material-icons",3,"iconPositionEnd",""],["mat-icon",3,"iconPositionEnd",""],["","matButtonIcon","",3,"iconPositionEnd",""]],"*",[["","iconPositionEnd","",8,"material-icons"],["mat-icon","iconPositionEnd",""],["","matButtonIcon","","iconPositionEnd",""]]],i6=[".material-icons:not([iconPositionEnd]), mat-icon:not([iconPositionEnd]), [matButtonIcon]:not([iconPositionEnd])","*",".material-icons[iconPositionEnd], mat-icon[iconPositionEnd], [matButtonIcon][iconPositionEnd]"];var r6=new dt("MAT_BUTTON_CONFIG");var o6=[{attribute:"mat-button",mdcClasses:["mdc-button","mat-mdc-button"]},{attribute:"mat-flat-button",mdcClasses:["mdc-button","mdc-button--unelevated","mat-mdc-unelevated-button"]},{attribute:"mat-raised-button",mdcClasses:["mdc-button","mdc-button--raised","mat-mdc-raised-button"]},{attribute:"mat-stroked-button",mdcClasses:["mdc-button","mdc-button--outlined","mat-mdc-outlined-button"]},{attribute:"mat-fab",mdcClasses:["mdc-fab","mat-mdc-fab-base","mat-mdc-fab"]},{attribute:"mat-mini-fab",mdcClasses:["mdc-fab","mat-mdc-fab-base","mdc-fab--mini","mat-mdc-mini-fab"]},{attribute:"mat-icon-button",mdcClasses:["mdc-icon-button","mat-mdc-icon-button"]}],s6=(()=>{class n{_elementRef=we(yi);_ngZone=we(ln);_animationMode=we(_a,{optional:!0});_focusMonitor=we(qg);_rippleLoader=we(sL);_isFab=!1;color;get disableRipple(){return this._disableRipple}set disableRipple(e){this._disableRipple=e,this._updateRippleDisabled()}_disableRipple=!1;get disabled(){return this._disabled}set disabled(e){this._disabled=e,this._updateRippleDisabled()}_disabled=!1;ariaDisabled;disabledInteractive;constructor(){we(Jl).load(cw);let e=we(r6,{optional:!0}),s=this._elementRef.nativeElement,u=s.classList;this.disabledInteractive=e?.disabledInteractive??!1,this.color=e?.color??null,this._rippleLoader?.configureRipple(s,{className:"mat-mdc-button-ripple"});for(let{attribute:i,mdcClasses:E}of o6)s.hasAttribute(i)&&u.add(...E)}ngAfterViewInit(){this._focusMonitor.monitor(this._elementRef,!0)}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef),this._rippleLoader?.destroyRipple(this._elementRef.nativeElement)}focus(e="program",s){e?this._focusMonitor.focusVia(this._elementRef.nativeElement,e,s):this._elementRef.nativeElement.focus(s)}_getAriaDisabled(){return this.ariaDisabled!=null?this.ariaDisabled:this.disabled&&this.disabledInteractive?!0:null}_getDisabledAttribute(){return this.disabledInteractive||!this.disabled?null:!0}_updateRippleDisabled(){this._rippleLoader?.setDisabled(this._elementRef.nativeElement,this.disableRipple||this.disabled)}static \u0275fac=function(s){return new(s||n)};static \u0275dir=Ni({type:n,inputs:{color:"color",disableRipple:[2,"disableRipple","disableRipple",Vr],disabled:[2,"disabled","disabled",Vr],ariaDisabled:[2,"aria-disabled","ariaDisabled",Vr],disabledInteractive:[2,"disabledInteractive","disabledInteractive",Vr]}})}return n})();var lL=(()=>{class n extends s6{static \u0275fac=(()=>{let e;return function(u){return(e||(e=ya(n)))(u||n)}})();static \u0275cmp=Bn({type:n,selectors:[["button","mat-button",""],["button","mat-raised-button",""],["button","mat-flat-button",""],["button","mat-stroked-button",""]],hostVars:14,hostBindings:function(s,u){s&2&&(co("disabled",u._getDisabledAttribute())("aria-disabled",u._getAriaDisabled()),Dh(u.color?"mat-"+u.color:""),mr("mat-mdc-button-disabled",u.disabled)("mat-mdc-button-disabled-interactive",u.disabledInteractive)("_mat-animation-noopable",u._animationMode==="NoopAnimations")("mat-unthemed",!u.color)("mat-mdc-button-base",!0))},exportAs:["matButton"],features:[Kc],attrs:t6,ngContentSelectors:i6,decls:7,vars:4,consts:[[1,"mat-mdc-button-persistent-ripple"],[1,"mdc-button__label"],[1,"mat-focus-indicator"],[1,"mat-mdc-button-touch-target"]],template:function(s,u){s&1&&(Hs(n6),Ui(0,"span",0),Zo(1),pn(2,"span",1),Zo(3,1),on(),Zo(4,2),Ui(5,"span",2)(6,"span",3)),s&2&&mr("mdc-button__ripple",!u._isFab)("mdc-fab__ripple",u._isFab)},styles:['.mat-mdc-button-base{text-decoration:none}.mdc-button{-webkit-user-select:none;user-select:none;position:relative;display:inline-flex;align-items:center;justify-content:center;box-sizing:border-box;min-width:64px;border:none;outline:none;line-height:inherit;-webkit-appearance:none;overflow:visible;vertical-align:middle;background:rgba(0,0,0,0);padding:0 8px}.mdc-button::-moz-focus-inner{padding:0;border:0}.mdc-button:active{outline:none}.mdc-button:hover{cursor:pointer}.mdc-button:disabled{cursor:default;pointer-events:none}.mdc-button[hidden]{display:none}.mdc-button .mdc-button__label{position:relative}.mat-mdc-button{padding:0 var(--mat-text-button-horizontal-padding, 12px);height:var(--mdc-text-button-container-height, 40px);font-family:var(--mdc-text-button-label-text-font, var(--mat-sys-label-large-font));font-size:var(--mdc-text-button-label-text-size, var(--mat-sys-label-large-size));letter-spacing:var(--mdc-text-button-label-text-tracking, var(--mat-sys-label-large-tracking));text-transform:var(--mdc-text-button-label-text-transform);font-weight:var(--mdc-text-button-label-text-weight, var(--mat-sys-label-large-weight))}.mat-mdc-button,.mat-mdc-button .mdc-button__ripple{border-radius:var(--mdc-text-button-container-shape, var(--mat-sys-corner-full))}.mat-mdc-button:not(:disabled){color:var(--mdc-text-button-label-text-color, var(--mat-sys-primary))}.mat-mdc-button[disabled],.mat-mdc-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mdc-text-button-disabled-label-text-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mat-mdc-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-button:has(.material-icons,mat-icon,[matButtonIcon]){padding:0 var(--mat-text-button-with-icon-horizontal-padding, 16px)}.mat-mdc-button>.mat-icon{margin-right:var(--mat-text-button-icon-spacing, 8px);margin-left:var(--mat-text-button-icon-offset, -4px)}[dir=rtl] .mat-mdc-button>.mat-icon{margin-right:var(--mat-text-button-icon-offset, -4px);margin-left:var(--mat-text-button-icon-spacing, 8px)}.mat-mdc-button .mdc-button__label+.mat-icon{margin-right:var(--mat-text-button-icon-offset, -4px);margin-left:var(--mat-text-button-icon-spacing, 8px)}[dir=rtl] .mat-mdc-button .mdc-button__label+.mat-icon{margin-right:var(--mat-text-button-icon-spacing, 8px);margin-left:var(--mat-text-button-icon-offset, -4px)}.mat-mdc-button .mat-ripple-element{background-color:var(--mat-text-button-ripple-color, color-mix(in srgb, var(--mat-sys-primary) calc(var(--mat-sys-pressed-state-layer-opacity) * 100%), transparent))}.mat-mdc-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-text-button-state-layer-color, var(--mat-sys-primary))}.mat-mdc-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-text-button-disabled-state-layer-color, var(--mat-sys-on-surface-variant))}.mat-mdc-button:hover>.mat-mdc-button-persistent-ripple::before{opacity:var(--mat-text-button-hover-state-layer-opacity, var(--mat-sys-hover-state-layer-opacity))}.mat-mdc-button.cdk-program-focused>.mat-mdc-button-persistent-ripple::before,.mat-mdc-button.cdk-keyboard-focused>.mat-mdc-button-persistent-ripple::before,.mat-mdc-button.mat-mdc-button-disabled-interactive:focus>.mat-mdc-button-persistent-ripple::before{opacity:var(--mat-text-button-focus-state-layer-opacity, var(--mat-sys-focus-state-layer-opacity))}.mat-mdc-button:active>.mat-mdc-button-persistent-ripple::before{opacity:var(--mat-text-button-pressed-state-layer-opacity, var(--mat-sys-pressed-state-layer-opacity))}.mat-mdc-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%);display:var(--mat-text-button-touch-target-display, block)}.mat-mdc-unelevated-button{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);height:var(--mdc-filled-button-container-height, 40px);font-family:var(--mdc-filled-button-label-text-font, var(--mat-sys-label-large-font));font-size:var(--mdc-filled-button-label-text-size, var(--mat-sys-label-large-size));letter-spacing:var(--mdc-filled-button-label-text-tracking, var(--mat-sys-label-large-tracking));text-transform:var(--mdc-filled-button-label-text-transform);font-weight:var(--mdc-filled-button-label-text-weight, var(--mat-sys-label-large-weight));padding:0 var(--mat-filled-button-horizontal-padding, 24px)}.mat-mdc-unelevated-button>.mat-icon{margin-right:var(--mat-filled-button-icon-spacing, 8px);margin-left:var(--mat-filled-button-icon-offset, -8px)}[dir=rtl] .mat-mdc-unelevated-button>.mat-icon{margin-right:var(--mat-filled-button-icon-offset, -8px);margin-left:var(--mat-filled-button-icon-spacing, 8px)}.mat-mdc-unelevated-button .mdc-button__label+.mat-icon{margin-right:var(--mat-filled-button-icon-offset, -8px);margin-left:var(--mat-filled-button-icon-spacing, 8px)}[dir=rtl] .mat-mdc-unelevated-button .mdc-button__label+.mat-icon{margin-right:var(--mat-filled-button-icon-spacing, 8px);margin-left:var(--mat-filled-button-icon-offset, -8px)}.mat-mdc-unelevated-button .mat-ripple-element{background-color:var(--mat-filled-button-ripple-color, color-mix(in srgb, var(--mat-sys-on-primary) calc(var(--mat-sys-pressed-state-layer-opacity) * 100%), transparent))}.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-filled-button-state-layer-color, var(--mat-sys-on-primary))}.mat-mdc-unelevated-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-filled-button-disabled-state-layer-color, var(--mat-sys-on-surface-variant))}.mat-mdc-unelevated-button:hover>.mat-mdc-button-persistent-ripple::before{opacity:var(--mat-filled-button-hover-state-layer-opacity, var(--mat-sys-hover-state-layer-opacity))}.mat-mdc-unelevated-button.cdk-program-focused>.mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button.cdk-keyboard-focused>.mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button.mat-mdc-button-disabled-interactive:focus>.mat-mdc-button-persistent-ripple::before{opacity:var(--mat-filled-button-focus-state-layer-opacity, var(--mat-sys-focus-state-layer-opacity))}.mat-mdc-unelevated-button:active>.mat-mdc-button-persistent-ripple::before{opacity:var(--mat-filled-button-pressed-state-layer-opacity, var(--mat-sys-pressed-state-layer-opacity))}.mat-mdc-unelevated-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%);display:var(--mat-filled-button-touch-target-display, block)}.mat-mdc-unelevated-button:not(:disabled){color:var(--mdc-filled-button-label-text-color, var(--mat-sys-on-primary));background-color:var(--mdc-filled-button-container-color, var(--mat-sys-primary))}.mat-mdc-unelevated-button,.mat-mdc-unelevated-button .mdc-button__ripple{border-radius:var(--mdc-filled-button-container-shape, var(--mat-sys-corner-full))}.mat-mdc-unelevated-button[disabled],.mat-mdc-unelevated-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mdc-filled-button-disabled-label-text-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent));background-color:var(--mdc-filled-button-disabled-container-color, color-mix(in srgb, var(--mat-sys-on-surface) 12%, transparent))}.mat-mdc-unelevated-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-raised-button{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);box-shadow:var(--mdc-protected-button-container-elevation-shadow, var(--mat-sys-level1));height:var(--mdc-protected-button-container-height, 40px);font-family:var(--mdc-protected-button-label-text-font, var(--mat-sys-label-large-font));font-size:var(--mdc-protected-button-label-text-size, var(--mat-sys-label-large-size));letter-spacing:var(--mdc-protected-button-label-text-tracking, var(--mat-sys-label-large-tracking));text-transform:var(--mdc-protected-button-label-text-transform);font-weight:var(--mdc-protected-button-label-text-weight, var(--mat-sys-label-large-weight));padding:0 var(--mat-protected-button-horizontal-padding, 24px)}.mat-mdc-raised-button>.mat-icon{margin-right:var(--mat-protected-button-icon-spacing, 8px);margin-left:var(--mat-protected-button-icon-offset, -8px)}[dir=rtl] .mat-mdc-raised-button>.mat-icon{margin-right:var(--mat-protected-button-icon-offset, -8px);margin-left:var(--mat-protected-button-icon-spacing, 8px)}.mat-mdc-raised-button .mdc-button__label+.mat-icon{margin-right:var(--mat-protected-button-icon-offset, -8px);margin-left:var(--mat-protected-button-icon-spacing, 8px)}[dir=rtl] .mat-mdc-raised-button .mdc-button__label+.mat-icon{margin-right:var(--mat-protected-button-icon-spacing, 8px);margin-left:var(--mat-protected-button-icon-offset, -8px)}.mat-mdc-raised-button .mat-ripple-element{background-color:var(--mat-protected-button-ripple-color, color-mix(in srgb, var(--mat-sys-primary) calc(var(--mat-sys-pressed-state-layer-opacity) * 100%), transparent))}.mat-mdc-raised-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-protected-button-state-layer-color, var(--mat-sys-primary))}.mat-mdc-raised-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-protected-button-disabled-state-layer-color, var(--mat-sys-on-surface-variant))}.mat-mdc-raised-button:hover>.mat-mdc-button-persistent-ripple::before{opacity:var(--mat-protected-button-hover-state-layer-opacity, var(--mat-sys-hover-state-layer-opacity))}.mat-mdc-raised-button.cdk-program-focused>.mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button.cdk-keyboard-focused>.mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button.mat-mdc-button-disabled-interactive:focus>.mat-mdc-button-persistent-ripple::before{opacity:var(--mat-protected-button-focus-state-layer-opacity, var(--mat-sys-focus-state-layer-opacity))}.mat-mdc-raised-button:active>.mat-mdc-button-persistent-ripple::before{opacity:var(--mat-protected-button-pressed-state-layer-opacity, var(--mat-sys-pressed-state-layer-opacity))}.mat-mdc-raised-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%);display:var(--mat-protected-button-touch-target-display, block)}.mat-mdc-raised-button:not(:disabled){color:var(--mdc-protected-button-label-text-color, var(--mat-sys-primary));background-color:var(--mdc-protected-button-container-color, var(--mat-sys-surface))}.mat-mdc-raised-button,.mat-mdc-raised-button .mdc-button__ripple{border-radius:var(--mdc-protected-button-container-shape, var(--mat-sys-corner-full))}.mat-mdc-raised-button:hover{box-shadow:var(--mdc-protected-button-hover-container-elevation-shadow, var(--mat-sys-level2))}.mat-mdc-raised-button:focus{box-shadow:var(--mdc-protected-button-focus-container-elevation-shadow, var(--mat-sys-level1))}.mat-mdc-raised-button:active,.mat-mdc-raised-button:focus:active{box-shadow:var(--mdc-protected-button-pressed-container-elevation-shadow, var(--mat-sys-level1))}.mat-mdc-raised-button[disabled],.mat-mdc-raised-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mdc-protected-button-disabled-label-text-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent));background-color:var(--mdc-protected-button-disabled-container-color, color-mix(in srgb, var(--mat-sys-on-surface) 12%, transparent))}.mat-mdc-raised-button[disabled].mat-mdc-button-disabled,.mat-mdc-raised-button.mat-mdc-button-disabled.mat-mdc-button-disabled{box-shadow:var(--mdc-protected-button-disabled-container-elevation-shadow, var(--mat-sys-level0))}.mat-mdc-raised-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-outlined-button{border-style:solid;transition:border 280ms cubic-bezier(0.4, 0, 0.2, 1);height:var(--mdc-outlined-button-container-height, 40px);font-family:var(--mdc-outlined-button-label-text-font, var(--mat-sys-label-large-font));font-size:var(--mdc-outlined-button-label-text-size, var(--mat-sys-label-large-size));letter-spacing:var(--mdc-outlined-button-label-text-tracking, var(--mat-sys-label-large-tracking));text-transform:var(--mdc-outlined-button-label-text-transform);font-weight:var(--mdc-outlined-button-label-text-weight, var(--mat-sys-label-large-weight));border-radius:var(--mdc-outlined-button-container-shape, var(--mat-sys-corner-full));border-width:var(--mdc-outlined-button-outline-width, 1px);padding:0 var(--mat-outlined-button-horizontal-padding, 24px)}.mat-mdc-outlined-button>.mat-icon{margin-right:var(--mat-outlined-button-icon-spacing, 8px);margin-left:var(--mat-outlined-button-icon-offset, -8px)}[dir=rtl] .mat-mdc-outlined-button>.mat-icon{margin-right:var(--mat-outlined-button-icon-offset, -8px);margin-left:var(--mat-outlined-button-icon-spacing, 8px)}.mat-mdc-outlined-button .mdc-button__label+.mat-icon{margin-right:var(--mat-outlined-button-icon-offset, -8px);margin-left:var(--mat-outlined-button-icon-spacing, 8px)}[dir=rtl] .mat-mdc-outlined-button .mdc-button__label+.mat-icon{margin-right:var(--mat-outlined-button-icon-spacing, 8px);margin-left:var(--mat-outlined-button-icon-offset, -8px)}.mat-mdc-outlined-button .mat-ripple-element{background-color:var(--mat-outlined-button-ripple-color, color-mix(in srgb, var(--mat-sys-primary) calc(var(--mat-sys-pressed-state-layer-opacity) * 100%), transparent))}.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-outlined-button-state-layer-color, var(--mat-sys-primary))}.mat-mdc-outlined-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-outlined-button-disabled-state-layer-color, var(--mat-sys-on-surface-variant))}.mat-mdc-outlined-button:hover>.mat-mdc-button-persistent-ripple::before{opacity:var(--mat-outlined-button-hover-state-layer-opacity, var(--mat-sys-hover-state-layer-opacity))}.mat-mdc-outlined-button.cdk-program-focused>.mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button.cdk-keyboard-focused>.mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button.mat-mdc-button-disabled-interactive:focus>.mat-mdc-button-persistent-ripple::before{opacity:var(--mat-outlined-button-focus-state-layer-opacity, var(--mat-sys-focus-state-layer-opacity))}.mat-mdc-outlined-button:active>.mat-mdc-button-persistent-ripple::before{opacity:var(--mat-outlined-button-pressed-state-layer-opacity, var(--mat-sys-pressed-state-layer-opacity))}.mat-mdc-outlined-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%);display:var(--mat-outlined-button-touch-target-display, block)}.mat-mdc-outlined-button:not(:disabled){color:var(--mdc-outlined-button-label-text-color, var(--mat-sys-primary));border-color:var(--mdc-outlined-button-outline-color, var(--mat-sys-outline))}.mat-mdc-outlined-button[disabled],.mat-mdc-outlined-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mdc-outlined-button-disabled-label-text-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent));border-color:var(--mdc-outlined-button-disabled-outline-color, color-mix(in srgb, var(--mat-sys-on-surface) 12%, transparent))}.mat-mdc-outlined-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-button,.mat-mdc-unelevated-button,.mat-mdc-raised-button,.mat-mdc-outlined-button{-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-button .mat-mdc-button-ripple,.mat-mdc-button .mat-mdc-button-persistent-ripple,.mat-mdc-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button .mat-mdc-button-ripple,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button .mat-mdc-button-ripple,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple::before{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-mdc-button .mat-mdc-button-ripple,.mat-mdc-unelevated-button .mat-mdc-button-ripple,.mat-mdc-raised-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mat-mdc-button-ripple{overflow:hidden}.mat-mdc-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple::before{content:"";opacity:0}.mat-mdc-button .mdc-button__label,.mat-mdc-button .mat-icon,.mat-mdc-unelevated-button .mdc-button__label,.mat-mdc-unelevated-button .mat-icon,.mat-mdc-raised-button .mdc-button__label,.mat-mdc-raised-button .mat-icon,.mat-mdc-outlined-button .mdc-button__label,.mat-mdc-outlined-button .mat-icon{z-index:1;position:relative}.mat-mdc-button .mat-focus-indicator,.mat-mdc-unelevated-button .mat-focus-indicator,.mat-mdc-raised-button .mat-focus-indicator,.mat-mdc-outlined-button .mat-focus-indicator{top:0;left:0;right:0;bottom:0;position:absolute}.mat-mdc-button:focus>.mat-focus-indicator::before,.mat-mdc-unelevated-button:focus>.mat-focus-indicator::before,.mat-mdc-raised-button:focus>.mat-focus-indicator::before,.mat-mdc-outlined-button:focus>.mat-focus-indicator::before{content:""}.mat-mdc-button._mat-animation-noopable,.mat-mdc-unelevated-button._mat-animation-noopable,.mat-mdc-raised-button._mat-animation-noopable,.mat-mdc-outlined-button._mat-animation-noopable{transition:none !important;animation:none !important}.mat-mdc-button>.mat-icon,.mat-mdc-unelevated-button>.mat-icon,.mat-mdc-raised-button>.mat-icon,.mat-mdc-outlined-button>.mat-icon{display:inline-block;position:relative;vertical-align:top;font-size:1.125rem;height:1.125rem;width:1.125rem}.mat-mdc-outlined-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mdc-button__ripple{top:-1px;left:-1px;bottom:-1px;right:-1px}.mat-mdc-unelevated-button .mat-focus-indicator::before,.mat-mdc-raised-button .mat-focus-indicator::before{margin:calc(calc(var(--mat-focus-indicator-border-width, 3px) + 2px)*-1)}.mat-mdc-outlined-button .mat-focus-indicator::before{margin:calc(calc(var(--mat-focus-indicator-border-width, 3px) + 3px)*-1)}',"@media(forced-colors: active){.mat-mdc-button:not(.mdc-button--outlined),.mat-mdc-unelevated-button:not(.mdc-button--outlined),.mat-mdc-raised-button:not(.mdc-button--outlined),.mat-mdc-outlined-button:not(.mdc-button--outlined),.mat-mdc-icon-button.mat-mdc-icon-button,.mat-mdc-outlined-button .mdc-button__ripple{outline:solid 1px}}"],encapsulation:2,changeDetection:0})}return n})();var uw=(()=>{class n{static \u0275fac=function(s){return new(s||n)};static \u0275mod=en({type:n});static \u0275inj=Jt({imports:[$i,oL,$i]})}return n})();var xv=class{_attachedHost;attach(r){return this._attachedHost=r,r.attach(this)}detach(){let r=this._attachedHost;r!=null&&(this._attachedHost=null,r.detach())}get isAttached(){return this._attachedHost!=null}setAttachedHost(r){this._attachedHost=r}},Ph=class extends xv{component;viewContainerRef;injector;componentFactoryResolver;projectableNodes;constructor(r,e,s,u,i){super(),this.component=r,this.viewContainerRef=e,this.injector=s,this.projectableNodes=i}},Zg=class extends xv{templateRef;viewContainerRef;context;injector;constructor(r,e,s,u){super(),this.templateRef=r,this.viewContainerRef=e,this.context=s,this.injector=u}get origin(){return this.templateRef.elementRef}attach(r,e=this.context){return this.context=e,super.attach(r)}detach(){return this.context=void 0,super.detach()}},fT=class extends xv{element;constructor(r){super(),this.element=r instanceof yi?r.nativeElement:r}},Xg=class{_attachedPortal;_disposeFn;_isDisposed=!1;hasAttached(){return!!this._attachedPortal}attach(r){if(r instanceof Ph)return this._attachedPortal=r,this.attachComponentPortal(r);if(r instanceof Zg)return this._attachedPortal=r,this.attachTemplatePortal(r);if(this.attachDomPortal&&r instanceof fT)return this._attachedPortal=r,this.attachDomPortal(r)}attachDomPortal=null;detach(){this._attachedPortal&&(this._attachedPortal.setAttachedHost(null),this._attachedPortal=null),this._invokeDisposeFn()}dispose(){this.hasAttached()&&this.detach(),this._invokeDisposeFn(),this._isDisposed=!0}setDisposeFn(r){this._disposeFn=r}_invokeDisposeFn(){this._disposeFn&&(this._disposeFn(),this._disposeFn=null)}};var dw=class extends Xg{outletElement;_appRef;_defaultInjector;_document;constructor(r,e,s,u,i){super(),this.outletElement=r,this._appRef=s,this._defaultInjector=u,this._document=i}attachComponentPortal(r){let e;if(r.viewContainerRef){let s=r.injector||r.viewContainerRef.injector,u=s.get(td,null,{optional:!0})||void 0;e=r.viewContainerRef.createComponent(r.component,{index:r.viewContainerRef.length,injector:s,ngModuleRef:u,projectableNodes:r.projectableNodes||void 0}),this.setDisposeFn(()=>e.destroy())}else{let s=this._appRef,u=r.injector||this._defaultInjector||Jn.NULL,i=u.get(jr,s.injector);e=hx(r.component,{elementInjector:u,environmentInjector:i,projectableNodes:r.projectableNodes||void 0}),s.attachView(e.hostView),this.setDisposeFn(()=>{s.viewCount>0&&s.detachView(e.hostView),e.destroy()})}return this.outletElement.appendChild(this._getComponentRootNode(e)),this._attachedPortal=r,e}attachTemplatePortal(r){let e=r.viewContainerRef,s=e.createEmbeddedView(r.templateRef,r.context,{injector:r.injector});return s.rootNodes.forEach(u=>this.outletElement.appendChild(u)),s.detectChanges(),this.setDisposeFn(()=>{let u=e.indexOf(s);u!==-1&&e.remove(u)}),this._attachedPortal=r,s}attachDomPortal=r=>{let e=r.element;e.parentNode;let s=this._document.createComment("dom-portal");e.parentNode.insertBefore(s,e),this.outletElement.appendChild(e),this._attachedPortal=r,super.setDisposeFn(()=>{s.parentNode&&s.parentNode.replaceChild(e,s)})};dispose(){super.dispose(),this.outletElement.remove()}_getComponentRootNode(r){return r.hostView.rootNodes[0]}};var pT=(()=>{class n extends Xg{_moduleRef=we(td,{optional:!0});_document=we(Un);_viewContainerRef=we(ba);_isInitialized=!1;_attachedRef;constructor(){super()}get portal(){return this._attachedPortal}set portal(e){this.hasAttached()&&!e&&!this._isInitialized||(this.hasAttached()&&super.detach(),e&&super.attach(e),this._attachedPortal=e||null)}attached=new Dt;get attachedRef(){return this._attachedRef}ngOnInit(){this._isInitialized=!0}ngOnDestroy(){super.dispose(),this._attachedRef=this._attachedPortal=null}attachComponentPortal(e){e.setAttachedHost(this);let s=e.viewContainerRef!=null?e.viewContainerRef:this._viewContainerRef,u=s.createComponent(e.component,{index:s.length,injector:e.injector||s.injector,projectableNodes:e.projectableNodes||void 0,ngModuleRef:this._moduleRef||void 0});return s!==this._viewContainerRef&&this._getRootNode().appendChild(u.hostView.rootNodes[0]),super.setDisposeFn(()=>u.destroy()),this._attachedPortal=e,this._attachedRef=u,this.attached.emit(u),u}attachTemplatePortal(e){e.setAttachedHost(this);let s=this._viewContainerRef.createEmbeddedView(e.templateRef,e.context,{injector:e.injector});return super.setDisposeFn(()=>this._viewContainerRef.clear()),this._attachedPortal=e,this._attachedRef=s,this.attached.emit(s),s}attachDomPortal=e=>{let s=e.element;s.parentNode;let u=this._document.createComment("dom-portal");e.setAttachedHost(this),s.parentNode.insertBefore(u,s),this._getRootNode().appendChild(s),this._attachedPortal=e,super.setDisposeFn(()=>{u.parentNode&&u.parentNode.replaceChild(s,u)})};_getRootNode(){let e=this._viewContainerRef.element.nativeElement;return e.nodeType===e.ELEMENT_NODE?e:e.parentNode}static \u0275fac=function(s){return new(s||n)};static \u0275dir=Ni({type:n,selectors:[["","cdkPortalOutlet",""]],inputs:{portal:[0,"cdkPortalOutlet","portal"]},outputs:{attached:"attached"},exportAs:["cdkPortalOutlet"],features:[Kc]})}return n})();var hw=(()=>{class n{static \u0275fac=function(s){return new(s||n)};static \u0275mod=en({type:n});static \u0275inj=Jt({})}return n})();var a6=20,wv=(()=>{class n{_ngZone=we(ln);_platform=we(Ur);_renderer=we(ko).createRenderer(null,null);_cleanupGlobalListener;constructor(){}_scrolled=new _n;_scrolledCount=0;scrollContainers=new Map;register(e){this.scrollContainers.has(e)||this.scrollContainers.set(e,e.elementScrolled().subscribe(()=>this._scrolled.next(e)))}deregister(e){let s=this.scrollContainers.get(e);s&&(s.unsubscribe(),this.scrollContainers.delete(e))}scrolled(e=a6){return this._platform.isBrowser?new Hn(s=>{this._cleanupGlobalListener||(this._cleanupGlobalListener=this._ngZone.runOutsideAngular(()=>this._renderer.listen("document","scroll",()=>this._scrolled.next())));let u=e>0?this._scrolled.pipe(n0(e)).subscribe(s):this._scrolled.subscribe(s);return this._scrolledCount++,()=>{u.unsubscribe(),this._scrolledCount--,this._scrolledCount||(this._cleanupGlobalListener?.(),this._cleanupGlobalListener=void 0)}}):nn()}ngOnDestroy(){this._cleanupGlobalListener?.(),this._cleanupGlobalListener=void 0,this.scrollContainers.forEach((e,s)=>this.deregister(s)),this._scrolled.complete()}ancestorScrolled(e,s){let u=this.getAncestorScrollContainers(e);return this.scrolled(s).pipe(Lr(i=>!i||u.indexOf(i)>-1))}getAncestorScrollContainers(e){let s=[];return this.scrollContainers.forEach((u,i)=>{this._scrollableContainsElement(i,e)&&s.push(i)}),s}_scrollableContainsElement(e,s){let u=fd(s),i=e.getElementRef().nativeElement;do if(u==i)return!0;while(u=u.parentElement);return!1}static \u0275fac=function(s){return new(s||n)};static \u0275prov=xt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var l6=20,pw=(()=>{class n{_platform=we(Ur);_listeners;_viewportSize;_change=new _n;_document=we(Un,{optional:!0});constructor(){let e=we(ln),s=we(ko).createRenderer(null,null);e.runOutsideAngular(()=>{if(this._platform.isBrowser){let u=i=>this._change.next(i);this._listeners=[s.listen("window","resize",u),s.listen("window","orientationchange",u)]}this.change().subscribe(()=>this._viewportSize=null)})}ngOnDestroy(){this._listeners?.forEach(e=>e()),this._change.complete()}getViewportSize(){this._viewportSize||this._updateViewportSize();let e={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),e}getViewportRect(){let e=this.getViewportScrollPosition(),{width:s,height:u}=this.getViewportSize();return{top:e.top,left:e.left,bottom:e.top+u,right:e.left+s,height:u,width:s}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};let e=this._document,s=this._getWindow(),u=e.documentElement,i=u.getBoundingClientRect(),E=-i.top||e.body.scrollTop||s.scrollY||u.scrollTop||0,L=-i.left||e.body.scrollLeft||s.scrollX||u.scrollLeft||0;return{top:E,left:L}}change(e=l6){return e>0?this._change.pipe(n0(e)):this._change}_getWindow(){return this._document.defaultView||window}_updateViewportSize(){let e=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:e.innerWidth,height:e.innerHeight}:{width:0,height:0}}static \u0275fac=function(s){return new(s||n)};static \u0275prov=xt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var fw=(()=>{class n{static \u0275fac=function(s){return new(s||n)};static \u0275mod=en({type:n});static \u0275inj=Jt({})}return n})(),mT=(()=>{class n{static \u0275fac=function(s){return new(s||n)};static \u0275mod=en({type:n});static \u0275inj=Jt({imports:[Rh,fw,Rh,fw]})}return n})();var cL=QM(),gT=class{_viewportRuler;_previousHTMLStyles={top:"",left:""};_previousScrollPosition;_isEnabled=!1;_document;constructor(r,e){this._viewportRuler=r,this._document=e}attach(){}enable(){if(this._canBeEnabled()){let r=this._document.documentElement;this._previousScrollPosition=this._viewportRuler.getViewportScrollPosition(),this._previousHTMLStyles.left=r.style.left||"",this._previousHTMLStyles.top=r.style.top||"",r.style.left=$r(-this._previousScrollPosition.left),r.style.top=$r(-this._previousScrollPosition.top),r.classList.add("cdk-global-scrollblock"),this._isEnabled=!0}}disable(){if(this._isEnabled){let r=this._document.documentElement,e=this._document.body,s=r.style,u=e.style,i=s.scrollBehavior||"",E=u.scrollBehavior||"";this._isEnabled=!1,s.left=this._previousHTMLStyles.left,s.top=this._previousHTMLStyles.top,r.classList.remove("cdk-global-scrollblock"),cL&&(s.scrollBehavior=u.scrollBehavior="auto"),window.scroll(this._previousScrollPosition.left,this._previousScrollPosition.top),cL&&(s.scrollBehavior=i,u.scrollBehavior=E)}}_canBeEnabled(){if(this._document.documentElement.classList.contains("cdk-global-scrollblock")||this._isEnabled)return!1;let e=this._document.body,s=this._viewportRuler.getViewportSize();return e.scrollHeight>s.height||e.scrollWidth>s.width}};var yT=class{_scrollDispatcher;_ngZone;_viewportRuler;_config;_scrollSubscription=null;_overlayRef;_initialScrollPosition;constructor(r,e,s,u){this._scrollDispatcher=r,this._ngZone=e,this._viewportRuler=s,this._config=u}attach(r){this._overlayRef,this._overlayRef=r}enable(){if(this._scrollSubscription)return;let r=this._scrollDispatcher.scrolled(0).pipe(Lr(e=>!e||!this._overlayRef.overlayElement.contains(e.getElementRef().nativeElement)));this._config&&this._config.threshold&&this._config.threshold>1?(this._initialScrollPosition=this._viewportRuler.getViewportScrollPosition().top,this._scrollSubscription=r.subscribe(()=>{let e=this._viewportRuler.getViewportScrollPosition().top;Math.abs(e-this._initialScrollPosition)>this._config.threshold?this._detach():this._overlayRef.updatePosition()})):this._scrollSubscription=r.subscribe(this._detach)}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}_detach=()=>{this.disable(),this._overlayRef.hasAttached()&&this._ngZone.run(()=>this._overlayRef.detach())}},mw=class{enable(){}disable(){}attach(){}};function _T(n,r){return r.some(e=>{let s=n.bottom<e.top,u=n.top>e.bottom,i=n.right<e.left,E=n.left>e.right;return s||u||i||E})}function uL(n,r){return r.some(e=>{let s=n.top<e.top,u=n.bottom>e.bottom,i=n.left<e.left,E=n.right>e.right;return s||u||i||E})}var vT=class{_scrollDispatcher;_viewportRuler;_ngZone;_config;_scrollSubscription=null;_overlayRef;constructor(r,e,s,u){this._scrollDispatcher=r,this._viewportRuler=e,this._ngZone=s,this._config=u}attach(r){this._overlayRef,this._overlayRef=r}enable(){if(!this._scrollSubscription){let r=this._config?this._config.scrollThrottle:0;this._scrollSubscription=this._scrollDispatcher.scrolled(r).subscribe(()=>{if(this._overlayRef.updatePosition(),this._config&&this._config.autoClose){let e=this._overlayRef.overlayElement.getBoundingClientRect(),{width:s,height:u}=this._viewportRuler.getViewportSize();_T(e,[{width:s,height:u,bottom:u,right:s,top:0,left:0}])&&(this.disable(),this._ngZone.run(()=>this._overlayRef.detach()))}})}}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}},c6=(()=>{class n{_scrollDispatcher=we(wv);_viewportRuler=we(pw);_ngZone=we(ln);_document=we(Un);constructor(){}noop=()=>new mw;close=e=>new yT(this._scrollDispatcher,this._ngZone,this._viewportRuler,e);block=()=>new gT(this._viewportRuler,this._document);reposition=e=>new vT(this._scrollDispatcher,this._viewportRuler,this._ngZone,e);static \u0275fac=function(s){return new(s||n)};static \u0275prov=xt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Cv=class{positionStrategy;scrollStrategy=new mw;panelClass="";hasBackdrop=!1;backdropClass="cdk-overlay-dark-backdrop";width;height;minWidth;minHeight;maxWidth;maxHeight;direction;disposeOnNavigation=!1;constructor(r){if(r){let e=Object.keys(r);for(let s of e)r[s]!==void 0&&(this[s]=r[s])}}};var bT=class{connectionPair;scrollableViewProperties;constructor(r,e){this.connectionPair=r,this.scrollableViewProperties=e}};var gL=(()=>{class n{_attachedOverlays=[];_document=we(Un);_isAttached;constructor(){}ngOnDestroy(){this.detach()}add(e){this.remove(e),this._attachedOverlays.push(e)}remove(e){let s=this._attachedOverlays.indexOf(e);s>-1&&this._attachedOverlays.splice(s,1),this._attachedOverlays.length===0&&this.detach()}static \u0275fac=function(s){return new(s||n)};static \u0275prov=xt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),u6=(()=>{class n extends gL{_ngZone=we(ln);_renderer=we(ko).createRenderer(null,null);_cleanupKeydown;add(e){super.add(e),this._isAttached||(this._ngZone.runOutsideAngular(()=>{this._cleanupKeydown=this._renderer.listen("body","keydown",this._keydownListener)}),this._isAttached=!0)}detach(){this._isAttached&&(this._cleanupKeydown?.(),this._isAttached=!1)}_keydownListener=e=>{let s=this._attachedOverlays;for(let u=s.length-1;u>-1;u--)if(s[u]._keydownEvents.observers.length>0){this._ngZone.run(()=>s[u]._keydownEvents.next(e));break}};static \u0275fac=(()=>{let e;return function(u){return(e||(e=ya(n)))(u||n)}})();static \u0275prov=xt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),d6=(()=>{class n extends gL{_platform=we(Ur);_ngZone=we(ln);_renderer=we(ko).createRenderer(null,null);_cursorOriginalValue;_cursorStyleIsSet=!1;_pointerDownEventTarget;_cleanups;add(e){if(super.add(e),!this._isAttached){let s=this._document.body,u={capture:!0};this._cleanups=this._ngZone.runOutsideAngular(()=>[Ql(this._renderer,s,"pointerdown",this._pointerDownListener,u),Ql(this._renderer,s,"click",this._clickListener,u),Ql(this._renderer,s,"auxclick",this._clickListener,u),Ql(this._renderer,s,"contextmenu",this._clickListener,u)]),this._platform.IOS&&!this._cursorStyleIsSet&&(this._cursorOriginalValue=s.style.cursor,s.style.cursor="pointer",this._cursorStyleIsSet=!0),this._isAttached=!0}}detach(){this._isAttached&&(this._cleanups?.forEach(e=>e()),this._cleanups=void 0,this._platform.IOS&&this._cursorStyleIsSet&&(this._document.body.style.cursor=this._cursorOriginalValue,this._cursorStyleIsSet=!1),this._isAttached=!1)}_pointerDownListener=e=>{this._pointerDownEventTarget=Ka(e)};_clickListener=e=>{let s=Ka(e),u=e.type==="click"&&this._pointerDownEventTarget?this._pointerDownEventTarget:s;this._pointerDownEventTarget=null;let i=this._attachedOverlays.slice();for(let E=i.length-1;E>-1;E--){let L=i[E];if(L._outsidePointerEvents.observers.length<1||!L.hasAttached())continue;if(dL(L.overlayElement,s)||dL(L.overlayElement,u))break;let j=L._outsidePointerEvents;this._ngZone?this._ngZone.run(()=>j.next(e)):j.next(e)}};static \u0275fac=(()=>{let e;return function(u){return(e||(e=ya(n)))(u||n)}})();static \u0275prov=xt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function dL(n,r){let e=typeof ShadowRoot<"u"&&ShadowRoot,s=r;for(;s;){if(s===n)return!0;s=e&&s instanceof ShadowRoot?s.host:s.parentNode}return!1}var yL=(()=>{class n{static \u0275fac=function(s){return new(s||n)};static \u0275cmp=Bn({type:n,selectors:[["ng-component"]],hostAttrs:["cdk-overlay-style-loader",""],decls:0,vars:0,template:function(s,u){},styles:[".cdk-overlay-container,.cdk-global-overlay-wrapper{pointer-events:none;top:0;left:0;height:100%;width:100%}.cdk-overlay-container{position:fixed}@layer cdk-overlay{.cdk-overlay-container{z-index:1000}}.cdk-overlay-container:empty{display:none}.cdk-global-overlay-wrapper{display:flex;position:absolute}@layer cdk-overlay{.cdk-global-overlay-wrapper{z-index:1000}}.cdk-overlay-pane{position:absolute;pointer-events:auto;box-sizing:border-box;display:flex;max-width:100%;max-height:100%}@layer cdk-overlay{.cdk-overlay-pane{z-index:1000}}.cdk-overlay-backdrop{position:absolute;top:0;bottom:0;left:0;right:0;pointer-events:auto;-webkit-tap-highlight-color:rgba(0,0,0,0);opacity:0}@layer cdk-overlay{.cdk-overlay-backdrop{z-index:1000;transition:opacity 400ms cubic-bezier(0.25, 0.8, 0.25, 1)}}.cdk-overlay-backdrop-showing{opacity:1}@media(forced-colors: active){.cdk-overlay-backdrop-showing{opacity:.6}}@layer cdk-overlay{.cdk-overlay-dark-backdrop{background:rgba(0,0,0,.32)}}.cdk-overlay-transparent-backdrop{transition:visibility 1ms linear,opacity 1ms linear;visibility:hidden;opacity:1}.cdk-overlay-transparent-backdrop.cdk-overlay-backdrop-showing,.cdk-high-contrast-active .cdk-overlay-transparent-backdrop{opacity:0;visibility:visible}.cdk-overlay-backdrop-noop-animation{transition:none}.cdk-overlay-connected-position-bounding-box{position:absolute;display:flex;flex-direction:column;min-width:1px;min-height:1px}@layer cdk-overlay{.cdk-overlay-connected-position-bounding-box{z-index:1000}}.cdk-global-scrollblock{position:fixed;width:100%;overflow-y:scroll}"],encapsulation:2,changeDetection:0})}return n})(),_L=(()=>{class n{_platform=we(Ur);_containerElement;_document=we(Un);_styleLoader=we(Jl);constructor(){}ngOnDestroy(){this._containerElement?.remove()}getContainerElement(){return this._loadStyles(),this._containerElement||this._createContainer(),this._containerElement}_createContainer(){let e="cdk-overlay-container";if(this._platform.isBrowser||JM()){let u=this._document.querySelectorAll(`.${e}[platform="server"], .${e}[platform="test"]`);for(let i=0;i<u.length;i++)u[i].remove()}let s=this._document.createElement("div");s.classList.add(e),JM()?s.setAttribute("platform","test"):this._platform.isBrowser||s.setAttribute("platform","server"),this._document.body.appendChild(s),this._containerElement=s}_loadStyles(){this._styleLoader.load(yL)}static \u0275fac=function(s){return new(s||n)};static \u0275prov=xt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),xT=class{_renderer;_ngZone;element;_cleanupClick;_cleanupTransitionEnd;_fallbackTimeout;constructor(r,e,s,u){this._renderer=e,this._ngZone=s,this.element=r.createElement("div"),this.element.classList.add("cdk-overlay-backdrop"),this._cleanupClick=e.listen(this.element,"click",u)}detach(){this._ngZone.runOutsideAngular(()=>{let r=this.element;clearTimeout(this._fallbackTimeout),this._cleanupTransitionEnd?.(),this._cleanupTransitionEnd=this._renderer.listen(r,"transitionend",this.dispose),this._fallbackTimeout=setTimeout(this.dispose,500),r.style.pointerEvents="none",r.classList.remove("cdk-overlay-backdrop-showing")})}dispose=()=>{clearTimeout(this._fallbackTimeout),this._cleanupClick?.(),this._cleanupTransitionEnd?.(),this._cleanupClick=this._cleanupTransitionEnd=this._fallbackTimeout=void 0,this.element.remove()}},wT=class{_portalOutlet;_host;_pane;_config;_ngZone;_keyboardDispatcher;_document;_location;_outsideClickDispatcher;_animationsDisabled;_injector;_renderer;_backdropClick=new _n;_attachments=new _n;_detachments=new _n;_positionStrategy;_scrollStrategy;_locationChanges=Oi.EMPTY;_backdropRef=null;_previousHostParent;_keydownEvents=new _n;_outsidePointerEvents=new _n;_renders=new _n;_afterRenderRef;_afterNextRenderRef;constructor(r,e,s,u,i,E,L,j,Y,oe=!1,Ee,Ye){this._portalOutlet=r,this._host=e,this._pane=s,this._config=u,this._ngZone=i,this._keyboardDispatcher=E,this._document=L,this._location=j,this._outsideClickDispatcher=Y,this._animationsDisabled=oe,this._injector=Ee,this._renderer=Ye,u.scrollStrategy&&(this._scrollStrategy=u.scrollStrategy,this._scrollStrategy.attach(this)),this._positionStrategy=u.positionStrategy,this._afterRenderRef=fp(()=>z_(()=>{this._renders.next()},{injector:this._injector}))}get overlayElement(){return this._pane}get backdropElement(){return this._backdropRef?.element||null}get hostElement(){return this._host}attach(r){!this._host.parentElement&&this._previousHostParent&&this._previousHostParent.appendChild(this._host);let e=this._portalOutlet.attach(r);return this._positionStrategy&&this._positionStrategy.attach(this),this._updateStackingOrder(),this._updateElementSize(),this._updateElementDirection(),this._scrollStrategy&&this._scrollStrategy.enable(),this._afterNextRenderRef?.destroy(),this._afterNextRenderRef=Xc(()=>{this.hasAttached()&&this.updatePosition()},{injector:this._injector}),this._togglePointerEvents(!0),this._config.hasBackdrop&&this._attachBackdrop(),this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!0),this._attachments.next(),this._keyboardDispatcher.add(this),this._config.disposeOnNavigation&&(this._locationChanges=this._location.subscribe(()=>this.dispose())),this._outsideClickDispatcher.add(this),typeof e?.onDestroy=="function"&&e.onDestroy(()=>{this.hasAttached()&&this._ngZone.runOutsideAngular(()=>Promise.resolve().then(()=>this.detach()))}),e}detach(){if(!this.hasAttached())return;this.detachBackdrop(),this._togglePointerEvents(!1),this._positionStrategy&&this._positionStrategy.detach&&this._positionStrategy.detach(),this._scrollStrategy&&this._scrollStrategy.disable();let r=this._portalOutlet.detach();return this._detachments.next(),this._keyboardDispatcher.remove(this),this._detachContentWhenEmpty(),this._locationChanges.unsubscribe(),this._outsideClickDispatcher.remove(this),r}dispose(){let r=this.hasAttached();this._positionStrategy&&this._positionStrategy.dispose(),this._disposeScrollStrategy(),this._backdropRef?.dispose(),this._locationChanges.unsubscribe(),this._keyboardDispatcher.remove(this),this._portalOutlet.dispose(),this._attachments.complete(),this._backdropClick.complete(),this._keydownEvents.complete(),this._outsidePointerEvents.complete(),this._outsideClickDispatcher.remove(this),this._host?.remove(),this._afterNextRenderRef?.destroy(),this._previousHostParent=this._pane=this._host=this._backdropRef=null,r&&this._detachments.next(),this._detachments.complete(),this._afterRenderRef.destroy(),this._renders.complete()}hasAttached(){return this._portalOutlet.hasAttached()}backdropClick(){return this._backdropClick}attachments(){return this._attachments}detachments(){return this._detachments}keydownEvents(){return this._keydownEvents}outsidePointerEvents(){return this._outsidePointerEvents}getConfig(){return this._config}updatePosition(){this._positionStrategy&&this._positionStrategy.apply()}updatePositionStrategy(r){r!==this._positionStrategy&&(this._positionStrategy&&this._positionStrategy.dispose(),this._positionStrategy=r,this.hasAttached()&&(r.attach(this),this.updatePosition()))}updateSize(r){this._config=ut(ut({},this._config),r),this._updateElementSize()}setDirection(r){this._config=Cn(ut({},this._config),{direction:r}),this._updateElementDirection()}addPanelClass(r){this._pane&&this._toggleClasses(this._pane,r,!0)}removePanelClass(r){this._pane&&this._toggleClasses(this._pane,r,!1)}getDirection(){let r=this._config.direction;return r?typeof r=="string"?r:r.value:"ltr"}updateScrollStrategy(r){r!==this._scrollStrategy&&(this._disposeScrollStrategy(),this._scrollStrategy=r,this.hasAttached()&&(r.attach(this),r.enable()))}_updateElementDirection(){this._host.setAttribute("dir",this.getDirection())}_updateElementSize(){if(!this._pane)return;let r=this._pane.style;r.width=$r(this._config.width),r.height=$r(this._config.height),r.minWidth=$r(this._config.minWidth),r.minHeight=$r(this._config.minHeight),r.maxWidth=$r(this._config.maxWidth),r.maxHeight=$r(this._config.maxHeight)}_togglePointerEvents(r){this._pane.style.pointerEvents=r?"":"none"}_attachBackdrop(){let r="cdk-overlay-backdrop-showing";this._backdropRef?.dispose(),this._backdropRef=new xT(this._document,this._renderer,this._ngZone,e=>{this._backdropClick.next(e)}),this._animationsDisabled&&this._backdropRef.element.classList.add("cdk-overlay-backdrop-noop-animation"),this._config.backdropClass&&this._toggleClasses(this._backdropRef.element,this._config.backdropClass,!0),this._host.parentElement.insertBefore(this._backdropRef.element,this._host),!this._animationsDisabled&&typeof requestAnimationFrame<"u"?this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>this._backdropRef?.element.classList.add(r))}):this._backdropRef.element.classList.add(r)}_updateStackingOrder(){this._host.nextSibling&&this._host.parentNode.appendChild(this._host)}detachBackdrop(){this._animationsDisabled?(this._backdropRef?.dispose(),this._backdropRef=null):this._backdropRef?.detach()}_toggleClasses(r,e,s){let u=Wg(e||[]).filter(i=>!!i);u.length&&(s?r.classList.add(...u):r.classList.remove(...u))}_detachContentWhenEmpty(){this._ngZone.runOutsideAngular(()=>{let r=this._renders.pipe(Br(t0(this._attachments,this._detachments))).subscribe(()=>{(!this._pane||!this._host||this._pane.children.length===0)&&(this._pane&&this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!1),this._host&&this._host.parentElement&&(this._previousHostParent=this._host.parentElement,this._host.remove()),r.unsubscribe())})})}_disposeScrollStrategy(){let r=this._scrollStrategy;r?.disable(),r?.detach?.()}},hL="cdk-overlay-connected-position-bounding-box",h6=/([A-Za-z%]+)$/,CT=class{_viewportRuler;_document;_platform;_overlayContainer;_overlayRef;_isInitialRender;_lastBoundingBoxSize={width:0,height:0};_isPushed=!1;_canPush=!0;_growAfterOpen=!1;_hasFlexibleDimensions=!0;_positionLocked=!1;_originRect;_overlayRect;_viewportRect;_containerRect;_viewportMargin=0;_scrollables=[];_preferredPositions=[];_origin;_pane;_isDisposed;_boundingBox;_lastPosition;_lastScrollVisibility;_positionChanges=new _n;_resizeSubscription=Oi.EMPTY;_offsetX=0;_offsetY=0;_transformOriginSelector;_appliedPanelClasses=[];_previousPushAmount;positionChanges=this._positionChanges;get positions(){return this._preferredPositions}constructor(r,e,s,u,i){this._viewportRuler=e,this._document=s,this._platform=u,this._overlayContainer=i,this.setOrigin(r)}attach(r){this._overlayRef&&this._overlayRef,this._validatePositions(),r.hostElement.classList.add(hL),this._overlayRef=r,this._boundingBox=r.hostElement,this._pane=r.overlayElement,this._isDisposed=!1,this._isInitialRender=!0,this._lastPosition=null,this._resizeSubscription.unsubscribe(),this._resizeSubscription=this._viewportRuler.change().subscribe(()=>{this._isInitialRender=!0,this.apply()})}apply(){if(this._isDisposed||!this._platform.isBrowser)return;if(!this._isInitialRender&&this._positionLocked&&this._lastPosition){this.reapplyLastPosition();return}this._clearPanelClasses(),this._resetOverlayElementStyles(),this._resetBoundingBoxStyles(),this._viewportRect=this._getNarrowedViewportRect(),this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();let r=this._originRect,e=this._overlayRect,s=this._viewportRect,u=this._containerRect,i=[],E;for(let L of this._preferredPositions){let j=this._getOriginPoint(r,u,L),Y=this._getOverlayPoint(j,e,L),oe=this._getOverlayFit(Y,e,s,L);if(oe.isCompletelyWithinViewport){this._isPushed=!1,this._applyPosition(L,j);return}if(this._canFitWithFlexibleDimensions(oe,Y,s)){i.push({position:L,origin:j,overlayRect:e,boundingBoxRect:this._calculateBoundingBoxRect(j,L)});continue}(!E||E.overlayFit.visibleArea<oe.visibleArea)&&(E={overlayFit:oe,overlayPoint:Y,originPoint:j,position:L,overlayRect:e})}if(i.length){let L=null,j=-1;for(let Y of i){let oe=Y.boundingBoxRect.width*Y.boundingBoxRect.height*(Y.position.weight||1);oe>j&&(j=oe,L=Y)}this._isPushed=!1,this._applyPosition(L.position,L.origin);return}if(this._canPush){this._isPushed=!0,this._applyPosition(E.position,E.originPoint);return}this._applyPosition(E.position,E.originPoint)}detach(){this._clearPanelClasses(),this._lastPosition=null,this._previousPushAmount=null,this._resizeSubscription.unsubscribe()}dispose(){this._isDisposed||(this._boundingBox&&Ep(this._boundingBox.style,{top:"",left:"",right:"",bottom:"",height:"",width:"",alignItems:"",justifyContent:""}),this._pane&&this._resetOverlayElementStyles(),this._overlayRef&&this._overlayRef.hostElement.classList.remove(hL),this.detach(),this._positionChanges.complete(),this._overlayRef=this._boundingBox=null,this._isDisposed=!0)}reapplyLastPosition(){if(this._isDisposed||!this._platform.isBrowser)return;let r=this._lastPosition;if(r){this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._viewportRect=this._getNarrowedViewportRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();let e=this._getOriginPoint(this._originRect,this._containerRect,r);this._applyPosition(r,e)}else this.apply()}withScrollableContainers(r){return this._scrollables=r,this}withPositions(r){return this._preferredPositions=r,r.indexOf(this._lastPosition)===-1&&(this._lastPosition=null),this._validatePositions(),this}withViewportMargin(r){return this._viewportMargin=r,this}withFlexibleDimensions(r=!0){return this._hasFlexibleDimensions=r,this}withGrowAfterOpen(r=!0){return this._growAfterOpen=r,this}withPush(r=!0){return this._canPush=r,this}withLockedPosition(r=!0){return this._positionLocked=r,this}setOrigin(r){return this._origin=r,this}withDefaultOffsetX(r){return this._offsetX=r,this}withDefaultOffsetY(r){return this._offsetY=r,this}withTransformOriginOn(r){return this._transformOriginSelector=r,this}_getOriginPoint(r,e,s){let u;if(s.originX=="center")u=r.left+r.width/2;else{let E=this._isRtl()?r.right:r.left,L=this._isRtl()?r.left:r.right;u=s.originX=="start"?E:L}e.left<0&&(u-=e.left);let i;return s.originY=="center"?i=r.top+r.height/2:i=s.originY=="top"?r.top:r.bottom,e.top<0&&(i-=e.top),{x:u,y:i}}_getOverlayPoint(r,e,s){let u;s.overlayX=="center"?u=-e.width/2:s.overlayX==="start"?u=this._isRtl()?-e.width:0:u=this._isRtl()?0:-e.width;let i;return s.overlayY=="center"?i=-e.height/2:i=s.overlayY=="top"?0:-e.height,{x:r.x+u,y:r.y+i}}_getOverlayFit(r,e,s,u){let i=pL(e),{x:E,y:L}=r,j=this._getOffset(u,"x"),Y=this._getOffset(u,"y");j&&(E+=j),Y&&(L+=Y);let oe=0-E,Ee=E+i.width-s.width,Ye=0-L,Ne=L+i.height-s.height,ct=this._subtractOverflows(i.width,oe,Ee),bt=this._subtractOverflows(i.height,Ye,Ne),Ut=ct*bt;return{visibleArea:Ut,isCompletelyWithinViewport:i.width*i.height===Ut,fitsInViewportVertically:bt===i.height,fitsInViewportHorizontally:ct==i.width}}_canFitWithFlexibleDimensions(r,e,s){if(this._hasFlexibleDimensions){let u=s.bottom-e.y,i=s.right-e.x,E=fL(this._overlayRef.getConfig().minHeight),L=fL(this._overlayRef.getConfig().minWidth),j=r.fitsInViewportVertically||E!=null&&E<=u,Y=r.fitsInViewportHorizontally||L!=null&&L<=i;return j&&Y}return!1}_pushOverlayOnScreen(r,e,s){if(this._previousPushAmount&&this._positionLocked)return{x:r.x+this._previousPushAmount.x,y:r.y+this._previousPushAmount.y};let u=pL(e),i=this._viewportRect,E=Math.max(r.x+u.width-i.width,0),L=Math.max(r.y+u.height-i.height,0),j=Math.max(i.top-s.top-r.y,0),Y=Math.max(i.left-s.left-r.x,0),oe=0,Ee=0;return u.width<=i.width?oe=Y||-E:oe=r.x<this._viewportMargin?i.left-s.left-r.x:0,u.height<=i.height?Ee=j||-L:Ee=r.y<this._viewportMargin?i.top-s.top-r.y:0,this._previousPushAmount={x:oe,y:Ee},{x:r.x+oe,y:r.y+Ee}}_applyPosition(r,e){if(this._setTransformOrigin(r),this._setOverlayElementStyles(e,r),this._setBoundingBoxStyles(e,r),r.panelClass&&this._addPanelClasses(r.panelClass),this._positionChanges.observers.length){let s=this._getScrollVisibility();if(r!==this._lastPosition||!this._lastScrollVisibility||!f6(this._lastScrollVisibility,s)){let u=new bT(r,s);this._positionChanges.next(u)}this._lastScrollVisibility=s}this._lastPosition=r,this._isInitialRender=!1}_setTransformOrigin(r){if(!this._transformOriginSelector)return;let e=this._boundingBox.querySelectorAll(this._transformOriginSelector),s,u=r.overlayY;r.overlayX==="center"?s="center":this._isRtl()?s=r.overlayX==="start"?"right":"left":s=r.overlayX==="start"?"left":"right";for(let i=0;i<e.length;i++)e[i].style.transformOrigin=`${s} ${u}`}_calculateBoundingBoxRect(r,e){let s=this._viewportRect,u=this._isRtl(),i,E,L;if(e.overlayY==="top")E=r.y,i=s.height-E+this._viewportMargin;else if(e.overlayY==="bottom")L=s.height-r.y+this._viewportMargin*2,i=s.height-L+this._viewportMargin;else{let Ne=Math.min(s.bottom-r.y+s.top,r.y),ct=this._lastBoundingBoxSize.height;i=Ne*2,E=r.y-Ne,i>ct&&!this._isInitialRender&&!this._growAfterOpen&&(E=r.y-ct/2)}let j=e.overlayX==="start"&&!u||e.overlayX==="end"&&u,Y=e.overlayX==="end"&&!u||e.overlayX==="start"&&u,oe,Ee,Ye;if(Y)Ye=s.width-r.x+this._viewportMargin*2,oe=r.x-this._viewportMargin;else if(j)Ee=r.x,oe=s.right-r.x;else{let Ne=Math.min(s.right-r.x+s.left,r.x),ct=this._lastBoundingBoxSize.width;oe=Ne*2,Ee=r.x-Ne,oe>ct&&!this._isInitialRender&&!this._growAfterOpen&&(Ee=r.x-ct/2)}return{top:E,left:Ee,bottom:L,right:Ye,width:oe,height:i}}_setBoundingBoxStyles(r,e){let s=this._calculateBoundingBoxRect(r,e);!this._isInitialRender&&!this._growAfterOpen&&(s.height=Math.min(s.height,this._lastBoundingBoxSize.height),s.width=Math.min(s.width,this._lastBoundingBoxSize.width));let u={};if(this._hasExactPosition())u.top=u.left="0",u.bottom=u.right=u.maxHeight=u.maxWidth="",u.width=u.height="100%";else{let i=this._overlayRef.getConfig().maxHeight,E=this._overlayRef.getConfig().maxWidth;u.height=$r(s.height),u.top=$r(s.top),u.bottom=$r(s.bottom),u.width=$r(s.width),u.left=$r(s.left),u.right=$r(s.right),e.overlayX==="center"?u.alignItems="center":u.alignItems=e.overlayX==="end"?"flex-end":"flex-start",e.overlayY==="center"?u.justifyContent="center":u.justifyContent=e.overlayY==="bottom"?"flex-end":"flex-start",i&&(u.maxHeight=$r(i)),E&&(u.maxWidth=$r(E))}this._lastBoundingBoxSize=s,Ep(this._boundingBox.style,u)}_resetBoundingBoxStyles(){Ep(this._boundingBox.style,{top:"0",left:"0",right:"0",bottom:"0",height:"",width:"",alignItems:"",justifyContent:""})}_resetOverlayElementStyles(){Ep(this._pane.style,{top:"",left:"",bottom:"",right:"",position:"",transform:""})}_setOverlayElementStyles(r,e){let s={},u=this._hasExactPosition(),i=this._hasFlexibleDimensions,E=this._overlayRef.getConfig();if(u){let oe=this._viewportRuler.getViewportScrollPosition();Ep(s,this._getExactOverlayY(e,r,oe)),Ep(s,this._getExactOverlayX(e,r,oe))}else s.position="static";let L="",j=this._getOffset(e,"x"),Y=this._getOffset(e,"y");j&&(L+=`translateX(${j}px) `),Y&&(L+=`translateY(${Y}px)`),s.transform=L.trim(),E.maxHeight&&(u?s.maxHeight=$r(E.maxHeight):i&&(s.maxHeight="")),E.maxWidth&&(u?s.maxWidth=$r(E.maxWidth):i&&(s.maxWidth="")),Ep(this._pane.style,s)}_getExactOverlayY(r,e,s){let u={top:"",bottom:""},i=this._getOverlayPoint(e,this._overlayRect,r);if(this._isPushed&&(i=this._pushOverlayOnScreen(i,this._overlayRect,s)),r.overlayY==="bottom"){let E=this._document.documentElement.clientHeight;u.bottom=`${E-(i.y+this._overlayRect.height)}px`}else u.top=$r(i.y);return u}_getExactOverlayX(r,e,s){let u={left:"",right:""},i=this._getOverlayPoint(e,this._overlayRect,r);this._isPushed&&(i=this._pushOverlayOnScreen(i,this._overlayRect,s));let E;if(this._isRtl()?E=r.overlayX==="end"?"left":"right":E=r.overlayX==="end"?"right":"left",E==="right"){let L=this._document.documentElement.clientWidth;u.right=`${L-(i.x+this._overlayRect.width)}px`}else u.left=$r(i.x);return u}_getScrollVisibility(){let r=this._getOriginRect(),e=this._pane.getBoundingClientRect(),s=this._scrollables.map(u=>u.getElementRef().nativeElement.getBoundingClientRect());return{isOriginClipped:uL(r,s),isOriginOutsideView:_T(r,s),isOverlayClipped:uL(e,s),isOverlayOutsideView:_T(e,s)}}_subtractOverflows(r,...e){return e.reduce((s,u)=>s-Math.max(u,0),r)}_getNarrowedViewportRect(){let r=this._document.documentElement.clientWidth,e=this._document.documentElement.clientHeight,s=this._viewportRuler.getViewportScrollPosition();return{top:s.top+this._viewportMargin,left:s.left+this._viewportMargin,right:s.left+r-this._viewportMargin,bottom:s.top+e-this._viewportMargin,width:r-2*this._viewportMargin,height:e-2*this._viewportMargin}}_isRtl(){return this._overlayRef.getDirection()==="rtl"}_hasExactPosition(){return!this._hasFlexibleDimensions||this._isPushed}_getOffset(r,e){return e==="x"?r.offsetX==null?this._offsetX:r.offsetX:r.offsetY==null?this._offsetY:r.offsetY}_validatePositions(){}_addPanelClasses(r){this._pane&&Wg(r).forEach(e=>{e!==""&&this._appliedPanelClasses.indexOf(e)===-1&&(this._appliedPanelClasses.push(e),this._pane.classList.add(e))})}_clearPanelClasses(){this._pane&&(this._appliedPanelClasses.forEach(r=>{this._pane.classList.remove(r)}),this._appliedPanelClasses=[])}_getOriginRect(){let r=this._origin;if(r instanceof yi)return r.nativeElement.getBoundingClientRect();if(r instanceof Element)return r.getBoundingClientRect();let e=r.width||0,s=r.height||0;return{top:r.y,bottom:r.y+s,left:r.x,right:r.x+e,height:s,width:e}}};function Ep(n,r){for(let e in r)r.hasOwnProperty(e)&&(n[e]=r[e]);return n}function fL(n){if(typeof n!="number"&&n!=null){let[r,e]=n.split(h6);return!e||e==="px"?parseFloat(r):null}return n||null}function pL(n){return{top:Math.floor(n.top),right:Math.floor(n.right),bottom:Math.floor(n.bottom),left:Math.floor(n.left),width:Math.floor(n.width),height:Math.floor(n.height)}}function f6(n,r){return n===r?!0:n.isOriginClipped===r.isOriginClipped&&n.isOriginOutsideView===r.isOriginOutsideView&&n.isOverlayClipped===r.isOverlayClipped&&n.isOverlayOutsideView===r.isOverlayOutsideView}var mL="cdk-global-overlay-wrapper",ET=class{_overlayRef;_cssPosition="static";_topOffset="";_bottomOffset="";_alignItems="";_xPosition="";_xOffset="";_width="";_height="";_isDisposed=!1;attach(r){let e=r.getConfig();this._overlayRef=r,this._width&&!e.width&&r.updateSize({width:this._width}),this._height&&!e.height&&r.updateSize({height:this._height}),r.hostElement.classList.add(mL),this._isDisposed=!1}top(r=""){return this._bottomOffset="",this._topOffset=r,this._alignItems="flex-start",this}left(r=""){return this._xOffset=r,this._xPosition="left",this}bottom(r=""){return this._topOffset="",this._bottomOffset=r,this._alignItems="flex-end",this}right(r=""){return this._xOffset=r,this._xPosition="right",this}start(r=""){return this._xOffset=r,this._xPosition="start",this}end(r=""){return this._xOffset=r,this._xPosition="end",this}width(r=""){return this._overlayRef?this._overlayRef.updateSize({width:r}):this._width=r,this}height(r=""){return this._overlayRef?this._overlayRef.updateSize({height:r}):this._height=r,this}centerHorizontally(r=""){return this.left(r),this._xPosition="center",this}centerVertically(r=""){return this.top(r),this._alignItems="center",this}apply(){if(!this._overlayRef||!this._overlayRef.hasAttached())return;let r=this._overlayRef.overlayElement.style,e=this._overlayRef.hostElement.style,s=this._overlayRef.getConfig(),{width:u,height:i,maxWidth:E,maxHeight:L}=s,j=(u==="100%"||u==="100vw")&&(!E||E==="100%"||E==="100vw"),Y=(i==="100%"||i==="100vh")&&(!L||L==="100%"||L==="100vh"),oe=this._xPosition,Ee=this._xOffset,Ye=this._overlayRef.getConfig().direction==="rtl",Ne="",ct="",bt="";j?bt="flex-start":oe==="center"?(bt="center",Ye?ct=Ee:Ne=Ee):Ye?oe==="left"||oe==="end"?(bt="flex-end",Ne=Ee):(oe==="right"||oe==="start")&&(bt="flex-start",ct=Ee):oe==="left"||oe==="start"?(bt="flex-start",Ne=Ee):(oe==="right"||oe==="end")&&(bt="flex-end",ct=Ee),r.position=this._cssPosition,r.marginLeft=j?"0":Ne,r.marginTop=Y?"0":this._topOffset,r.marginBottom=this._bottomOffset,r.marginRight=j?"0":ct,e.justifyContent=bt,e.alignItems=Y?"flex-start":this._alignItems}dispose(){if(this._isDisposed||!this._overlayRef)return;let r=this._overlayRef.overlayElement.style,e=this._overlayRef.hostElement,s=e.style;e.classList.remove(mL),s.justifyContent=s.alignItems=r.marginTop=r.marginBottom=r.marginLeft=r.marginRight=r.position="",this._overlayRef=null,this._isDisposed=!0}},p6=(()=>{class n{_viewportRuler=we(pw);_document=we(Un);_platform=we(Ur);_overlayContainer=we(_L);constructor(){}global(){return new ET}flexibleConnectedTo(e){return new CT(e,this._viewportRuler,this._document,this._platform,this._overlayContainer)}static \u0275fac=function(s){return new(s||n)};static \u0275prov=xt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),pd=(()=>{class n{scrollStrategies=we(c6);_overlayContainer=we(_L);_positionBuilder=we(p6);_keyboardDispatcher=we(u6);_injector=we(Jn);_ngZone=we(ln);_document=we(Un);_directionality=we(bv);_location=we(Th);_outsideClickDispatcher=we(d6);_animationsModuleType=we(_a,{optional:!0});_idGenerator=we(Cp);_renderer=we(ko).createRenderer(null,null);_appRef;_styleLoader=we(Jl);constructor(){}create(e){this._styleLoader.load(yL);let s=this._createHostElement(),u=this._createPaneElement(s),i=this._createPortalOutlet(u),E=new Cv(e);return E.direction=E.direction||this._directionality.value,new wT(i,s,u,E,this._ngZone,this._keyboardDispatcher,this._document,this._location,this._outsideClickDispatcher,this._animationsModuleType==="NoopAnimations",this._injector.get(jr),this._renderer)}position(){return this._positionBuilder}_createPaneElement(e){let s=this._document.createElement("div");return s.id=this._idGenerator.getId("cdk-overlay-"),s.classList.add("cdk-overlay-pane"),e.appendChild(s),s}_createHostElement(){let e=this._document.createElement("div");return this._overlayContainer.getContainerElement().appendChild(e),e}_createPortalOutlet(e){return this._appRef||(this._appRef=this._injector.get(js)),new dw(e,null,this._appRef,this._injector,this._document)}static \u0275fac=function(s){return new(s||n)};static \u0275prov=xt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var m6=new dt("cdk-connected-overlay-scroll-strategy",{providedIn:"root",factory:()=>{let n=we(pd);return()=>n.scrollStrategies.reposition()}});function g6(n){return()=>n.scrollStrategies.reposition()}var y6={provide:m6,deps:[pd],useFactory:g6},gw=(()=>{class n{static \u0275fac=function(s){return new(s||n)};static \u0275mod=en({type:n});static \u0275inj=Jt({providers:[pd,y6],imports:[Rh,hw,mT,mT]})}return n})();function _6(n,r){if(n&1){let e=hp();pn(0,"div",1)(1,"button",2),cr("click",function(){wh(e);let u=xa();return Ch(u.action())}),Li(2),on()()}if(n&2){let e=xa();Xn(2),Xo(" ",e.data.action," ")}}var v6=["label"];function b6(n,r){}var x6=Math.pow(2,31)-1,Ev=class{_overlayRef;instance;containerInstance;_afterDismissed=new _n;_afterOpened=new _n;_onAction=new _n;_durationTimeoutId;_dismissedByAction=!1;constructor(r,e){this._overlayRef=e,this.containerInstance=r,r._onExit.subscribe(()=>this._finishDismiss())}dismiss(){this._afterDismissed.closed||this.containerInstance.exit(),clearTimeout(this._durationTimeoutId)}dismissWithAction(){this._onAction.closed||(this._dismissedByAction=!0,this._onAction.next(),this._onAction.complete(),this.dismiss()),clearTimeout(this._durationTimeoutId)}closeWithAction(){this.dismissWithAction()}_dismissAfter(r){this._durationTimeoutId=setTimeout(()=>this.dismiss(),Math.min(r,x6))}_open(){this._afterOpened.closed||(this._afterOpened.next(),this._afterOpened.complete())}_finishDismiss(){this._overlayRef.dispose(),this._onAction.closed||this._onAction.complete(),this._afterDismissed.next({dismissedByAction:this._dismissedByAction}),this._afterDismissed.complete(),this._dismissedByAction=!1}afterDismissed(){return this._afterDismissed}afterOpened(){return this.containerInstance._onEnter}onAction(){return this._onAction}},yw=new dt("MatSnackBarData"),Yg=class{politeness="assertive";announcementMessage="";viewContainerRef;duration=0;panelClass;direction;data=null;horizontalPosition="center";verticalPosition="bottom"},w6=(()=>{class n{static \u0275fac=function(s){return new(s||n)};static \u0275dir=Ni({type:n,selectors:[["","matSnackBarLabel",""]],hostAttrs:[1,"mat-mdc-snack-bar-label","mdc-snackbar__label"]})}return n})(),C6=(()=>{class n{static \u0275fac=function(s){return new(s||n)};static \u0275dir=Ni({type:n,selectors:[["","matSnackBarActions",""]],hostAttrs:[1,"mat-mdc-snack-bar-actions","mdc-snackbar__actions"]})}return n})(),E6=(()=>{class n{static \u0275fac=function(s){return new(s||n)};static \u0275dir=Ni({type:n,selectors:[["","matSnackBarAction",""]],hostAttrs:[1,"mat-mdc-snack-bar-action","mdc-snackbar__action"]})}return n})(),vL=(()=>{class n{snackBarRef=we(Ev);data=we(yw);constructor(){}action(){this.snackBarRef.dismissWithAction()}get hasAction(){return!!this.data.action}static \u0275fac=function(s){return new(s||n)};static \u0275cmp=Bn({type:n,selectors:[["simple-snack-bar"]],hostAttrs:[1,"mat-mdc-simple-snack-bar"],exportAs:["matSnackBar"],decls:3,vars:2,consts:[["matSnackBarLabel",""],["matSnackBarActions",""],["mat-button","","matSnackBarAction","",3,"click"]],template:function(s,u){s&1&&(pn(0,"div",0),Li(1),on(),qo(2,_6,3,1,"div",1)),s&2&&(Xn(),Xo(" ",u.data.message,`
`),Xn(),Mh(u.hasAction?2:-1))},dependencies:[lL,w6,C6,E6],styles:[".mat-mdc-simple-snack-bar{display:flex}"],encapsulation:2,changeDetection:0})}return n})(),DT="_mat-snack-bar-enter",MT="_mat-snack-bar-exit",D6=(()=>{class n extends Xg{_ngZone=we(ln);_elementRef=we(yi);_changeDetectorRef=we(ps);_platform=we(Ur);_rendersRef;_animationsDisabled=we(_a,{optional:!0})==="NoopAnimations";snackBarConfig=we(Yg);_document=we(Un);_trackedModals=new Set;_enterFallback;_exitFallback;_renders=new _n;_announceDelay=150;_announceTimeoutId;_destroyed=!1;_portalOutlet;_onAnnounce=new _n;_onExit=new _n;_onEnter=new _n;_animationState="void";_live;_label;_role;_liveElementId=we(Cp).getId("mat-snack-bar-container-live-");constructor(){super();let e=this.snackBarConfig;e.politeness==="assertive"&&!e.announcementMessage?this._live="assertive":e.politeness==="off"?this._live="off":this._live="polite",this._platform.FIREFOX&&(this._live==="polite"&&(this._role="status"),this._live==="assertive"&&(this._role="alert")),this._rendersRef=z_(()=>this._renders.next(),{manualCleanup:!0})}attachComponentPortal(e){this._assertNotAttached();let s=this._portalOutlet.attachComponentPortal(e);return this._afterPortalAttached(),s}attachTemplatePortal(e){this._assertNotAttached();let s=this._portalOutlet.attachTemplatePortal(e);return this._afterPortalAttached(),s}attachDomPortal=e=>{this._assertNotAttached();let s=this._portalOutlet.attachDomPortal(e);return this._afterPortalAttached(),s};onAnimationEnd(e){e===MT?this._completeExit():e===DT&&(clearTimeout(this._enterFallback),this._ngZone.run(()=>{this._onEnter.next(),this._onEnter.complete()}))}enter(){this._destroyed||(this._animationState="visible",this._changeDetectorRef.markForCheck(),this._changeDetectorRef.detectChanges(),this._screenReaderAnnounce(),this._animationsDisabled?this._renders.pipe(go(1)).subscribe(()=>{this._ngZone.run(()=>queueMicrotask(()=>this.onAnimationEnd(DT)))}):(clearTimeout(this._enterFallback),this._enterFallback=setTimeout(()=>{this._elementRef.nativeElement.classList.add("mat-snack-bar-fallback-visible"),this.onAnimationEnd(DT)},200)))}exit(){return this._destroyed?nn(void 0):(this._ngZone.run(()=>{this._animationState="hidden",this._changeDetectorRef.markForCheck(),this._elementRef.nativeElement.setAttribute("mat-exit",""),clearTimeout(this._announceTimeoutId),this._animationsDisabled?this._renders.pipe(go(1)).subscribe(()=>{this._ngZone.run(()=>queueMicrotask(()=>this.onAnimationEnd(MT)))}):(clearTimeout(this._exitFallback),this._exitFallback=setTimeout(()=>this.onAnimationEnd(MT),200))}),this._onExit)}ngOnDestroy(){this._destroyed=!0,this._clearFromModals(),this._completeExit(),this._renders.complete(),this._rendersRef.destroy()}_completeExit(){clearTimeout(this._exitFallback),queueMicrotask(()=>{this._onExit.next(),this._onExit.complete()})}_afterPortalAttached(){let e=this._elementRef.nativeElement,s=this.snackBarConfig.panelClass;s&&(Array.isArray(s)?s.forEach(E=>e.classList.add(E)):e.classList.add(s)),this._exposeToModals();let u=this._label.nativeElement,i="mdc-snackbar__label";u.classList.toggle(i,!u.querySelector(`.${i}`))}_exposeToModals(){let e=this._liveElementId,s=this._document.querySelectorAll('body > .cdk-overlay-container [aria-modal="true"]');for(let u=0;u<s.length;u++){let i=s[u],E=i.getAttribute("aria-owns");this._trackedModals.add(i),E?E.indexOf(e)===-1&&i.setAttribute("aria-owns",E+" "+e):i.setAttribute("aria-owns",e)}}_clearFromModals(){this._trackedModals.forEach(e=>{let s=e.getAttribute("aria-owns");if(s){let u=s.replace(this._liveElementId,"").trim();u.length>0?e.setAttribute("aria-owns",u):e.removeAttribute("aria-owns")}}),this._trackedModals.clear()}_assertNotAttached(){this._portalOutlet.hasAttached()}_screenReaderAnnounce(){this._announceTimeoutId||this._ngZone.runOutsideAngular(()=>{this._announceTimeoutId=setTimeout(()=>{if(this._destroyed)return;let e=this._elementRef.nativeElement,s=e.querySelector("[aria-hidden]"),u=e.querySelector("[aria-live]");if(s&&u){let i=null;this._platform.isBrowser&&document.activeElement instanceof HTMLElement&&s.contains(document.activeElement)&&(i=document.activeElement),s.removeAttribute("aria-hidden"),u.appendChild(s),i?.focus(),this._onAnnounce.next(),this._onAnnounce.complete()}},this._announceDelay)})}static \u0275fac=function(s){return new(s||n)};static \u0275cmp=Bn({type:n,selectors:[["mat-snack-bar-container"]],viewQuery:function(s,u){if(s&1&&(wa(pT,7),wa(v6,7)),s&2){let i;Gs(i=Ws())&&(u._portalOutlet=i.first),Gs(i=Ws())&&(u._label=i.first)}},hostAttrs:[1,"mdc-snackbar","mat-mdc-snack-bar-container"],hostVars:6,hostBindings:function(s,u){s&1&&cr("animationend",function(E){return u.onAnimationEnd(E.animationName)})("animationcancel",function(E){return u.onAnimationEnd(E.animationName)}),s&2&&mr("mat-snack-bar-container-enter",u._animationState==="visible")("mat-snack-bar-container-exit",u._animationState==="hidden")("mat-snack-bar-container-animations-enabled",!u._animationsDisabled)},features:[Kc],decls:6,vars:3,consts:[["label",""],[1,"mdc-snackbar__surface","mat-mdc-snackbar-surface"],[1,"mat-mdc-snack-bar-label"],["aria-hidden","true"],["cdkPortalOutlet",""]],template:function(s,u){s&1&&(pn(0,"div",1)(1,"div",2,0)(3,"div",3),qo(4,b6,0,0,"ng-template",4),on(),Ui(5,"div"),on()()),s&2&&(Xn(5),co("aria-live",u._live)("role",u._role)("id",u._liveElementId))},dependencies:[pT],styles:["@keyframes _mat-snack-bar-enter{from{transform:scale(0.8);opacity:0}to{transform:scale(1);opacity:1}}@keyframes _mat-snack-bar-exit{from{opacity:1}to{opacity:0}}.mat-mdc-snack-bar-container{display:flex;align-items:center;justify-content:center;box-sizing:border-box;-webkit-tap-highlight-color:rgba(0,0,0,0);margin:8px}.mat-mdc-snack-bar-handset .mat-mdc-snack-bar-container{width:100vw}.mat-snack-bar-container-animations-enabled{opacity:0}.mat-snack-bar-container-animations-enabled.mat-snack-bar-fallback-visible{opacity:1}.mat-snack-bar-container-animations-enabled.mat-snack-bar-container-enter{animation:_mat-snack-bar-enter 150ms cubic-bezier(0, 0, 0.2, 1) forwards}.mat-snack-bar-container-animations-enabled.mat-snack-bar-container-exit{animation:_mat-snack-bar-exit 75ms cubic-bezier(0.4, 0, 1, 1) forwards}.mat-mdc-snackbar-surface{box-shadow:0px 3px 5px -1px rgba(0, 0, 0, 0.2), 0px 6px 10px 0px rgba(0, 0, 0, 0.14), 0px 1px 18px 0px rgba(0, 0, 0, 0.12);display:flex;align-items:center;justify-content:flex-start;box-sizing:border-box;padding-left:0;padding-right:8px}[dir=rtl] .mat-mdc-snackbar-surface{padding-right:0;padding-left:8px}.mat-mdc-snack-bar-container .mat-mdc-snackbar-surface{min-width:344px;max-width:672px}.mat-mdc-snack-bar-handset .mat-mdc-snackbar-surface{width:100%;min-width:0}@media(forced-colors: active){.mat-mdc-snackbar-surface{outline:solid 1px}}.mat-mdc-snack-bar-container .mat-mdc-snackbar-surface{color:var(--mdc-snackbar-supporting-text-color, var(--mat-sys-inverse-on-surface));border-radius:var(--mdc-snackbar-container-shape, var(--mat-sys-corner-extra-small));background-color:var(--mdc-snackbar-container-color, var(--mat-sys-inverse-surface))}.mdc-snackbar__label{width:100%;flex-grow:1;box-sizing:border-box;margin:0;padding:14px 8px 14px 16px}[dir=rtl] .mdc-snackbar__label{padding-left:8px;padding-right:16px}.mat-mdc-snack-bar-container .mdc-snackbar__label{font-family:var(--mdc-snackbar-supporting-text-font, var(--mat-sys-body-medium-font));font-size:var(--mdc-snackbar-supporting-text-size, var(--mat-sys-body-medium-size));font-weight:var(--mdc-snackbar-supporting-text-weight, var(--mat-sys-body-medium-weight));line-height:var(--mdc-snackbar-supporting-text-line-height, var(--mat-sys-body-medium-line-height))}.mat-mdc-snack-bar-actions{display:flex;flex-shrink:0;align-items:center;box-sizing:border-box}.mat-mdc-snack-bar-handset,.mat-mdc-snack-bar-container,.mat-mdc-snack-bar-label{flex:1 1 auto}.mat-mdc-snack-bar-container .mat-mdc-button.mat-mdc-snack-bar-action:not(:disabled).mat-unthemed{color:var(--mat-snack-bar-button-color, var(--mat-sys-inverse-primary))}.mat-mdc-snack-bar-container .mat-mdc-button.mat-mdc-snack-bar-action:not(:disabled){--mat-text-button-state-layer-color:currentColor;--mat-text-button-ripple-color:currentColor}.mat-mdc-snack-bar-container .mat-mdc-button.mat-mdc-snack-bar-action:not(:disabled) .mat-ripple-element{opacity:.1}"],encapsulation:2})}return n})();function M6(){return new Yg}var T6=new dt("mat-snack-bar-default-options",{providedIn:"root",factory:M6}),TT=(()=>{class n{_overlay=we(pd);_live=we(Y2);_injector=we(Jn);_breakpointObserver=we(Jx);_parentSnackBar=we(n,{optional:!0,skipSelf:!0});_defaultConfig=we(T6);_snackBarRefAtThisLevel=null;simpleSnackBarComponent=vL;snackBarContainerComponent=D6;handsetCssClass="mat-mdc-snack-bar-handset";get _openedSnackBarRef(){let e=this._parentSnackBar;return e?e._openedSnackBarRef:this._snackBarRefAtThisLevel}set _openedSnackBarRef(e){this._parentSnackBar?this._parentSnackBar._openedSnackBarRef=e:this._snackBarRefAtThisLevel=e}constructor(){}openFromComponent(e,s){return this._attach(e,s)}openFromTemplate(e,s){return this._attach(e,s)}open(e,s="",u){let i=ut(ut({},this._defaultConfig),u);return i.data={message:e,action:s},i.announcementMessage===e&&(i.announcementMessage=void 0),this.openFromComponent(this.simpleSnackBarComponent,i)}dismiss(){this._openedSnackBarRef&&this._openedSnackBarRef.dismiss()}ngOnDestroy(){this._snackBarRefAtThisLevel&&this._snackBarRefAtThisLevel.dismiss()}_attachSnackBarContainer(e,s){let u=s&&s.viewContainerRef&&s.viewContainerRef.injector,i=Jn.create({parent:u||this._injector,providers:[{provide:Yg,useValue:s}]}),E=new Ph(this.snackBarContainerComponent,s.viewContainerRef,i),L=e.attach(E);return L.instance.snackBarConfig=s,L.instance}_attach(e,s){let u=ut(ut(ut({},new Yg),this._defaultConfig),s),i=this._createOverlay(u),E=this._attachSnackBarContainer(i,u),L=new Ev(E,i);if(e instanceof Xa){let j=new Zg(e,null,{$implicit:u.data,snackBarRef:L});L.instance=E.attachTemplatePortal(j)}else{let j=this._createInjector(u,L),Y=new Ph(e,void 0,j),oe=E.attachComponentPortal(Y);L.instance=oe.instance}return this._breakpointObserver.observe(U2.HandsetPortrait).pipe(Br(i.detachments())).subscribe(j=>{i.overlayElement.classList.toggle(this.handsetCssClass,j.matches)}),u.announcementMessage&&E._onAnnounce.subscribe(()=>{this._live.announce(u.announcementMessage,u.politeness)}),this._animateSnackBar(L,u),this._openedSnackBarRef=L,this._openedSnackBarRef}_animateSnackBar(e,s){e.afterDismissed().subscribe(()=>{this._openedSnackBarRef==e&&(this._openedSnackBarRef=null),s.announcementMessage&&this._live.clear()}),s.duration&&s.duration>0&&e.afterOpened().subscribe(()=>e._dismissAfter(s.duration)),this._openedSnackBarRef?(this._openedSnackBarRef.afterDismissed().subscribe(()=>{e.containerInstance.enter()}),this._openedSnackBarRef.dismiss()):e.containerInstance.enter()}_createOverlay(e){let s=new Cv;s.direction=e.direction;let u=this._overlay.position().global(),i=e.direction==="rtl",E=e.horizontalPosition==="left"||e.horizontalPosition==="start"&&!i||e.horizontalPosition==="end"&&i,L=!E&&e.horizontalPosition!=="center";return E?u.left("0"):L?u.right("0"):u.centerHorizontally(),e.verticalPosition==="top"?u.top("0"):u.bottom("0"),s.positionStrategy=u,this._overlay.create(s)}_createInjector(e,s){let u=e&&e.viewContainerRef&&e.viewContainerRef.injector;return Jn.create({parent:u||this._injector,providers:[{provide:Ev,useValue:s},{provide:yw,useValue:e.data}]})}static \u0275fac=function(s){return new(s||n)};static \u0275prov=xt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var bL=(()=>{class n{static \u0275fac=function(s){return new(s||n)};static \u0275mod=en({type:n});static \u0275inj=Jt({providers:[TT],imports:[gw,hw,uw,$i,vL,$i]})}return n})();var _w=class n{constructor(r){this.data=r}static \u0275fac=function(e){return new(e||n)(Hi(yw))};static \u0275cmp=Bn({type:n,selectors:[["app-custom-snackbar"]],standalone:!1,decls:2,vars:2,consts:[[3,"ngClass"]],template:function(e,s){e&1&&(pn(0,"div",0),Li(1),on()),e&2&&(Gi("ngClass",s.data.panelClass),Xn(),Xo(" ",s.data.message," "))},dependencies:[Cg],styles:[".success-snackbar[_ngcontent-%COMP%]{background-color:#4caf50;color:#fff;padding:16px}.error-snackbar[_ngcontent-%COMP%]{background-color:#f44336;color:#fff;padding:16px}.warning-snackbar[_ngcontent-%COMP%]{background-color:#ffeb3b;color:#000;padding:16px}.info-snackbar[_ngcontent-%COMP%]{background-color:#2196f3;color:#fff;padding:16px}"]})};var Oh=class n{constructor(r){this.snackBar=r}showNotification(r,e,s=2500){let u={duration:s,horizontalPosition:"end",verticalPosition:"top",data:{message:r,panelClass:e},panelClass:"custom-snackbar-panel"};this.snackBar.openFromComponent(_w,u)}success(r,e){this.showNotification(r,"success-snackbar",e)}error(r,e){this.showNotification(r,"error-snackbar",e)}warning(r,e){this.showNotification(r,"warning-snackbar",e)}info(r,e){this.showNotification(r,"info-snackbar",e)}static \u0275fac=function(e){return new(e||n)(St(TT))};static \u0275prov=xt({token:n,factory:n.\u0275fac,providedIn:"root"})};var wL=new dt("");var CL=new dt("");var S6={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},vne=Cn(ut({},S6),{"[class.ng-submitted]":"isSubmitted"});var A6=new dt("",{providedIn:"root",factory:()=>EL}),EL="always";var k6=(()=>{class n{static \u0275fac=function(s){return new(s||n)};static \u0275mod=en({type:n});static \u0275inj=Jt({})}return n})();var DL=(()=>{class n{static withConfig(e){return{ngModule:n,providers:[{provide:A6,useValue:e.callSetDisabledState??EL}]}}static \u0275fac=function(s){return new(s||n)};static \u0275mod=en({type:n});static \u0275inj=Jt({imports:[k6]})}return n})();var R6=["switch"],P6=["*"];function O6(n,r){n&1&&(pn(0,"span",10),pk(),pn(1,"svg",12),Ui(2,"path",13),on(),pn(3,"svg",14),Ui(4,"path",15),on()())}var L6=new dt("mat-slide-toggle-default-options",{providedIn:"root",factory:()=>({disableToggleValue:!1,hideIcon:!1,disabledInteractive:!1})}),F6={provide:wL,useExisting:up(()=>bw),multi:!0},vw=class{source;checked;constructor(r,e){this.source=r,this.checked=e}},bw=(()=>{class n{_elementRef=we(yi);_focusMonitor=we(qg);_changeDetectorRef=we(ps);defaults=we(L6);_onChange=e=>{};_onTouched=()=>{};_validatorOnChange=()=>{};_uniqueId;_checked=!1;_createChangeEvent(e){return new vw(this,e)}_labelId;get buttonId(){return`${this.id||this._uniqueId}-button`}_switchElement;focus(){this._switchElement.nativeElement.focus()}_noopAnimations;_focused;name=null;id;labelPosition="after";ariaLabel=null;ariaLabelledby=null;ariaDescribedby;required;color;disabled=!1;disableRipple=!1;tabIndex=0;get checked(){return this._checked}set checked(e){this._checked=e,this._changeDetectorRef.markForCheck()}hideIcon;disabledInteractive;change=new Dt;toggleChange=new Dt;get inputId(){return`${this.id||this._uniqueId}-input`}constructor(){we(Jl).load(cw);let e=we(new sg("tabindex"),{optional:!0}),s=this.defaults,u=we(_a,{optional:!0});this.tabIndex=e==null?0:parseInt(e)||0,this.color=s.color||"accent",this._noopAnimations=u==="NoopAnimations",this.id=this._uniqueId=we(Cp).getId("mat-mdc-slide-toggle-"),this.hideIcon=s.hideIcon??!1,this.disabledInteractive=s.disabledInteractive??!1,this._labelId=this._uniqueId+"-label"}ngAfterContentInit(){this._focusMonitor.monitor(this._elementRef,!0).subscribe(e=>{e==="keyboard"||e==="program"?(this._focused=!0,this._changeDetectorRef.markForCheck()):e||Promise.resolve().then(()=>{this._focused=!1,this._onTouched(),this._changeDetectorRef.markForCheck()})})}ngOnChanges(e){e.required&&this._validatorOnChange()}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef)}writeValue(e){this.checked=!!e}registerOnChange(e){this._onChange=e}registerOnTouched(e){this._onTouched=e}validate(e){return this.required&&e.value!==!0?{required:!0}:null}registerOnValidatorChange(e){this._validatorOnChange=e}setDisabledState(e){this.disabled=e,this._changeDetectorRef.markForCheck()}toggle(){this.checked=!this.checked,this._onChange(this.checked)}_emitChangeEvent(){this._onChange(this.checked),this.change.emit(this._createChangeEvent(this.checked))}_handleClick(){this.disabled||(this.toggleChange.emit(),this.defaults.disableToggleValue||(this.checked=!this.checked,this._onChange(this.checked),this.change.emit(new vw(this,this.checked))))}_getAriaLabelledBy(){return this.ariaLabelledby?this.ariaLabelledby:this.ariaLabel?null:this._labelId}static \u0275fac=function(s){return new(s||n)};static \u0275cmp=Bn({type:n,selectors:[["mat-slide-toggle"]],viewQuery:function(s,u){if(s&1&&wa(R6,5),s&2){let i;Gs(i=Ws())&&(u._switchElement=i.first)}},hostAttrs:[1,"mat-mdc-slide-toggle"],hostVars:13,hostBindings:function(s,u){s&2&&(vg("id",u.id),co("tabindex",null)("aria-label",null)("name",null)("aria-labelledby",null),Dh(u.color?"mat-"+u.color:""),mr("mat-mdc-slide-toggle-focused",u._focused)("mat-mdc-slide-toggle-checked",u.checked)("_mat-animation-noopable",u._noopAnimations))},inputs:{name:"name",id:"id",labelPosition:"labelPosition",ariaLabel:[0,"aria-label","ariaLabel"],ariaLabelledby:[0,"aria-labelledby","ariaLabelledby"],ariaDescribedby:[0,"aria-describedby","ariaDescribedby"],required:[2,"required","required",Vr],color:"color",disabled:[2,"disabled","disabled",Vr],disableRipple:[2,"disableRipple","disableRipple",Vr],tabIndex:[2,"tabIndex","tabIndex",e=>e==null?0:dx(e)],checked:[2,"checked","checked",Vr],hideIcon:[2,"hideIcon","hideIcon",Vr],disabledInteractive:[2,"disabledInteractive","disabledInteractive",Vr]},outputs:{change:"change",toggleChange:"toggleChange"},exportAs:["matSlideToggle"],features:[Ca([F6,{provide:CL,useExisting:n,multi:!0}]),hs],ngContentSelectors:P6,decls:13,vars:27,consts:[["switch",""],["mat-internal-form-field","",3,"labelPosition"],["role","switch","type","button",1,"mdc-switch",3,"click","tabIndex","disabled"],[1,"mdc-switch__track"],[1,"mdc-switch__handle-track"],[1,"mdc-switch__handle"],[1,"mdc-switch__shadow"],[1,"mdc-elevation-overlay"],[1,"mdc-switch__ripple"],["mat-ripple","",1,"mat-mdc-slide-toggle-ripple","mat-focus-indicator",3,"matRippleTrigger","matRippleDisabled","matRippleCentered"],[1,"mdc-switch__icons"],[1,"mdc-label",3,"click","for"],["viewBox","0 0 24 24","aria-hidden","true",1,"mdc-switch__icon","mdc-switch__icon--on"],["d","M19.69,5.23L8.96,15.96l-4.23-4.23L2.96,13.5l6,6L21.46,7L19.69,5.23z"],["viewBox","0 0 24 24","aria-hidden","true",1,"mdc-switch__icon","mdc-switch__icon--off"],["d","M20 13H4v-2h16v2z"]],template:function(s,u){if(s&1){let i=hp();Hs(),pn(0,"div",1)(1,"button",2,0),cr("click",function(){return wh(i),Ch(u._handleClick())}),Ui(3,"span",3),pn(4,"span",4)(5,"span",5)(6,"span",6),Ui(7,"span",7),on(),pn(8,"span",8),Ui(9,"span",9),on(),qo(10,O6,5,0,"span",10),on()()(),pn(11,"label",11),cr("click",function(L){return wh(i),Ch(L.stopPropagation())}),Zo(12),on()()}if(s&2){let i=mD(2);Gi("labelPosition",u.labelPosition),Xn(),mr("mdc-switch--selected",u.checked)("mdc-switch--unselected",!u.checked)("mdc-switch--checked",u.checked)("mdc-switch--disabled",u.disabled)("mat-mdc-slide-toggle-disabled-interactive",u.disabledInteractive),Gi("tabIndex",u.disabled&&!u.disabledInteractive?-1:u.tabIndex)("disabled",u.disabled&&!u.disabledInteractive),co("id",u.buttonId)("name",u.name)("aria-label",u.ariaLabel)("aria-labelledby",u._getAriaLabelledBy())("aria-describedby",u.ariaDescribedby)("aria-required",u.required||null)("aria-checked",u.checked)("aria-disabled",u.disabled&&u.disabledInteractive?"true":null),Xn(8),Gi("matRippleTrigger",i)("matRippleDisabled",u.disableRipple||u.disabled)("matRippleCentered",!0),Xn(),Mh(u.hideIcon?-1:10),Xn(),Gi("for",u.buttonId),co("id",u._labelId)}},dependencies:[rL,aL],styles:['.mdc-switch{align-items:center;background:none;border:none;cursor:pointer;display:inline-flex;flex-shrink:0;margin:0;outline:none;overflow:visible;padding:0;position:relative;width:var(--mdc-switch-track-width, 52px)}.mdc-switch.mdc-switch--disabled{cursor:default;pointer-events:none}.mdc-switch.mat-mdc-slide-toggle-disabled-interactive{pointer-events:auto}.mdc-switch__track{overflow:hidden;position:relative;width:100%;height:var(--mdc-switch-track-height, 32px);border-radius:var(--mdc-switch-track-shape, var(--mat-sys-corner-full))}.mdc-switch--disabled.mdc-switch .mdc-switch__track{opacity:var(--mdc-switch-disabled-track-opacity, 0.12)}.mdc-switch__track::before,.mdc-switch__track::after{border:1px solid rgba(0,0,0,0);border-radius:inherit;box-sizing:border-box;content:"";height:100%;left:0;position:absolute;width:100%;border-width:var(--mat-switch-track-outline-width, 2px);border-color:var(--mat-switch-track-outline-color, var(--mat-sys-outline))}.mdc-switch--selected .mdc-switch__track::before,.mdc-switch--selected .mdc-switch__track::after{border-width:var(--mat-switch-selected-track-outline-width, 2px);border-color:var(--mat-switch-selected-track-outline-color, transparent)}.mdc-switch--disabled .mdc-switch__track::before,.mdc-switch--disabled .mdc-switch__track::after{border-width:var(--mat-switch-disabled-unselected-track-outline-width, 2px);border-color:var(--mat-switch-disabled-unselected-track-outline-color, var(--mat-sys-on-surface))}@media(forced-colors: active){.mdc-switch__track{border-color:currentColor}}.mdc-switch__track::before{transition:transform 75ms 0ms cubic-bezier(0, 0, 0.2, 1);transform:translateX(0);background:var(--mdc-switch-unselected-track-color, var(--mat-sys-surface-variant))}.mdc-switch--selected .mdc-switch__track::before{transition:transform 75ms 0ms cubic-bezier(0.4, 0, 0.6, 1);transform:translateX(100%)}[dir=rtl] .mdc-switch--selected .mdc-switch--selected .mdc-switch__track::before{transform:translateX(-100%)}.mdc-switch--selected .mdc-switch__track::before{opacity:var(--mat-switch-hidden-track-opacity, 0);transition:var(--mat-switch-hidden-track-transition, opacity 75ms)}.mdc-switch--unselected .mdc-switch__track::before{opacity:var(--mat-switch-visible-track-opacity, 1);transition:var(--mat-switch-visible-track-transition, opacity 75ms)}.mdc-switch:enabled:hover:not(:focus):not(:active) .mdc-switch__track::before{background:var(--mdc-switch-unselected-hover-track-color, var(--mat-sys-surface-variant))}.mdc-switch:enabled:focus:not(:active) .mdc-switch__track::before{background:var(--mdc-switch-unselected-focus-track-color, var(--mat-sys-surface-variant))}.mdc-switch:enabled:active .mdc-switch__track::before{background:var(--mdc-switch-unselected-pressed-track-color, var(--mat-sys-surface-variant))}.mat-mdc-slide-toggle-disabled-interactive.mdc-switch--disabled:hover:not(:focus):not(:active) .mdc-switch__track::before,.mat-mdc-slide-toggle-disabled-interactive.mdc-switch--disabled:focus:not(:active) .mdc-switch__track::before,.mat-mdc-slide-toggle-disabled-interactive.mdc-switch--disabled:active .mdc-switch__track::before,.mdc-switch.mdc-switch--disabled .mdc-switch__track::before{background:var(--mdc-switch-disabled-unselected-track-color, var(--mat-sys-surface-variant))}.mdc-switch__track::after{transform:translateX(-100%);background:var(--mdc-switch-selected-track-color, var(--mat-sys-primary))}[dir=rtl] .mdc-switch__track::after{transform:translateX(100%)}.mdc-switch--selected .mdc-switch__track::after{transform:translateX(0)}.mdc-switch--selected .mdc-switch__track::after{opacity:var(--mat-switch-visible-track-opacity, 1);transition:var(--mat-switch-visible-track-transition, opacity 75ms)}.mdc-switch--unselected .mdc-switch__track::after{opacity:var(--mat-switch-hidden-track-opacity, 0);transition:var(--mat-switch-hidden-track-transition, opacity 75ms)}.mdc-switch:enabled:hover:not(:focus):not(:active) .mdc-switch__track::after{background:var(--mdc-switch-selected-hover-track-color, var(--mat-sys-primary))}.mdc-switch:enabled:focus:not(:active) .mdc-switch__track::after{background:var(--mdc-switch-selected-focus-track-color, var(--mat-sys-primary))}.mdc-switch:enabled:active .mdc-switch__track::after{background:var(--mdc-switch-selected-pressed-track-color, var(--mat-sys-primary))}.mat-mdc-slide-toggle-disabled-interactive.mdc-switch--disabled:hover:not(:focus):not(:active) .mdc-switch__track::after,.mat-mdc-slide-toggle-disabled-interactive.mdc-switch--disabled:focus:not(:active) .mdc-switch__track::after,.mat-mdc-slide-toggle-disabled-interactive.mdc-switch--disabled:active .mdc-switch__track::after,.mdc-switch.mdc-switch--disabled .mdc-switch__track::after{background:var(--mdc-switch-disabled-selected-track-color, var(--mat-sys-on-surface))}.mdc-switch__handle-track{height:100%;pointer-events:none;position:absolute;top:0;transition:transform 75ms 0ms cubic-bezier(0.4, 0, 0.2, 1);left:0;right:auto;transform:translateX(0);width:calc(100% - var(--mdc-switch-handle-width))}[dir=rtl] .mdc-switch__handle-track{left:auto;right:0}.mdc-switch--selected .mdc-switch__handle-track{transform:translateX(100%)}[dir=rtl] .mdc-switch--selected .mdc-switch__handle-track{transform:translateX(-100%)}.mdc-switch__handle{display:flex;pointer-events:auto;position:absolute;top:50%;transform:translateY(-50%);left:0;right:auto;transition:width 75ms cubic-bezier(0.4, 0, 0.2, 1),height 75ms cubic-bezier(0.4, 0, 0.2, 1),margin 75ms cubic-bezier(0.4, 0, 0.2, 1);width:var(--mdc-switch-handle-width);height:var(--mdc-switch-handle-height);border-radius:var(--mdc-switch-handle-shape, var(--mat-sys-corner-full))}[dir=rtl] .mdc-switch__handle{left:auto;right:0}.mat-mdc-slide-toggle .mdc-switch--unselected .mdc-switch__handle{width:var(--mat-switch-unselected-handle-size, 16px);height:var(--mat-switch-unselected-handle-size, 16px);margin:var(--mat-switch-unselected-handle-horizontal-margin, 0 8px)}.mat-mdc-slide-toggle .mdc-switch--unselected .mdc-switch__handle:has(.mdc-switch__icons){margin:var(--mat-switch-unselected-with-icon-handle-horizontal-margin, 0 4px)}.mat-mdc-slide-toggle .mdc-switch--selected .mdc-switch__handle{width:var(--mat-switch-selected-handle-size, 24px);height:var(--mat-switch-selected-handle-size, 24px);margin:var(--mat-switch-selected-handle-horizontal-margin, 0 24px)}.mat-mdc-slide-toggle .mdc-switch--selected .mdc-switch__handle:has(.mdc-switch__icons){margin:var(--mat-switch-selected-with-icon-handle-horizontal-margin, 0 24px)}.mat-mdc-slide-toggle .mdc-switch__handle:has(.mdc-switch__icons){width:var(--mat-switch-with-icon-handle-size, 24px);height:var(--mat-switch-with-icon-handle-size, 24px)}.mat-mdc-slide-toggle .mdc-switch:active:not(.mdc-switch--disabled) .mdc-switch__handle{width:var(--mat-switch-pressed-handle-size, 28px);height:var(--mat-switch-pressed-handle-size, 28px)}.mat-mdc-slide-toggle .mdc-switch--selected:active:not(.mdc-switch--disabled) .mdc-switch__handle{margin:var(--mat-switch-selected-pressed-handle-horizontal-margin, 0 22px)}.mat-mdc-slide-toggle .mdc-switch--unselected:active:not(.mdc-switch--disabled) .mdc-switch__handle{margin:var(--mat-switch-unselected-pressed-handle-horizontal-margin, 0 2px)}.mdc-switch--disabled.mdc-switch--selected .mdc-switch__handle::after{opacity:var(--mat-switch-disabled-selected-handle-opacity, 1)}.mdc-switch--disabled.mdc-switch--unselected .mdc-switch__handle::after{opacity:var(--mat-switch-disabled-unselected-handle-opacity, 0.38)}.mdc-switch__handle::before,.mdc-switch__handle::after{border:1px solid rgba(0,0,0,0);border-radius:inherit;box-sizing:border-box;content:"";width:100%;height:100%;left:0;position:absolute;top:0;transition:background-color 75ms 0ms cubic-bezier(0.4, 0, 0.2, 1),border-color 75ms 0ms cubic-bezier(0.4, 0, 0.2, 1);z-index:-1}@media(forced-colors: active){.mdc-switch__handle::before,.mdc-switch__handle::after{border-color:currentColor}}.mdc-switch--selected:enabled .mdc-switch__handle::after{background:var(--mdc-switch-selected-handle-color, var(--mat-sys-on-primary))}.mdc-switch--selected:enabled:hover:not(:focus):not(:active) .mdc-switch__handle::after{background:var(--mdc-switch-selected-hover-handle-color, var(--mat-sys-primary-container))}.mdc-switch--selected:enabled:focus:not(:active) .mdc-switch__handle::after{background:var(--mdc-switch-selected-focus-handle-color, var(--mat-sys-primary-container))}.mdc-switch--selected:enabled:active .mdc-switch__handle::after{background:var(--mdc-switch-selected-pressed-handle-color, var(--mat-sys-primary-container))}.mat-mdc-slide-toggle-disabled-interactive.mdc-switch--disabled.mdc-switch--selected:hover:not(:focus):not(:active) .mdc-switch__handle::after,.mat-mdc-slide-toggle-disabled-interactive.mdc-switch--disabled.mdc-switch--selected:focus:not(:active) .mdc-switch__handle::after,.mat-mdc-slide-toggle-disabled-interactive.mdc-switch--disabled.mdc-switch--selected:active .mdc-switch__handle::after,.mdc-switch--selected.mdc-switch--disabled .mdc-switch__handle::after{background:var(--mdc-switch-disabled-selected-handle-color, var(--mat-sys-surface))}.mdc-switch--unselected:enabled .mdc-switch__handle::after{background:var(--mdc-switch-unselected-handle-color, var(--mat-sys-outline))}.mdc-switch--unselected:enabled:hover:not(:focus):not(:active) .mdc-switch__handle::after{background:var(--mdc-switch-unselected-hover-handle-color, var(--mat-sys-on-surface-variant))}.mdc-switch--unselected:enabled:focus:not(:active) .mdc-switch__handle::after{background:var(--mdc-switch-unselected-focus-handle-color, var(--mat-sys-on-surface-variant))}.mdc-switch--unselected:enabled:active .mdc-switch__handle::after{background:var(--mdc-switch-unselected-pressed-handle-color, var(--mat-sys-on-surface-variant))}.mdc-switch--unselected.mdc-switch--disabled .mdc-switch__handle::after{background:var(--mdc-switch-disabled-unselected-handle-color, var(--mat-sys-on-surface))}.mdc-switch__handle::before{background:var(--mdc-switch-handle-surface-color)}.mdc-switch__shadow{border-radius:inherit;bottom:0;left:0;position:absolute;right:0;top:0}.mdc-switch:enabled .mdc-switch__shadow{box-shadow:var(--mdc-switch-handle-elevation-shadow)}.mat-mdc-slide-toggle-disabled-interactive.mdc-switch--disabled:hover:not(:focus):not(:active) .mdc-switch__shadow,.mat-mdc-slide-toggle-disabled-interactive.mdc-switch--disabled:focus:not(:active) .mdc-switch__shadow,.mat-mdc-slide-toggle-disabled-interactive.mdc-switch--disabled:active .mdc-switch__shadow,.mdc-switch.mdc-switch--disabled .mdc-switch__shadow{box-shadow:var(--mdc-switch-disabled-handle-elevation-shadow)}.mdc-switch__ripple{left:50%;position:absolute;top:50%;transform:translate(-50%, -50%);z-index:-1;width:var(--mdc-switch-state-layer-size, 40px);height:var(--mdc-switch-state-layer-size, 40px)}.mdc-switch__ripple::after{content:"";opacity:0}.mdc-switch--disabled .mdc-switch__ripple::after{display:none}.mat-mdc-slide-toggle-disabled-interactive .mdc-switch__ripple::after{display:block}.mdc-switch:hover .mdc-switch__ripple::after{opacity:.04;transition:75ms opacity cubic-bezier(0, 0, 0.2, 1)}.mat-mdc-slide-toggle.mat-mdc-slide-toggle-focused .mdc-switch .mdc-switch__ripple::after{opacity:.12}.mat-mdc-slide-toggle-disabled-interactive.mdc-switch--disabled:enabled:focus .mdc-switch__ripple::after,.mat-mdc-slide-toggle-disabled-interactive.mdc-switch--disabled:enabled:active .mdc-switch__ripple::after,.mat-mdc-slide-toggle-disabled-interactive.mdc-switch--disabled:enabled:hover:not(:focus) .mdc-switch__ripple::after,.mdc-switch--unselected:enabled:hover:not(:focus) .mdc-switch__ripple::after{background:var(--mdc-switch-unselected-hover-state-layer-color, var(--mat-sys-on-surface))}.mdc-switch--unselected:enabled:focus .mdc-switch__ripple::after{background:var(--mdc-switch-unselected-focus-state-layer-color, var(--mat-sys-on-surface))}.mdc-switch--unselected:enabled:active .mdc-switch__ripple::after{background:var(--mdc-switch-unselected-pressed-state-layer-color, var(--mat-sys-on-surface));opacity:var(--mdc-switch-unselected-pressed-state-layer-opacity, var(--mat-sys-pressed-state-layer-opacity));transition:opacity 75ms linear}.mdc-switch--selected:enabled:hover:not(:focus) .mdc-switch__ripple::after{background:var(--mdc-switch-selected-hover-state-layer-color, var(--mat-sys-primary))}.mdc-switch--selected:enabled:focus .mdc-switch__ripple::after{background:var(--mdc-switch-selected-focus-state-layer-color, var(--mat-sys-primary))}.mdc-switch--selected:enabled:active .mdc-switch__ripple::after{background:var(--mdc-switch-selected-pressed-state-layer-color, var(--mat-sys-primary));opacity:var(--mdc-switch-selected-pressed-state-layer-opacity, var(--mat-sys-pressed-state-layer-opacity));transition:opacity 75ms linear}.mdc-switch__icons{position:relative;height:100%;width:100%;z-index:1;transform:translateZ(0)}.mdc-switch--disabled.mdc-switch--unselected .mdc-switch__icons{opacity:var(--mdc-switch-disabled-unselected-icon-opacity, 0.38)}.mdc-switch--disabled.mdc-switch--selected .mdc-switch__icons{opacity:var(--mdc-switch-disabled-selected-icon-opacity, 0.38)}.mdc-switch__icon{bottom:0;left:0;margin:auto;position:absolute;right:0;top:0;opacity:0;transition:opacity 30ms 0ms cubic-bezier(0.4, 0, 1, 1)}.mdc-switch--unselected .mdc-switch__icon{width:var(--mdc-switch-unselected-icon-size, 16px);height:var(--mdc-switch-unselected-icon-size, 16px);fill:var(--mdc-switch-unselected-icon-color, var(--mat-sys-surface-variant))}.mdc-switch--unselected.mdc-switch--disabled .mdc-switch__icon{fill:var(--mdc-switch-disabled-unselected-icon-color, var(--mat-sys-surface-variant))}.mdc-switch--selected .mdc-switch__icon{width:var(--mdc-switch-selected-icon-size, 16px);height:var(--mdc-switch-selected-icon-size, 16px);fill:var(--mdc-switch-selected-icon-color, var(--mat-sys-on-primary-container))}.mdc-switch--selected.mdc-switch--disabled .mdc-switch__icon{fill:var(--mdc-switch-disabled-selected-icon-color, var(--mat-sys-on-surface))}.mdc-switch--selected .mdc-switch__icon--on,.mdc-switch--unselected .mdc-switch__icon--off{opacity:1;transition:opacity 45ms 30ms cubic-bezier(0, 0, 0.2, 1)}.mat-mdc-slide-toggle{-webkit-user-select:none;user-select:none;display:inline-block;-webkit-tap-highlight-color:rgba(0,0,0,0);outline:0}.mat-mdc-slide-toggle .mat-mdc-slide-toggle-ripple,.mat-mdc-slide-toggle .mdc-switch__ripple::after{top:0;left:0;right:0;bottom:0;position:absolute;border-radius:50%;pointer-events:none}.mat-mdc-slide-toggle .mat-mdc-slide-toggle-ripple:not(:empty),.mat-mdc-slide-toggle .mdc-switch__ripple::after:not(:empty){transform:translateZ(0)}.mat-mdc-slide-toggle.mat-mdc-slide-toggle-focused .mat-focus-indicator::before{content:""}.mat-mdc-slide-toggle .mat-internal-form-field{color:var(--mat-switch-label-text-color, var(--mat-sys-on-surface));font-family:var(--mat-switch-label-text-font, var(--mat-sys-body-medium-font));line-height:var(--mat-switch-label-text-line-height, var(--mat-sys-body-medium-line-height));font-size:var(--mat-switch-label-text-size, var(--mat-sys-body-medium-size));letter-spacing:var(--mat-switch-label-text-tracking, var(--mat-sys-body-medium-tracking));font-weight:var(--mat-switch-label-text-weight, var(--mat-sys-body-medium-weight))}.mat-mdc-slide-toggle .mat-ripple-element{opacity:.12}.mat-mdc-slide-toggle .mat-focus-indicator::before{border-radius:50%}.mat-mdc-slide-toggle._mat-animation-noopable .mdc-switch__handle-track,.mat-mdc-slide-toggle._mat-animation-noopable .mdc-switch__icon,.mat-mdc-slide-toggle._mat-animation-noopable .mdc-switch__handle::before,.mat-mdc-slide-toggle._mat-animation-noopable .mdc-switch__handle::after,.mat-mdc-slide-toggle._mat-animation-noopable .mdc-switch__track::before,.mat-mdc-slide-toggle._mat-animation-noopable .mdc-switch__track::after{transition:none}.mat-mdc-slide-toggle .mdc-switch:enabled+.mdc-label{cursor:pointer}.mat-mdc-slide-toggle .mdc-switch--disabled+label{color:var(--mdc-switch-disabled-label-text-color)}'],encapsulation:2,changeDetection:0})}return n})();var ML=(()=>{class n{static \u0275fac=function(s){return new(s||n)};static \u0275mod=en({type:n});static \u0275inj=Jt({imports:[bw,$i,$i]})}return n})();var z6=["*"],xw;function B6(){if(xw===void 0&&(xw=null,typeof window<"u")){let n=window;n.trustedTypes!==void 0&&(xw=n.trustedTypes.createPolicy("angular#components",{createHTML:r=>r}))}return xw}function Dv(n){return B6()?.createHTML(n)||n}function TL(n){return Error(`Unable to find icon with the name "${n}"`)}function j6(){return Error("Could not find HttpClient for use with Angular Material icons. Please add provideHttpClient() to your providers.")}function IL(n){return Error(`The URL provided to MatIconRegistry was not trusted as a resource URL via Angular's DomSanitizer. Attempted URL was "${n}".`)}function SL(n){return Error(`The literal provided to MatIconRegistry was not trusted as safe HTML by Angular's DomSanitizer. Attempted literal was "${n}".`)}var md=class{url;svgText;options;svgElement;constructor(r,e,s){this.url=r,this.svgText=e,this.options=s}},V6=(()=>{class n{_httpClient;_sanitizer;_errorHandler;_document;_svgIconConfigs=new Map;_iconSetConfigs=new Map;_cachedIconsByUrl=new Map;_inProgressUrlFetches=new Map;_fontCssClassesByAlias=new Map;_resolvers=[];_defaultFontSetClass=["material-icons","mat-ligature-font"];constructor(e,s,u,i){this._httpClient=e,this._sanitizer=s,this._errorHandler=i,this._document=u}addSvgIcon(e,s,u){return this.addSvgIconInNamespace("",e,s,u)}addSvgIconLiteral(e,s,u){return this.addSvgIconLiteralInNamespace("",e,s,u)}addSvgIconInNamespace(e,s,u,i){return this._addSvgIconConfig(e,s,new md(u,null,i))}addSvgIconResolver(e){return this._resolvers.push(e),this}addSvgIconLiteralInNamespace(e,s,u,i){let E=this._sanitizer.sanitize($s.HTML,u);if(!E)throw SL(u);let L=Dv(E);return this._addSvgIconConfig(e,s,new md("",L,i))}addSvgIconSet(e,s){return this.addSvgIconSetInNamespace("",e,s)}addSvgIconSetLiteral(e,s){return this.addSvgIconSetLiteralInNamespace("",e,s)}addSvgIconSetInNamespace(e,s,u){return this._addSvgIconSetConfig(e,new md(s,null,u))}addSvgIconSetLiteralInNamespace(e,s,u){let i=this._sanitizer.sanitize($s.HTML,s);if(!i)throw SL(s);let E=Dv(i);return this._addSvgIconSetConfig(e,new md("",E,u))}registerFontClassAlias(e,s=e){return this._fontCssClassesByAlias.set(e,s),this}classNameForFontAlias(e){return this._fontCssClassesByAlias.get(e)||e}setDefaultFontSetClass(...e){return this._defaultFontSetClass=e,this}getDefaultFontSetClass(){return this._defaultFontSetClass}getSvgIconFromUrl(e){let s=this._sanitizer.sanitize($s.RESOURCE_URL,e);if(!s)throw IL(e);let u=this._cachedIconsByUrl.get(s);return u?nn(ww(u)):this._loadSvgIconFromConfig(new md(e,null)).pipe(xr(i=>this._cachedIconsByUrl.set(s,i)),un(i=>ww(i)))}getNamedSvgIcon(e,s=""){let u=AL(s,e),i=this._svgIconConfigs.get(u);if(i)return this._getSvgFromConfig(i);if(i=this._getIconConfigFromResolvers(s,e),i)return this._svgIconConfigs.set(u,i),this._getSvgFromConfig(i);let E=this._iconSetConfigs.get(s);return E?this._getSvgFromIconSetConfigs(e,E):fh(TL(u))}ngOnDestroy(){this._resolvers=[],this._svgIconConfigs.clear(),this._iconSetConfigs.clear(),this._cachedIconsByUrl.clear()}_getSvgFromConfig(e){return e.svgText?nn(ww(this._svgElementFromConfig(e))):this._loadSvgIconFromConfig(e).pipe(un(s=>ww(s)))}_getSvgFromIconSetConfigs(e,s){let u=this._extractIconWithNameFromAnySet(e,s);if(u)return nn(u);let i=s.filter(E=>!E.svgText).map(E=>this._loadSvgIconSetFromConfig(E).pipe(jc(L=>{let Y=`Loading icon set URL: ${this._sanitizer.sanitize($s.RESOURCE_URL,E.url)} failed: ${L.message}`;return this._errorHandler.handleError(new Error(Y)),nn(null)})));return uC(i).pipe(un(()=>{let E=this._extractIconWithNameFromAnySet(e,s);if(!E)throw TL(e);return E}))}_extractIconWithNameFromAnySet(e,s){for(let u=s.length-1;u>=0;u--){let i=s[u];if(i.svgText&&i.svgText.toString().indexOf(e)>-1){let E=this._svgElementFromConfig(i),L=this._extractSvgIconFromSet(E,e,i.options);if(L)return L}}return null}_loadSvgIconFromConfig(e){return this._fetchIcon(e).pipe(xr(s=>e.svgText=s),un(()=>this._svgElementFromConfig(e)))}_loadSvgIconSetFromConfig(e){return e.svgText?nn(null):this._fetchIcon(e).pipe(xr(s=>e.svgText=s))}_extractSvgIconFromSet(e,s,u){let i=e.querySelector(`[id="${s}"]`);if(!i)return null;let E=i.cloneNode(!0);if(E.removeAttribute("id"),E.nodeName.toLowerCase()==="svg")return this._setSvgAttributes(E,u);if(E.nodeName.toLowerCase()==="symbol")return this._setSvgAttributes(this._toSvgElement(E),u);let L=this._svgElementFromString(Dv("<svg></svg>"));return L.appendChild(E),this._setSvgAttributes(L,u)}_svgElementFromString(e){let s=this._document.createElement("DIV");s.innerHTML=e;let u=s.querySelector("svg");if(!u)throw Error("<svg> tag not found");return u}_toSvgElement(e){let s=this._svgElementFromString(Dv("<svg></svg>")),u=e.attributes;for(let i=0;i<u.length;i++){let{name:E,value:L}=u[i];E!=="id"&&s.setAttribute(E,L)}for(let i=0;i<e.childNodes.length;i++)e.childNodes[i].nodeType===this._document.ELEMENT_NODE&&s.appendChild(e.childNodes[i].cloneNode(!0));return s}_setSvgAttributes(e,s){return e.setAttribute("fit",""),e.setAttribute("height","100%"),e.setAttribute("width","100%"),e.setAttribute("preserveAspectRatio","xMidYMid meet"),e.setAttribute("focusable","false"),s&&s.viewBox&&e.setAttribute("viewBox",s.viewBox),e}_fetchIcon(e){let{url:s,options:u}=e,i=u?.withCredentials??!1;if(!this._httpClient)throw j6();if(s==null)throw Error(`Cannot fetch icon from URL "${s}".`);let E=this._sanitizer.sanitize($s.RESOURCE_URL,s);if(!E)throw IL(s);let L=this._inProgressUrlFetches.get(E);if(L)return L;let j=this._httpClient.get(E,{responseType:"text",withCredentials:i}).pipe(un(Y=>Dv(Y)),Vc(()=>this._inProgressUrlFetches.delete(E)),pC());return this._inProgressUrlFetches.set(E,j),j}_addSvgIconConfig(e,s,u){return this._svgIconConfigs.set(AL(e,s),u),this}_addSvgIconSetConfig(e,s){let u=this._iconSetConfigs.get(e);return u?u.push(s):this._iconSetConfigs.set(e,[s]),this}_svgElementFromConfig(e){if(!e.svgElement){let s=this._svgElementFromString(e.svgText);this._setSvgAttributes(s,e.options),e.svgElement=s}return e.svgElement}_getIconConfigFromResolvers(e,s){for(let u=0;u<this._resolvers.length;u++){let i=this._resolvers[u](s,e);if(i)return U6(i)?new md(i.url,null,i.options):new md(i,null)}}static \u0275fac=function(s){return new(s||n)(St(G_,8),St(UD),St(Un,8),St(Bs))};static \u0275prov=xt({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function ww(n){return n.cloneNode(!0)}function AL(n,r){return n+":"+r}function U6(n){return!!(n.url&&n.options)}var $6=new dt("MAT_ICON_DEFAULT_OPTIONS"),H6=new dt("mat-icon-location",{providedIn:"root",factory:G6});function G6(){let n=we(Un),r=n?n.location:null;return{getPathname:()=>r?r.pathname+r.search:""}}var kL=["clip-path","color-profile","src","cursor","fill","filter","marker","marker-start","marker-mid","marker-end","mask","stroke"],W6=kL.map(n=>`[${n}]`).join(", "),q6=/^url\(['"]?#(.*?)['"]?\)$/,Cw=(()=>{class n{_elementRef=we(yi);_iconRegistry=we(V6);_location=we(H6);_errorHandler=we(Bs);_defaultColor;get color(){return this._color||this._defaultColor}set color(e){this._color=e}_color;inline=!1;get svgIcon(){return this._svgIcon}set svgIcon(e){e!==this._svgIcon&&(e?this._updateSvgIcon(e):this._svgIcon&&this._clearSvgElement(),this._svgIcon=e)}_svgIcon;get fontSet(){return this._fontSet}set fontSet(e){let s=this._cleanupFontValue(e);s!==this._fontSet&&(this._fontSet=s,this._updateFontIconClasses())}_fontSet;get fontIcon(){return this._fontIcon}set fontIcon(e){let s=this._cleanupFontValue(e);s!==this._fontIcon&&(this._fontIcon=s,this._updateFontIconClasses())}_fontIcon;_previousFontSetClass=[];_previousFontIconClass;_svgName;_svgNamespace;_previousPath;_elementsWithExternalReferences;_currentIconFetch=Oi.EMPTY;constructor(){let e=we(new sg("aria-hidden"),{optional:!0}),s=we($6,{optional:!0});s&&(s.color&&(this.color=this._defaultColor=s.color),s.fontSet&&(this.fontSet=s.fontSet)),e||this._elementRef.nativeElement.setAttribute("aria-hidden","true")}_splitIconName(e){if(!e)return["",""];let s=e.split(":");switch(s.length){case 1:return["",s[0]];case 2:return s;default:throw Error(`Invalid icon name: "${e}"`)}}ngOnInit(){this._updateFontIconClasses()}ngAfterViewChecked(){let e=this._elementsWithExternalReferences;if(e&&e.size){let s=this._location.getPathname();s!==this._previousPath&&(this._previousPath=s,this._prependPathToReferences(s))}}ngOnDestroy(){this._currentIconFetch.unsubscribe(),this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear()}_usingFontIcon(){return!this.svgIcon}_setSvgElement(e){this._clearSvgElement();let s=this._location.getPathname();this._previousPath=s,this._cacheChildrenWithExternalReferences(e),this._prependPathToReferences(s),this._elementRef.nativeElement.appendChild(e)}_clearSvgElement(){let e=this._elementRef.nativeElement,s=e.childNodes.length;for(this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear();s--;){let u=e.childNodes[s];(u.nodeType!==1||u.nodeName.toLowerCase()==="svg")&&u.remove()}}_updateFontIconClasses(){if(!this._usingFontIcon())return;let e=this._elementRef.nativeElement,s=(this.fontSet?this._iconRegistry.classNameForFontAlias(this.fontSet).split(/ +/):this._iconRegistry.getDefaultFontSetClass()).filter(u=>u.length>0);this._previousFontSetClass.forEach(u=>e.classList.remove(u)),s.forEach(u=>e.classList.add(u)),this._previousFontSetClass=s,this.fontIcon!==this._previousFontIconClass&&!s.includes("mat-ligature-font")&&(this._previousFontIconClass&&e.classList.remove(this._previousFontIconClass),this.fontIcon&&e.classList.add(this.fontIcon),this._previousFontIconClass=this.fontIcon)}_cleanupFontValue(e){return typeof e=="string"?e.trim().split(" ")[0]:e}_prependPathToReferences(e){let s=this._elementsWithExternalReferences;s&&s.forEach((u,i)=>{u.forEach(E=>{i.setAttribute(E.name,`url('${e}#${E.value}')`)})})}_cacheChildrenWithExternalReferences(e){let s=e.querySelectorAll(W6),u=this._elementsWithExternalReferences=this._elementsWithExternalReferences||new Map;for(let i=0;i<s.length;i++)kL.forEach(E=>{let L=s[i],j=L.getAttribute(E),Y=j?j.match(q6):null;if(Y){let oe=u.get(L);oe||(oe=[],u.set(L,oe)),oe.push({name:E,value:Y[1]})}})}_updateSvgIcon(e){if(this._svgNamespace=null,this._svgName=null,this._currentIconFetch.unsubscribe(),e){let[s,u]=this._splitIconName(e);s&&(this._svgNamespace=s),u&&(this._svgName=u),this._currentIconFetch=this._iconRegistry.getNamedSvgIcon(u,s).pipe(go(1)).subscribe(i=>this._setSvgElement(i),i=>{let E=`Error retrieving icon ${s}:${u}! ${i.message}`;this._errorHandler.handleError(new Error(E))})}}static \u0275fac=function(s){return new(s||n)};static \u0275cmp=Bn({type:n,selectors:[["mat-icon"]],hostAttrs:["role","img",1,"mat-icon","notranslate"],hostVars:10,hostBindings:function(s,u){s&2&&(co("data-mat-icon-type",u._usingFontIcon()?"font":"svg")("data-mat-icon-name",u._svgName||u.fontIcon)("data-mat-icon-namespace",u._svgNamespace||u.fontSet)("fontIcon",u._usingFontIcon()?u.fontIcon:null),Dh(u.color?"mat-"+u.color:""),mr("mat-icon-inline",u.inline)("mat-icon-no-color",u.color!=="primary"&&u.color!=="accent"&&u.color!=="warn"))},inputs:{color:"color",inline:[2,"inline","inline",Vr],svgIcon:"svgIcon",fontSet:"fontSet",fontIcon:"fontIcon"},exportAs:["matIcon"],ngContentSelectors:z6,decls:1,vars:0,template:function(s,u){s&1&&(Hs(),Zo(0))},styles:["mat-icon,mat-icon.mat-primary,mat-icon.mat-accent,mat-icon.mat-warn{color:var(--mat-icon-color, inherit)}.mat-icon{-webkit-user-select:none;user-select:none;background-repeat:no-repeat;display:inline-block;fill:currentColor;height:24px;width:24px;overflow:hidden}.mat-icon.mat-icon-inline{font-size:inherit;height:inherit;line-height:inherit;width:inherit}.mat-icon.mat-ligature-font[fontIcon]::before{content:attr(fontIcon)}[dir=rtl] .mat-icon-rtl-mirror{transform:scale(-1, 1)}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon{display:block}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button .mat-icon{margin:auto}"],encapsulation:2,changeDetection:0})}return n})(),RL=(()=>{class n{static \u0275fac=function(s){return new(s||n)};static \u0275mod=en({type:n});static \u0275inj=Jt({imports:[$i,$i]})}return n})();var X6=["tooltip"],FL=20;var NL=new dt("mat-tooltip-scroll-strategy",{providedIn:"root",factory:()=>{let n=we(pd);return()=>n.scrollStrategies.reposition({scrollThrottle:FL})}});function Y6(n){return()=>n.scrollStrategies.reposition({scrollThrottle:FL})}var K6={provide:NL,deps:[pd],useFactory:Y6};function Q6(){return{showDelay:0,hideDelay:0,touchendHideDelay:1500}}var J6=new dt("mat-tooltip-default-options",{providedIn:"root",factory:Q6});var OL="tooltip-panel",LL=bp({passive:!0}),eG=8,tG=8,nG=24,iG=200,Kg=(()=>{class n{_elementRef=we(yi);_ngZone=we(ln);_platform=we(Ur);_ariaDescriber=we(Z2);_focusMonitor=we(qg);_dir=we(bv);_injector=we(Jn);_viewContainerRef=we(ba);_defaultOptions=we(J6,{optional:!0});_overlayRef;_tooltipInstance;_portal;_position="below";_positionAtOrigin=!1;_disabled=!1;_tooltipClass;_viewInitialized=!1;_pointerExitEventsInitialized=!1;_tooltipComponent=rG;_viewportMargin=8;_currentPosition;_cssClassPrefix="mat-mdc";_ariaDescriptionPending;_dirSubscribed=!1;get position(){return this._position}set position(e){e!==this._position&&(this._position=e,this._overlayRef&&(this._updatePosition(this._overlayRef),this._tooltipInstance?.show(0),this._overlayRef.updatePosition()))}get positionAtOrigin(){return this._positionAtOrigin}set positionAtOrigin(e){this._positionAtOrigin=Gg(e),this._detach(),this._overlayRef=null}get disabled(){return this._disabled}set disabled(e){let s=Gg(e);this._disabled!==s&&(this._disabled=s,s?this.hide(0):this._setupPointerEnterEventsIfNeeded(),this._syncAriaDescription(this.message))}get showDelay(){return this._showDelay}set showDelay(e){this._showDelay=Qx(e)}_showDelay;get hideDelay(){return this._hideDelay}set hideDelay(e){this._hideDelay=Qx(e),this._tooltipInstance&&(this._tooltipInstance._mouseLeaveHideDelay=this._hideDelay)}_hideDelay;touchGestures="auto";get message(){return this._message}set message(e){let s=this._message;this._message=e!=null?String(e).trim():"",!this._message&&this._isTooltipVisible()?this.hide(0):(this._setupPointerEnterEventsIfNeeded(),this._updateTooltipMessage()),this._syncAriaDescription(s)}_message="";get tooltipClass(){return this._tooltipClass}set tooltipClass(e){this._tooltipClass=e,this._tooltipInstance&&this._setTooltipClass(this._tooltipClass)}_passiveListeners=[];_touchstartTimeout=null;_destroyed=new _n;_isDestroyed=!1;constructor(){let e=this._defaultOptions;e&&(this._showDelay=e.showDelay,this._hideDelay=e.hideDelay,e.position&&(this.position=e.position),e.positionAtOrigin&&(this.positionAtOrigin=e.positionAtOrigin),e.touchGestures&&(this.touchGestures=e.touchGestures),e.tooltipClass&&(this.tooltipClass=e.tooltipClass)),this._viewportMargin=eG}ngAfterViewInit(){this._viewInitialized=!0,this._setupPointerEnterEventsIfNeeded(),this._focusMonitor.monitor(this._elementRef).pipe(Br(this._destroyed)).subscribe(e=>{e?e==="keyboard"&&this._ngZone.run(()=>this.show()):this._ngZone.run(()=>this.hide(0))})}ngOnDestroy(){let e=this._elementRef.nativeElement;this._touchstartTimeout&&clearTimeout(this._touchstartTimeout),this._overlayRef&&(this._overlayRef.dispose(),this._tooltipInstance=null),this._passiveListeners.forEach(([s,u])=>{e.removeEventListener(s,u,LL)}),this._passiveListeners.length=0,this._destroyed.next(),this._destroyed.complete(),this._isDestroyed=!0,this._ariaDescriber.removeDescription(e,this.message,"tooltip"),this._focusMonitor.stopMonitoring(e)}show(e=this.showDelay,s){if(this.disabled||!this.message||this._isTooltipVisible()){this._tooltipInstance?._cancelPendingAnimations();return}let u=this._createOverlay(s);this._detach(),this._portal=this._portal||new Ph(this._tooltipComponent,this._viewContainerRef);let i=this._tooltipInstance=u.attach(this._portal).instance;i._triggerElement=this._elementRef.nativeElement,i._mouseLeaveHideDelay=this._hideDelay,i.afterHidden().pipe(Br(this._destroyed)).subscribe(()=>this._detach()),this._setTooltipClass(this._tooltipClass),this._updateTooltipMessage(),i.show(e)}hide(e=this.hideDelay){let s=this._tooltipInstance;s&&(s.isVisible()?s.hide(e):(s._cancelPendingAnimations(),this._detach()))}toggle(e){this._isTooltipVisible()?this.hide():this.show(void 0,e)}_isTooltipVisible(){return!!this._tooltipInstance&&this._tooltipInstance.isVisible()}_createOverlay(e){if(this._overlayRef){let E=this._overlayRef.getConfig().positionStrategy;if((!this.positionAtOrigin||!e)&&E._origin instanceof yi)return this._overlayRef;this._detach()}let s=this._injector.get(wv).getAncestorScrollContainers(this._elementRef),u=this._injector.get(pd),i=u.position().flexibleConnectedTo(this.positionAtOrigin?e||this._elementRef:this._elementRef).withTransformOriginOn(`.${this._cssClassPrefix}-tooltip`).withFlexibleDimensions(!1).withViewportMargin(this._viewportMargin).withScrollableContainers(s);return i.positionChanges.pipe(Br(this._destroyed)).subscribe(E=>{this._updateCurrentPositionClass(E.connectionPair),this._tooltipInstance&&E.scrollableViewProperties.isOverlayClipped&&this._tooltipInstance.isVisible()&&this._ngZone.run(()=>this.hide(0))}),this._overlayRef=u.create({direction:this._dir,positionStrategy:i,panelClass:`${this._cssClassPrefix}-${OL}`,scrollStrategy:this._injector.get(NL)()}),this._updatePosition(this._overlayRef),this._overlayRef.detachments().pipe(Br(this._destroyed)).subscribe(()=>this._detach()),this._overlayRef.outsidePointerEvents().pipe(Br(this._destroyed)).subscribe(()=>this._tooltipInstance?._handleBodyInteraction()),this._overlayRef.keydownEvents().pipe(Br(this._destroyed)).subscribe(E=>{this._isTooltipVisible()&&E.keyCode===27&&!z2(E)&&(E.preventDefault(),E.stopPropagation(),this._ngZone.run(()=>this.hide(0)))}),this._defaultOptions?.disableTooltipInteractivity&&this._overlayRef.addPanelClass(`${this._cssClassPrefix}-tooltip-panel-non-interactive`),this._dirSubscribed||(this._dirSubscribed=!0,this._dir.change.pipe(Br(this._destroyed)).subscribe(()=>{this._overlayRef&&this._updatePosition(this._overlayRef)})),this._overlayRef}_detach(){this._overlayRef&&this._overlayRef.hasAttached()&&this._overlayRef.detach(),this._tooltipInstance=null}_updatePosition(e){let s=e.getConfig().positionStrategy,u=this._getOrigin(),i=this._getOverlayPosition();s.withPositions([this._addOffset(ut(ut({},u.main),i.main)),this._addOffset(ut(ut({},u.fallback),i.fallback))])}_addOffset(e){let s=tG,u=!this._dir||this._dir.value=="ltr";return e.originY==="top"?e.offsetY=-s:e.originY==="bottom"?e.offsetY=s:e.originX==="start"?e.offsetX=u?-s:s:e.originX==="end"&&(e.offsetX=u?s:-s),e}_getOrigin(){let e=!this._dir||this._dir.value=="ltr",s=this.position,u;s=="above"||s=="below"?u={originX:"center",originY:s=="above"?"top":"bottom"}:s=="before"||s=="left"&&e||s=="right"&&!e?u={originX:"start",originY:"center"}:(s=="after"||s=="right"&&e||s=="left"&&!e)&&(u={originX:"end",originY:"center"});let{x:i,y:E}=this._invertPosition(u.originX,u.originY);return{main:u,fallback:{originX:i,originY:E}}}_getOverlayPosition(){let e=!this._dir||this._dir.value=="ltr",s=this.position,u;s=="above"?u={overlayX:"center",overlayY:"bottom"}:s=="below"?u={overlayX:"center",overlayY:"top"}:s=="before"||s=="left"&&e||s=="right"&&!e?u={overlayX:"end",overlayY:"center"}:(s=="after"||s=="right"&&e||s=="left"&&!e)&&(u={overlayX:"start",overlayY:"center"});let{x:i,y:E}=this._invertPosition(u.overlayX,u.overlayY);return{main:u,fallback:{overlayX:i,overlayY:E}}}_updateTooltipMessage(){this._tooltipInstance&&(this._tooltipInstance.message=this.message,this._tooltipInstance._markForCheck(),Xc(()=>{this._tooltipInstance&&this._overlayRef.updatePosition()},{injector:this._injector}))}_setTooltipClass(e){this._tooltipInstance&&(this._tooltipInstance.tooltipClass=e,this._tooltipInstance._markForCheck())}_invertPosition(e,s){return this.position==="above"||this.position==="below"?s==="top"?s="bottom":s==="bottom"&&(s="top"):e==="end"?e="start":e==="start"&&(e="end"),{x:e,y:s}}_updateCurrentPositionClass(e){let{overlayY:s,originX:u,originY:i}=e,E;if(s==="center"?this._dir&&this._dir.value==="rtl"?E=u==="end"?"left":"right":E=u==="start"?"left":"right":E=s==="bottom"&&i==="top"?"above":"below",E!==this._currentPosition){let L=this._overlayRef;if(L){let j=`${this._cssClassPrefix}-${OL}-`;L.removePanelClass(j+this._currentPosition),L.addPanelClass(j+E)}this._currentPosition=E}}_setupPointerEnterEventsIfNeeded(){this._disabled||!this.message||!this._viewInitialized||this._passiveListeners.length||(this._platformSupportsMouseEvents()?this._passiveListeners.push(["mouseenter",e=>{this._setupPointerExitEventsIfNeeded();let s;e.x!==void 0&&e.y!==void 0&&(s=e),this.show(void 0,s)}]):this.touchGestures!=="off"&&(this._disableNativeGesturesIfNecessary(),this._passiveListeners.push(["touchstart",e=>{let s=e.targetTouches?.[0],u=s?{x:s.clientX,y:s.clientY}:void 0;this._setupPointerExitEventsIfNeeded(),this._touchstartTimeout&&clearTimeout(this._touchstartTimeout);let i=500;this._touchstartTimeout=setTimeout(()=>{this._touchstartTimeout=null,this.show(void 0,u)},this._defaultOptions?.touchLongPressShowDelay??i)}])),this._addListeners(this._passiveListeners))}_setupPointerExitEventsIfNeeded(){if(this._pointerExitEventsInitialized)return;this._pointerExitEventsInitialized=!0;let e=[];if(this._platformSupportsMouseEvents())e.push(["mouseleave",s=>{let u=s.relatedTarget;(!u||!this._overlayRef?.overlayElement.contains(u))&&this.hide()}],["wheel",s=>this._wheelListener(s)]);else if(this.touchGestures!=="off"){this._disableNativeGesturesIfNecessary();let s=()=>{this._touchstartTimeout&&clearTimeout(this._touchstartTimeout),this.hide(this._defaultOptions?.touchendHideDelay)};e.push(["touchend",s],["touchcancel",s])}this._addListeners(e),this._passiveListeners.push(...e)}_addListeners(e){e.forEach(([s,u])=>{this._elementRef.nativeElement.addEventListener(s,u,LL)})}_platformSupportsMouseEvents(){return!this._platform.IOS&&!this._platform.ANDROID}_wheelListener(e){if(this._isTooltipVisible()){let s=this._injector.get(Un).elementFromPoint(e.clientX,e.clientY),u=this._elementRef.nativeElement;s!==u&&!u.contains(s)&&this.hide()}}_disableNativeGesturesIfNecessary(){let e=this.touchGestures;if(e!=="off"){let s=this._elementRef.nativeElement,u=s.style;(e==="on"||s.nodeName!=="INPUT"&&s.nodeName!=="TEXTAREA")&&(u.userSelect=u.msUserSelect=u.webkitUserSelect=u.MozUserSelect="none"),(e==="on"||!s.draggable)&&(u.webkitUserDrag="none"),u.touchAction="none",u.webkitTapHighlightColor="transparent"}}_syncAriaDescription(e){this._ariaDescriptionPending||(this._ariaDescriptionPending=!0,this._ariaDescriber.removeDescription(this._elementRef.nativeElement,e,"tooltip"),this._isDestroyed||Xc({write:()=>{this._ariaDescriptionPending=!1,this.message&&!this.disabled&&this._ariaDescriber.describe(this._elementRef.nativeElement,this.message,"tooltip")}},{injector:this._injector}))}static \u0275fac=function(s){return new(s||n)};static \u0275dir=Ni({type:n,selectors:[["","matTooltip",""]],hostAttrs:[1,"mat-mdc-tooltip-trigger"],hostVars:2,hostBindings:function(s,u){s&2&&mr("mat-mdc-tooltip-disabled",u.disabled)},inputs:{position:[0,"matTooltipPosition","position"],positionAtOrigin:[0,"matTooltipPositionAtOrigin","positionAtOrigin"],disabled:[0,"matTooltipDisabled","disabled"],showDelay:[0,"matTooltipShowDelay","showDelay"],hideDelay:[0,"matTooltipHideDelay","hideDelay"],touchGestures:[0,"matTooltipTouchGestures","touchGestures"],message:[0,"matTooltip","message"],tooltipClass:[0,"matTooltipClass","tooltipClass"]},exportAs:["matTooltip"]})}return n})(),rG=(()=>{class n{_changeDetectorRef=we(ps);_elementRef=we(yi);_isMultiline=!1;message;tooltipClass;_showTimeoutId;_hideTimeoutId;_triggerElement;_mouseLeaveHideDelay;_animationsDisabled;_tooltip;_closeOnInteraction=!1;_isVisible=!1;_onHide=new _n;_showAnimation="mat-mdc-tooltip-show";_hideAnimation="mat-mdc-tooltip-hide";constructor(){let e=we(_a,{optional:!0});this._animationsDisabled=e==="NoopAnimations"}show(e){this._hideTimeoutId!=null&&clearTimeout(this._hideTimeoutId),this._showTimeoutId=setTimeout(()=>{this._toggleVisibility(!0),this._showTimeoutId=void 0},e)}hide(e){this._showTimeoutId!=null&&clearTimeout(this._showTimeoutId),this._hideTimeoutId=setTimeout(()=>{this._toggleVisibility(!1),this._hideTimeoutId=void 0},e)}afterHidden(){return this._onHide}isVisible(){return this._isVisible}ngOnDestroy(){this._cancelPendingAnimations(),this._onHide.complete(),this._triggerElement=null}_handleBodyInteraction(){this._closeOnInteraction&&this.hide(0)}_markForCheck(){this._changeDetectorRef.markForCheck()}_handleMouseLeave({relatedTarget:e}){(!e||!this._triggerElement.contains(e))&&(this.isVisible()?this.hide(this._mouseLeaveHideDelay):this._finalizeAnimation(!1))}_onShow(){this._isMultiline=this._isTooltipMultiline(),this._markForCheck()}_isTooltipMultiline(){let e=this._elementRef.nativeElement.getBoundingClientRect();return e.height>nG&&e.width>=iG}_handleAnimationEnd({animationName:e}){(e===this._showAnimation||e===this._hideAnimation)&&this._finalizeAnimation(e===this._showAnimation)}_cancelPendingAnimations(){this._showTimeoutId!=null&&clearTimeout(this._showTimeoutId),this._hideTimeoutId!=null&&clearTimeout(this._hideTimeoutId),this._showTimeoutId=this._hideTimeoutId=void 0}_finalizeAnimation(e){e?this._closeOnInteraction=!0:this.isVisible()||this._onHide.next()}_toggleVisibility(e){let s=this._tooltip.nativeElement,u=this._showAnimation,i=this._hideAnimation;if(s.classList.remove(e?i:u),s.classList.add(e?u:i),this._isVisible!==e&&(this._isVisible=e,this._changeDetectorRef.markForCheck()),e&&!this._animationsDisabled&&typeof getComputedStyle=="function"){let E=getComputedStyle(s);(E.getPropertyValue("animation-duration")==="0s"||E.getPropertyValue("animation-name")==="none")&&(this._animationsDisabled=!0)}e&&this._onShow(),this._animationsDisabled&&(s.classList.add("_mat-animation-noopable"),this._finalizeAnimation(e))}static \u0275fac=function(s){return new(s||n)};static \u0275cmp=Bn({type:n,selectors:[["mat-tooltip-component"]],viewQuery:function(s,u){if(s&1&&wa(X6,7),s&2){let i;Gs(i=Ws())&&(u._tooltip=i.first)}},hostAttrs:["aria-hidden","true"],hostBindings:function(s,u){s&1&&cr("mouseleave",function(E){return u._handleMouseLeave(E)})},decls:4,vars:4,consts:[["tooltip",""],[1,"mdc-tooltip","mat-mdc-tooltip",3,"animationend","ngClass"],[1,"mat-mdc-tooltip-surface","mdc-tooltip__surface"]],template:function(s,u){if(s&1){let i=hp();pn(0,"div",1,0),cr("animationend",function(L){return wh(i),Ch(u._handleAnimationEnd(L))}),pn(2,"div",2),Li(3),on()()}s&2&&(mr("mdc-tooltip--multiline",u._isMultiline),Gi("ngClass",u.tooltipClass),Xn(3),bg(u.message))},dependencies:[Cg],styles:['.mat-mdc-tooltip{position:relative;transform:scale(0);display:inline-flex}.mat-mdc-tooltip::before{content:"";top:0;right:0;bottom:0;left:0;z-index:-1;position:absolute}.mat-mdc-tooltip-panel-below .mat-mdc-tooltip::before{top:-8px}.mat-mdc-tooltip-panel-above .mat-mdc-tooltip::before{bottom:-8px}.mat-mdc-tooltip-panel-right .mat-mdc-tooltip::before{left:-8px}.mat-mdc-tooltip-panel-left .mat-mdc-tooltip::before{right:-8px}.mat-mdc-tooltip._mat-animation-noopable{animation:none;transform:scale(1)}.mat-mdc-tooltip-surface{word-break:normal;overflow-wrap:anywhere;padding:4px 8px;min-width:40px;max-width:200px;min-height:24px;max-height:40vh;box-sizing:border-box;overflow:hidden;text-align:center;will-change:transform,opacity;background-color:var(--mdc-plain-tooltip-container-color, var(--mat-sys-inverse-surface));color:var(--mdc-plain-tooltip-supporting-text-color, var(--mat-sys-inverse-on-surface));border-radius:var(--mdc-plain-tooltip-container-shape, var(--mat-sys-corner-extra-small));font-family:var(--mdc-plain-tooltip-supporting-text-font, var(--mat-sys-body-small-font));font-size:var(--mdc-plain-tooltip-supporting-text-size, var(--mat-sys-body-small-size));font-weight:var(--mdc-plain-tooltip-supporting-text-weight, var(--mat-sys-body-small-weight));line-height:var(--mdc-plain-tooltip-supporting-text-line-height, var(--mat-sys-body-small-line-height));letter-spacing:var(--mdc-plain-tooltip-supporting-text-tracking, var(--mat-sys-body-small-tracking))}.mat-mdc-tooltip-surface::before{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:1px solid rgba(0,0,0,0);border-radius:inherit;content:"";pointer-events:none}.mdc-tooltip--multiline .mat-mdc-tooltip-surface{text-align:left}[dir=rtl] .mdc-tooltip--multiline .mat-mdc-tooltip-surface{text-align:right}.mat-mdc-tooltip-panel{line-height:normal}.mat-mdc-tooltip-panel.mat-mdc-tooltip-panel-non-interactive{pointer-events:none}@keyframes mat-mdc-tooltip-show{0%{opacity:0;transform:scale(0.8)}100%{opacity:1;transform:scale(1)}}@keyframes mat-mdc-tooltip-hide{0%{opacity:1;transform:scale(1)}100%{opacity:0;transform:scale(0.8)}}.mat-mdc-tooltip-show{animation:mat-mdc-tooltip-show 150ms cubic-bezier(0, 0, 0.2, 1) forwards}.mat-mdc-tooltip-hide{animation:mat-mdc-tooltip-hide 75ms cubic-bezier(0.4, 0, 1, 1) forwards}'],encapsulation:2,changeDetection:0})}return n})();var zL=(()=>{class n{static \u0275fac=function(s){return new(s||n)};static \u0275mod=en({type:n});static \u0275inj=Jt({providers:[K6],imports:[K2,gw,$i,$i,fw]})}return n})();var Ew=class n{constructor(r,e){this.store=r;this.notificationService=e;this.store.pipe(kh(Kx)).subscribe(s=>{s&&this.searchedCity.set(s)})}cityNameChanged(r){this.searchedCity.set(r?.target?.value)}isCelsius=fs(!0);searchedCity=fs("");selectedCity=K0();updateTemperatureType(){this.isCelsius.update(r=>r=!r),this.notificationService.success(`Temperature unit changed to ${this.isCelsius()?"Celsius":"Fahrenheit"}`),this.searchCity(!0)}searchCity(r){let e=[this.searchedCity(),this.isCelsius()];r&&e.push(!0),this.selectedCity.emit(e)}static \u0275fac=function(e){return new(e||n)(Hi(hd),Hi(Oh))};static \u0275cmp=Bn({type:n,selectors:[["app-search-city"]],outputs:{selectedCity:"selectedCity"},standalone:!1,decls:9,vars:2,consts:[[1,"searchContainer"],[1,"d-inline-flex","align-items-center"],["type","text","placeholder","Enter City Name",3,"input","keydown.enter","value"],["matTooltip","Search",1,"cursor-pointer",3,"click"],[1,"ms-4","d-inline-flex"],["matTooltip","Change Units","value","isCelsius()",3,"toggleChange"]],template:function(e,s){e&1&&(pn(0,"div",0)(1,"div",1)(2,"input",2),cr("input",function(i){return s.cityNameChanged(i)})("keydown.enter",function(){return s.searchCity()}),on(),Li(3," \xA0\xA0 "),pn(4,"mat-icon",3),cr("click",function(){return s.searchCity()}),Li(5,"search"),on()(),pn(6,"div",4)(7,"mat-slide-toggle",5),cr("toggleChange",function(){return s.updateTemperatureType()}),Li(8),on()()()),e&2&&(Xn(2),Gi("value",s.searchedCity()),Xn(6),Xo(" ",s.isCelsius()?" Celsius":" Fahrenheit"," "))},dependencies:[bw,Cw,Kg],styles:[".example-form[_ngcontent-%COMP%]{min-width:150px;max-width:500px;width:100%}.example-full-width[_ngcontent-%COMP%]{width:100%}.searchContainer[_ngcontent-%COMP%]{width:565px;display:flex;justify-content:flex-end;align-items:center}  .mdc-label{width:30px}input[type=text][_ngcontent-%COMP%]{padding:15px;margin:10px 0;width:100%;max-width:300px;border:1px solid #ccc;border-radius:5px;font-size:18px;box-shadow:0 5px 15px #0000001a;transition:border-color .3s ease-in-out}input[type=text][_ngcontent-%COMP%]:focus{outline:none;border-color:#2196f3}input[type=text][_ngcontent-%COMP%]::placeholder{color:#aaa}.cursor-pointer[_ngcontent-%COMP%]{cursor:pointer}"]})};var sG=()=>[12],BL=(n,r)=>[n,r];function aG(n,r){if(n&1&&(pn(0,"div",1),Ui(1,"mgl-marker",2),on()),n&2){let e=xa();Xn(),Gi("lngLat",yD(1,BL,e.longitude(),e.latitude()))}}var Dw=class n{constructor(r){this.store=r;this.store.pipe(kh(F2)).subscribe(e=>{e&&this.latitude.set(e)}),this.store.pipe(kh(N2)).subscribe(e=>{e&&this.longitude.set(e)})}latLongSelected=K0();longitude=fs(-74.0066);latitude=fs(40.7135);onMapClick(r){let e=r.lngLat;this.latitude.set(e.lat),this.longitude.set(e.lng),this.store.dispatch(Hg({latitude:this.latitude(),longitude:this.longitude()})),this.latLongSelected.emit(e)}static \u0275fac=function(e){return new(e||n)(Hi(hd))};static \u0275cmp=Bn({type:n,selectors:[["app-map"]],outputs:{latLongSelected:"latLongSelected"},standalone:!1,decls:2,vars:9,consts:[[3,"mapClick","zoom","center"],["matTooltip","Info about the action"],[3,"lngLat"]],template:function(e,s){e&1&&(pn(0,"mgl-map",0),cr("mapClick",function(i){return s.onMapClick(i)}),qo(1,aG,2,4,"div",1),on()),e&2&&(tP("mapbox://styles/mapbox/streets-v11"),Gi("zoom",gD(5,sG))("center",yD(6,BL,s.longitude(),s.latitude())),Xn(),Mh(s.longitude()&&s.latitude()?1:-1))},dependencies:[Kg,t2,n2],styles:["mgl-map[_ngcontent-%COMP%]{height:100%;width:100%}"]})};var Mw=HI(jL());var cG=["*"];var uG=new dt("MAT_CARD_CONFIG"),VL=(()=>{class n{appearance;constructor(){let e=we(uG,{optional:!0});this.appearance=e?.appearance||"raised"}static \u0275fac=function(s){return new(s||n)};static \u0275cmp=Bn({type:n,selectors:[["mat-card"]],hostAttrs:[1,"mat-mdc-card","mdc-card"],hostVars:4,hostBindings:function(s,u){s&2&&mr("mat-mdc-card-outlined",u.appearance==="outlined")("mdc-card--outlined",u.appearance==="outlined")},inputs:{appearance:"appearance"},exportAs:["matCard"],ngContentSelectors:cG,decls:1,vars:0,template:function(s,u){s&1&&(Hs(),Zo(0))},styles:['.mat-mdc-card{display:flex;flex-direction:column;box-sizing:border-box;position:relative;border-style:solid;border-width:0;background-color:var(--mdc-elevated-card-container-color, var(--mat-sys-surface-container-low));border-color:var(--mdc-elevated-card-container-color, var(--mat-sys-surface-container-low));border-radius:var(--mdc-elevated-card-container-shape, var(--mat-sys-corner-medium));box-shadow:var(--mdc-elevated-card-container-elevation, var(--mat-sys-level1))}.mat-mdc-card::after{position:absolute;top:0;left:0;width:100%;height:100%;border:solid 1px rgba(0,0,0,0);content:"";display:block;pointer-events:none;box-sizing:border-box;border-radius:var(--mdc-elevated-card-container-shape, var(--mat-sys-corner-medium))}.mat-mdc-card-outlined{background-color:var(--mdc-outlined-card-container-color, var(--mat-sys-surface));border-radius:var(--mdc-outlined-card-container-shape, var(--mat-sys-corner-medium));border-width:var(--mdc-outlined-card-outline-width, 1px);border-color:var(--mdc-outlined-card-outline-color, var(--mat-sys-outline-variant));box-shadow:var(--mdc-outlined-card-container-elevation, var(--mat-sys-level0))}.mat-mdc-card-outlined::after{border:none}.mdc-card__media{position:relative;box-sizing:border-box;background-repeat:no-repeat;background-position:center;background-size:cover}.mdc-card__media::before{display:block;content:""}.mdc-card__media:first-child{border-top-left-radius:inherit;border-top-right-radius:inherit}.mdc-card__media:last-child{border-bottom-left-radius:inherit;border-bottom-right-radius:inherit}.mat-mdc-card-actions{display:flex;flex-direction:row;align-items:center;box-sizing:border-box;min-height:52px;padding:8px}.mat-mdc-card-title{font-family:var(--mat-card-title-text-font, var(--mat-sys-title-large-font));line-height:var(--mat-card-title-text-line-height, var(--mat-sys-title-large-line-height));font-size:var(--mat-card-title-text-size, var(--mat-sys-title-large-size));letter-spacing:var(--mat-card-title-text-tracking, var(--mat-sys-title-large-tracking));font-weight:var(--mat-card-title-text-weight, var(--mat-sys-title-large-weight))}.mat-mdc-card-subtitle{color:var(--mat-card-subtitle-text-color, var(--mat-sys-on-surface));font-family:var(--mat-card-subtitle-text-font, var(--mat-sys-title-medium-font));line-height:var(--mat-card-subtitle-text-line-height, var(--mat-sys-title-medium-line-height));font-size:var(--mat-card-subtitle-text-size, var(--mat-sys-title-medium-size));letter-spacing:var(--mat-card-subtitle-text-tracking, var(--mat-sys-title-medium-tracking));font-weight:var(--mat-card-subtitle-text-weight, var(--mat-sys-title-medium-weight))}.mat-mdc-card-title,.mat-mdc-card-subtitle{display:block;margin:0}.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-title,.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-subtitle{padding:16px 16px 0}.mat-mdc-card-header{display:flex;padding:16px 16px 0}.mat-mdc-card-content{display:block;padding:0 16px}.mat-mdc-card-content:first-child{padding-top:16px}.mat-mdc-card-content:last-child{padding-bottom:16px}.mat-mdc-card-title-group{display:flex;justify-content:space-between;width:100%}.mat-mdc-card-avatar{height:40px;width:40px;border-radius:50%;flex-shrink:0;margin-bottom:16px;object-fit:cover}.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-subtitle,.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-title{line-height:normal}.mat-mdc-card-sm-image{width:80px;height:80px}.mat-mdc-card-md-image{width:112px;height:112px}.mat-mdc-card-lg-image{width:152px;height:152px}.mat-mdc-card-xl-image{width:240px;height:240px}.mat-mdc-card-subtitle~.mat-mdc-card-title,.mat-mdc-card-title~.mat-mdc-card-subtitle,.mat-mdc-card-header .mat-mdc-card-header-text .mat-mdc-card-title,.mat-mdc-card-header .mat-mdc-card-header-text .mat-mdc-card-subtitle,.mat-mdc-card-title-group .mat-mdc-card-title,.mat-mdc-card-title-group .mat-mdc-card-subtitle{padding-top:0}.mat-mdc-card-content>:last-child:not(.mat-mdc-card-footer){margin-bottom:0}.mat-mdc-card-actions-align-end{justify-content:flex-end}'],encapsulation:2,changeDetection:0})}return n})();var UL=(()=>{class n{static \u0275fac=function(s){return new(s||n)};static \u0275dir=Ni({type:n,selectors:[["mat-card-content"]],hostAttrs:[1,"mat-mdc-card-content"]})}return n})();var $L=(()=>{class n{static \u0275fac=function(s){return new(s||n)};static \u0275mod=en({type:n});static \u0275inj=Jt({imports:[$i,$i]})}return n})();var HL=(()=>{class n{get vertical(){return this._vertical}set vertical(e){this._vertical=Gg(e)}_vertical=!1;get inset(){return this._inset}set inset(e){this._inset=Gg(e)}_inset=!1;static \u0275fac=function(s){return new(s||n)};static \u0275cmp=Bn({type:n,selectors:[["mat-divider"]],hostAttrs:["role","separator",1,"mat-divider"],hostVars:7,hostBindings:function(s,u){s&2&&(co("aria-orientation",u.vertical?"vertical":"horizontal"),mr("mat-divider-vertical",u.vertical)("mat-divider-horizontal",!u.vertical)("mat-divider-inset",u.inset))},inputs:{vertical:"vertical",inset:"inset"},decls:0,vars:0,template:function(s,u){},styles:[".mat-divider{display:block;margin:0;border-top-style:solid;border-top-color:var(--mat-divider-color, var(--mat-sys-outline));border-top-width:var(--mat-divider-width, 1px)}.mat-divider.mat-divider-vertical{border-top:0;border-right-style:solid;border-right-color:var(--mat-divider-color, var(--mat-sys-outline));border-right-width:var(--mat-divider-width, 1px)}.mat-divider.mat-divider-inset{margin-left:80px}[dir=rtl] .mat-divider.mat-divider-inset{margin-left:auto;margin-right:80px}"],encapsulation:2,changeDetection:0})}return n})(),GL=(()=>{class n{static \u0275fac=function(s){return new(s||n)};static \u0275mod=en({type:n});static \u0275inj=Jt({imports:[$i,$i]})}return n})();var WL=(()=>{class n{constructor(e,s){this.el=e,this._zone=s,this.updateChange=new Dt(!0),this.chartInstance=new Dt}ngOnChanges(e){let s=e.update?.currentValue;(e.options||s)&&(this.wrappedUpdateOrCreateChart(),s&&this.updateChange.emit(!1))}wrappedUpdateOrCreateChart(){this.runOutsideAngular?this._zone.runOutsideAngular(()=>{this.updateOrCreateChart()}):this.updateOrCreateChart()}updateOrCreateChart(){this.chart?.update?this.chart.update(this.options,!0,this.oneToOne||!1):(this.chart=this.Highcharts[this.constructorType||"chart"](this.el.nativeElement,this.options,this.callbackFunction||null),this.chartInstance.emit(this.chart))}ngOnDestroy(){this.chart&&(this.chart.destroy(),this.chart=null,this.chartInstance.emit(this.chart))}static{this.\u0275fac=function(s){return new(s||n)(Hi(yi),Hi(ln))}}static{this.\u0275cmp=Bn({type:n,selectors:[["highcharts-chart"]],inputs:{Highcharts:"Highcharts",constructorType:"constructorType",callbackFunction:"callbackFunction",oneToOne:"oneToOne",runOutsideAngular:"runOutsideAngular",options:"options",update:"update"},outputs:{updateChange:"updateChange",chartInstance:"chartInstance"},standalone:!1,features:[hs],decls:0,vars:0,template:function(s,u){},encapsulation:2})}}return n})(),qL=(()=>{class n{static{this.\u0275fac=function(s){return new(s||n)}}static{this.\u0275mod=en({type:n})}static{this.\u0275inj=Jt({})}}return n})();function pG(n,r){if(n&1&&(pn(0,"div",5)(1,"div",6)(2,"div",7)(3,"p",8)(4,"mat-icon",9),Li(5,"thermostat"),on(),Li(6),on(),pn(7,"p",10)(8,"mat-icon",11),Li(9,"wb_cloudy"),on(),Li(10),on()(),Ui(11,"mat-divider",12),pn(12,"div")(13,"p",13)(14,"mat-icon",14),Li(15,"thermostat"),on(),Li(16),on(),pn(17,"p",15)(18,"mat-icon",16),Li(19,"speed"),on(),Li(20),on(),pn(21,"p",15)(22,"mat-icon",17),Li(23,"water_drop"),on(),Li(24),on(),pn(25,"p",15)(26,"mat-icon",18),Li(27,"air"),on(),Li(28),on(),pn(29,"p",15)(30,"mat-icon",19),Li(31,"cloud"),on(),Li(32),on()()()()),n&2){let e,s,u=xa();Xn(3),Gi("ngClass",u.getTemperatureClass()),Xn(3),lx(" ",(e=u.currentWeather().main)==null?null:e.temp," \xB0 ",u.isCelsius()?"C":"F"," "),Xn(4),Xo(" ",u.currentWeather().weather[0].main," "),Xn(),Gi("vertical",!0),Xn(5),lx(" \xA0 ",(s=u.currentWeather())==null||s.main==null?null:s.main.feels_like," \xB0",u.isCelsius()?"C":"F"," "),Xn(4),Xo(" \xA0 ",u.currentWeather().main.pressure," hPa "),Xn(4),Xo(" \xA0 ",u.currentWeather().main.humidity,"% "),Xn(4),Xo(" \xA0 ",u.currentWeather().wind.speed," km/h "),Xn(4),Xo(" \xA0 ",u.currentWeather().clouds.all,"% ")}}var Tw=class n{Highcharts=Mw;name="";country="";currentWeather=L_();isCelsius=L_();foreCastList={list:[]};set updateForeCastListInput(r){this.foreCastList=r,this.updateTempAndWind()}loaded=!0;iconUrl="https://openweathermap.org/img/wn/50n@2x.png";temperatureChartOptions={};windSpeedChartOptions={};constructor(){}ngOnInit(){}getTemperatureClass(){let r=this.currentWeather()?.main?.temp,e=this.isCelsius();if(r===void 0)return{};let s=r;return e||(s=(r-32)*5/9),{blue:s<5,yellow:5<=s&&s<15,orange:15<=s&&s<25,red:s>=25}}updateTempAndWind(){this.temperatureChartOptions={chart:{type:"line"},title:{text:"Temperature Forecast"},xAxis:{type:"datetime",title:{text:"Time"},labels:{formatter:function(){return Mw.dateFormat("%e %b",this.value)}}},yAxis:{title:{text:`Temperature (${this.isCelsius()?"\xB0C":"\xB0F"})`}},tooltip:{xDateFormat:"%e %b %Y %H:%M",valueSuffix:`${this.isCelsius()?" \xB0C":" \xB0F"}`},series:[{name:"Temperature",data:this.foreCastList?.list.map(r=>({x:new Date(r.dt_txt).getTime(),y:r.main.temp})),type:"line"}]},this.windSpeedChartOptions={chart:{type:"line"},title:{text:"Wind Speed Forecast"},xAxis:{type:"datetime",title:{text:"Time"},labels:{formatter:function(){return Mw.dateFormat("%e %b",this.value)}}},yAxis:{title:{text:"Wind Speed (m/s)"}},tooltip:{xDateFormat:"%e %b %Y %H:%M",valueSuffix:" m/s"},series:[{name:"Wind Speed",data:this.foreCastList?.list.map(r=>({x:new Date(r.dt_txt).getTime(),y:r.wind.speed})),type:"line"}]}}convertTimestampToDayMonth(r){let e=new Date(r*1e3),s=e.getDate(),u=["January","February","March","April","May","June","July","August","September","October","November","December"],i=e.getMonth(),E=u[i];return`${s}-${E}`}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=Bn({type:n,selectors:[["app-weather-display"]],inputs:{currentWeather:[1,"currentWeather"],isCelsius:[1,"isCelsius"],updateForeCastListInput:[0,"foreCastList","updateForeCastListInput"]},standalone:!1,decls:12,vars:5,consts:[[1,"grid-container"],["appearance","outlined",1,"grid-item","weatherDetailsCard"],["class","content",4,"ngIf"],[1,"weather-chart"],[2,"width","100%","height","400px","display","block",3,"Highcharts","options"],[1,"content"],[1,"d-flex","justify-content-evenly","mt-3"],[1,"currentTemperatureSection"],[1,"largeText","mb-1",3,"ngClass"],["matTooltip","Current Temperature",1,"cursorInitial","align-middle","increaseIconSize"],[1,"blue-color","text-center"],["matTooltip","Current Weather",1,"align-middle","cursorInitial"],[3,"vertical"],[1,"blue-color",2,"margin-top","10px"],["matTooltip","Feels like",1,"cursorInitial"],[1,"blue-color"],["matTooltip","Pressure",1,"cursorInitial"],["matTooltip","Humidity",1,"cursorInitial"],["matTooltip","Wind",1,"cursorInitial"],["matTooltip","Clouds",1,"cursorInitial"]],template:function(e,s){e&1&&(pn(0,"div",0)(1,"mat-card",1)(2,"mat-card-content"),qo(3,pG,33,11,"div",2),on()(),pn(4,"mat-card",1)(5,"mat-card-content")(6,"div",3),Ui(7,"highcharts-chart",4),on()()(),pn(8,"mat-card",1)(9,"mat-card-content")(10,"div",3),Ui(11,"highcharts-chart",4),on()()()()),e&2&&(Xn(3),Gi("ngIf",s.loaded),Xn(4),Gi("Highcharts",s.Highcharts)("options",s.temperatureChartOptions),Xn(4),Gi("Highcharts",s.Highcharts)("options",s.windSpeedChartOptions))},dependencies:[VL,UL,Cg,mx,HL,Cw,Kg,WL],styles:[".weatherDetailsCard[_ngcontent-%COMP%]{-webkit-box-shadow:-1px 2px 9px -2px rgba(0,0,0,.55);-moz-box-shadow:-1px 2px 9px -2px rgba(0,0,0,.55);box-shadow:-1px 2px 9px -2px #0000008c}.grid-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr 1fr;grid-gap:10px;padding:10px;height:30vh}.blue[_ngcontent-%COMP%]{color:#4169e1}.yellow[_ngcontent-%COMP%]{color:#f4a460}.orange[_ngcontent-%COMP%]{color:#ff8c00}.red[_ngcontent-%COMP%]{color:red}.justify-content-evenly[_ngcontent-%COMP%]{justify-content:space-evenly}.cursorInitial[_ngcontent-%COMP%]{cursor:initial}.blue-color[_ngcontent-%COMP%]{color:#2caffe;font-weight:600}.currentTemperatureSection[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center}.increaseIconSize[_ngcontent-%COMP%]{transform:scale(1.5)}.largeText[_ngcontent-%COMP%]{font-size:48px;line-height:50px}@media only screen and (max-height: 768px),screen and (max-width: 768px){.container[_ngcontent-%COMP%]{justify-content:normal}.main[_ngcontent-%COMP%]{width:100vw;padding-top:2em;padding-bottom:1em}}"]})};function gG(n,r){if(n&1&&(pn(0,"h6"),Li(1," Current weather in "),pn(2,"b",9),Li(3),on()()),n&2){let e=xa();Xn(3),bg(e.currentCityDetails==null?null:e.currentCityDetails.name)}}function yG(n,r){if(n&1&&Ui(0,"app-weather-display",10),n&2){let e=xa();Gi("currentWeather",e.currentCityDetails)("foreCastList",e.foreCastList)("isCelsius",e.metric())}}var Iw=class n{constructor(r,e,s,u){this.httpService=r;this.weatherService=e;this.store=s;this.notificationService=u;this.store.pipe(kh(Kx)).subscribe(i=>{i&&(this.cityName.set(i),this.searchCityApiCall())})}get showCardDetails(){return Object.keys(this.currentCityDetails)?.length}cityName=fs("");metric=fs(!0);currentCityDetails={};foreCastList={list:[]};onlyMetricChanged=!1;searchCity(r){this.cityName.set(r[0]),this.metric.set(r[1]),r?.[2]&&(this.onlyMetricChanged=!0),this.searchCityApiCall()}searchCityApiCall(){let r=this.weatherService.getDetailsViaCityName(this.cityName(),this.metric());this.httpService.get(r).subscribe(e=>{this.currentCityDetails=e,this.store.dispatch(Hg({latitude:parseFloat(e?.coord?.lat),longitude:parseFloat(e?.coord?.lon)})),this.store.dispatch(_v({locationName:this.cityName()})),this.onlyMetricChanged?this.onlyMetricChanged=!1:this.notificationService.success(`Displaying weather for ${this.cityName()}`),this.foreCastDetails()},e=>{this.notificationService.error("City not found. Please check the spelling and try again."),console.error("Error",e)})}foreCastDetails(){let r=this.weatherService.getDetailsViaCityName(this.cityName(),this.metric(),!0);this.httpService.get(r).subscribe(e=>{this.foreCastList={list:[]},this.foreCastList=e},e=>{this.notificationService.error(e),console.error("Error",e)})}updateDetailsViaLatLon(r){let e=this.weatherService.getDetailsViaLatLong(r.lat,r.lng,this.metric());this.httpService.get(e).subscribe(s=>{this.currentCityDetails=s,this.foreCastDetails(),this.store.dispatch(_v({locationName:s?.name}))},s=>{this.notificationService.error(s),console.error("Error",s)})}static \u0275fac=function(e){return new(e||n)(Hi(Vg),Hi(jg),Hi(hd),Hi(Oh))};static \u0275cmp=Bn({type:n,selectors:[["app-weather-dashboard"]],standalone:!1,features:[Ca([])],decls:10,vars:2,consts:[[1,"containerBox"],[1,"grid-container"],[1,"element-two-thirds"],[4,"ngIf"],[1,"element-one-third"],[3,"selectedCity"],[1,"mapComponent"],[3,"latLongSelected"],[3,"currentWeather","foreCastList","isCelsius",4,"ngIf"],[1,"blue"],[3,"currentWeather","foreCastList","isCelsius"]],template:function(e,s){e&1&&(pn(0,"div",0)(1,"div",1)(2,"div",2),qo(3,gG,4,1,"h6",3),on(),pn(4,"div",4)(5,"app-search-city",5),cr("selectedCity",function(i){return s.searchCity(i)}),on()()(),pn(6,"div",6)(7,"app-map",7),cr("latLongSelected",function(i){return s.updateDetailsViaLatLon(i)}),on()(),pn(8,"div"),qo(9,yG,1,3,"app-weather-display",8),on()()),e&2&&(Xn(3),Gi("ngIf",s.showCardDetails),Xn(6),Gi("ngIf",s.showCardDetails))},dependencies:[mx,Ew,Dw,Tw],styles:[".mapComponent[_ngcontent-%COMP%]{height:35vh;padding:15px;margin-left:15px;margin-right:15px;-webkit-box-shadow:-1px 2px 9px -2px rgba(0,0,0,.55);-moz-box-shadow:-1px 2px 9px -2px rgba(0,0,0,.55);box-shadow:-1px 2px 9px -2px #0000008c}.mainBlock[_ngcontent-%COMP%]{width:95%}.grid-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:6fr 4fr;height:10vh;place-items:center}.element-one-third[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:center}.blue[_ngcontent-%COMP%]{color:#00f}"]})};var _G=[{path:"",component:Iw}],Sw=class n{static \u0275fac=function(e){return new(e||n)};static \u0275mod=en({type:n});static \u0275inj=Jt({imports:[TM.forRoot(_G),TM]})};var Tv=(()=>{class n{static \u0275fac=function(s){return new(s||n)};static \u0275mod=en({type:n});static \u0275inj=Jt({imports:[$i,tw,$i]})}return n})();var ZL=(()=>{class n{static \u0275fac=function(s){return new(s||n)};static \u0275mod=en({type:n});static \u0275inj=Jt({})}return n})();var XL=(()=>{class n{static \u0275fac=function(s){return new(s||n)};static \u0275mod=en({type:n});static \u0275inj=Jt({imports:[$i,Tv,Tv,ZL,$i]})}return n})();var vG={latitude:40.7143,longitude:-74.006,locationName:"New York"},bG=L2(vG,qM(Hg,(n,{latitude:r,longitude:e})=>Cn(ut({},n),{latitude:r,longitude:e})),qM(_v,(n,{locationName:r})=>Cn(ut({},n),{locationName:r})));function YL(n,r){return bG(n,r)}var Aw=class n{static \u0275fac=function(e){return new(e||n)};static \u0275mod=en({type:n,bootstrap:[Gx]});static \u0275inj=Jt({providers:[jg,Vg,Oh],imports:[DL,Tv,XL,$L,ML,uw,Eg,rO,Sw,GP,GL,RL,zL,i2.withConfig({accessToken:"pk.eyJ1Ijoid3lra3NzIiwiYSI6ImNqMjR6aTdmdzAwNHMzMnBvbjBucjlqNm8ifQ.6GjGpofWBVaIuSnhdXQb5w"}),O2.forRoot({location:YL}),qL,bL]})};iO().bootstrapModule(Aw).catch(n=>console.error(n));
